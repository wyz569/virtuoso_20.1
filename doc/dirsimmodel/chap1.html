
<html><head><title>Modeling for Direct Simulation</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="shubh" />
<meta name="CreateDate" content="2020-09-15" />
<meta name="CreateTime" content="1600236310" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes direct simulation modeling for Virtuoso Analog Design Environment." />
<meta name="DocTitle" content="Direct Simulation Modeling Guide" />
<meta name="DocType" content="User Guide" />
<meta name="FileTitle" content="Modeling for Direct Simulation" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-3.2.1" />
<meta name="Keyword" content="dirsimmodel" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2020-09-15" />
<meta name="ModifiedTime" content="1600236310" />
<meta name="NextFile" content="dirsimmodelIX.html" />
<meta name="Group" content="" />
<meta name="Platform" content="Custom IC Design,Custom IC Design" />
<meta name="PrevFile" content="preface.html" />
<meta name="c_product" content="Spectre,Virtuoso Analog Design Environment" />
<meta name="Product" content="Spectre,Virtuoso Analog Design Environment" />
<meta name="ProductFamily" content="Spectre,Virtuoso Analog Design Environment" />
<meta name="ProductVersion" content="ICADVM20.1" />
<meta name="RightsManagement" content="Copyright 2012-2020 Cadence Design Systems Inc." />
<meta name="Title" content="Direct Simulation Modeling Guide -- Modeling for Direct Simulation" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="prod_feature" content="" />
<meta name="prod_subfeature" content="" />
<meta name="new_topic" content="No" />
<meta name="spotlight_topic" content="0" />
<meta name="Version" content="ICADVM20.1" />
<meta name="SpaceKey" content="dirsimmodelICADVM201" />
<meta name="webflare-version" content="2.0" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" /></head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="dirsimmodelTOC.html">Contents</a></li><li><a class="prev" href="preface.html" title="Preface">Preface</a></li><li style="float: right;"><a class="viewPrint" href="dirsimmodel.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="dirsimmodelIX.html" title="Index">Index</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Direct Simulation Modeling Guide<br />Product Version ICADVM20.1, October 2020</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;"><a name="#firstpage"></a>

<h1>1
<a id="pgfId-1032955"></a></h1>
<h1>
<a id="pgfId-1035319"></a><hr />
Modeling for Direct Simulation<hr />
</h1>

<p>
<a id="pgfId-1035334"></a>Cad<a id="1037145"></a>ence strongly recommends that you use the modeling practices described in this document. Cadence is committed to these modeling practices, and these practices are fully supported by the Virtuoso Analog Design Environment, the Spectre Circuit Simulator, and the Spectre interface. </p>
<p>
<a id="pgfId-1035335"></a>By employing the direct modeling practices described in this document, you can use different types of models without making any design changes. For example, you can model an<em> npn</em> device as </p>
<ul><li>
<a id="pgfId-1035336"></a>a simple simulator model statement, </li><li>
<a id="pgfId-1035337"></a>a simple <code>subckt</code> definition, </li><li>
<a id="pgfId-1035338"></a>an advanced <code>subckt</code> definition, or </li><li>
<a id="pgfId-1035339"></a>a behavioral definition.</li></ul>



<p>
<a id="pgfId-1035340"></a>Neither the design nor the component description format (CDF) of the <em>npn</em> component in <code>analogLib</code><a id="marker-1035341"></a> needs to change. You can change the model complexity without design or CDF edits.</p>

<h3>
<a id="pgfId-1035343"></a>Modeling Strategies</h3>

<p>
<a id="pgfId-1035344"></a>This document gives you information about the implementation and advisability of the following modeling strategies:</p>
<ul><li>
<a id="pgfId-1035348"></a><a href="chap1.html#14655">Simple Device Models</a> describes how to use the simplest device models which do not contain expressions, user-defined parameters, or instance parameters.</li><li>
<a id="pgfId-1035352"></a><a href="chap1.html#20727">Built-In Geometric Models</a> describes how to specify parameters in addition to those included in simple device models. This method is convenient when the unmodified instance parameters provided by the simulator are adequate, such as when the simulator performs geometric scaling internally. </li><li>
<a id="pgfId-1035356"></a><a href="chap1.html#42304">External Models</a> describes how to define models that are based on the models provided by the simulator but which have slightly different behavior or interface. The modifications are implemented outside the simulator, as opposed to internally, and defined in a file. </li><li>
<a id="pgfId-1035360"></a><a href="chap1.html#37201">Standard Model Binning</a> describes how to select a different model for each range of device geometries. </li><li>
<a id="pgfId-1035364"></a><a href="chap1.html#30853">Custom Model Binning</a> describes how to select a different model for different ranges of certain parameters, but in contrast to standard binning, this capability is not built into the model. Instead, it is a general simulator capability. </li><li>
<a id="pgfId-1035368"></a><a href="chap1.html#28841">Process Modeling</a> describes how to include, or not include, process and geometry effects in your simulation. </li><li>
<a id="pgfId-1035372"></a><a href="chap1.html#41890">Corners Modeling</a> describes how to create one library that places the worst, typical, and best cases in one model file. </li><li>
<a id="pgfId-1035376"></a><a href="chap1.html#30501">Monte Carlo Modeling</a> describes how to use statistical quantities in your models. </li><li>
<a id="pgfId-1035380"></a><a href="chap1.html#35165">Package Modeling</a> points to a discussion of package modeling in the <em>Spectre Circuit Simulator and Accelerated Parallel Simulator RF Analysis User Guide</em>. </li><li>
<a id="pgfId-1035386"></a><a href="chap1.html#33110">Behavioral Modeling</a> describes how to use behavioral models to abstract parts of a design to shorten the simulation time. </li><li>
<a id="pgfId-1035390"></a><a href="chap1.html#63323">Miscellaneous Modeling Techniques</a> summarizes several other modeling techniques used in analog simulation. The usefulness of each technique is discussed, as is the degree of support for each technique available from Cadence tools. </li><li>
<a id="pgfId-1035394"></a><a href="chap1.html#newlink libraries">Libraries</a> explains how devices are created for simulation in a Cadence library. </li></ul>












<h2>
<a id="pgfId-1035398"></a><a id="14655"></a>Sim<a id="simple"></a>ple De<a id="simpledevicemodels"></a>vice Models</h2>

<p>
<a id="pgfId-1035400"></a>In analog simulation, components frequently reference models. For example, a <code>bjt</code><a id="marker-1035399"></a> component requires both an instance and a definition of the model it references. The instances and the model definitions can be complex or simple. </p>
<p>
<a id="pgfId-1035401"></a>This section describes the use of the simplest device models. With simple device models, no expressions, no user-defined parameters, and no instance parameters are used. </p>
<p>
<a id="pgfId-1035402"></a>An example of a simple device model is the instance Q25 in the schematic view of the <code>opamp</code> cell from the <code>aExamples</code> library which is shown in Figure <a href="chap1.html#10244">1-1</a>. </p>

<p><strong>Figure 1-1
<a id="pgfId-1035407"></a><a id="10244"></a>opamp Cell from the aExamples Library Showing Q25</strong></p>
<p>
<a id="pgfId-1035411"></a></p>
<div class="webflare-div-image">
<img width="643" height="373" src="images/chap1-2.gif" /></div>

<p>
<a id="pgfId-1035412"></a>You can find the <code>aExamples</code> library in the directory <code>tools/dfII/samples/artist</code> in your Cadence installation directory. </p>
<p>
<a id="pgfId-1035416"></a>In the Edit Object Properties form shown in the following figure, the model<em> </em>parameter, <em>Model name</em> is for the instance Q25 and is <code>npn</code>. This makes this instance a reference to the <code>npn</code><em> </em>model. </p>

<p><strong>Figure 1-2
<a id="pgfId-1035419"></a><a actuate="user" class="URL" href="../comphelp/chap8.html#firstpage" show="replace" xml:link="simple">Edit Object Properties Form for Instance Q25 of the aExamples opamp</a><a id="29907"></a></strong></p>
<p>
<a id="pgfId-1035423"></a></p>
<div class="webflare-div-image">
<img width="518" height="565" src="images/chap1-3.gif" /></div>

<p>
<a id="pgfId-1035427"></a>The netlist lines in Figure <a href="chap1.html#42542">1-3</a> show the Spectre syntax for this device instance along with the model <code>npn</code> it references shown in Figure <a href="chap1.html#19070">1-4</a>. The model defines both the device type (<code>bjt</code><a id="marker-1035431"></a>) and the parameters associated with the device. </p>
<p>
<a id="pgfId-1035433"></a>The model <code>npn</code><a id="marker-1035432"></a> is included from the file <code>tools/dfII/samples/artist/models/spectre/models.scs. </code></p>
<p>
<a id="pgfId-1035438"></a>The opamp cel<a id="marker-1035434"></a>l in Figure <a href="chap1.html#10244">1-1</a><a actuate="user" class="URL" href="../anasimhelp/anasimhelpTOC.html#firstpage" show="replace" xml:link="simple"></a> is used by the lowpass schematic cell view in the same library. When you simulate this cell view in the <a href="chap1.html#10244">Virtuoso Analog Design Environment</a>, you specify <code>models.scs</code> as the model file by typing this filename in the <a href="chap1.html#10244">Setup Model Libraries</a> form.<a id="marker-1035440"></a><a id="marker-1035441"></a></p>

<p><strong>Figure 1-3
<a id="pgfId-1035445"></a><a id="42542"></a>File: lowpass<a id="marker-1035444"></a>.scs for Simple Device Models</strong></p>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035446"></a>simulator lang=spectre</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035447"></a>...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035448"></a>include &quot;models.scs&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035449"></a>...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035450"></a>Q25 (net39 inp net80) npn</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035451"></a>...</pre>
<p><strong>Figure 1-4
<a id="pgfId-1035455"></a><a id="19070"></a>File: <a id="models.scs"></a>bipola<a id="marker-1035454"></a>r.scs for Simple Device Models</strong></p>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035456"></a>...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035457"></a>model npn bjt type=npn is=3.26E-16 va=60 bf=100 \</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035458"></a>br=6 nc=2 ikr=100m rc=1 vje=0.7 \</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035459"></a>cjc=1e-12 fc=0.5 cje=0.7p \</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035460"></a>tr=200e-12 tf=25e-12 itf=0.03 vtf=7 xtf=2</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035461"></a>...</pre>
<h2>
<a id="pgfId-1035465"></a><a id="20727"></a>Bui<a id="built-in"></a>lt-In Ge<a id="builtingeometricmodels"></a>ometric Models</h2>

<p>
<a id="pgfId-1035466"></a>For most device primitives, you can specify additional parameters besides those included in the model. For example, with the <code>l </code>and <code>w </code>parameters, you can change the size of specific instances of Spectre MOS d<a id="marker-1035467"></a>evices that are otherwise identical and described by a single model statement. This method is convenient when the unmodified instance parameters provided by the simulator are adequate for your simulation needs, such as when the simulator performs geometric scaling internally.</p>
<p>
<a id="pgfId-1037145"></a><a actuate="user" class="URL" href="../anasimhelp/anasimhelpTOC.html#firstpage" show="replace" xml:link="simple">In the </a><a id="marker-1037143"></a><h-hot>Virtuoso Analog Design Environment</h-hot>, the developer of the library adds parameter definitions to the CDF for such components as shown in Figure <a href="chap1.html#10966">1-5</a>. The developer also adds the parameter names, such as <code>l</code><em> </em>and<em> </em><code>w</code>, to the list of instance parameters in the simulator information section for each simulator of interest. For the<em> nmos </em>cell of the <code>analogLib</code><a id="marker-1037149"></a> library, you define the <code>l </code>and<em> </em><code>w</code><em> </em><a href="chap1.html#nmoscdf">parameters in the CDF with the prompts </a><em>Length</em><a id="marker-1037150"></a> and <em>Width</em> respectively. These parameters are referenced in the <code>instParameters</code> section of the Edit Simulation Information form. </p>

<p><strong>Figure 1-5
<a id="pgfId-1037154"></a><a id="10966"></a>Edit <a id="nmoscdf"></a>CDF Form for the nmos Cell </strong></p>
<p>
<a id="pgfId-1037166"></a></p>
<div class="webflare-div-image">
<img width="644" height="503" src="images/chap1-4.gif" /></div>

<p>
<a id="pgfId-1035494"></a>The instances <code>M14</code> and <code>M15</code> in the schematic view of the foldedCascode cell in the <code>aExamples</code><a id="marker-1035495"></a> library, shown in Figure <a href="chap1.html#37619">1-6</a>, demonstrate this technique. Both instances have identical values for <code>l</code> and <code>w</code>. The instances <code>M2</code> and <code>M4</code> also use this technique, and although these instances differ in size, both reference model <code>nmos24</code> as shown in Figure <a href="chap1.html#27484">1-7</a>.</p>

<p><strong>Figure 1-6
<a id="pgfId-1035504"></a><a id="37619"></a>foldedCascode Cell From the aE<a id="foldedcascode"></a>xamples Library</strong></p>
<p>
<a id="pgfId-1035508"></a></p>
<div class="webflare-div-image">
<img width="619" height="397" src="images/chap1-5.gif" /></div>
<p><strong>Figure 1-7
<a id="pgfId-1035512"></a><a id="27484"></a>File: foldedCa<a id="foldedcascode.scs"></a>scode.<a id="marker-1035511"></a>scs for Built-In Geometric Models</strong></p>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035513"></a>simulator lang=spectre</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035514"></a>...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035515"></a>include &quot;basicMos.scs&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035516"></a>...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035517"></a>M2 (2 1 0 0) nmos24 l=3u w=40u </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035518"></a>...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035519"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035520"></a>M4 (2 1 0 0) nmos24 l=1.8u w=20u</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035521"></a>...</pre>

<p>
<a id="pgfId-1035527"></a>The <code>basicMos.scs</code> file in Figure <a href="chap1.html#17888">1-8</a> is selected as the model file on t<a id="marker-1035525"></a>he <h-hot><a actuate="user" class="URL" href="../assembler/asmTests.html#formModelLibrarySetup" show="replace" xml:link="simple">Setup Model Libraries</a></h-hot><a actuate="user" class="URL" href="../anasimhelp/anasimhelpTOC.html#firstpage" show="replace" xml:link="simple"> form in the </a><h-hot>Virtuoso Analog Design Environment</h-hot><a id="marker-1035528"></a>. </p>

<p><strong>Figure 1-8
<a id="pgfId-1035533"></a><a id="17888"></a>File: basicM<a id="basicmos"></a>os.s<a id="marker-1035532"></a>cs for Built-In Geometric Models</strong></p>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035534"></a>...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035535"></a>model nmos24 mos2 type=n vto = 0.775 tox = 400e-10 nsub = 8e+15 </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035536"></a>+ xj = 0.15u ld = 0.20u uo = 650 ucrit = 0.62e+5 uexp = 0.125 </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035537"></a>+ vmax = 5.1e+4 neff = 4.0 delta = 1.4 rsh = 36 cgso = 1.95e-10 </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035538"></a>+ cgdo = 1.95e-10 cj = 195u cjsw = 500p mj = 0.76 mjsw = 0.30 </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035539"></a>+ pb = 0.8</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035540"></a>...</pre>

<p>
<a id="pgfId-1035543"></a>After simulation, the operating-point results for the instance appear in t<a id="marker-1035541"></a>he Results Browser as shown in Figure <a href="chap1.html#30906">1-9</a>.</p>

<p><strong>Figure 1-9
<a id="pgfId-1035548"></a><a id="30906"></a>Operating Points for the Built-In Geometric Models Example</strong></p>
<p>
<a id="pgfId-1035552"></a></p>
<div class="webflare-div-image">
<img width="594" height="533" src="images/chap1-6.gif" /></div>
<h2>
<a id="pgfId-1035557"></a><a id="42304"></a>Exte<a id="External Models"></a>rn<a id="external"></a>al M<a id="externalmodels"></a>odels</h2>

<p>
<a id="pgfId-1035558"></a>In some cases, specifying different parameter values for the instances of built-in models, as is shown in the previous example, <a href="chap1.html#20727">Built-In Geometric Models</a>, is not a satisfactory solution. External modeling might be a preferred procedure.</p>
<p>
<a id="pgfId-1035562"></a>With external modeling, you define models that are based on the models provided by the simulator but that have slightly different behavior or interfaces. The modifications are implemented outside the simulator, as opposed to internally, and are defined in a file that is normally provided by the foundry developer. This file might contain parameter definitions, function definitions, and an extra layer of computation, as well as the modified model. </p>
<p>
<a id="pgfId-1035563"></a>You can also further modify the behavior of an individual device with your own instance parameters. For example, the length and width are often user-specified for bipolar devices, but these parameters might not be available in a particular simulator. The following features or effects might be modeled in an externally created model:</p>
<ul><li>
<a id="pgfId-1035564"></a>Geometry </li><li>
<a id="pgfId-1035565"></a>Temperature </li><li>
<a id="pgfId-1035566"></a>Process parameters </li><li>
<a id="pgfId-1035567"></a>Device mismatch </li><li>
<a id="pgfId-1035568"></a>Parameter correlation </li><li>
<a id="pgfId-1035569"></a>Radiation </li></ul>





<p>
<a id="pgfId-1035570"></a><a actuate="user" class="URL" href="../anasimhelp/anasimhelpTOC.html#firstpage" show="replace" xml:link="simple">You can accomplish external modeling by making instance parameter and model parameter values functions of the quantity of interest, such as geometry. This approach is available within the </a><a id="marker-1035572"></a><h-hot>Virtuoso Analog Design Environment</h-hot> for any component you choose. </p>
<p>
<a id="pgfId-1035579"></a>Compare the netlist in Figure <a href="chap1.html#25019">1-10</a> to the example shown in Figure <a href="chap1.html#27484">1-7</a> that also utilizes the <code>M2</code> and <code>M4</code> instances in the foldedCascode circ<a id="marker-1035580"></a>uit shown in Figure <a href="chap1.html#37619">1-6</a>. In both examples, the <code>M2</code> and <code>M4</code> instances reference the same model <code>nmos24</code> but specify instance values for the<code> l </code>and <code>w</code> parameters. </p>
<p>
<a id="pgfId-1035584"></a>The two examples differ in the choice of the model file. The external modeling example uses <code>externalMos.scs</code> in Figure <a href="chap1.html#18384">1-11</a> instead of <code>basicMos.scs</code> shown in Figure <a href="chap1.html#17888">1-8</a>. Without any changes to the <code>foldedCascode</code> schematic in Figure <a href="chap1.html#37619">1-6</a>, a more powerful modeling approach is used by specifying a different filename. For external modeling, the file in Figure <a href="chap1.html#25019">1-10</a> is the netlist created by the Virtuoso Analog Design Environment: <a id="marker-1035597"></a></p>

<p><strong>Figure 1-10
<a id="pgfId-1035599"></a><a id="25019"></a>File: foldedCascode.scs for External Models</strong></p>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035601"></a>// Using direct netlister</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035602"></a>simulator lang=spectre</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035603"></a>...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035604"></a>include &quot;externalMos.scs&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035605"></a>...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035606"></a>M2 (2 1 0 0) nmos24 l=3u w=40u </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035607"></a>...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035608"></a>M4 (2 1 0 0) nmos24 l=1.8u w=20u</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035609"></a>...</pre>

<p>
<a id="pgfId-1035610"></a>This example demonstrates modeling of geometry with process effects. The <code>externalMos.scs </code>model file in Figure <a href="chap1.html#18384">1-11</a> is located in the samples directory <code>tools/dfII/samples/artist/models/spectre</code>. </p>
<p>
<a id="pgfId-1035614"></a>In the <code>externalMos.scs</code> model file, the variables <code>mos24LengthOffset</code> and <code>mos24WidthOffset</code>, as well as the functions <code>mos24LengthCorrection</code><em> </em>and <code>mos24WidthCorrection</code><em>,</em> are defined for the <code>nmos24</code> model. The variable values <code>nmos24LengthOffset</code> and <code>nmos24WidthOffset</code> (.1μ, .015μ) are called <em>process parameters</em>. These process parameters are used in both a function and an algebraic expression where they are combined with the user-defined instance parameters <code>l </code>and<code> w</code> to determine the effective length and width. The <code>l</code> and <code>w</code> parameters of instance<code> _mos</code> in the <code>nmos24</code> and <code>pmos24</code> <code>inline subckt</code> definitions use the functions <code>mos24LengthCorrection</code> and <code>mos24WidthCorrection</code> to determine their values.</p>
<p>
<a id="pgfId-1035618"></a>The <code>externalMos.scs</code> file shown in Figure <a href="chap1.html#18384">1-11</a> includes an <code>inline subckt</code> definition which replaces the <em>nmos24</em> model card of the <code>basicMos.scs</code> file shown in Figure <a href="chap1.html#17888">1-8</a>. The <code>inline subckt</code> contains a single instance of a device as well as a model definition. The terminals are identical to those of the Spectre <code>mos2</code> model. </p>
<p>
<a id="pgfId-1035626"></a>The parameters<code> l </code>and <code>w</code> for the foldedCascode ex<a id="marker-1035622"></a>ample in Figure <a href="chap1.html#25019">1-10</a> are also defined in the <code>inline</code> <code>subckt</code> definition of Figure <a href="chap1.html#18384">1-11</a>. The <code>inline subckt</code> definition transparently replaces the model statement from Figure <a href="chap1.html#25019">1-10</a>. Inside the <code>inline subckt</code> definition, the length and width of the instance are replaced with corrected values. </p>
<p>
<a id="pgfId-1035636"></a>The example in Figure <a href="chap1.html#18384">1-11</a> shows alteration of the instance parameters. Of course, the model parameters can be altered. </p>

<p><strong>Figure 1-11
<a id="pgfId-1035640"></a><a id="18384"></a>File: external<a id="externalmos"></a>Mos.sc<a id="marker-1035639"></a>s for External Models</strong></p>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035641"></a>simulator lang=spectre</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035642"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035643"></a>parameters mos24LengthOffset=.1u mos24WidthOffset=.015u</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035644"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035645"></a>real mos24WidthCorrection( real w, real offset ) {</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035646"></a>   return  w + offset</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035647"></a>}</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035648"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035649"></a>real mos24LengthCorrection( real l, real offset ) {</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035650"></a>   return  l + offset</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035651"></a>}</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035652"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035653"></a>inline subckt nmos24 (d g s b)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035654"></a>parameters w=1 l=1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035655"></a>nmos24 (d g s b) _mos l=mos24LengthCorrection( l, mos24LengthOffset )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035656"></a>+ w=mos24WidthCorrection( w, mos24WidthOffset )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035657"></a>model _mos mos2 type=n vto = 0.775 tox = 400e-10 nsub = 8e+15</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035658"></a>+ xj = 0.15u ld = 0.20u uo = 650 ucrit = 0.62e+5 uexp = 0.125</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035659"></a>+ vmax = 5.1e+4 neff = 4.0 delta = 1.4 rsh = 36 cgso = 1.95e-10</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035660"></a>+ cgdo = 1.95e-10 cj = 195u cjsw = 500p mj = 0.76 mjsw = 0.30</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035661"></a>+ pb = 0.8</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035662"></a>ends</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035663"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035664"></a>inline subckt pmos24 (d g s b)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035665"></a>parameters w=1 l=1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035666"></a>pmos24 (d g s b) _mos l=mos24LengthCorrection( l, mos24LengthOffset )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035667"></a>+ w=mos24WidthCorrection( w, mos24WidthOffset )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035668"></a>model _mos mos2 type=p vto = -0.75 tox = 400e-10 nsub = 6e+15</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035669"></a>+ xj = 0.05u ld = 0.20u uo = 255 ucrit = 0.86e+5 uexp = 0.29</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035670"></a>+ vm = 3.0e+4 neff = 2.65 delta = 1.0 rsh = 101 cgso = 1.90e-10</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035671"></a>+ cgdo = 1.90e-10 cj = 250u cjsw = 350p mj = 0.535 mjsw = 0.34</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035672"></a>+ pb = 0.8</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035673"></a>ends</pre>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1035674"></a>You must define the global parameters <code>nmos24LengthOffset</code> and <code>mos24WidthOffset</code> before you reference them. </div>
<p>
<a id="pgfId-1035676"></a>An <code>inline subckt</code> definition is used instead of a <code>subckt</code><a id="marker-1035675"></a> definition to make the simulation results appear similar to <code>mos2</code> results. With inline subcircuits, no extra hierarchy is introduced by the use of subcircuits. The <code>inline subckt</code> contains a single instance whose instance name is identical to the name of the <code>inline subckt</code>,<em> </em><code>nmos24</code>. </p>
<p>
<a id="pgfId-1037120"></a>After simulation, you can display the operating points for <code>M2</code> in the Results Browser. Compare the operating-point results with those shown in Figure <a href="chap1.html#30906">1-9</a><a id="marker-1037119"></a>. The operating-point names are identical to those of the model card although the values might differ because of the offsets of width and length in <code>externalMos.scs</code>. </p>
<p>
<a id="pgfId-1037125"></a>For more information about inline subcircuits, se<a id="marker-1037124"></a>e the <em>Spectre Circuit Simulator Reference</em>.</p>

<h2>
<a id="pgfId-1037092"></a><a id="37201"></a>Standard M<a id="standard"></a>odel Binn<a id="standardmodelbinning"></a>ing</h2>

<p>
<a id="pgfId-1035700"></a>When you specify the <code>stdbinMos.scs </code>file for the foldedCascode example shown in Figure <a href="chap1.html#30753">1-12</a><a id="marker-1035699"></a> on the <h-hot><a actuate="user" class="URL" href="../assembler/asmTests.html#formModelLibrarySetup" show="replace" xml:link="simple">Setup Model Libraries </a></h-hot>form, different model sections are used for instances <code>M2</code><a id="marker-1035705"></a> and <code>M4</code>. This modeling style is again different from that in the previous two examples in Figure <a href="chap1.html#27484">1-7</a> and Figure <a href="chap1.html#25019">1-10</a> while the schematic shown in Figure <a href="chap1.html#37619">1-6</a> is the same.</p>
<p>
<a id="pgfId-1035715"></a>The resulting netlist is shown below: </p>

<p><strong>Figure 1-12
<a id="pgfId-1035717"></a><a id="30753"></a>File: foldedCascode.scs for Standard Model Binning</strong></p>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035718"></a>// Using direct netlister</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035719"></a>simulator lang=spectre</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035720"></a>...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035721"></a>include &quot;stdbinMos.scs&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035722"></a>...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035723"></a>M2 (2 1 0 0) nmos24 l=3u w=40u </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035724"></a>...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035725"></a>M4 (2 1 0 0) nmos24 l=1.8u w=20u</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035726"></a>...</pre>

<p>
<a id="pgfId-1035727"></a>The following is a section of the sample model file: </p>

<p><strong>Figure 1-13
<a id="pgfId-1035730"></a><a id="31525"></a>File: stdbinM<a id="marker-1035729"></a>os.scs for Standard Model Binning</strong></p>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035731"></a>simulator lang=spectre</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035732"></a>...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035733"></a>model nmos24 mos2 {</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035734"></a>1: type=n vto = 0.775 tox = 400e-10 nsub = 8e+15 </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035735"></a>+ xj = 0.15u ld = 0.20u uo = 650 ucrit = 0.62e+5 uexp = 0.125 </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035736"></a>+ vmax = 5.1e+4 neff = 4.0 delta = 1.4 rsh = 36 cgso = 1.95e-10 </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035737"></a>+ cgdo = 1.95e-10 cj = 195u cjsw = 500p mj = 0.76 mjsw = 0.30 </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035738"></a>+ pb = 0.8 lmin=0.1u lmax=2u wmin=1u wmax=30u</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035739"></a>2: type=n vto = 0.775 tox = 400e-10 nsub = 8e+15 </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035740"></a>+ xj = 0.15u ld = 0.20u uo = 650 ucrit = 0.62e+5 uexp = 0.125 </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035741"></a>+ vmax = 5.1e+4 neff = 4.0 delta = 1.4 rsh = 36 cgso = 1.95e-10 </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035742"></a>+ cgdo = 1.95e-10 cj = 195u cjsw = 500p mj = 0.76 mjsw = 0.30 </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035743"></a>+ pb = 0.8 lmin=2u lmax=10u wmin=30u wmax=100u</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035744"></a>}</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035745"></a>...</pre>
<h2>
<a id="pgfId-1035749"></a><a id="30853"></a>Custom Mod<a id="custom"></a>el Bin<a id="custommodelbinning"></a>ning</h2>

<p>
<a id="pgfId-1035750"></a>As is the case with standard binning, a different model is selected for different ranges of certain parameters, but in contrast to standard binning, the custom binning capability is not built into the model. Instead, it is a general simulator capability. </p>
<p>
<a id="pgfId-1035751"></a>In this example, the appropriate model is selected by the simulator for each device or subcircuit instance based on the values of the subcircuit parameters for the area of that instance. The model selection can be based on any parameter, not just on geometry parameters. </p>
<p>
<a id="pgfId-1035752"></a>Unlike standard binning, which is limited to the <code>l</code> and <code>w</code> parameters for <code>mos </code>devices, custom binning can be used for any parameter or design variable of any device type, including bipolar devices. In Spectre, custom binning is achieved using the structural <code>if</code> statement, as shown i<a id="marker-1035753"></a>n <code>cstbinMos.scs </code>in <a href="chap1.html#36705">Figure&#160;1-15</a>, and the conditional expressions used in the <code>if</code> statements can reference any netlist parameter, subcircuit parameter, or design variable.</p>
<p>
<a id="pgfId-1035761"></a>The <code>cstbinMos.scs</code> file in Figure <a href="chap1.html#36705">1-15</a> is located in the samples directory <code>tools/dfII/samples/artist/models/spectre</code><a id="marker-1035760"></a>. </p>
<p>
<a id="pgfId-1035762"></a>When you specify the <code>cstbinMos.scs</code> model file on the model setup form for the foldedCascode example shown in Figure <a href="chap1.html#28449">1-14</a>, different model sections are again used for instances <code>M2</code> and <code>M4</code>. The resulting netlist is shown in Figure <a href="chap1.html#28449">1-14</a>:</p>

<p><strong>Figure 1-14
<a id="pgfId-1035771"></a><a id="28449"></a>File: foldedCascod<a id="marker-1035770"></a>e.scs for Custom Model Binning</strong></p>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035772"></a>// Using direct netlister</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035773"></a>simulator lang=spectre</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035774"></a>...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035775"></a>include &quot;cstbinMos.scs&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035776"></a>...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035777"></a>M2 (2 1 0 0) nmos24 l=3u w=40u </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035778"></a>...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035779"></a>M4 (2 1 0 0) nmos24 l=1.8u w=20u</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035780"></a>...</pre>

<p>
<a id="pgfId-1035784"></a>Figure <a href="chap1.html#36705">1-15</a> is a section of the sample model file. </p>

<p><strong>Figure 1-15
<a id="pgfId-1035788"></a><a id="36705"></a>File: cstbinM<a id="cstbinmos"></a>os.s<a id="marker-1035787"></a>cs for Custom Model Binning</strong></p>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035789"></a>simulator lang=spectre</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035790"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035791"></a>inline subckt nmos24 (d g s b)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035792"></a>parameters l=1u w=1u area=l*w</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035793"></a>    if (area &lt; 4e-12) {</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035794"></a>        nmos24 (d g s b) small l=l w=w</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035795"></a>    } else {</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035796"></a>        nmos24 (d g s b) large l=l w=w</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035797"></a>    }</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035798"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035799"></a>model small mos2 type=n vto = 0.775 tox = 400e-10 nsub = 8e+15</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035800"></a>+ xj = 0.15u ld = 0.20u uo = 650 ucrit = 0.62e+5 uexp = 0.125</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035801"></a>+ vmax = 5.1e+4 neff = 4.0 delta = 1.4 rsh = 36 cgso = 1.95e-10</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035802"></a>+ cgdo = 1.95e-10 cj = 195u cjsw = 500p mj = 0.76 mjsw = 0.30</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035803"></a>+ pb = 0.8</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035804"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035805"></a>model large mos2 type=n vto = 0.775 tox = 400e-10 nsub = 8e+15</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035806"></a>+ xj = 0.15u ld = 0.20u uo = 650 ucrit = 0.62e+5 uexp = 0.125</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035807"></a>+ vmax = 5.1e+4 neff = 4.0 delta = 1.4 rsh = 36 cgso = 1.95e-10</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035808"></a>+ cgdo = 1.95e-10 cj = 195u cjsw = 500p mj = 0.76 mjsw = 0.30</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035809"></a>+ pb = 0.8 lmin=2u lmax=10u wmin=30u wmax=100u</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035810"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035811"></a>ends nmos24</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035812"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035813"></a>inline subckt pmos24 (d g s b)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035814"></a>parameters l=1u w=1u area=l*w</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035815"></a>    if (area &lt; 4e-12) {</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035816"></a>        _mos (d g s b) small l=l w=w</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035817"></a>    } else {</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035818"></a>        _mos (d g s b) large l=l w=w</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035819"></a>    }</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035820"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035821"></a>model small mos2 type=p vto = 0.775 tox = 400e-10 nsub = 8e+15</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035822"></a>+ xj = 0.15u ld = 0.20u uo = 650 ucrit = 0.62e+5 uexp = 0.125</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035823"></a>+ vmax = 5.1e+4 neff = 4.0 delta = 1.4 rsh = 36 cgso = 1.95e-10</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035824"></a>+ cgdo = 1.95e-10 cj = 195u cjsw = 500p mj = 0.76 mjsw = 0.30</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035825"></a>+ pb = 0.8</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035826"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035827"></a>model large mos2 type=p vto = 0.775 tox = 400e-10 nsub = 8e+15</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035828"></a>+ xj = 0.15u ld = 0.20u uo = 650 ucrit = 0.62e+5 uexp = 0.125</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035829"></a>+ vmax = 5.1e+4 neff = 4.0 delta = 1.4 rsh = 36 cgso = 1.95e-10</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035830"></a>+ cgdo = 1.95e-10 cj = 195u cjsw = 500p mj = 0.76 mjsw = 0.30</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035831"></a>+ pb = 0.8 lmin=2u lmax=10u wmin=30u wmax=100u</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035832"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035833"></a>ends pmos24</pre>

<p>
<a id="pgfId-1035834"></a>In this example, model binning is performed for MOS devices within the inline subcircuit definition. The devices <code>M2</code> and <code>M4</code> in the foldedCascode example in Figure <a href="chap1.html#28449">1-14</a><a id="marker-1035835"></a> reference the same model <code>nmos24</code>. The values of the <code>l</code> and <code>w</code> parameters, which are passed from the <code>M2</code> and <code>M4</code> instances, determine the appropriate model definition. No instance or model names change in the result files. </p>

<h2>
<a id="pgfId-1035842"></a><a id="28841"></a>Pro<a id="process"></a>cess Model<a id="processmodeling"></a>ing</h2>

<p>
<a id="pgfId-1035843"></a>Successful IC design requires accurate modeling of the fabrication process. Many of the techniques described in previous sections are used in the netlist below. This section shows a Spectre simulator example of a complete process modeling approach. The example shows you how to create a netlist that lets you include, or not include (plain simulation), process and geometry effects in your simulation.</p>
<ul><li>
<a id="pgfId-1035844"></a>To include process and geometry effects in your simulation, include the <code>Process.scs</code> file in the <code>diffamp.ckt</code><a id="marker-1035845"></a> <a id="marker-1035846"></a>netlist instead of<a id="marker-1035847"></a> the <code>Plain.h</code> file. </li><li>
<a id="pgfId-1035848"></a>To perform a plain simulation which does not model the process and geometry effects, include <a id="marker-1035849"></a>the <code>Plain.h</code> file in the <code>diffamp.ckt</code> <a id="marker-1035850"></a>netlist instead of the <code>Process.scs</code> file. <a id="marker-1035851"></a></li></ul>

<p>
<a id="pgfId-1035855"></a>The <code>diffamp</code> schematic cell view in Figure <a href="chap1.html#36337">1-16</a> from the <code>aExamples</code> library is a simple differential amplifier with two resistors and two <code>npn</code> bipolar transistors. The resistor and bipolar models are defined in the <code>ProcessSimple.scs</code> file. Both process and geometry effects are also modeled in this file.</p>
<p>
<a id="pgfId-1035859"></a>When you include the <code>Process.scs </code>file shown in Figure <a href="chap1.html#39997">1-19</a> in the netlist, you specify geometric parameters to model <code>bjt</code> and <code>resistor</code> devices. Certain non-ideal process effects are also modeled in this file.</p>
<p>
<a id="pgfId-1035863"></a>The<code> Plain.scs</code> file shown in Figure <a href="chap1.html#19321">1-20</a> is not used in this example, but it gives you an interface in which the parameters that you specify are the electrical parameters used by the simulator.</p>

<p><strong>Figure 1-16
<a id="pgfId-1035865"></a>diffamp Schematic from the <a id="36337"></a>aExamples Library</strong></p>
<p>
<a id="pgfId-1035869"></a></p>
<div class="webflare-div-image">
<img width="643" height="410" src="images/chap1-7.gif" /></div>
<p><strong>Figure 1-17
<a id="pgfId-1035871"></a>File: diffamp.s<a id="marker-1035870"></a>cs for Process Modeling</strong></p>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035872"></a>// A differential amplifier, biased with a 1mA current source</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035873"></a>simulator lang=spectre</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035874"></a>include &quot;ProcessSimple.scs&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035875"></a>include &quot;Process.scs&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035876"></a>E1 (1 0) vsource dc=12</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035877"></a>// Pullup resistors, 4k ohms nominal</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035878"></a>R1 (1 2) RPLR Rnom=4k WB=5&#160;&#160;   // 5 units wide, model calcs required length</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035879"></a>R2 (1 3) RPLR Rnom=4k WB=10&#160;&#160;  // 10 units wide, model calcs required length</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035880"></a>// The input pair</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035881"></a>TNSA1 (2 4 5 0) TNSA WE=10 LE=10</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035882"></a>TNSA2 (3 4 5 0) TNSA WE=10 LE=10</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035883"></a>// No differential input voltage, both inputs tied to same source</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035884"></a>E4 (4 0) vsource dc=5</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035885"></a>// current source biasing</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035886"></a>J5 (5 0) isource dc=1m</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035887"></a>dcop dc</pre>
<p><strong>Figure 1-18
<a id="pgfId-1035891"></a><a id="37078"></a>File: ProcessS<a id="processSimple"></a>imple.sc<a id="marker-1035890"></a>s for Process Modeling</strong></p>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035892"></a>simulator lang=spectre</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035893"></a>// Define process parameters, including mismatch effects</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035894"></a>parameters RSHSP=200 RSHPI=5k&#160;&#160;         // sheet resistance, pinched sheet res</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035895"></a>+&#160;&#160;        SPDW=0 SNDW=0              // etching variation from ideal</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035896"></a>+&#160;&#160;       XISN=1 XBFN=1 XRSP=1        // device &#8220;mismatch&#8221; parameters</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035897"></a>+&#160;&#160;         XISNafac=100m XISNbfac=1m    // IS scaling factors for mismatch eqns</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035898"></a>+&#160;&#160;       XBFNafac=100m XBFNbfac=1m   // BF    &#8220;       &#8220;     &#8220;     &#8220;       &#8220;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035899"></a>+&#160;&#160;       XRSPafac=100m XRSPbfac=1m   // RS    &#8220;       &#8220;     &#8220;     &#8220;       &#8220;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035900"></a>+&#160;&#160;         RSHSPnom=200 RSHPInom=5k     // sheet resistance nominal values</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035901"></a>+&#160;&#160;         FRSHPI=RSHPI/RSHPInom        // ratio of PI sheet res to nominal</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035902"></a>//&#160;&#160; Define &quot;simple&quot; bipolar and resistor devices...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035903"></a>//&#160;&#160; Define a &quot;base&quot; TNSA subckt i.e</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035904"></a>//&#160;&#160; Define a simple &quot;TNSA&quot; bipolar transistor subcircuit, with model // card</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035905"></a>inline subckt TNSA_B (C B E S)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035906"></a>  parameters MULT=1 IS=1e-15 BF=100</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035907"></a>  model modX bjt type=npn is=IS bf=BF   // a model card</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035908"></a>  TNSA_B (C B E S) modX m=MULT          // &quot;inline&quot; device instance</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035909"></a>ends TNSA_B</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035910"></a>// Define a &quot;base&quot; resistor</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035911"></a>// A simple &quot;RPLR&quot; resistor subcircuit</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035912"></a>inline subckt RPLR_B (A B)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035913"></a>  parameters R MULT=1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035914"></a>  RPLR_B (A B) resistor r=R m=MULT           // &quot;inline&quot; device</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035915"></a>ends RPLR_B</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035916"></a>//&#160;&#160; Define process/geometry dependent bipolar and resistor devices..</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035917"></a>//&#160;&#160; Define a &quot;geometrical/process&quot; TNSA subckt</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035918"></a>//&#160;&#160; Define BJT subcircuit, with process and geometry effects modeled</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035919"></a>//&#160;&#160; Bipolar model parameters IS and BF are functions of the</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035920"></a>//&#160;&#160; effective emitter area/perimeter taking process factors </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035921"></a>//&#160;&#160; (e.g&#160;&#160;non-ideal etching) into account</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035922"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035923"></a>inline subckt TNSA_PR (C B E S)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035924"></a>  parameters WE LE MULT=1 dIS=0 dBF=0</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035925"></a>+&#160;&#160;        WEA=WE+SNDW        // effective or &quot;Actual&quot; emitter width</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035926"></a>+&#160;&#160;       LEA=LE+SNDW        // effective or &quot;Actual&quot; emitter length</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035927"></a>+&#160;&#160;         AE=WEA*LEA         // effective emitter area</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035928"></a>+&#160;&#160;          IS=1e-18*FRSHPI*AE*(1+(XISNafac/sqrt(AE)+XISNbfac)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035929"></a>+&#160;&#160;                           *(dIS/2+XISN-1)/sqrt(MULT))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035930"></a>+&#160;&#160;          BF=100*FRSHPI*(1+(XBFNafac/sqrt(AE)+XBFNbfac)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035931"></a>+&#160;&#160;                           *(dBF/2+XBFN-1)/sqrt(MULT))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035932"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035933"></a>  TNSA_PR (C B E S) TNSA_B IS=IS BF=BF MULT=MULT         // &quot;inline&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035934"></a>ends TNSA_PR</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035935"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035936"></a>// Define a &quot;geometrical/process&quot; RPLR resistor subckt</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035937"></a>// Resistance is function of effective device geometry, taking</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035938"></a>// process factors (e.g non-ideal etching) into account</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035939"></a>inline subckt RPLR_PR (A B)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035940"></a>  parameters Rnom WB MULT=1 dR=0</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035941"></a>+&#160;&#160;          LB=Rnom*WB/RSHSPnom</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035942"></a>+&#160;&#160;          AB=LB*(WB+SPDW)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035943"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035944"></a>  RPLR_PR (A B) RPLR_B R=RSHSP*LB/(WB+SPDW)*(1+(XRSPafac/sqrt(AB)+XRSPbfac)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035945"></a>+&#160;&#160;                           *(dR/2+XRSP-1)/sqrt(MULT))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035946"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035947"></a>ends RPLR_PR</pre>
<p><strong>Figure 1-19
<a id="pgfId-1035951"></a><a id="39997"></a>File: Proc<a id="process.scs"></a>ess.s<a id="marker-1035950"></a>cs for Process Modeling</strong></p>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035952"></a>// Provides the designer with &quot;geometrical&quot; device interface</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035953"></a>simulator lang=spectre</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035954"></a>// Call to the geometrical TNSA model</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035955"></a>inline subckt TNSA (C B E S)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035956"></a>  parameters WE=1u LE=1u MULT=1 dIS=0 dBF=0</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035957"></a>  TNSA (C B E S) TNSA_PR WE=WE LE=LE \</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035958"></a>                 MULT=MULT dIS=dIS dBF=dBF     // call TNSA_PR</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035959"></a>ends TNSA</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035960"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035961"></a>// Call to the geometrical RPLR model</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035962"></a>inline subckt RPLR (A B)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035963"></a>  parameters Rnom=1 WB=10u MULT=1 dR=0</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035964"></a>  RPLR (A B) RPLR_PR Rnom=Rnom WB=WB \</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035965"></a>             MULT=MULT dR=dR                   // call RPLR_PR</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035966"></a>ends RPLR</pre>
<p><strong>Figure 1-20
<a id="pgfId-1035970"></a><a id="19321"></a>File: Pla<a id="plain.scs"></a>in.sc<a id="marker-1035969"></a>s for Process Modeling</strong></p>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035971"></a>//</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035972"></a>// Provides designer with &quot;plain&quot; device interface (i.e.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035973"></a>// no geometrical or process modeling)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035974"></a>simulator lang=spectre</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035975"></a>// Plain TNSA, no geometrical or process modeling</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035976"></a>inline subckt TNSA (C B E S)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035977"></a>  parameters MULT=1 IS=1e-15 BF=100</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035978"></a>  TNSA (C B E S) TNSA_B IS=IS BF=BF MULT=MULT // call TNSA_B</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035979"></a>ends TNSA</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035980"></a>// Plain RPLR no geometrical or process modeling</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035981"></a>inline subckt RPLR (A B)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035982"></a>  parameters R=1 MULT=1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035983"></a>  RPLR (A B) RPLR_B R=R MULT=MULT</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1035984"></a>ends RPLR</pre>

<p>
<a id="pgfId-1035985"></a>The number of process variables and functions might be large for realistic processes and designs. Using many expressions, like increasing design size, can slow the simulation, and tasks such as reading in user-defined functions and process variables might have an impact on performance. </p>

<h2>
<a id="pgfId-1035989"></a><a id="41890"></a>Corner<a id="corners"></a>s Mo<a id="cornersmodeling"></a>deling</h2>

<p>
<a id="pgfId-1035990"></a>You can create one library that places the worst, typical, and best cases in one models file. The foldedCascode sch<a id="marker-1035991"></a>ematic view shown in Figure <a href="chap1.html#37619">1-6</a> in the <code>aExamples</code> library is used as an example of this practice. T<a id="marker-1035995"></a>he <code>cornersMos.scs</code> models file contains worst, typical, and best case models. The <h-hot><a actuate="user" class="URL" href="../assembler/asmTests.html#formModelLibrarySetup" show="replace" xml:link="simple">Setup Model Library</a></h-hot> for<a id="marker-1035997"></a>m provides a convenient way to specify the section with the model file of interest.</p>
<p>
<a id="pgfId-1035998"></a>The method shown below is the preferred approach. You place all the models in one file and then include the models you want to use.</p>
<p>
<a id="pgfId-1036001"></a>The netlist created for this design from the <h-hot><a actuate="user" class="URL" href="../anasimhelp/anasimhelpTOC.html#firstpage" show="replace" xml:link="simple">Virtuoso Analog Design Environment</a></h-hot><a id="marker-1036000"></a> is shown in <code>foldedCascode.scs</code> in Figure <a href="chap1.html#40343">1-21</a>. </p>

<p><strong>Figure 1-21
<a id="pgfId-1036006"></a><a id="40343"></a>File: foldedCascode.scs for Corners Modeling</strong></p>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036007"></a>* </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036008"></a>simulator lang=spectre</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036009"></a>...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036010"></a>include &quot;cornersMos.scs&quot; section=FCS</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036011"></a>...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036012"></a>File: cornersMos.scs</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036013"></a>library vti_2u</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036014"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036015"></a>section TNTP</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036016"></a>simulator lang=spice</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036017"></a>* VTI-derived Level=2 nominal model</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036018"></a>.model nmos24 nmos level=2 vto = 0.775 tox = 400e-10 nsub = 8e+15 xj = 0.15U ld = 0.20U u0 = 650 ucrit = 0.62e+5 uexp = 0.125 vmax = 5.1e+4 neff = 4.0 delta = 1.4 rsh = 36 cgso = 1.95e-10 cgdo = 1.95e-10 cj = 195U cjsw = 500P mj = 0.76 mjsw = 0.30 pb = 0.8</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036019"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036020"></a>.model pmos24 pmos level=2 vto = -0.75 tox = 400e-10 nsub = 6e+15 xj = 0.05U ld = 0.20U u0 = 255 ucrit = 0.86e+5 uexp = 0.29 vmax = 3.0e+4 neff = 2.65 delta = 1.0 rsh = 101 cgso = 1.90e-10 cgdo = 1.90e-10 cj = 250U cjsw = 350P mj = 0.535 mjsw = 0.34 pb = 0.8</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036021"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036022"></a>endsection</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036023"></a>...</pre>
<h2>
<a id="pgfId-1036027"></a><a id="30501"></a>Monte Carl<a id="monte carlo"></a>o Mod<a id="montecarlomodeling"></a>eling</h2>

<p>
<a id="pgfId-1036029"></a>With Monte Carlo an<a id="marker-1036028"></a>alysis, you can use statistical quantities in your models by applying statistical variations to the process parameters. Monte Carlo analysis determines the parameter values by generating randomly distributed numbers according to the distributions (means and standard deviations) of process parameters. You then implement these process parameters as design variables. </p>
<p>
<a id="pgfId-1036030"></a>You model all of the statistical quantities such as mismatch, deterministic tracking, and correlations through these process parameters. The parameters are typically physical, measurable values from silicon such as sheet rho, island depth, and oxide thickness. The process parameters are different for each manufacturing process. The modeling equations use these process parameters to calculate the final model parameters that are used by the simulator.</p>
<p>
<a id="pgfId-1036034"></a>You can use Monte Carlo modeling with the <code>diffamp</code> example shown in Figure <a href="chap1.html#36337">1-16</a> from the Process Modeling section. The <code>monteProcess.scs</code> file in Figure <a href="chap1.html#27245">1-22</a> is an example of a model file you might want to include. </p>

<p><strong>Figure 1-22
<a id="pgfId-1036040"></a><a id="27245"></a>File: monteProce<a id="marker-1036039"></a>ss.scs for Monte Carlo Modeling</strong></p>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036041"></a>simulator lang=spectre</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036042"></a>include &quot;processSimple.scs&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036043"></a>include &quot;process.scs&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036044"></a>statistics {</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036045"></a>    process {</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036046"></a>       vary RSHSP dist=gauss std=5</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036047"></a>       vary RSHPI dist=lnorm std=0.15</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036048"></a>       vary SPDW dist=gauss std=0.25</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036049"></a>       vary SNDW dist=gauss std=0.25</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036050"></a>    }</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036051"></a>    correlate param=[RSHSP RSHPI] cc=0.6</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036052"></a>    mismatch {</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036053"></a>       vary XISN dist=gauss std=1 </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036054"></a>       vary XBFN dist=gauss std=1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036055"></a>       vary XRSP dist=gauss std=1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036056"></a>    }</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036057"></a>}</pre>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1036059"></a>The <code>monteProcess.scs</code> model file includes both the <code>process.scs</code><a id="marker-1036058"></a> file shown in Figure <a href="chap1.html#39997">1-19</a> and the <code>processSimple.scs</code> file shown in Figure <a href="chap1.html#37078">1-18</a>. Both files and the relevant process parameters are discussed in the Process Modeling section. </div>

<h2>
<a id="pgfId-1036067"></a><a id="35165"></a>Package Modeling</h2>

<p>
<a id="pgfId-1036070"></a>With package modeling, yo<a id="packagemodeling"></a>u can simulate the effects of <a id="marker-1036069"></a>the package on the IC. The design is simulated along with the package model. See the <em>SpectreRF User Guide</em> for a discussion of package modeling. </p>

<h2>
<a id="pgfId-1036074"></a><a id="33110"></a>Behavio<a id="beharioral"></a>ral Mo<a id="behavioralmodeling"></a>deling</h2>

<p>
<a id="pgfId-1036076"></a>You usually use behavioral models to abstra<a id="marker-1036075"></a>ct parts of a design, which shortens the simulation time. Behavioral modeling is usually not appropriate for low-level modeling, for example, the implementation of transistor models. However, you can use it to prototype such models. </p>
<p>
<a id="pgfId-1036079"></a>You can write behavioral models in behavioral languages like the Verilog&#174;-A lang<a id="marker-1036081"></a>uage without using the compiled model interface (CM<a id="marker-1036082"></a>I). If the behavioral modeling language is a standard language, you can use the model with other tools. The parameter <code>r</code> can be passed in form the instand of the Verilog-A model.</p>

<h2>
<a id="pgfId-1036099"></a><a id="63323"></a>Miscellaneous Mo<a id="miscellaneousmodelingtechniques"></a>deling Techniques </h2>

<p>
<a id="pgfId-1036100"></a>This section summarizes other modeling techniques used in analog simulation. The usefulness of each technique is discussed, as is the degree of support for each technique available from Cadence tools.</p>

<h3>
<a id="pgfId-1036103"></a>Passe<a id="passed"></a>d Mo<a id="passedmodelnames"></a>del Names</h3>

<p>
<a id="pgfId-1036104"></a>You can use a subcircuit with a device whose model name has the value of pPar( &quot;model&quot; ). This helps you model a device as a schematic. You can add other components to the schematic. The additional components can be used to model for effects not built-in in the simulation primitive. You have the flexibility to specify the model name of the core device while creating instance of the symbol for the schematic model.</p>
<p>
<a id="pgfId-1036108"></a>The library developer specifies the model name for the core device M0 as pPar( &quot;model&quot; ). He also creates a parameter model in the CDF with prompt Model Name, parseasCEL as yes and parseAsNumber set to no</p>

<p><strong>Figure 1-23
<a id="pgfId-1036116"></a>Cell nch_sub showing M0 Instance.<a id="14680"></a><a id="passed"></a><a id="passedmodelnames"></a></strong></p>
<p>
<a id="pgfId-1036270"></a><a id="90274"></a></p>
<div class="webflare-div-image">
<img width="594" height="361" src="images/chap1-8.gif" /></div>
<p><strong>Figure 1-24
<a id="pgfId-1036220"></a>Edit Object Properties Form for Instance M0</strong></p>
<p>
<a id="pgfId-1036250"></a></p>
<div class="webflare-div-image">
<img width="514" height="674" src="images/chap1-9.gif" /></div>

<p>
<a id="pgfId-1037192"></a>The designer can now place the symbol for the schematic and can specify the model name of the core device at instance creation time.</p>
<p>
<a id="pgfId-1036294"></a>For direct interface, both the netlister and the simulator should support passed model names. The analogmodel device is netlisted in the netlist and the model name is passed through the hierarchy.</p>

<p><strong>Figure 1-25
<a id="pgfId-1036295"></a>Direct netlist</strong></p>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036296"></a>// Using direct netlister</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036297"></a>simulator lang=spectre</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036298"></a>subckt nch_sub D G S inh_MN_B</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036299"></a>parameters _par0=&quot;nmos4&quot; w=(0.15)*(1) l=0.15 as ad ps pd</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036300"></a>M0 (D G S inh_MN_B) analogmodel modelname=_par0 w=w l=l as=as ad=ad \</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036301"></a>        ps=ps pd=pd</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036302"></a>...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036303"></a>ends nch_sub</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036304"></a>I0 (net3 net1 net2 VSS!) nch_sub _par0=&quot;nmos24&quot; w=(0.15)*(1) \</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036305"></a>        l=0.15</pre>
<p><strong>Figure 1-26
<a id="pgfId-1036316"></a>Contents of file samplelib_nch_sub_schematic.s</strong></p>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036317"></a>...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036318"></a>subckt &amp;1 d g s inh_mn_b</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036319"></a>m0 (d g s inh_mn_b) &amp;2 w=(&amp;3) l=(&amp;4)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036320"></a>...</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036321"></a>simulator lang=\spice</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036322"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036323"></a>USEM &amp;2 &amp;2</pre>
<h3>
<a id="pgfId-1036334"></a><a id="36364"></a>Usin<a id="using"></a>g the AEL iPar F<a id="iparfunction"></a>unction</h3>

<p>
<a id="pgfId-1036337"></a>When using the <code>iPar</code> function, you use component description format (CDF) to calculate the length and width of the simulator device from the length and the width you specify on the schematic. This calculation uses the Analog Expression Language (AEL) <code>iPar</code><a id="marker-1036335"></a><a id="marker-1036336"></a> function. </p>
<p>
<a id="pgfId-1036338"></a>For example, a CDF parameter <code>Luser</code> with prompt Physical length is accessible for a foundry MOS device through the Virtuoso<sup>&#174;</sup> schematic composer <h-hot><a actuate="user" class="URL" href="../comphelp/chap8.html#firstpage" show="replace" xml:link="simple">Edit Object Properties</a></h-hot> form. The parameter<code> l </code><a id="marker-1036340"></a>is not shown on that form, but rather is given the value<code> iPar( &quot;Luser&quot; )</code>. You also specify the parameter <code>l</code> as one of the instance parameters for the Spectre netlist. When the component is netlisted, the netlister substitutes the value of <code>Luser</code> for the value of <code>l</code>. </p>
<p>
<a id="pgfId-1036341"></a>The drawback of this technique is the substitution performed by the netlister for the <code>iPar </code>expression. After substitution, the relationships between the parameter values on the schematic and those in the netlist are no longer straightforward. </p>
<p>
<a id="pgfId-1036342"></a>For these reasons, use of the <code>iPar</code> function is discouraged. Instead, you should use the method described in the <h-hot><a href="chap1.html#External Models">External Models</a></h-hot> section.</p>

<h3>
<a id="pgfId-1036348"></a><a id="37708"></a>CDF C<a id="cdf"></a>allb<a id="cdfcallbacks"></a>acks<a id="marker-1036347"></a></h3>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1036349"></a><em>You should avoid using this technique as it has many drawbacks.</em></div>

<h3>
<a id="pgfId-1036353"></a><a id="26915"></a>Mult<a id="multiplier"></a>iplier Techn<a id="multipliertechniques"></a>iques</h3>

<p>
<a id="pgfId-1036354"></a>In this approach, the devices used have fixed geometries, but a different, related quantity modifies the specification. Such a quantity might be one of the following:</p>
<ul><li>
<a id="pgfId-1036355"></a>Number of emitters </li><li>
<a id="pgfId-1036356"></a>Number of rows and or number of columns or both for the emitter layout </li><li>
<a id="pgfId-1036357"></a>A multiplier </li></ul>


<p>
<a id="pgfId-1036358"></a>You add parameters to the schematic to specify the number of emitters and the number of rows or colum<a id="marker-1037738"></a>ns in the emitter layou<a id="marker-1037757"></a>t. </p>
<p>
<a id="pgfId-1036361"></a><a actuate="user" class="URL" href="../anasimhelp/anasimhelpTOC.html#firstpage" show="replace" xml:link="simple">In the </a><a id="marker-1036360"></a><h-hot>Virtuoso Analog Design Environment</h-hot>, the multiplier parameter <code>m</code> is a special parameter for devices. In a Spectre netlist, you cannot declare <code>m</code> in the subcircuit parameter statement. The netlister handles the <code>m</code> parameter explicitly for Spectre simulation. </p>

<h3>
<a id="pgfId-1036367"></a><a id="15111"></a>Sha<a id="shared"></a>red M<a id="sharedmodels"></a>odels</h3>

<p>
<a id="pgfId-1036368"></a>The term <em>shared models</em> refers to device models with passed parameters. Instances of models within a subcircuit that have identical model parameter values can share the same model. Sharing models saves some memory in the simulator. </p>
<p>
<a id="pgfId-1036369"></a>The shared models technique works well for circuits that have many models in a single subcircuit, but the technique offers no improvement if only a few devices are instantiated within a subcircuit. </p>
<p>
<a id="pgfId-1036938"></a>Model sharing is accomplished with a subcircuit definition. The efficiency aspects described above are handled by the simulator. No special netlisting is performed. Both the netlister and the simulator support passed model parameters. Sharing of models, however, depends entirely on the capabilities of the simulator. </p>

<h2>
<a id="pgfId-1036374"></a>Lib<a id="libraries"></a>r<a id="newlink libraries"></a>aries</h2>

<p>
<a id="pgfId-1036376"></a>This section explains how devices are created in a Cadence library for simulation. <a id="newlink with cdf"></a></p>

<h3>
<a id="pgfId-1036378"></a>Defini<a id="with CDF"></a>ng Netlisting Attributes for Components With CDF</h3>

<p>
<a id="pgfId-1036379"></a>This procedure is explained in the Component Description Format User Guide. </p>

<h3>
<a id="pgfId-1036381"></a>Defining Netlisting Attributes for Compon<a id="without CDF"></a>ents Without CDF</h3>

<p>
<a id="pgfId-1036382"></a>You can define the netlisting attributes using the following documented SKILL procedures:</p>
<ul><li>
<a id="pgfId-1036385"></a><a id="marker-1036383"></a><code>almGetModuleName/almSetModuleName</code><a id="marker-1036384"></a></li><li>
<a id="pgfId-1036388"></a><code>almGetNamePrefix/almSetNamePrefix</code><a id="marker-1036386"></a><a id="marker-1036387"></a></li><li>
<a id="pgfId-1036391"></a><code>almGetParameterList/almSetParameterList</code><a id="marker-1036389"></a><a id="marker-1036390"></a></li><li>
<a id="pgfId-1036394"></a><code>almGetTerminalList/almSetTerminalList</code><a id="marker-1036392"></a><a id="marker-1036393"></a></li><li>
<a id="pgfId-1036397"></a><a id="marker-1036395"></a><code>almGetTerminalMap/almSetTerminalMap</code><a id="marker-1036396"></a></li><li>
<a id="pgfId-1036400"></a><a id="marker-1036398"></a><code>almGetOpPointParamMap/almSetOpPointParamMap</code><a id="marker-1036399"></a></li><li>
<a id="pgfId-1036403"></a><code>almGetNetlistProcedure/almSetNetlistProcedure</code><a id="marker-1036401"></a><a id="marker-1036402"></a></li><li>
<a id="pgfId-1036405"></a><a id="marker-1036404"></a><code>almGetViewInfoNameList</code></li><li>
<a id="pgfId-1036407"></a><a id="marker-1036406"></a><code>almGetNetlistType</code></li></ul>









<h3>
<a id="pgfId-1036410"></a><code></code><a id="marker-1036408"></a>almHasViewInformation<a id="almHasInformation"></a></h3>

<p>
<a id="pgfId-1036411"></a>To use these procedures, use <em>?noCdf</em> arguments with a<code> </code>nil value. </p>

<h3>
<a id="pgfId-1036414"></a>Bulk term<a id="marker-1036412"></a>inal<a id="bulk Terminals"></a>s</h3>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1036415"></a>You can use this technique for devices with or without CDF.</div>
<p>
<a id="pgfId-1036416"></a>A device might have extra terminals that are not on the symbol, for example, the bulk terminal (B) on MOS devices or the substrate terminal (<em>S</em>) on bipolar devices. In 4.4.3 and later releases, inherited connections are used. The <em>npn</em> spectre cellview in <code>analogLib</code><em> </em>is an example of using inherited connections. In this cellview, the terminal <em>S</em> has a net expression. </p>

<h3>
<a id="pgfId-1036419"></a>Exa<a id="examples"></a>mp<a id="marker-1036418"></a>les</h3>

<p>
<a id="pgfId-1036420"></a>This section presents several specific examples. </p>

<h4>
<a id="pgfId-1036421"></a>Example: pmos Device</h4>

<p>
<a id="pgfId-1036422"></a>Terminal B in the <code>pmos spectre</code> cellview from the sample library has a net expression. The default is <code>vdd!</code>, and the parameter is <code>bulk_B</code>. </p>
<p>
<a id="pgfId-1036423"></a>The following code sets the netlist attributes for this device: </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036424"></a>lib = &#8220;sample&#8221;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036425"></a>cell = &quot;pmos&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036426"></a>view = &#8220;spectre&#8221;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036427"></a>    cv=(dbOpenCellViewByType lib cell view nil &quot;a&quot;)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036428"></a>    (almSetTerminalList </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036429"></a>    lib cell &#8217;( D G S B ) ?view view ?useCdf nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036430"></a>    (almSetTerminalMap lib cell &#8217;D &#8217;d ?view view ?useCdf nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036431"></a>    (almSetTerminalMap lib cell &#8217;G &#8217;g ?view view ?useCdf nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036432"></a>    (almSetTerminalMap lib cell &#8217;S &#8217;s ?view view ?useCdf nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036433"></a>    (almSetTerminalMap lib cell &#8217;B &#8217;b ?view view ?useCdf nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036434"></a>    (almSetParameterList </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036435"></a>    lib cell</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036436"></a>    &#8217;( w l as ad ps pd nrd nrs ld ls m trise region degradation ) </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036437"></a>    ?view view ?useCdf nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036438"></a>    dbSave( cv )</pre>

<p>
<a id="pgfId-1036439"></a>The<code> lib</code> variable is set to <code>sample</code>, and the <code>view</code> variable is set to <code>spectre</code>. </p>

<h4>
<a id="pgfId-1036440"></a>Example: nmos Device</h4>

<p>
<a id="pgfId-1036441"></a>Terminal B in the<code> spectre</code> view of the <code>nmos </code>device has a net expression. The default is <code>gnd!</code><em>,</em> and the parameter of the net expression is <code>bulk_B</code><em>.</em></p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036442"></a>lib = &#8220;sample&#8221;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036443"></a>cell = &quot;nmos&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036444"></a>view = &#8220;spectre&#8221;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036445"></a>    cv=(dbOpenCellViewByType lib cell view nil &quot;a&quot;)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036446"></a>    (almSetTerminalList lib cell &#8217;( D G S B ) ?view &quot;spectre&quot; ?useCdf nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036447"></a>    (almSetTerminalMap lib cell &#8217;D &#8217;d ?view &quot;spectre&quot; ?useCdf nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036448"></a>    (almSetTerminalMap lib cell &#8217;G &#8217;g ?view &quot;spectre&quot; ?useCdf nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036449"></a>    (almSetTerminalMap lib cell &#8217;S &#8217;s ?view &quot;spectre&quot; ?useCdf nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036450"></a>    (almSetTerminalMap lib cell &#8217;B &#8217;b ?view &quot;spectre&quot; ?useCdf nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036451"></a>    almSetParameterList </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036452"></a>    lib cell </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036453"></a>    &#8217;( w l as ad ps pd nrd nrs ld ls m trise region degradation )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036454"></a>    ?view &quot;spectre&quot; ?useCdf nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036455"></a>    dbSave( cv )</pre>
<h4>
<a id="pgfId-1036456"></a>Example: Resistor</h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036457"></a>cell = &quot;resistor&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036458"></a>    (almSetModuleName lib cell &quot;resistor&quot; ?view &quot;spectre&quot; ?useCdf nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036459"></a>    (almSetTerminalList lib cell &#8217;(PLUS MINUS ) ?view &quot;spectre&quot; ?useCdf nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036460"></a>    (almSetTerminalMap lib cell &#8217;PLUS &quot;:1&quot; ?view &quot;spectre&quot; ?useCdf nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036461"></a>    (almSetTerminalMap lib cell &#8217;MINUS &quot;(FUNCTION minus(root(&#39;PLUS&#39;)))&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036462"></a>        ?view &quot;spectre&quot; ?useCdf nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036463"></a>    (almSetParameterList lib cell &#8217;( r l w m trise tc1 tc2 resform isnoisy )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036464"></a>        ?view &quot;spectre&quot; ?useCdf nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036465"></a>    dbSave( cv )</pre>
<h4>
<a id="pgfId-1036466"></a>Example: Voltage Source</h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036467"></a>cell = &quot;vsrc&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036468"></a>(almSetModuleName lib cell &quot;vsource&quot; ?view &quot;spectre&quot; ?useCdf nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036469"></a>(almSetTerminalList lib cell &#8217;(N\+ N ) ?view &quot;spectre&quot; ?useCdf nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036470"></a>(almSetTerminalMap lib cell &#8217;N\+ &quot;:p&quot; ?view &quot;spectre&quot; ?useCdf nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036471"></a>(almSetTerminalMap lib cell &#8217;N &quot;(FUNCTION minus(root(&#39;N+&#39;)))&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036472"></a>      ?view &quot;spectre&quot; ?useCdf nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036473"></a>(almSetParameterList </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036474"></a>lib cell</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036475"></a>&#8217;( </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036476"></a>dc type</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036477"></a>;; Pulse waveform parameters:</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036478"></a>    delay val0 val1 period rise fall </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036479"></a>    width</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036480"></a>;; PWL waveform parameters:</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036481"></a>    file wave offset scale stretch </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036482"></a>    allbrkpts pwlperiod twidth</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036483"></a>;; Sinusoidal waveform parameters:</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036484"></a>    sinedc ampl freq sinephase ampl2 </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036485"></a>    freq2 sinephase2 fundname</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036486"></a>    other fundname2 fmmodindex fmmodfreq </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036487"></a>    ammodindex ammodfreq</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036488"></a>    ammodphase damp</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036489"></a>;;Exponential waveform parameters:</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036490"></a>    td1 tau1 td2 tau2</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036491"></a>;;Noise Parameters:</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036492"></a>    noisefile noisevec</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036493"></a>;; Small signal parameters:</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036494"></a>    mag phase xfmag pacmag pacphase</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036495"></a>;; Multiplication factor parameters:</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036496"></a>    m</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036497"></a>;;Temperature effects parameters:</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036498"></a>    tc1 tc2 tnom)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036499"></a>         ?view &quot;spectre&quot; ?useCdf nil)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036500"></a>    dbSave( cv )</pre>
<h3>
<a id="pgfId-1036503"></a>Netlist p<a id="netlist procedures"></a>ro<a id="marker-1036502"></a>cedures</h3>

<p>
<a id="pgfId-1036504"></a>You can write netlist procedures using documented methods. In most situations, the netlisting of components is adequately addressed by specifying entities such as parameter lists. </p>
<p>
<a id="pgfId-1036505"></a>In certain situations, however, more advanced control is required. This control can be obtained through netlist procedures. By default, the netlist procedure is specified as <code>nil</code>, and the <em>nlPrintInst</em> method from the formatter is used. If you specify a netlisting procedure, that procedure is used instead. </p>
<p>
<a id="pgfId-1036506"></a>You can define attributes to customize components by using the procedures in the <h-hot><a href="chap1.html#without CDF">Defining Netlisting Attributes for Components Without CDF</a></h-hot> section. </p>
<p>
<a id="pgfId-1036508"></a>The principal reason for customizing netlisting is to use special parameters. To maintain consistency, Cadence discourages customization of other aspects of the netlist. Customization affects netlisting performance in the following ways:</p>
<ul><li>
<a id="pgfId-1036509"></a><strong>Modifying comments affects the look of the netlist.</strong> A modified component looks different from components from other sources. Designers look at the netlist and the simulator input file, so such presentation differences deserve caution.</li><li>
<a id="pgfId-1036510"></a><strong>Modifying only the indent string changes the look of the netlist.</strong> Do not modify it to customize libraries.</li><li>
<a id="pgfId-1036511"></a><strong>Changing the formatter instance name can create name mapping errors.</strong> These errors result in unresolved names during the simulation or results display. The formatter guarantees correct name mapping. It also ensures that signals are printed according to the connectivity in the design and in the order specified.</li><li>
<a id="pgfId-1036512"></a><strong>Changing the default model name causes serious design flow problems. </strong>The default model name follows conventions used throughout the Virtuoso Analog Design Environment and the major OSS interfaces. </li></ul>



<p>
<a id="pgfId-1036513"></a>The netlisting procedure does not print the end of the line. End-of-line printing is the responsibility of the <code>nlPrintInstEnd</code> method, which is called by the netlister after the netlist procedure is called. This practice permits a netlist procedure to be called from another netlist procedure.</p>
<p>
<a id="pgfId-1036514"></a>In the following example, a netlist procedure prints a parameter that is enclosed by double quotes. </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036515"></a>(defun myNetlistProc (inst)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036516"></a>(let ((formatter (nlGetFormatter inst))(netlister(nlGetNetlister inst)) val)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036517"></a>     ;; Call the nlPrintInst method defined for the formatter</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036518"></a>     (nlPrintInst formatter inst) </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036519"></a>     ;; Get the value of the parameter</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036520"></a>     val = (nlGetParamStringValue inst &#8220;myLiteralParam&#8221;)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036521"></a>     ;; Print the parameter if it has a (non-blank) value</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036522"></a>     (when val</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036523"></a>         (nlPrintString netlister &#8220; myLiteralParam=\&#8221;&#8221; val &#8220;\&#8221;&#8221;)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036524"></a>             )</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036525"></a>t))</pre>

<p>
<a id="pgfId-1036526"></a>For completeness, the following example shows a netlist procedure that has identical functionality to the <code>nlPrintInst</code> method of the <code>nlAnalogFormatter</code> class: </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036527"></a>(defun myNetlistProc (inst)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036528"></a>    ;; Print any comments</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036529"></a>    (nlPrintInstComments formatter inst)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036530"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036531"></a>    ;; Print the indentation</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036532"></a>    (nlPrintIndentString netlister)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036533"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036534"></a>    ;; Print the instance name</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036535"></a>    (nlPrintInstName formatter inst)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036536"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036537"></a>    ;; Print the signals</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036538"></a>    (nlPrintInstSignals formatter inst)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036539"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036540"></a>    ;; Print the model name</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036541"></a>    (nlPrintModelName formatter inst)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036542"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036543"></a>    ;;Print the instance parameters</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036544"></a>    (nlPrintInstParameters formatter inst)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036545"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036546"></a>t)</pre>

<p>
<a id="pgfId-1036547"></a>The following example shows modifications required in nlPrintModelName method for your simulator to support model name passing:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036548"></a>(defmethod nlPrintModelName ((formatter &lt;your&gt;Formatter) inst)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036549"></a>  (let ((name (nlGetModelName inst)))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036550"></a>  (if (nlIsModelNameInherited inst)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036551"></a>    (nlPrintString (nlGetNetlister formatter) &quot; &quot; &quot;analogmodel modelname=&quot; name)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036552"></a>    (nlPrintString (nlGetNetlister formatter) &quot; &quot; name))))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1036599"></a></pre>
<br /><a href="#pagetop">Return to top</a><br /></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="preface.html" id="prev" title="Preface">Preface</a></em></b><b><em><a href="dirsimmodelIX.html" id="nex" title="Index">Index</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2020, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
</body></html>