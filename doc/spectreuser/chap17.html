
<html><head><title>Identifying Problems and Troubleshooting</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="kamal" />
<meta name="CreateDate" content="2020-06-16" />
<meta name="CreateTime" content="1592307255" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes the Spectre Circuit Simulator." />
<meta name="DocTitle" content="Spectre Classic Simulator, Spectre APS, Spectre X, and Spectre XPS User Guide" />
<meta name="DocType" content="User Guide" />
<meta name="FileTitle" content="Identifying Problems and Troubleshooting" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-3.2" />
<meta name="Keyword" content="spectreuser" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2020-06-16" />
<meta name="ModifiedTime" content="1592307255" />
<meta name="NextFile" content="appA.html" />
<meta name="Order" content="1" />
<meta name="Group" content="Spectre Simulator" />
<meta name="Platform" content="Custom IC Design" />
<meta name="PrevFile" content="chap16.html" />
<meta name="c_product" content="Spectre" />
<meta name="Product" content="Spectre" />
<meta name="ProductFamily" content="Spectre" />
<meta name="ProductVersion" content="19.1" />
<meta name="RightsManagement" content="Copyright 2012-2020 Cadence Design Systems Inc." />
<meta name="Title" content="Spectre Classic Simulator, Spectre APS, Spectre X, and Spectre XPS User Guide -- Identifying Problems and Troubleshooting" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="prod_feature" content="" />
<meta name="prod_subfeature" content="" />
<meta name="Version" content="19.1" />
<meta name="SpaceKey" content="spectreuser191" />
<meta name="webflare-version" content="2.0" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" /></head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="spectreuserTOC.html">Contents</a></li><li><a class="prev" href="chap16.html" title="Managing Files">Managing Files</a></li><li style="float: right;"><a class="viewPrint" href="spectreuser.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="appA.html" title="Example Circuits">Example Circuits</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Spectre Classic Simulator, Spectre APS, Spectre X, and Spectre XPS User Guide<br />Product Version 19.1, June 2020</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;"><a name="#firstpage"></a>

<h1>20
<a id="pgfId-273422"></a></h1>
<h1>
<a id="pgfId-273423"></a><hr />
<a id="26551"></a>Identifying Problems and Troubleshooting<hr />
</h1>

<p>
<a id="pgfId-293329"></a>This chapter discusses the following topics:</p>
<ul><li>
<a id="pgfId-293332"></a><a href="chap17.html#34445">Error Conditions</a></li><li>
<a id="pgfId-293342"></a><a href="chap17.html#18066">Spectre Warning Messages</a></li><li>
<a id="pgfId-293343"></a><a href="chap17.html#22399">Customizing Error and Warning Messages</a></li><li>
<a id="pgfId-293333"></a><a href="chap17.html#19115">Controlling Program-Generated Messages</a></li><li>
<a id="pgfId-293331"></a><a href="chap17.html#23399">Correcting Convergence Problems</a></li><li>
<a id="pgfId-293355"></a><a href="chap17.html#30567">Correcting Accuracy Problems</a></li><li>
<a id="pgfId-300752"></a><a href="chap17.html#93804">Packaging a Test Case for Shipment to Cadence</a></li></ul>







<h2>
<a id="pgfId-262406"></a><a id="34445"></a>Error Conditions</h2>

<p>
<a id="pgfId-262407"></a>Error conditions terminate a Spectre<sup>&#174; </sup>circuit simulator run. If you receive any of the messages described in this section, you must fix the problem and rerun the simulation.</p>

<h3>
<a id="pgfId-299223"></a>Invalid Parameter Values That<a id="marker-299220"></a><a id="marker-299221"></a> Terminate the Program</h3>

<p>
<a id="pgfId-299226"></a>If you enter a parameter that causes the Spectre simulator to stop or puts a model in an invalid region, such as giving <code>z0=0</code> to a transmission line, the Spectre simulator sends you a message like this one and exits. </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-262450"></a>Error from spectre during hierarchy flattening.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-288166"></a> tl1: Value of &#39;z0&#39; should be nonzero.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-262453"></a>spectre terminated prematurely due to fatal error.</pre>

<p>
<a id="pgfId-260675"></a>To run the simulation, you must change the parameter to an acceptable value.</p>

<h3>
<a id="pgfId-261238"></a>Singular Matri<a id="marker-262616"></a>ces</h3>

<p>
<a id="pgfId-260855"></a>If you receive an error message that says a matrix is singular, your netlist contains either a floating node which is causing the problem or a loop of zero resistance branches, for example, a loop of voltage sources or inductors. The following procedures might help you find the problem:</p>
<ul><li>
<a id="pgfId-260868"></a>Check the <code>options</code> statement in your netlist to ensure that <code>topcheck=full</code><a id="marker-262623"></a> in at least one statement. The topology checker normally helps you identify singular matrix problems, but it cannot do so if it is disabled.</li><li>
<a id="pgfId-260857"></a>If the error message appears only for particular components or circuit parameters or only for particular voltages or currents, try one of the following procedures:<ul><li>
<a id="pgfId-260859"></a>Set <code>gmin=1e-12</code><a id="marker-262638"></a> (the default value).</li><li>
<a id="pgfId-260860"></a>If you are working with simplified semiconductor models, try using more complex models.</li></ul><br />
<a id="pgfId-260858"></a>A CMOS (complementary metal oxide semiconductor) inverter whose model parameters have infinite output impedance in saturation demonstrates the usefulness of these techniques. When either the N- or P-type device is in the ohmic region, the solution is unique. However, when both devices are saturated, there is a range of output voltages that all satisfy Kirchhoff&#8217;s Current Law. In this situation, the Newton-Ra<a id="marker-292242"></a>phson method forms a linearized circuit that is singular for that iteration.</li><li>
<a id="pgfId-260872"></a>Check ideal transformers, N-ports, or transmission lines for floating nodes or loops of zero-resistance branches and modify the circuit to eliminate them.<br />
<a id="pgfId-276247"></a>For example, consider this center-tapped transformer:<br />
<a id="pgfId-294678"></a><div class="webflare-div-image">
<img width="668" height="198" src="images/chap17-2.gif" /></div><pre class="webflare-pre-block webflare-courier-new" id="#id276248">
<a id="pgfId-276248"></a>subckt ct_xfmr (t1 b1 t2 m2 b2)
 Tt t1 m1 t2 m2 transformer n1=2
 Tb m1 b1 m2 b2 transformer n1=2
end ct_xfmr </pre>
<a id="pgfId-260866"></a>If you use this transformer and leave the center-tap terminal (<code>m2</code>) floating, the Spectre simulator notifies you of a singular matrix. Because both <code>m1</code> and <code>m2</code> are floating, the DC solution is not unique. <br />
<a id="pgfId-276383"></a>If you choose a different topology for the transformer, like the one in the following example, you can avoid the problem.<br />
<a id="pgfId-295208"></a><div class="webflare-div-image">
<img width="668" height="198" src="images/chap17-3.gif" /></div><pre class="webflare-pre-block webflare-courier-new" id="#id276384">
<a id="pgfId-276384"></a>subckt ct_xfmr (t1 b1 t2 m2 b2) 
 Tt t1 b1 t2 m2 transformer n1=2 
 Tb t1 b1 m2 b2 transformer n1=2 
end ct_xfmr </pre>
<a id="pgfId-260856"></a>Circuits that contain ideal transformers, N-ports, or transmission lines can have floating nodes or loops of zero-resistance branches because the topology checker cannot adequately verify these components. Finding these currents is difficult because all these components act like ideal transformers at DC. When you look into one port of a transformer, you can see either a short or an open circuit, depending on what you see looking out of the other port.</li></ul>




















<h3>
<a id="pgfId-261255"></a>Internal Er<a id="marker-262645"></a>ror Messages</h3>

<p>
<a id="pgfId-300654"></a>If the Spectre simulator detects an internal error, it displays a message like one of the following:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-300655"></a>Internal error detected by spectre. Please see <h-hot><a actuate="user" class="URL" href="http://support.cadence.com/wps/mypoc/cos?uri=deeplinkmin:COSHome" show="replace" xml:link="simple"></a>http://support.cadence.com/wps/mypoc/cos?uri=deeplinkmin:COSHome</h-hot> for Customer Support contact information. </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-300656"></a>Error detected in file &#39;file.c&#39; at line 101. </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-300650"></a>Internal error detected by spectre. Please see <h-hot><a actuate="user" class="URL" href="http://support.cadence.com/wps/mypoc/cos?uri=deeplinkmin:COSHome" show="replace" xml:link="simple">http://support.cadence.com/wps/mypoc/cos?uri=deeplinkmin:COSHome</a></h-hot> for Customer Support contact information. </pre>

<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-300651"></a>Arithmetic exception. </pre>
<p>
<a id="pgfId-297138"></a>Cadence can help you find solutions to these problems. If you get one of these messages, call Cadence Customer Support or contact a Cadence application engineer. </p>

<h3>
<a id="pgfId-297144"></a>Ti<a id="marker-297143"></a>me Is Not Strictly Increasing</h3>

<p>
<a id="pgfId-297093"></a>PWL takes a wave parameter that accepts time/value pairs. If the time value does not increase, the Spectre simulator displays the following message:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-297094"></a>Error found in spectre during initial setup.</pre>
<pr-prog id="#id297095">
<a id="pgfId-297095"></a> v10:time is not strictly increasing in waveform.</pr-prog>

<p>
<a id="pgfId-297096"></a>Check the PWL component to fix this error.</p>

<h2>
<a id="pgfId-269806"></a><a id="18066"></a>Spectre Warning Messages</h2>

<p>
<a id="pgfId-260678"></a>Warning messages tell you about conditions that might cause invalid results. Unlike error messages, warnings do not stop a simulation. When you receive a warning message, you must decide whether the particular condition creates a problem for your simulation. This section describes some common Spectre warning messages. It also tells you how to modify parameters to correct conditions that might produce invalid simulation results.</p>
<p>
<a id="pgfId-293986"></a>The Spectre simulator often prints warnings and notices that are eventually determined to be &#8220;uninteresting,&#8221; and there is a natural tendency after a while to ignore them. We recommend that you carefully study them the first few times you simulate a particular circuit and whenever the simulator gives you unexpected results. </p>

<h3>
<a id="pgfId-261266"></a>P-N Junction Warning Messages</h3>

<p>
<a id="pgfId-260682"></a>Almost every semiconductor device includes at least one p-n junction. Normally, these p-n junctions are biased in a particular operating region. Three types of warning messages are available for each p-n junction, one for exceeding a maximum current, one for exceeding a melting current, and one for exceeding a breakdow<a id="marker-262653"></a>n voltage.</p>

<h4>
<a id="pgfId-261279"></a>Explosion Re<a id="marker-262661"></a>gion Warnings</h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297409"></a>Warning from spectre at dc = 191 mA during DC analysis &#8216;srcSweep&#39;.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297410"></a>mos_mod: The bulk-drain junction current exceeds `imelt&#39;. </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297411"></a>The results computed by Spectre are now incorrect because the junction </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297412"></a>current model has been linearized.</pre>

<p>
<a id="pgfId-297413"></a>Or</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-297414"></a>xram.d3247: The junction is melting (increase imax)</pre>

<p>
<a id="pgfId-297440"></a>The Spectre simulator provides two parameters, <code>imax</code> and <code>imelt</code>, that limit the current across a PN junction. These parameters aid convergence and prevent numerical overflow. The junction characteristics of the device are assumed to be accurately modeled for current up to <code>imax</code>. If <code>imax</code> is exceeded during iterations, the linear model is substituted until the current drops below <code>imax</code> or until convergence is achieved. If convergence is achieved with the current exceeding <code>imax</code>, the results are inaccurate, and Spectre prints a warning similar to the first one above.</p>
<p>
<a id="pgfId-297441"></a>The <code>imelt</code> parameter is used as a limit warning for the junction current. This parameter can be set to the maximum current rating of the device. By default it is set to the value of <code>imax</code>. When any component of the junction current exceeds <code>imelt</code>, Spectre issues a warning and again the results become inaccurate. The junction current is linearized above the value of <code>imelt</code> to prevent arithmetic exceptions.</p>
<p>
<a id="pgfId-297442"></a>Both these parameters have current density counterparts, <code>jmax</code> and <code>jmelt</code>, that you can specify if you want the absolute current values to depend on the device area.</p>

<h4>
<a id="pgfId-295733"></a>Melting Curre<a id="marker-295739"></a><a id="marker-296538"></a>nt Warnings</h4>

<p>
<a id="pgfId-295741"></a>A separate model parameter, <code>imelt</code>, is used as a limit warning for the junction current. This parameter can be set to the maximum current rating of the device. When any component of the junction current exceeds <code>imelt</code>, Spectre issues a warning and the results become inaccurate. The junction current is linearized above the value of <code>imelt</code> to prevent arithmetic exception, with the exponential term replaced by a linear equation at <code>imelt</code>.</p>

<h4>
<a id="pgfId-275654"></a>Breakdown Reg<a id="marker-275653"></a><a id="marker-296490"></a>ion Warnings</h4>

<p>
<a id="pgfId-275655"></a>Messages like the following are breakdown region warnings:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-275656"></a>D2: Breakdown voltage exceeded.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-260708"></a>Q1: The collector-substrate voltage exceeded breakdown voltage.</pre>

<p>
<a id="pgfId-260760"></a>The warning message identifies the relevant component name (<code>D2</code> and <code>Q1</code>) and the affected junction. </p>
<p>
<a id="pgfId-260663"></a>The Spectre simulator issues breakdown region warnings only when you specify conditions for them. For information on setting parameters to identify a breakdown region, see <xrefstd>&#8220;Customizing Error and Warning Messages&#8221;</xrefstd></p>

<h4>
<a id="pgfId-261327"></a>Missing Diode Wou<a id="marker-262681"></a>ld Be Forward-Biased</h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297299"></a>Warning from spectre at time = 501.778 ns during transient analysis tran_to_1u.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297301"></a>i1.q0: Missing collector-substrate diode would be forward biased.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297303"></a>Notice from spectre at time = 510.1688 ns during transient analysis tran_to_1u.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-260730"></a>i1.q0: Missing collector-substrate diode returns to normal bias condition.</pre>

<p>
<a id="pgfId-297326"></a>Most p-n junctions in semiconductor models include both a resistive (the diode) and a capacitive (the junction capacitance) model. If the diode reverse saturation current is set to zero, the resistive part of the junction is turned off, and the Spectre simulator assumes that the resistive portion of the junction does not exist (but the junction capacitance may still be present). In this case, if the voltage across the missing diode is larger than 10 * Vt (where Vt is the thermal voltage), Spectre will issue a warning message telling you that the junction, which is missing, will be forward biased. A follow-up notice is issued if, and when, the device returns to a normal bias condition.</p>

<h3>
<a id="pgfId-261356"></a>Tolerances Might Be Set Too Tight</h3>

<p>
<a id="pgfId-260681"></a>When you simulate high-vo<a id="marker-262693"></a>ltage or high-current circuits, the default tolerances might be tight enough to make convergence difficult or impossible. If you get a &#8220;Tolerances might be set too tight&#8221; message, try relaxing tolerances by increasing the value of <code>reltol</code>, <code>iabstol</code>, and <code>vabstol</code>.</p>

<h3>
<a id="pgfId-261377"></a>Parameter Is Unusually La<a id="marker-262706"></a>rge or Small</h3>

<p>
<a id="pgfId-260711"></a>The Spectre simulator checks the parameter values to see if they are within a normal range of expected values. This check can catch data entry errors or identify situations that can cause the Spectre simulator to have difficulties simulating the circuit.</p>
<p>
<a id="pgfId-279615"></a>The &#8220;Parameter is unusually large or small&#8221; message issues a notice about a parameter value. The message looks like one of the following:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-264802"></a>NPNbjt: &#39;rb&#39; has the unusually small value of 1mOhms. </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-264803"></a>PNPbjt: &#39;tf&#39; has the unusually large value of 1Gs.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-264804"></a>OA1.Q16 of ua741: &#39;region&#39; has the unusual value of rev.</pre>

<p>
<a id="pgfId-264786"></a>If you receive such a message, check the parameter. If the unusual parameter value is correct, you can ignore this message.</p>
<p>
<a id="pgfId-265014"></a>The limits settings that generate these warning messages are soft limits, as opposed to hard limits settings. Hard limits stop a simulation if they are violated. the Spectre simulator has automatic soft limits on a few parameter values. However, you can override these limits or specify your own limits for parameters that do not have automatic limits. For more information, see <xrefstd>&#8220;Customizing Error and Warning Messages&#8221;</xrefstd></p>

<h3>
<a id="pgfId-261402"></a>gmin Is <a id="marker-262720"></a>Large Enough to Noticeably Affect the DC Solution</h3>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297264"></a><code>Warning detected by spectre during DC analysis oppoint.</code></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297265"></a><code>Gmin=1pS is large enough to noticeably affect the DC solution.</code></pre>

<p>
<a id="pgfId-297693"></a>By default, the Spectre simulator (and SPICE) adds a very small conductance of 10-12 siemens called <code>gmin</code> across nonlinear devices. This conductance prevents nodes from floating if the nonlinear devices are turned off. By default, <code>GMIN=1e-12 Siemens</code>. The <code>gmin</code> parameter usually has a minimal effect on circuit behavior. However, some circuits, such as charge storage circuits are very sensitive to the small currents that flow through <code>gmin</code>.</p>
<p>
<a id="pgfId-297695"></a>You see a message such as the one given above if the current flowing through the <code>gmin</code> conductors, when treated as an error current, does not meet the <code>gmin</code> criteria. That is, the message is displayed if the current that enters any node from all attached <code>gmin</code> conductors is larger than either <code>iabstol</code> or <code>reltol</code> multiplied by the sum of the absolute value of the individual currents that enter the node.</p>
<p>
<a id="pgfId-297643"></a>If your circuit is not sensitive to small leakage currents, you can ignore this message. If your circuit is sensitive to these currents, reduce the <code>gmin</code> value or set it to zero.</p>

<h3>
<a id="pgfId-295955"></a>Minimum Tim<a id="marker-295984"></a><a id="marker-296478"></a>estep Used</h3>

<p>
<a id="pgfId-297188"></a>If this problem occurs, the analysis continues, and a warning message is displayed at each time point that does not meet the convergence criteria. In the Spectre simulator, this is very rare, but it does occur. Occasionally, this needs to be remedied to get the correct solution.</p>
<ol><li>
<a id="pgfId-299240"></a>Make sure devices have junction and overlap capacitance specified.</li><li>
<a id="pgfId-296607"></a>Increase <code>maxiters</code>, but do not go higher than 200.</li><li>
<a id="pgfId-295963"></a>Change to the <code>gear2</code> or <code>gear2only</code> method of integration.</li><li>
<a id="pgfId-295964"></a>Reduce other occurrences of the local truncation error cutting the timestep. Increase <code>lteratio</code> and increase the absolute error tolerances <code>vabstol</code> and <code>iabstol</code>. Do not go too high with any of these.</li><li>
<a id="pgfId-295965"></a>Combine 2, 3, and 4 and set <code>cmin</code> to prevent instantaneous change at every node in the circuit.</li><li>
<a id="pgfId-295966"></a>Relax <code>reltol</code> in combination with 5.</li></ol>






<h3>
<a id="pgfId-296732"></a>Syntax Errors</h3>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297204"></a>Warning from spectre in <code>indab_7</code> during circuit read-in:</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297205"></a>na300.scs&quot; 27: `c11&#39;: Encountered statement in Spectre format while in Spice language mode. This will not be supported in a future release.</pre>

<p>
<a id="pgfId-297202"></a>The Spectre parser is dual mode and accepts both the Spectre native language and documented Spice2G6. The default for the Spectre simulator is SPICE. If you include a file written in Spectre native syntax, you must either specify simulator <code>lang=spectre</code> or name the file with a <code>.scs</code> suffix. After Spectre processes the file, it reverts to the default mode. It is illegal to include Spectre syntax in the SPICE mode or vice versa.</p>
<p>
<a id="pgfId-296744"></a>For the MOS instance line given below:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-296745"></a>M1 1 2 0 0 NCH W= 10u L= 2u</pre>

<p>
<a id="pgfId-296749"></a>Spectre displays the following warning:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-296758"></a>m1: Encountered statement in Spectre format while in SPICE language mode. This will not be supported in a future release.</pre>

<p>
<a id="pgfId-296762"></a>Since the instance statement is valid in both languages, you can ignore this warning.</p>

<h3>
<a id="pgfId-296766"></a>Topology Messages</h3>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297246"></a>Notice from spectre during topology check.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297247"></a>Only one connection to the following node:</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297248"></a>4</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297249"></a>No DC path from node `4&#39; to ground, Gmin installed to provide path.</pre>

<p>
<a id="pgfId-296770"></a>The Spectre topology checker identifies floating nodes and automatically inserts a gmin resistor (1e12 Ohms) to prevent a non-isolated solution. The Spectre simulator then displays a message telling you what it did.</p>

<h3>
<a id="pgfId-296793"></a>Model Parameter Values Clamped</h3>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297278"></a><code>Warning from spectre during initial setup.</code></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297279"></a><code>n: The value of `vj(pb)&#39; at T = 25 C is 50e-03 V, which is too small.</code></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297280"></a><code>Clamped to 0.1 V.</code></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297281"></a><code>n: The value of `vj(pb)&#39; at T = 27 C is 41.7617e-03 V, which is too small.</code></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297282"></a><code>Clamped to 0.1 V.</code></pre>

<p>
<a id="pgfId-297276"></a>The Spectre simulator clamps model parameter values to prevent numerical difficulties during simulation. When clamping is completed, Spectre displays a message indicating that it is using clamped values. There is no way to disable these clamps.</p>

<h3>
<a id="pgfId-296818"></a>Invalid Parameter Warnings</h3>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297354"></a>Warning from spectre during circuit read-in.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297355"></a>`pchmod&#39;: `tox&#39; is not a valid parameter for `bsim4&#39; models.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297352"></a>`pchmod&#39;: `nch&#39; is not a valid parameter for `bsim4&#39; models.</pre>

<p>
<a id="pgfId-297367"></a>This type of warning is issued any time you specify an invalid parameter in a model definition. The models included with Spectre have predefined model parameters. For more information, see <code>spectre -h</code>.</p>
<p>
<a id="pgfId-297369"></a>Only these predefined parameters can be used within a model definition. The Spectre circuit simulator issues similar warnings for invalid instance and subcircuit parameters.</p>

<h3>
<a id="pgfId-296848"></a>Redefine Primitives Messages</h3>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297511"></a>Warning from spectre in `q2&#39; during circuit read-in.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-296856"></a>&quot;redefPrim.scs&quot; 6: `q2.resistor&#39; redefines the primitive named `resistor</pre>

<p>
<a id="pgfId-297509"></a>Spectre displays this message if you define a model or subcircuit with the same name as a built-in primitive device. </p>
<p>
<a id="pgfId-296858"></a>The following message tells you that the local definition will override the built-in definition:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-296867"></a>model resistor bjt</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-296871"></a>q1 1 2 3 resistor</pre>

<p>
<a id="pgfId-296872"></a><code>q1</code> is considered a bjt device rather than a resistor.</p>

<h3>
<a id="pgfId-297523"></a>Initial Condition Messages</h3>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297529"></a>Notice from spectre during IC analysis, during transient analysis &#39;tran1&#39;.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297530"></a>Initial condition computed for node 2 is in error by 755.152 uV. To reduce error in computed initial conditions, decrease `rforce&#39;. However, setting rforce too small may result in convergence difficulties or in</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297524"></a>the matrix becoming singular.</pre>

<p>
<a id="pgfId-297558"></a>The Spectre simulator sets initial conditions on a node by attaching a voltage source through a resistor. The default value of this resistor is 1, but you can control the value through the options parameter <code>rforce</code>. This notice indicates that the initial condition calculated for this node is about 755uV from the value specified in the netlist. You can lower the value of<em> </em><code>rforce</code> to bring the voltage values into agreement in one of the following ways:</p>
<ul><li>
<a id="pgfId-297579"></a>Through the Analog Options window in the Analog Design Environment.</li><li>
<a id="pgfId-297582"></a>Inserting an options statement in the netlist. An example is given below:<br /><pre class="webflare-pre-block webflare-courier-new" id="#id297559">
<a id="pgfId-297559"></a><code>myOptions options rforce=1m</code></pre></li></ul>



<h3>
<a id="pgfId-263872"></a>Output Messages</h3>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297599"></a>Notice from spectre during transient analysis &#39;tran1&#39;.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-297600"></a>No outputs found. Loosening output filter criterion to &#39;lvlpub&#39;.</pre>

<p>
<a id="pgfId-297604"></a>If you set <code>save=selected</code>, the Spectre simulator saves the voltages in the save statement. If the save statement does not contain any voltage values, Spectre issues the above warning and changes the <code>save</code> option default to <code>lvlpub</code>. This saves all node voltages.</p>

<h3>
<a id="pgfId-300513"></a>Log File Messages</h3>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-300542"></a>Warning from Spectre during generation of log file.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-300557"></a>opt1 options warning_limit=number warning_id = [message_type_1 message_type_2]</pre>

<p>
<a id="pgfId-300543"></a>For example, </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-300544"></a>opt1 options warning_limit=3 warning_id = [SFE-30 CMI-2151]</pre>

<p>
<a id="pgfId-300600"></a>IN the statement, <code>3</code> is the number of messages allowed for printing in log file for each message type defined in <code>warning_id</code>.</p>
<p>
<a id="pgfId-300601"></a><code>SFE-30</code> and <code>CMI-2151</code> are the user-defined message types for printing in the log file.</p>

<h2>
<a id="pgfId-300608"></a>Customizing Error <a id="22399"></a><a id="customizing"></a>and Warning Messages<a id="marker-300604"></a><a id="marker-300605"></a><a id="marker-300606"></a><a id="marker-300607"></a></h2>

<p>
<a id="pgfId-263873"></a>You can customize the Spectre error and warning messages to some extent to fit the needs of a simulation. This section tells you about these customization options.</p>

<h3>
<a id="pgfId-261487"></a><a id="62944"></a>Selecting Limits for Parameter Val<a id="spectre_limits"></a>ue Warning Messages</h3>

<p>
<a id="pgfId-260714"></a>You can accept Cadence default soft limits that determine when you receive warning messages about parameter values, or you can enter your own limits. You can also control which parameters the Spectre simulator checks. This section gives you instructions for all.</p>

<h4>
<a id="pgfId-263775"></a>Accepting Cadence Range Limits De<a id="marker-263776"></a><a id="marker-296430"></a>faults</h4>

<p>
<a id="pgfId-263777"></a>The most convenient option for deciding which warning messages you receive is to accept Cadence Range Limits Defaults. The Cadence defaults are located in <span class="webflare-courier-new" style="white-space:pre"><em>your_install_dir</em></span><code>/tools/spectre/etc/limits/range.lmts</code>, and you can examine them to see if they meet your needs. You can enter Cadence defaults with the <code>SPECTRE_DEFAULTS</code><a id="marker-268742"></a><a id="marker-296504"></a> environment variable in your shell initialization file (such as <code>.profile</code><a id="marker-263778"></a> or <code>.cshrc</code><a id="marker-263779"></a>). The entry in your shell initi<a id="marker-263780"></a>alization file looks like the following:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-260716"></a>setenv SPECTRE_DEFAULTS &quot;+param $HOME/tools/dfII/etc/<br />       spectre/range.lmts&quot; </pre>

<p>
<a id="pgfId-260709"></a>With this entry in the shell initialization file, the Spectre simulator reads parameter limits from <span class="webflare-courier-new" style="white-space:pre"><em>your_install_dir</em></span><code>/tools/spectre/etc/limits/range.lmts</code>.</p>
<p>
<a id="pgfId-267971"></a>You can override a <code>SPECTRE_DEFAULTS</code> setting with the <code>param</code> option of the <code>spectre</code> command. Specifying <code>+param</code> as a command line argument overrides <a id="marker-268046"></a><code>+param</code> in <code>SPECTRE_DEFAULTS</code><a id="marker-268750"></a> and tells the Spectre simulator to read range limits from the file you specify. Specifying <code>-param</code> tells the Spectre simulator to ignore the <code>+param</code> given in <code>SPECTRE_DEFAULTS</code> without giving the Spectre simulator a new location to find range limits.</p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-286306"></a>For more information about Spectre defaults, see the <em><a actuate="user" class="URL" href="../spectreref/spectrerefTOC.html#firstpage" show="replace" xml:link="simple">Spectre Circuit Simulator Reference</a></em> manual and &#8220;Customizing Percent Codes&#8221;.</div>

<h4>
<a id="pgfId-261521"></a>Creating a Parameter Range Limit<a id="marker-262828"></a>s File</h4>

<p>
<a id="pgfId-260689"></a>In some circumstances, you might want to set your own parameter limits for warning messages. This might be the case, for example, if you are maintaining your own sets of model libraries. If you want to choose your own parameter limits for warnings, you must use a text editor to create a parameter range limits file. </p>
<p>
<a id="pgfId-260719"></a>A parameter range limits file requires the following syntax. Fields enclosed by single brackets (<code>[]</code>) are optional.</p>

<pr-prog id="#id260688">
<a id="pgfId-260688"></a>[<span class="webflare-courier-new" style="white-space:pre"><em>ComponentKeyword</em></span><a id="marker-262838"></a>] [<span class="webflare-courier-new" style="white-space:pre"><em>model</em></span>] [<span class="webflare-courier-new" style="white-space:pre"><em>LowerLimit</em></span> &lt;[<span class="webflare-courier-new" style="white-space:pre"><em>=</em></span>]] 
 [|]Param[|]  &lt;[=] <span class="webflare-courier-new" style="white-space:pre"><em>UpperLimit</em></span>]</pr-prog>

<p>
<a id="pgfId-260776"></a>Observe the following syntax rules for a parameter limits file:</p>
<ul><li>
<a id="pgfId-265066"></a>You can specify limits for input, output, or operating-point parameters for either component instances or models. You can also specify limits for analysis parameters.</li><li>
<a id="pgfId-265668"></a>You must specify the limits for each parameter on a single line.</li><li>
<a id="pgfId-265671"></a>You can specify open bou<a id="marker-265669"></a>nds using angle brackets (<code>&lt;</code>) or closed bounds using an angle bracket with an equal sign (<code>&lt;=</code><a id="marker-265670"></a>). If you specify closed bounds, there can be no space between <code>&lt;</code> and <code>=</code>.</li><li>
<a id="pgfId-269032"></a>You can specify inclusive or exclusive ranges. If you specify exclusive ranges, the upper limit must be smaller than the lower limit.</li></ul>



<p>
<a id="pgfId-265774"></a>The diagram on the following pages shows you the proper formats for range specifications.</p>

<ft-figtabl-title id="#id265820">
<a id="pgfId-265820"></a>Examples of Range Limits Specifications </ft-figtabl-title>
<p>
<a id="pgfId-296622"></a></p>
<div class="webflare-div-image">
<img width="540" height="627" src="images/chap17-4.gif" /></div>
<ft-figtabl-title id="#id260779">
<a id="pgfId-260779"></a>Examples of Range Limits Specifications (continued)</ft-figtabl-title>
<p>
<a id="pgfId-299245"></a></p>
<div class="webflare-div-image">
<img width="540" height="330" src="images/chap17-5.gif" /></div>

<ul><li>
<a id="pgfId-266417"></a>The component keyword must be a Spectre name, not a name used for SPICE compatibility. For example, use <code>mos3</code> rather than <code>mos</code>.</li><li>
<a id="pgfId-260781"></a>If you specify more than one parameter limit for a component, you need to specify the component keyword only once. The Spectre simulator assumes the keyword is unchanged from the previous parameter unless you specify a new component keyword. </li><li>
<a id="pgfId-260787"></a>If you give a parameter limit more than once, your last instructions override previous limits.</li><li>
<a id="pgfId-260788"></a>If you mention a parameter but give it no limits, all limits are disabled for that parameter.</li><li>
<a id="pgfId-267619"></a>You can specify limits for integer, real, or enumerated parameters. Enumerated parameters are those that take only predefined values (such as <code>yes</code> or <code>no</code> and <code>all</code> or <code>none</code>).<br />
<a id="pgfId-267796"></a>To specify limits on enumerated parameters, use the index of the enumeration in the limits declaration for that parameter. To find the index of a parameter of component <code>name</code>, see the parameter listings for the component <code>name</code> in the Spectre online help (<code>spectre -h</code>) and count the enumerations in the limits declaration starting from zero. <br />
<a id="pgfId-267797"></a>For example, to specify that the BJT operating-point parameter <code>region</code> should not be <code>rev</code> (reversed), look for the <code>region</code> parameter in the parameter listings for the BJT component. The <code>region</code> parameter is described as  follows:<br /><table class="webflareTable" id="#id302670">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-302694"></a><code>region=fwd</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-302696"></a>Estimated operating region. Possible values are <code>off</code>, <code>fwd</code>, <code>rev</code>, or <code>sat</code>.</p>
</td>
</tr>
</tbody></table><br />
<a id="pgfId-267621"></a>For this parameter, <code>off</code> has index 0, <code>fwd</code> has index 1, <code>rev</code> has index 2, and <code>sat</code> has index 3. To specify a limit that notifies you if any BJT is reversed, use either of the following specifications:<pre class="webflare-pre-block webflare-courier-new" id="#id267622">
<a id="pgfId-267622"></a>2 &lt; region &lt; 2</pre>
<a id="pgfId-267623"></a>or<pre class="webflare-pre-block webflare-courier-new" id="#id267624">
<a id="pgfId-267624"></a>3 &lt;= region &lt;= 1</pre></li><li>
<a id="pgfId-265493"></a>You must give the keyword <code>model</code> when you place limits on model parameters. If you do not give the keyword <code>model</code><a id="marker-265492"></a>, the limits are applied to instance parameters. </li><li>
<a id="pgfId-265495"></a>You can indicate upper or lower limits for the absolut<a id="marker-265494"></a>e value of a parameter with the vertical line character(<code>|vto|</code>). <br />
<a id="pgfId-265784"></a>For example,<pre class="webflare-pre-block webflare-courier-new" id="#id265496">
<a id="pgfId-265496"></a>resistor 0.1 &lt; |r| &lt; 1M </pre>
<a id="pgfId-265497"></a>specifies that the absolute value of <code>r</code> should be greater than 0.1 ohm and less than 1 megohm. There can be no spaces between the absolute value symbols and the parameter name.</li><li>
<a id="pgfId-265498"></a>You currently cannot place limits on vector parameters.</li><li>
<a id="pgfId-260789"></a>You can write parameter limits using Spectre native-mode scale factors. For example, you can write the limit <br /><pre class="webflare-pre-block webflare-courier-new" id="#id260790">
<a id="pgfId-260790"></a>f &lt;= 1.0e6</pre>
<a id="pgfId-260792"></a>as<pre class="webflare-pre-block webflare-courier-new" id="#id260815">
<a id="pgfId-260815"></a>f &lt;= 1M </pre></li></ul>






















<h4>
<a id="pgfId-261590"></a>Example of a Parame<a id="marker-262848"></a>ter Range Limits File</h4>

<p>
<a id="pgfId-260687"></a>This example shows a parameter limits file with correct syntax.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-260767"></a>mos3&#160;&#160;    0.5u &lt;= l &lt;= 100u </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-260768"></a>          0.5u &lt;= w </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-260769"></a>          0 &lt; as &lt;= 1e-8 </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-293289"></a>          0 &lt; ad &lt;= 1e</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-293305"></a>model |vto| &lt;= 3</pre>

<p>
<a id="pgfId-293291"></a>You can find the parameter names (<code>l</code>, <code>w</code>, <code>as</code>, <code>ad</code>, <code>vto</code>) and component keywords (<code>mos3</code>) in the parameter listings in the Spectre online help (<code>spectre -h</code>). This example instructs the Spectre simulator to accept without warnings <code>mos3</code> components for these conditions: </p>
<ul><li>
<a id="pgfId-260690"></a>If channel length is more than or equal to 0.5 μm, or less than or equal to 100 μm</li><li>
<a id="pgfId-260766"></a>If channel width is greater than or equal to 0. 5 μm</li><li>
<a id="pgfId-260773"></a>If the area of source diffusion is greater than 0, or less or equal to 
1e-8 m2</li><li>
<a id="pgfId-260774"></a>If the area of drain diffusion is greater than 0, or less or equal 
to 1e-8 m2</li><li>
<a id="pgfId-260775"></a>If the <code>mos3</code> model parameter <code>vto</code> (the threshold voltage at zero body bias) has an absolute value less than or equal to 3</li></ul>





<h4>
<a id="pgfId-261605"></a>Entering a Parameter Range Limits File</h4>

<p>
<a id="pgfId-260785"></a>You can enter a parameter range li<a id="marker-262854"></a>mits file in two ways:</p>
<ul><li>
<a id="pgfId-260794"></a>Type the <code>+param</code> <span class="webflare-courier-new" style="white-space:pre"><em>&lt;filename</em></span><code>&gt;</code> option of the <code>spectre</code> command from the command line or place it in an environment variable. <span class="webflare-courier-new" style="white-space:pre"><em>&lt;filename</em></span><code>&gt;</code> is the name of the parameter range limits file. In the following example, <code>limits3</code> is the range limits file for this simulation of <code>test.circuit</code>.<br /><pre class="webflare-pre-block webflare-courier-new" id="#id260784">
<a id="pgfId-260784"></a>spectre +param limits3 test.circuit</pre></li><li>
<a id="pgfId-260795"></a>Read the parameter limits file from within another file by putting an <code>include</code> statement with a syntax like the following example in your netlist. <a id="marker-262860"></a><br /><pre class="webflare-pre-block webflare-courier-new" id="#id260793">
<a id="pgfId-260793"></a>include &quot;<code><em>filename</em></code>&quot;</pre>
<a id="pgfId-260694"></a><span class="webflare-courier-new" style="white-space:pre"><em>filename</em></span> is the name you give to the range limits file.<br />
<a id="pgfId-266676"></a>You can nest <code>include</code> statements. The only limit on depth is that imposed by the operating system on the number of files that can be open simultaneously in the Spectre simulator.<br />
<a id="pgfId-266758"></a>Paths you specify in filenames refer to the directory that contains the current file, not to the directory in which the Spectre simulator was started. For example, suppose your directory tree is set up as follows<pre class="webflare-pre-block webflare-courier-new" id="#id266759">
<a id="pgfId-266759"></a>design1/ckt1 
design1/param.lmts 
design1/resistor.lmts 
design2/ckt2 
design2/param.lmts 
design2/resistor.lmts </pre>
<a id="pgfId-266765"></a>and you run the Spectre simulator in <code>design1</code> with the following <code>spectre</code> command:<pre class="webflare-pre-block webflare-courier-new" id="#id266766">
<a id="pgfId-266766"></a>spectre +param ../design2/param.lmts ckt1 </pre>
<a id="pgfId-266767"></a>If the file <code>design1/param.lmts</code> contains the line<pre class="webflare-pre-block webflare-courier-new" id="#id266768">
<a id="pgfId-266768"></a>include &quot;resistor.lmts&quot; </pre>
<a id="pgfId-267285"></a>the Spectre simulator reads in the <code>design2/resistor.lmts</code> file, but not the <code>design1/resistor.lmts</code> file.</li></ul>













<h4>
<a id="pgfId-267286"></a>Requesting Breakdown Region War<a id="marker-267287"></a><a id="marker-296520"></a><a id="marker-296518"></a>nings for Transistors</h4>

<p>
<a id="pgfId-260828"></a>If you want warning messages about the breakdown regions of transistors, you must set the appropriate parameters for each component when you identify the component with an instance or <code>model</code> statement. For most transistors, you set the <code>bvj</code><a id="marker-262937"></a> parameter.</p>
<p>
<a id="pgfId-260830"></a>For BJTs, you must set three parameters: <code>bvbe</code><a id="marker-262881"></a>, <code>bvbc</code><a id="marker-262892"></a>, and <code>bvsub</code><a id="marker-262903"></a>. These are breakdown parameters for the base-emitter, the base-collector, and the substrate junctions.</p>
<p>
<a id="pgfId-260831"></a>Diodes are also exceptions because you can set both the <code>bvj</code> and <code>bv</code> parameters. You need two different parameters for the diode breakdown voltage because of the Zener breakdown model in the diode. When you use the diode as a Zener diode, it is purposely biased in the breakdown region, and you do not want to be warned about the Zener breakdown. By specifying the <code>bv</code> parameter, you tell the Spectre simulator to implement the Zener diode model at <code>bv</code>.</p>

<h4>
<a id="pgfId-261653"></a>Telling Spe<a id="marker-280932"></a><a id="marker-296486"></a>ctre to Perform Additional Checks of Parameter Values</h4>

<p>
<a id="pgfId-260723"></a>You can perform a <code>check</code><a id="marker-262914"></a> analysis at any point in a simulation to be sure that the values of component parameters are reasonable. You can perform checks on input, output, or operating-point parameters. The Spectre simulator checks parameter values against parameter soft limits. To use the <code>check</code> analysis, you must also enter the <code>+param</code> command line argument with the <code>spectre</code> command to specify a file that contains the soft limits. </p>
<p>
<a id="pgfId-260747"></a>The following example illustrates the syntax of the <code>check</code> statement. It tells the Spectre simulator to check the parameter values for instance statements.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-260746"></a>ParamChk ch<a id="marker-262949"></a><a id="marker-296434"></a><a id="marker-296432"></a>eck what=inst</pre>

<ul><li>
<a id="pgfId-260751"></a><code>ParamChk</code> is your unique name for this <code>check</code> statement.</li><li>
<a id="pgfId-260752"></a>The keyword <code>check</code> is the component keyword for the statement.</li><li>
<a id="pgfId-260753"></a>The <code>what</code> parameter tells the Spectre simulator which parameters to check.</li></ul>


<p>
<a id="pgfId-276758"></a>The <code>what</code><a id="marker-276757"></a> parameter of the <code>check</code> statement gives you the following options:</p>

<p>
<a id="pgfId-299351"></a></p>
<table class="webflareTable" id="#id299356">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id299358">
<a id="pgfId-299358"></a>Option</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id299360">
<a id="pgfId-299360"></a>Action</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299363"></a><code>none</code><a id="marker-299362"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299367"></a>Disables parameter<a id="marker-299365"></a><a id="marker-299366"></a> checking.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299370"></a><code>models</code><a id="marker-299369"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299373"></a>Checks input parameters <a id="marker-299372"></a>for all models only.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299376"></a><code>inst</code><a id="marker-299375"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299379"></a>Checks input param<a id="marker-299378"></a>eters for all instances only.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299382"></a><code>input</code><a id="marker-299381"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299385"></a>Checks input pa<a id="marker-299384"></a>rameters for all models and all instances.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299388"></a><code>output</code><a id="marker-299387"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299391"></a>Checks output para<a id="marker-299390"></a>meters for all models and all instances.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299394"></a><code>all</code><a id="marker-299393"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299397"></a>Checks input and output param<a id="marker-299396"></a>eters for all models and all instances.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299400"></a><code>oppoint</code><a id="marker-299399"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299403"></a>Checks operating<a id="marker-299402"></a>-point parameters for all models and all instances.</p>
</td>
</tr>
</tbody></table>
<h3>
<a id="pgfId-276808"></a>Selecting Lim<a id="marker-296532"></a>its for Operating Region Warnings</h3>

<p>
<a id="pgfId-260725"></a>The Spectre simulator lets you specify forbidden operating regions for transistors. If a transistor operates in a forbidden operating region, the Spectre simulator sends you a warning message. This feature is available for BJTs, MOSFETs, JFETs, and GaAs MESFETs. </p>

<h4>
<a id="pgfId-261738"></a>Specifying Forbidden Operati<a id="marker-263133"></a>ng Regions for Transistors</h4>

<p>
<a id="pgfId-260728"></a>You specify a forbidden operating region in a transistor with the <code>alarm</code><a id="marker-263142"></a> parameter. The <code>alarm</code> parameter gives you the following options:</p>

<p>
<a id="pgfId-299407"></a></p>
<table class="webflareTable" id="#id299412">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id299414">
<a id="pgfId-299414"></a>Option</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id299416">
<a id="pgfId-299416"></a>Description </span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299418"></a><code>none</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299420"></a>The default condition with no warnings issued.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299422"></a><code>off</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299425"></a>Warns if the transistor is turned off.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299427"></a><code>triode</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299429"></a>Warns if the transistor operates in the triode region (available for MOSFETs).</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299431"></a><code>sat</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299433"></a>Warns if the transistor operates in the saturation region.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299435"></a><code>subth</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299437"></a>Warns if the transistor operates in the subthreshold region (available for MOSFETs).</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299439"></a><code>fwd</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299441"></a>Warns if the transistor is forward-biased (available for BJTs).</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299443"></a><code>rev</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299445"></a>Warns if the transistor is reverse-biased.</p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-268819"></a>For example, to be sure that a group of MOSFETs always operates in the saturation region, you enter this <code>model</code> statement: </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-268821"></a>model mos_example nmos al<a id="marker-268820"></a><a id="marker-296424"></a>arm=off alarm=triode &#160;&#160;&#160;&#160;
&#160;&#160;    alarm=subth .....</pre>

<p>
<a id="pgfId-260809"></a>Each of the three <code>alarm</code> parameters in this example identifies a forbidden operating condition. Operating the device anywhere except in the saturation region triggers a warning. The warning looks like the following:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-270881"></a>Warning detected by spectre during transient analysis &#39;timesweep&#39;.<br />M1: Device operated in the triode region.</pre>
<h4>
<a id="pgfId-261759"></a>Defining BJT Operating R<a id="marker-296426"></a>egions</h4>

<p>
<a id="pgfId-260807"></a>The Spectre simulator provides two parameters, <code>vbefwd</code><a id="marker-263236"></a> and <code>vbcfwd</code><a id="marker-263249"></a>, that let you specify the boundaries between BJT operating regions. The default value for each parameter is 0.2 volts. </p>
<p>
<a id="pgfId-260810"></a>The following table shows you the criteria the Spectre simulator uses to determine BJT operating regions.</p>

<p>
<a id="pgfId-299449"></a></p>
<table class="webflareTable" id="#id299454">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id299456">
<a id="pgfId-299456"></a>Region</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id299458">
<a id="pgfId-299458"></a>Bias Conditions</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299460"></a><code>off</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299462"></a>Vbe &lt;= <code>vbefwd</code> and Vbc &lt;= <code>vbcfwd</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299464"></a><code>saturation</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299466"></a>Vbe &gt; <code>vbefwd</code> and Vbc &gt; <code>vbcfwd</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299468"></a><code>forward</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299470"></a>Vbe &gt; <code>vbefwd</code> and Vbc &lt;= <code>vbcfwd</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299472"></a><code>reverse</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299474"></a>Vbe &lt;= <code>vbefwd</code> and Vbc &gt; <code>vbcfwd</code></p>
</td>
</tr>
</tbody></table>
<h3>
<a id="pgfId-261783"></a><a id="27265"></a>Range Checking on Subcircuit Parameters<a id="marker-263376"></a><a id="marker-296510"></a></h3>

<p>
<a id="pgfId-260695"></a>You can test the value of subcircuit parameters with the <code>paramtest</code> component. If the parameters meet your testing criteria, you can print an informational message, print a warning, or print an error message and terminate the program. </p>

<h3>
<a id="pgfId-274282"></a>Formatting the paramtest Component</h3>

<p>
<a id="pgfId-260733"></a>The <code>paramtest</code><a id="marker-274262"></a> component has the following format:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-260720"></a><code><em>Name</em></code> paramtest <code><em>parameter</em></code><a id="marker-263404"></a><a id="marker-296488"></a>=<code><em>value</em></code>&#8230;</pre>

<ul><li>
<a id="pgfId-260734"></a><span class="webflare-courier-new" style="white-space:pre"><em>Name</em></span> is your unique name for this <code>paramtest</code> component.</li><li>
<a id="pgfId-260732"></a>The keyword <code>paramtest</code> is the component keyword for the component.</li><li>
<a id="pgfId-260696"></a>The parameters specify the tests that are applied to the parameters, the action taken if parameters satisfy the test conditions, and the text of the message that is printed when parameters satisfy the test conditions.</li></ul>



<h4>
<a id="pgfId-261836"></a>Rules and Guidelines to Remember</h4>

<ul><li>
<a id="pgfId-260885"></a>If you specify more than one test, the conditional action is taken if any test passes.</li><li>
<a id="pgfId-260888"></a>If you use the <code>paramtest</code> component without specifying test conditions, the specified actions are taken, and the message is printed unconditionally. This option is useful for using the <code>paramtest</code> component with the <code>if</code> statement. The <code>paramtest</code> instruction can be followed whenever a given <code>if</code> statement option is executed. </li></ul>


<h4>
<a id="pgfId-261863"></a>The paramtest Options</h4>

<p>
<a id="pgfId-260882"></a>The following table explains the possible <code>paramtest</code> options.</p>

<p>
<a id="pgfId-299478"></a></p>
<table class="webflareTable" id="#id299480">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id299482">
<a id="pgfId-299482"></a>Parameter</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id299484">
<a id="pgfId-299484"></a>Instruction</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299487"></a><code>printif</code><a id="marker-299486"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299489"></a>Informational message is printed if test condition is satisfied.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299492"></a><code>warnif</code><a id="marker-299491"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299494"></a>Warning is printed if test condition is satisfied.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299497"></a><code>errorif</code><a id="marker-299496"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299499"></a>Program quits and error message is printed if testing condition is satisfied.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299502"></a><code>message</code><a id="marker-299501"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299504"></a>Parameter value is the message text.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299507"></a><code>severity</code><a id="marker-299506"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299509"></a>You set this parameter when you use <code>paramtest</code> without a test condition. It specifies the type of message printed and the action to be taken, if any. The possible values are <code>debug</code>, <code>status</code>, <code>warning</code>, <code>error</code>, and <code>fatal</code>. If you specify <code>error</code>, the current analysis quits with an error message. If you specify <code>fatal</code>, the whole simulation stops.</p>
</td>
</tr>
</tbody></table>
<h4>
<a id="pgfId-261896"></a>A paramtest Exa<a id="marker-263489"></a>mple</h4>

<p>
<a id="pgfId-260890"></a>This example uses three consecutive <code>paramtest</code> statements to check the values of four parameters&#8212;<code>l</code>, <code>w</code>, <code>ls</code>, and <code>ld</code>. If a parameter value satisfies a test condition, one of three different warning messages is printed:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-260892"></a>TooShort paramtest warnif=(l &lt; 1um) \<br /> message=&quot;Channel length for nmos must be greater than 1u.&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-260894"></a>TooThin paramtest warnif=(w &lt; 1um) \<br /> message=&quot;Channel width for nmos must be greater than 1u.&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-260896"></a>TooNarrow paramtest warnif=(ls &lt; 1um) warnif=(ld &lt; 1um) \<br /> message=&quot;Strip width for nmos must be greater than 1u.&quot;</pre>
<h2>
<a id="pgfId-260780"></a><a id="19115"></a>Controlling Progra<a id="marker-272651"></a>m-Generated Messages</h2>

<p>
<a id="pgfId-272098"></a>The Spectre simulator normally sends error, warning, and informational messages to the screen. To prevent confusion, the Spectre simulator limits the amount of material it sends to the screen. You can, however, get a more complete printout of messages if you send the messages to a log file that you can generate with the <code>spectre</code> command or in a <code>SPECTRE_DEFAULTS</code> environment variable. </p>

<h3>
<a id="pgfId-272135"></a>Specifying Lo<a id="marker-272619"></a>g File Options</h3>

<p>
<a id="pgfId-291581"></a>You can choose from among the following command line options:</p>

<p>
<a id="pgfId-299516"></a></p>
<table class="webflareTable" id="#id299521">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299524"></a><code>+log &lt;</code><a id="marker-299523"></a><span class="webflare-courier-new" style="white-space:pre"><em>file</em></span><code>&gt;</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299526"></a>The Spectre simulator sends all messages to a log file as well as printing to the screen. You specify the name for the file. You can use <code>+l</code> as an abbreviation of <code>+log</code>.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299529"></a><code>=log &lt;</code><a id="marker-299528"></a><span class="webflare-courier-new" style="white-space:pre"><em>file</em></span><code>&gt;</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299531"></a>The Spectre simulator sends all messages to a log file but does not print to the screen. You specify the name for the file. You can use <code>=l</code> as an abbreviation of <code>=log</code>.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299534"></a><code>-log</code><a id="marker-299533"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299536"></a>The Spectre simulator does not create a log file. You can use <code>-l</code> as an abbreviation of <code>-log</code>. This is the default option.</p>
</td>
</tr>
</tbody></table>
<h4>
<a id="pgfId-272148"></a>Command Line Example</h4>

<p>
<a id="pgfId-272155"></a>The following entry on the command line runs a simulation for circuit <code>smps.circuit</code> and sends all messages to a log file named <code>smps.logfile</code>:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-272172"></a>spectre =log smps.logfile smps.circuit</pre>
<h4>
<a id="pgfId-272181"></a>Setting Environment Variables</h4>

<p>
<a id="pgfId-272198"></a>If you specify log file options in a <code>SPECTRE_DEFAULTS</code> environment variable, you might want to name log files according to some system that helps you keep track of log files from different simulations. Spectre predefined percent codes are useful for this. The following example uses the predefined percent code <code>%C</code> to create log filenames based on the input filename. If you run a simulation for <code>smps.circuit</code>, the Spectre simulator creates a log file named <code>smps.circuit.logfile</code>. You place the <code>SPECTRE_DEFAULTS</code> environment variable in the <code>.cshrc</code> or <code>.profile</code> files.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-272261"></a>setenv SPECTRE_DEFAULTS &quot;=log %C.logfile&quot;</pre>

<p>
<a id="pgfId-293323"></a>For more information about predefined percent codes and the <code>SPECTRE_DEFAULTS</code> environment variable, see <h-hot>Chapter 13, &#8220;Managing Files.&#8221;</h-hot></p>

<h4>
<a id="pgfId-293328"></a>Suppressing Me<a id="marker-293327"></a><a id="marker-296476"></a>ssages</h4>

<p>
<a id="pgfId-272368"></a>There are also <code>spectre</code> command options that let you print or suppress error, warning, or informational messages:</p>

<p>
<a id="pgfId-299540"></a></p>
<table class="webflareTable" id="#id299545">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299549"></a><code>+error</code><a id="marker-299547"></a><a id="marker-299548"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299551"></a>Prints error messages</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299553"></a><code>-error</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299555"></a>Does not print error messages</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299559"></a><code>+warning</code><a id="marker-299557"></a><a id="marker-299558"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299561"></a>Prints warning messages</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299563"></a><code>-warning</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299565"></a>Does not print warning messages</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299569"></a><code>+info</code><a id="marker-299567"></a><a id="marker-299568"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299571"></a>Prints informational messages</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299573"></a><code>-info</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-299575"></a>Does not print informational messages</p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-272471"></a>As a default, the Spectre simulator prints all these messages.</p>

<h2>
<a id="pgfId-260899"></a><a id="23399"></a>Correcting Convergence Problems<a id="marker-263498"></a></h2>

<p>
<a id="pgfId-260900"></a>In this section, you will learn about procedures that can help you if a simulation does not converge.</p>

<h3>
<a id="pgfId-261913"></a>Correcting D<a id="marker-263501"></a>C Convergence Problems</h3>

<p>
<a id="pgfId-263697"></a>If you have DC convergence problems, these suggestions might help you. Simple solutions generally precede more radical or complex measures in the list.</p>
<ul><li>
<a id="pgfId-263699"></a>Evaluate and resolve any warning or error mess<a id="marker-263698"></a>ages.</li><li>
<a id="pgfId-295826"></a>Check for circuit connection errors. Check to see that the polarity and value are correct for independent sources. Check to see if the polarity and multiplier are correct for controlled sources.</li><li>
<a id="pgfId-295827"></a>Try all of the homotopy methods (<code>gmin</code>, <code>source</code>, <code>ptran</code>, <code>dptran</code>,<code> arclength</code>, and <code>tranrampup</code>). These are tried by default.</li><li>
<a id="pgfId-295937"></a>Check for an incorrect estimated operating region. The default estimated operating region in the Spectre simulator is on in the forward region for all devices. If there are a reasonable number of devices that are really off, set them off in the schematic. For a large number of devices, this might not be practical.</li><li>
<a id="pgfId-295938"></a>Check for extremely high gain circuits with nonlinearities and feedback. The convergence criteria are applied to all nodes in the circuit. The output of the gain block meets Kirchhoff&#8217;s Current Law and delta (reltol*V) about 1 part in 10<sup>3</sup> by default. Because of the gain, the input must move by this value divided by the gain. If the gain is high (for example, 10<sup>8</sup>), the input must move less than 1 part in 10<sup>11</sup>. This is an extremely small motion from iteration to iteration that might not be achievable. If the gain is even higher, the numerical resolution of the machine might be approached. About 15 digits of resolution is available in a 64-bit floating-point number. In this case, the gain needs to be reduced.<br /><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-295939"></a>In this case, one node (the output) controls convergence, and all the other nodes are more accurate than the convergence criteria by itself would predict. This is typical for most circuits.</div></li><li>
<a id="pgfId-263701"></a>Enable the topology checker (set <code>topcheck=full</code><a id="marker-264494"></a><a id="marker-263700"></a><a id="marker-296450"></a> on the <code>options</code> statement) and pay attention to any warnings.</li><li>
<a id="pgfId-260905"></a>Increase <code>maxiters</code><a id="marker-263509"></a><a id="marker-296454"></a><a id="marker-296452"></a> for the DC analysis.</li><li>
<a id="pgfId-260906"></a>If you have convergence problems during a DC sweep, reduce the st<a id="marker-263517"></a><a id="marker-296506"></a>ep size.</li><li>
<a id="pgfId-260907"></a>Check for unusual para<a id="marker-263545"></a>meter values using the parameter ran<a id="marker-263513"></a>ge checker (add <code>+param</code> <span class="webflare-courier-new" style="white-space:pre"><em>param-limits-file</em></span> to the <code>spectre</code> command line arguments) and pay attention to any warnings. <br />
<a id="pgfId-260908"></a>Print out the minimum and maximum parameter values by placing an <code>info</code> statement in the netlist. Make sure that the values for the instance, model, output, temperature-dependent, and (if possible) operating-point parameters are reasonable.</li><li>
<a id="pgfId-260909"></a>Avoid using very small floating resis<a id="marker-263521"></a><a id="marker-296466"></a>tors, particularly small parasitic resistors in semiconductors. Use voltage sources or <code>iprobes</code><a id="marker-263525"></a><a id="marker-296474"></a><a id="marker-296472"></a> to measure currents instead. Small floating resistors connected to high impedance nodes can cause convergence difficulties. <code>rbm</code> in the bipolar model is especially troublesome.</li><li>
<a id="pgfId-295830"></a>If the <code>minr</code> model parameter is set, make certain it is set to 1 mOhm or larger.</li><li>
<a id="pgfId-260910"></a>Use realistic d<a id="marker-263541"></a>evice models. Make sure that all component parameters are reasonable, particularly nonlinear device model parameters.</li><li>
<a id="pgfId-260911"></a>Increase the value of <code>gmin</code><a id="marker-263529"></a><a id="marker-296468"></a> with the <code>options</code> statement.</li><li>
<a id="pgfId-260912"></a>Loosen tolerances, particularly absolute tolerances such as <code>iabstol</code><a id="marker-264508"></a><a id="marker-296470"></a><a id="marker-263533"></a><a id="marker-296438"></a> (on the <code>options</code> statement). </li><li>
<a id="pgfId-262170"></a>Simplify the nonlinear compon<a id="marker-263537"></a><a id="marker-296482"></a>ent models. Try to avoid regions in the model that might cause convergence problems.</li><li>
<a id="pgfId-260914"></a>When you have a solution, write it to a node<a id="marker-263553"></a><a id="marker-296480"></a>set file using the <code>write</code> parameter. When you run the simulation again, read the solution back in using the <code>readns</code> parameter in the <code>dc</code> statement.</li><li>
<a id="pgfId-260915"></a>If this is not the first analysis, the solution from the previous analysis might be an inadequate solution estimate because it differs too much from the solution for the current analysis. If this is so, set <code>restart=yes</code><a id="marker-263557"></a>.</li><li>
<a id="pgfId-260916"></a>If you have an estimate of the solution, use nodeset statements or a nodeset file to set as many nodes as possible.</li><li>
<a id="pgfId-260917"></a>If using nodesets or initial conditions causes convergence difficulties, try increasing <code>rforce</code><a id="marker-263561"></a><a id="marker-296496"></a> with the <code>options</code> statement.</li><li>
<a id="pgfId-260918"></a>If you are simulating a bipola<a id="marker-263565"></a><a id="marker-296448"></a>r analog circuit, make sure the region parameters on all transistors and diodes are set correctly.</li><li>
<a id="pgfId-260919"></a>If the analysis fails at an extreme temperature but succeeds at room temperature, try adding a DC analysis that sweeps te<a id="marker-263569"></a><a id="marker-296436"></a>mperature. Start at room temperature, sweep to the extreme temperature, and write the last solution to a nodeset file.</li><li>
<a id="pgfId-260920"></a>Use numeric pivotin<a id="marker-263573"></a><a id="marker-296446"></a><a id="marker-296444"></a>g in the sparse matrix factorization. Set <code>pivotdc=yes</code> with the <code>options</code> statement. Sometimes you must also increase the pivot threshold to between 0.1 to 0.5 by resetting the <code>pivrel</code> parameter with the <code>options</code> statement.</li><li>
<a id="pgfId-260921"></a>Divide the circuit into pieces and simul<a id="marker-263577"></a>ate them individually. Make sure that results for a part alone are close to results for that part combined with the rest of the circuit. Use the results to create nodesets for the whole circuit.</li><li>
<a id="pgfId-260922"></a>Try replacing the DC analysis<a id="marker-263581"></a> with a transient analysis. Modify all the independent sources to start at zero and ramp to the independent source DC values. Run the transient analysis well beyond the time when all the sources have reached their final values. Write the final point to a nodeset file. <br />
<a id="pgfId-260923"></a>You can make this transient analysis more efficient with one of the following procedures: <ul><li>
<a id="pgfId-260924"></a>Set the integrat<a id="marker-269316"></a>ion method to backward-Euler (<code>method=euler</code>).</li><li>
<a id="pgfId-260925"></a>Loosen the local truncat<a id="marker-263587"></a><a id="marker-296442"></a><a id="marker-296440"></a>ion error criteria by increasing <code>lteratio</code> to 50 or more. </li></ul><br />
<a id="pgfId-260926"></a>Occasionally, an oscillato<a id="marker-263590"></a>r in the circuit causes the transient analysis to terminate or work very slowly.</li></ul>






























<h3>
<a id="pgfId-261924"></a>Correcting Transient Analysis Convergence Problems</h3>

<p>
<a id="pgfId-260928"></a>You can use two approaches to eliminate transient analysis convergence problems. The first strategy is to reduce the effect of discontinuities in nonlinear capacitors. The second method is to eliminate discontinuous jumps in the solution. Try the following suggestions if you have difficulty with transient analysis convergence:</p>
<ul><li>
<a id="pgfId-260929"></a>Use a complete set of par<a id="marker-263602"></a><a id="marker-296516"></a>asitic capacitors on nonlinear devices to avoid jumps in the solution waveforms. Specify nonzero source and drain areas on MOS mod<a id="marker-263605"></a><a id="marker-296514"></a>els.</li><li>
<a id="pgfId-260930"></a>Use the <code>cmin</code> parameter to install a small capacitor from every node in the circuit to ground. This usually eliminates any jumps in the solution.<a id="marker-263608"></a></li><li>
<a id="pgfId-260931"></a>If you can identify a nonlinear capacitance that might have a discontinuity, simplify the nonlinear cap<a id="marker-263611"></a><a id="marker-296512"></a>acitor model. If you cannot actually simplify the model, modifying it might help convergence.</li><li>
<a id="pgfId-260932"></a>As a last resort, relax the tolerance valu<a id="marker-263614"></a>es for the <code>lteratio</code> or <code>reltol</code> parameters and widen transitions in the stimulus waveforms.</li></ul>




<h2>
<a id="pgfId-271450"></a><a id="30567"></a>Correcting Accura<a id="marker-271919"></a>cy Problems</h2>

<p>
<a id="pgfId-271485"></a>If you need greater accuracy from a Spectre simulation, the most common solution is to tighten the <code>reltol</code><a id="marker-271937"></a> parameter of the <code>options</code> or <code>set</code> statements. In addition, be sure that the absolute tolerance parameters, <code>vabstol</code><a id="marker-271944"></a> and <code>iabstol</code><a id="marker-271951"></a>, are set to appropriate values. If tightening <code>reltol</code> does not help or if it greatly slows the simulation, try the additional suggestions in the following sections.</p>

<h3>
<a id="pgfId-271573"></a>Suggestions for Improvin<a id="marker-271924"></a>g DC Analysis Accuracy</h3>

<ul><li>
<a id="pgfId-271578"></a>Be sure there are no errors in the circuit. Use the computed DC solution and the operating point to debug the circuit. Check the topology, the component parameters, the models, and the power supplies.</li><li>
<a id="pgfId-271587"></a>Be sure you are using appropriate models and that the model parameters are consistent and correct.</li><li>
<a id="pgfId-271592"></a>If the circuit might have more than one solution, use <code>nodeset</code> statements to influence the Spectre simulator to compute the solution you want.</li><li>
<a id="pgfId-271599"></a>Be sure that <code>gmin</code><a id="marker-271958"></a> is not influencing the solution. If possible, set <code>gmin</code> to 0 (in an <code>options</code> or <code>set</code> statement).</li></ul>




<h3>
<a id="pgfId-271608"></a>Suggestions for Improving T<a id="marker-271930"></a>ransient Analysis Accuracy</h3>

<ul><li>
<a id="pgfId-271619"></a>Verify that the circuit biased up properly. If it did not, there might be a problem in the topology, the models, or the power supplies.</li><li>
<a id="pgfId-271632"></a>Be sure you are using appropriate models and that the model parameters are consistent and correct. Check the operating point of each device.</li><li>
<a id="pgfId-279903"></a>Set the transient analysis parameter <code>errpreset</code> to <code>conservative</code>.</li><li>
<a id="pgfId-271649"></a>If there is a charge conservation problem, use only charge-conserving models if you are not already doing so. Then tighten <code>reltol</code> to increase accuracy. (With the Spectre simulator, only customer-installed models might not be charge conserving.)</li><li>
<a id="pgfId-271676"></a>Be sure that <code>gmin</code><a id="marker-271965"></a> is not influencing the solution. If possible, set <code>gmin</code> to 0 (in an <code>options</code> or <code>set</code> statement).</li><li>
<a id="pgfId-271670"></a>If a solution exhibits point-to-point ringing, set the integration method in the transient analysis to Gear&#8217;s second-order backward-difference formula (<code>method=gear2only</code><a id="marker-271972"></a>).</li><li>
<a id="pgfId-271695"></a>If a low-loss resonator exhibits too much loss, set the integration method in the transient analysis to the trapezoidal rule (<code>method=traponly</code>).</li><li>
<a id="pgfId-271731"></a>If the initial conditions used by the Spectre simulator are not the same as the ones you specified, decrease the <code>rforce</code><a id="marker-271979"></a> parameter in the <code>options</code> or <code>set</code> statements until the initial conditions are correct.</li><li>
<a id="pgfId-271749"></a>If the Spectre simulator does not accurately follow the turn-on transient of an oscillator, set the <code>maxstep</code><a id="marker-271986"></a> parameter of the transient analysis to one-tenth the size of the expected period of oscillation or less.</li></ul>









<h2>
<a id="pgfId-300719"></a><a id="93804"></a>Packaging a Test Case for Shipment to Cadence</h2>

<p>
<a id="pgfId-300720"></a>The <code>mmsimpack</code> utility, shipped with the SPECTRE release, enables you to create a compressed tar file containing all input files required for a test case. If a test case needs to be sent to Cadence for discussing and resolving Spectre simulation problems, the utility can be used to create the required file set, and to ship the case to Cadence.</p>
<p>
<a id="pgfId-300721"></a>To create a compressed tar file, perform the following steps:</p>
<ol><li>
<a id="pgfId-300722"></a>Run a regular Spectre simulation to create a Spectre log file which reports all the files being read during parsing. Since, for this job, only the parsing is of relevance, the transient time may be shorted to accelerate the process.</li><li>
<a id="pgfId-300723"></a>Use the <code>mmsimpack</code> utility to create the compressed tar file, as follows:<br /><pre class="webflare-pre-block webflare-courier-new" id="#id300724">
<a id="pgfId-300724"></a>% mmsimpack logfile -pack &lt;packdir&gt; [-filter &lt;filter_file&gt; ]</pre>
<a id="pgfId-300725"></a>Where<br />
<a id="pgfId-300726"></a><code>pack &lt;</code><span class="webflare-courier-new" style="white-space:pre"><em>packdir</em></span><code>&gt;</code> specifies the directory where you want to save the packed netlist.<br />
<a id="pgfId-300727"></a><code>-filter &lt;filter_file&gt;</code> (Optional) is a user-defined filter. The files that match the pattern in the filter file are not packed. The format of <span class="webflare-courier-new" style="white-space:pre"><em>filter_file</em></span> should be a regular expression.<br />
<a id="pgfId-301076"></a><code>-copy_only</code> (Optional) Copy only the input netlist files and do not replace the absolute path in the netlist. This can reduce the <code>mmsimpack</code> runtime, however, the netlist might not run at another location because of the path issue.<br />
<a id="pgfId-300728"></a><code>-h</code> displays the help information.</li></ol>








<h3>
<a id="pgfId-300729"></a>Example</h3>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-300730"></a>% spectre +aps mult16.scs +log mult16.out</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-300731"></a>% mmsimpack mult16.out -pack packngo</pre>

<p>
<a id="pgfId-300732"></a>The above example will create a file called <code>SendMe.tar.gz</code> in the directory <code>packngo</code>. The <code>SendMe.tar.gz</code> file contains all the files required for running Spectre on the <code>mult16.scs</code> test case.</p>

<br /><a href="#pagetop">Return to top</a><br /></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="chap16.html" id="prev" title="Managing Files">Managing Files</a></em></b><b><em><a href="appA.html" id="nex" title="Example Circuits">Example Circuits</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2020, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
</body></html>