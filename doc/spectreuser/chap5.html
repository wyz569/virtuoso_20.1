
<html><head><title>Parameter Specification and Modeling Features</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="kamal" />
<meta name="CreateDate" content="2020-06-16" />
<meta name="CreateTime" content="1592307261" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes the Spectre Circuit Simulator." />
<meta name="DocTitle" content="Spectre Classic Simulator, Spectre APS, Spectre X, and Spectre XPS User Guide" />
<meta name="DocType" content="User Guide" />
<meta name="FileTitle" content="Parameter Specification and Modeling Features" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-3.2" />
<meta name="Keyword" content="spectreuser" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2020-06-16" />
<meta name="ModifiedTime" content="1592307261" />
<meta name="NextFile" content="chap6.html" />
<meta name="Order" content="1" />
<meta name="Group" content="Spectre Simulator" />
<meta name="Platform" content="Custom IC Design" />
<meta name="PrevFile" content="chap4.html" />
<meta name="c_product" content="Spectre" />
<meta name="Product" content="Spectre" />
<meta name="ProductFamily" content="Spectre" />
<meta name="ProductVersion" content="19.1" />
<meta name="RightsManagement" content="Copyright 2012-2020 Cadence Design Systems Inc." />
<meta name="Title" content="Spectre Classic Simulator, Spectre APS, Spectre X, and Spectre XPS User Guide -- Parameter Specification and Modeling Features" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="prod_feature" content="" />
<meta name="prod_subfeature" content="" />
<meta name="Version" content="19.1" />
<meta name="SpaceKey" content="spectreuser191" />
<meta name="webflare-version" content="2.0" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" /></head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="spectreuserTOC.html">Contents</a></li><li><a class="prev" href="chap4.html" title="Spectre Netlists">Spectre Netlists</a></li><li style="float: right;"><a class="viewPrint" href="spectreuser.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="chap6.html" title="Modeling for Signal Integrity">Modeling for Signal Integrity</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Spectre Classic Simulator, Spectre APS, Spectre X, and Spectre XPS User Guide<br />Product Version 19.1, June 2020</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;"><a name="#firstpage"></a>

<h1>8
<a id="pgfId-1611"></a></h1>
<h1>
<a id="pgfId-195448"></a><hr />
<a id="41330"></a>Parameter Specification and Modeling Features<hr />
</h1>

<p>
<a id="pgfId-195449"></a>You can use the Spectre<sup>&#174;</sup> circuit simulator models and AHDL modules in Spectre netlists. This chapter describes the powerful modeling capabilities of Spectre, including</p>
<ul><li>
<a id="pgfId-191332"></a><a href="chap5.html#22193">Instance (Component or Analysis) Parameters</a></li><li>
<a id="pgfId-191827"></a><a href="chap5.html#28121">Parameters Statement</a></li><li>
<a id="pgfId-190295"></a><a href="chap5.html#30338">Expressions</a></li><li>
<a id="pgfId-187903"></a><a href="chap5.html#41460">Subcircuits</a></li><li>
<a id="pgfId-187921"></a><a href="chap5.html#28198">Inline Subcircuits</a></li><li>
<a id="pgfId-187904"></a><a href="chap5.html#13255">Binning</a></li><li>
<a id="pgfId-191813"></a><a href="chap5.html#11351">Scaling Physical Dimensions of Components and Device Model Technology</a></li><li>
<a id="pgfId-256789"></a><a href="chap5.html#13932">Multi-Technology Simulation</a></li></ul>








<h2>
<a id="pgfId-195595"></a><a id="22193"></a>Instance (Component or Analysis) Parameters</h2>

<p>
<a id="pgfId-257600"></a>In this section, you will learn about the types of component or analysis parameter values the Spectre circuit simulator accepts and how to specify them.</p>

<h3>
<a id="pgfId-257602"></a>Types of Parameter Values<a id="marker-257601"></a></h3>

<p>
<a id="pgfId-186238"></a>Spectre component or analysis parameters can take the following types of values:</p>
<ul><li>
<a id="pgfId-186240"></a>Real or integer expression, consisting of<ul><li>
<a id="pgfId-190141"></a>Literals</li><li>
<a id="pgfId-190142"></a>Arithmetic or Boolean operators</li><li>
<a id="pgfId-190176"></a>Predefined circuit or subcircuit parameters</li><li>
<a id="pgfId-186242"></a>Built-in constants (fixed values) or mathematical functions (software routines that calculate equations)</li><li>
<a id="pgfId-190163"></a>Real or integer constants</li></ul></li><li>
<a id="pgfId-186244"></a>The name of a component instance or model</li><li>
<a id="pgfId-186245"></a>The name of a component parameter </li><li>
<a id="pgfId-186246"></a>A character string (must be surrounded by quotation marks) </li><li>
<a id="pgfId-186247"></a>A name from a predefined set of names available to specify the parameter value (enumerated types)</li></ul>










<h3>
<a id="pgfId-186248"></a>Parameter Dimension</h3>

<p>
<a id="pgfId-186249"></a>Component or analysis parameters can be either scalar or vector.</p>
<p>
<a id="pgfId-186252"></a>If a component or analysis para<a id="marker-191980"></a>meter value is a group of numbers or names, you specify the group as a vector of values by enclosing the list of items in square brackets (<em></em><a id="marker-186253"></a><code>[]</code>)&#8212;for example, <code>coeffs=[0 0.1 0.2 0.5]</code> to specify the parameter values 0, 0.1, 0.2, and 0.5. You can specify a group of number pairs (such as time-voltage pairs to specify a waveform) as a vector of the individual numbers.</p>
<p>
<a id="pgfId-260884"></a>For a vector parameter assignment, you can use the <code>range</code> function to specify a range of values. Following is the syntax for the <code>range</code> function:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-260885"></a>range(start, stop, step)</pre>

<p>
<a id="pgfId-260886"></a>Here,</p>
<p>
<a id="pgfId-260887"></a><code>start</code> - start value of the parameter range</p>
<p>
<a id="pgfId-260888"></a><code>stop</code> - end value of the parameter range</p>
<p>
<a id="pgfId-260889"></a><code>step</code> - number by which the parameter&#39;s value should be increased. The <code>step</code> argument is optional. If it is not specified, the default value is taken as 1. Negative values are also supported. The values can be integer or float.</p>
<p>
<a id="pgfId-260891"></a>For example,</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-260892"></a>&lt;param_name&gt;=[1 2 3 range(4, 10, 2)]</pre>

<p>
<a id="pgfId-260893"></a>will return <code>[1 2 3 4 6 8 10]</code>.</p>
<p>
<a id="pgfId-186254"></a>Remember these guidelines when you specify vectors of value:</p>
<ul><li>
<a id="pgfId-186255"></a>You can mix numbers and netlist or subcircuit parameter names in the same vector (<code>coeff=[0 coeff1 coeff2 0.5]</code>). </li><li>
<a id="pgfId-186256"></a>You cannot leave a list of items empty.</li><li>
<a id="pgfId-186257"></a>You can use expressions (such as formulas) to specify numbers within a vector. When you use a vector of expressions, each expression must be surrounded by parentheses (<code>coeff=[0 (A*B) C 0.5]</code>).</li><li>
<a id="pgfId-186258"></a>You can use subcircuit parameters within vectors.</li></ul>




<h3>
<a id="pgfId-186259"></a>Parameter Ranges</h3>

<p>
<a id="pgfId-186260"></a>Parameter ranges have ha<a id="marker-192695"></a>rd limits and so<a id="marker-192696"></a>ft limits. Hard limits are enforced by the Spectre simulator; if you violate them, the Spectre simulator issues an error and terminates. You specify soft limits; if you violate them, the Spectre simulator issues a warning and continues. Soft limits are used to define reasonable ranges for parameter values and can help find &#8220;unreasonable&#8221; values that are likely errors. You can change soft limits, which are defined in one or more files. Use the <code>+param</code> command line option to use the suggested parameter range limits.</p>
<p>
<a id="pgfId-188140"></a>You can specify limits for any scalar parameter that takes either a real number, an integer, or an enumeration. To specify the limits of a parameter that takes enumerations, use the indices or index values associated with the enumerations. For example, consider the region parameter of the bjt. There are four possible regions (see <code>spectre -h bjt</code>): </p>
<ul><li>
<a id="pgfId-188187"></a><code>off</code></li><li>
<a id="pgfId-188188"></a><code>fwd</code></li><li>
<a id="pgfId-188189"></a><code>rev</code></li><li>
<a id="pgfId-188190"></a><code>sat</code></li></ul>



<p>
<a id="pgfId-188195"></a>Each enumeration is assigned a number starting at 0 and counting up. Thus, </p>
<ul><li>
<a id="pgfId-188200"></a><code>off=0</code></li><li>
<a id="pgfId-188196"></a><code>fwd=1</code></li><li>
<a id="pgfId-188203"></a><code>rev=2</code></li><li>
<a id="pgfId-188198"></a><code>sat=3</code></li></ul>



<p>
<a id="pgfId-188199"></a>The specification <code>bjt 3 &lt;= region &lt;= 1</code> indicates that a warning is printed if <code>region=rev</code> because the conditions <code>3 &lt;= region</code> and <code>region &lt;= 1</code> exclude only <code>region=2</code> and <code>region</code> 2 is <code>rev</code>.</p>
<p>
<a id="pgfId-186264"></a>For more information on parameter range checking, see <a href="chap5.html#10416">Checking for Invalid Parameter Values</a>.</p>

<h3>
<a id="pgfId-186265"></a>Help on Parameters</h3>

<p>
<a id="pgfId-186266"></a>There are four main ways to get online help about Spectre component or analysis parameters.</p>

<h4>
<a id="pgfId-186267"></a>spectre -help</h4>

<p>
<a id="pgfId-186268"></a>When you type <code>spectre -help </code><span class="webflare-courier-new" style="white-space:pre"><em>name</em></span>, where <span class="webflare-courier-new" style="white-space:pre"><em>name</em></span> is the name of a component or analysis, you get the following information:</p>
<ul><li>
<a id="pgfId-186269"></a>Parameter names<br />
<a id="pgfId-186270"></a>Related parameters are grouped together.</li><li>
<a id="pgfId-186271"></a>Parameter defaults</li><li>
<a id="pgfId-190197"></a>Units</li><li>
<a id="pgfId-186272"></a>Parameter description</li></ul>




<p>
<a id="pgfId-186274"></a>For analyses and controls, parameters are listed in the &#8220;Parameters&#8221; section. At the end of the longer parameter listings is the parameter index. This index lists the parameters alphabetically and gives the number that corresponds to where the parameter is in the numbered list.</p>
<p>
<a id="pgfId-191354"></a>For components, parameters are divided into up to four sections: &#8220;Instance Parameters,&#8221; &#8220;Model Parameters,&#8221; &#8220;Output Parameters,&#8221; and &#8220;Operating Point Parameters.&#8221; At the end of longer parameter listings is the parameter index. This index indicates where to find a parameter&#8217;s description with a letter and a number. The letter refers to the section (for example, <em>I</em> refers to the instance parameters section, <em>M</em> refers to the model parameters section, <em>O</em> refers to the output parameters section, and <em>OP</em> refers to the operating-point parameters section), and the number refers to where the parameter is in the numbered list.</p>

<h4>
<a id="pgfId-186275"></a>spectre -helpsort</h4>

<p>
<a id="pgfId-186276"></a>When you type <code>spectre -helpsort </code><span class="webflare-courier-new" style="white-space:pre"><em>name</em></span>, where <span class="webflare-courier-new" style="white-space:pre"><em>name</em></span> is the name of a component or analysis, you get the same information as you do with <code>spectre -h </code><span class="webflare-courier-new" style="white-space:pre"><em>name</em></span>, but the parameters are sorted alphabetically instead of divided into related groups.</p>

<h4>
<a id="pgfId-186277"></a>spectre -helpfull</h4>

<p>
<a id="pgfId-186278"></a>When you type <code>spectre -helpfull </code><span class="webflare-courier-new" style="white-space:pre"><em>name</em></span>, where <span class="webflare-courier-new" style="white-space:pre"><em>name</em></span> is the name of a component or analysis, you get related parameters grouped as you do with <code>spectre -h </code><span class="webflare-courier-new" style="white-space:pre"><em>name</em></span>, and you get the following additional information:</p>
<ul><li>
<a id="pgfId-186279"></a>Parameter type</li><li>
<a id="pgfId-186280"></a>Parameter dimension&#8212;scalar or vector</li><li>
<a id="pgfId-186281"></a>Parameter range</li></ul>



<h4>
<a id="pgfId-186282"></a>spectre -helpsortfull</h4>

<p>
<a id="pgfId-186283"></a>When you type <code>spectre -helpsortfull </code><span class="webflare-courier-new" style="white-space:pre"><em>name</em></span>, where <span class="webflare-courier-new" style="white-space:pre"><em>name</em></span> is the name of a component or analysis, you get the same information as you do with <code>spectre -helpfull </code><span class="webflare-courier-new" style="white-space:pre"><em>name</em></span>, but the parameters are sorted alphabetically instead of divided into related groups.</p>

<h3>
<a id="pgfId-186286"></a><a id="41379"></a>Scaling Numerical Literals<a id="marker-186285"></a></h3>

<p>
<a id="pgfId-186287"></a>If a parameter value is an integer or a floating-point number, you can scale it in the following ways: </p>
<ul><li>
<a id="pgfId-186288"></a>Follow the number with an <code>e</code> or an <code>E</code> and an integer exponent (for example, <code>2.65e3</code>, <code>5.32e-4</code>, <code>1E-14</code>, <code>3.04E6</code>) </li><li>
<a id="pgfId-186290"></a>Use scale fac<a id="marker-186289"></a>tors (for example <code>5u</code>, <code>3.26k</code>, <code>4.2m</code>)<br /><div class="webflare-information-macro webflare-macro-information">
<a id="pgfId-186291"></a>
You cannot use both scale factors and exponents in the same parameter value. For example, the Spectre simulator ignores the <code>p</code> in a value such as <code>1.234E-3p</code>.</div><div class="webflare-information-macro webflare-macro-warning">
<a id="pgfId-190216"></a>
The Spectre simulator also accepts additional data files, such as the waveform and noise files accepted by the independent sources or the S-parameter file accepted by the N-port. Generally, these files do <em>not</em> accept numbers with scale factors.</div></li></ul>





<p>
<a id="pgfId-203975"></a>The Spectre mode (<code>simulator lang=spectre</code><a id="marker-203974"></a>) accepts only the following ANSI standard (SI) scale factors: </p>

<p>
<a id="pgfId-204007"></a></p>
<table class="webflareTable" id="#id203976">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-203978"></a><code>T</code>=10<sup>12</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-203980"></a><code>G</code>=10<sup>9</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-203982"></a><code>M</code>=10<sup>6</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-203984"></a><code>K</code>=10<sup>3</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-203986"></a><code>k</code>=10<sup>3</sup></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-203988"></a><code>_</code>=1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-203990"></a><code>%</code>=10<sup>-2</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-203992"></a><code>c</code>=10<sup>-2</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-203994"></a><code>m</code>=10<sup>-3</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-203996"></a><code>u</code>=10<sup>-6</sup></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-203998"></a><code>n</code>=10<sup>-9</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-204000"></a><code>p</code>=10<sup>-12</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-204002"></a><code>f</code>=10<sup>-15</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-204004"></a><code>a</code>=10<sup>-18</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-204006"></a></p>
</td>
</tr>
</tbody></table>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-203825"></a>SI scale factors are case sensitive.</div>
<p>
<a id="pgfId-186337"></a>The Spectre simulator allows you to specify units, but only if you specify a scale factor. If specified, units are ignored. Thus,</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-190218"></a>c=1pf&#160;&#160;// units = &quot;f&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-190219"></a>l=1uH // units = &quot;H&quot;</pre>

<p>
<a id="pgfId-190224"></a>are accepted, but</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-190225"></a>r=50Ohms</pre>

<p>
<a id="pgfId-190226"></a>is rejected because units are provided without a scale factor. For the last example, use</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-190227"></a>r=50_Ohms</pre>

<p>
<a id="pgfId-190217"></a>SPICE mode (<code>simulator lang=spice</code><a id="marker-186336"></a>) accepts only the following SPICE scale factors:</p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-186360"></a>SPICE scale factors are not case sensitive. Any other scale factor is ignored (treated as 1.0).</div>

<p>
<a id="pgfId-203828"></a></p>
<table class="webflareTable" id="#id203833">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-203835"></a><code>t</code>=10<sup>12</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-203837"></a><code>g</code>=10<sup>9</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-203839"></a><code>meg</code>=10<sup>6</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-203841"></a><code>k</code>=10<sup>3</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-203843"></a><code>p</code>=10<sup>-12</sup></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-203845"></a><code>m</code>=10<sup>-3</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-203847"></a><code>mil</code>=25.4 x 10<sup>-6</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-203849"></a><code>u</code>=10<sup>-6</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-203851"></a><code>n</code>=10<sup>-9</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-203853"></a><code>f</code>=10<sup>-15</sup></p>
</td>
</tr>
</tbody></table>
<div class="webflare-information-macro webflare-macro-warning">
<a id="pgfId-186361"></a>
If you are not clear about the scaling rules for each simulation mode, you can cause errors in your simulation. For example, <code>1.0M</code> is interpreted as 10-3 in the SPICE mode but as 106 in the Spectre mode.</div>
<h2>
<a id="pgfId-191839"></a><a id="28121"></a>Pa<a id="marker-191836"></a>rameters S<a id="param_statement"></a>tatement</h2>

<p>
<a id="pgfId-191841"></a>In this section, you will learn about the circuit and subcircuit parameters (collectively known as netlist parameters) as defined by the <code>parameters</code> statement. </p>

<h3>
<a id="pgfId-191844"></a><a id="14104"></a>Circ<a id="marker-191843"></a>uit and Subcircuit Parameters</h3>

<p>
<a id="pgfId-191845"></a>The Spectre Netlist Language allows real-valued parameters to be defined and referenced in the netlist, both at the top-level scope and within subcircuit declarations (run <code>spectre -h subckt</code> for more details on parameters within subcircuits). </p>
<p>
<a id="pgfId-191846"></a>The format for defining parameters is as follows:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-191847"></a>parameters <code><em>param=value</em></code> <code><em>param=value</em></code> ...</pre>

<p>
<a id="pgfId-191848"></a>Once defined, you can use parameters freely in expressions. The following are examples:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-191849"></a>simulator lang=spectre<br />parameters p1=1 p2=2&#160;&#160;          // declare some parameters</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-191850"></a>r1 1 0 resistor r=p1            // use a parameter, value=1<br />r2 1 0 resistor r=p1+p2&#160;&#160; // use parameters in an expression, value=3</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-191851"></a>x1 s1 p4=8&#160;&#160;   // subckt &quot;s1&quot; is defined below, pass in value 8 for &quot;p4&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-191852"></a>subckt s1<br />  parameters p1=4 p3=5 p4=6  // note: no &quot;p2&quot; here, p1 &quot;redefined&quot;<br />  r1 1 0 resistor r=p1       // local definition used: value=4<br />  r2 1 0 resistor r=p2       // inherit from parent(top-level) value=2<br />  r3 1 0 resistor r=p3       // use local definition, value=5<br />  r4 1 0 resistor r=p4       // use passed-in value, value=8<br />  r5 1 0 resistor r=p1+p2/p3 //use local+inherited/local=(4+2/5)=4.4<br />ends</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-191853"></a>time_sweep tran start=0 stop=(p1+p2)*50e-6 // use 5*50e-6 = 150 us<br />dc_sweep dc param=p1 values=[0.5 1 +p2 (sqrt(p2*p2)) ]&#160;&#160;// sweep p1 </pre>
<h3>
<a id="pgfId-191854"></a>Parameter Declaration</h3>

<p>
<a id="pgfId-191855"></a>Parameters can be declared anywhere in the top-level circuit description or on the first line of a subcircuit definition. Parameters must be declared before they are used (referenced). Multiple parameters can be declared on a single line. When parameters are declared in the top-level, their values are also specified. When parameters are declared within subcircuits, their default values are specified. The value or default value for a parameter can be a constant, expression, a reference to a previously defined parameter, or any combination of these.</p>
<p>
<a id="pgfId-197940"></a>You can declare parameters between subcircuit definitions if the subcircuits do not refer to parameters in the parent scope defined after the subcircuit definition. If you want to use <code>altergroups</code>, you must declare all parameters before the subcircuit definitions.</p>

<h3>
<a id="pgfId-191856"></a>Parameter Inheritance</h3>

<p>
<a id="pgfId-191857"></a>Subcircuit definitions inherit parameters from their parent (enclosing subcircuit definition, or top-level definition). This inheritance continues across all levels of nesting of subcircuit definitions; that is, if a subcircuit <code>s1</code> is defined, which itself contains a nested subcircuit definition <code>s2</code>, then any parameters accessible within the scope of <code>s1</code> are also accessible from within <code>s2</code>. Also, any parameters declared within the top-level circuit description are also accessible within both <code>s1</code> and <code>s2</code>. However, any subcircuit definition can redefine a parameter that it inherited. In this case, if no value is specified for the redefined parameter when the subcircuit is instantiated, then the redefined parameter uses the locally defined default value, rather than inheriting the actual parameter value from the parent. See how the <code>r2</code> resistor is used in the examples in <a href="chap5.html#14104">Circuit and Subcircuit Parameters</a>.</p>

<h3>
<a id="pgfId-191863"></a>Parameter Referencing</h3>

<p>
<a id="pgfId-191864"></a>Spectre netlist parameters can be referenced anywhere that a numeric value is normally specified on the right-hand side of an <code>=</code> sign or within a vector, where the vector itself is on the right-hand side of an <code>=</code> sign. This includes referencing of parameters in expressions (run <code>spectre -h expressions</code> for more details on netlist expression handling), as indicated in the preceding examples. You can use expressions containing parameter references when specifying component or analysis parameter values (for example specifying the resistance of a resistor or the stop time of a transient analysis, as outlined in the preceding example), when specifying model parameter values in model statements (for example specifying <code>bf=p1*0.8</code> for a bipolar model parameter, <code>bf</code>), or when specifying initial conditions and nodesets for individual circuit nodes. </p>

<h3>
<a id="pgfId-191865"></a>Altering/Sweeping Parameters</h3>

<p>
<a id="pgfId-191866"></a>Just as certain Spectre analyses (such as <code>sweep</code>, <code>alter</code>, <code>ac</code>, <code>dc</code>, <code>noise</code>, <code>sp</code>, and <code>xf</code>) can sweep component instance or model parameters, they can also sweep netlist parameters. Run <code>spectre -h </code><span class="webflare-courier-new" style="white-space:pre"><em>analysis</em></span> to see the particular details for any of these analyses, where <span class="webflare-courier-new" style="white-space:pre"><em>analysis</em></span> is the analysis of interest.</p>

<h2>
<a id="pgfId-186444"></a><a id="29010"></a><a id="30338"></a>Expre<a id="marker-186443"></a>ssions</h2>

<p>
<a id="pgfId-186445"></a>An expression is a construct that combines operands with operators to produce a result that is a function of the values of the operands and the semantic meaning of the operators. Any legal operand is also an expression in itself. Legal operands include numeric constants and references to top-level netlist parameters or subcircuit parameters. Calls to algebraic and trigonometric functions are also supported. The complete lists of operators, algebraic, and trigonometric functions are given after some examples. </p>
<p>
<a id="pgfId-186446"></a>The following are examples:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-186447"></a>simulator lang=spectre<br />parameters p1=1 p2=2&#160;&#160;         // declare some top-level parameters</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-186448"></a>r1 (1 0) resistor r=p1        // the simplest type of expression<br />r2 (1 0) resistor r=p1+p2     // a binary (+) expression <br />r3 (1 0) resistor r=5+6/2&#160;&#160;  // expression of constants, = 8 </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-186449"></a>x1 s1 p4=8 // instantiate a subcircuit, defined in the following lines</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-186450"></a>subckt s1
parameters p1=4 p3=5 p4=p1+p3       // subcircuit parameters
&#160;&#160;&#160;&#160;r1 (1 0) resistor r=p1      // another simple expression
&#160;&#160;&#160;&#160;r2 (1 0) resistor r=p2*p2   // a binary multiply expression
&#160;&#160;&#160;&#160;r3 (1 0) resistor r=(p1+p2)/p3      // a more complex expression
&#160;&#160;&#160;&#160;r4 (1 0) resistor r=sqrt(p1+p2)     // an algebraic function call
&#160;&#160;&#160;&#160;r5 (1 0) resistor r=3+atan(p1/p2) //a trigonometric function call
&#160;&#160;&#160;&#160;r6 (1 0) RESMOD r=(p1 ? p4+1 : p3)  // the ternary operator<br />ends</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-186451"></a>//  a model statement, containing expressions<br />model RESMOD resistor tc1=p1+p2 tc2=sqrt(p1*p2)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-186452"></a>//  some expressions used with analysis parameters<br />time_sweep tran start=0 stop=(p1+p2)*50e-6 // use 5*50e-6 = 150 us</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-186453"></a>//  a vector of expressions (see notes on vectors below)<br />dc_sweep dc param=p1 values=[0.5 1 +p2 (sqrt(p2*p2)) ]&#160;&#160;// sweep p1 </pre>
<h4>
<a id="pgfId-186454"></a>Where Expressions Can Be Used</h4>

<p>
<a id="pgfId-186455"></a>The Spectre Netlist Language allows expressions to be used where numeric values are expected on the right-hand side of an <code>=</code> sign or within a vector, where the vector itself is on the right-hand side of an <code>=</code> sign. Expressions can be used when specifying component or analysis instance parameter values (for example, specifying the resistance of a resistor or the stop time of a transient analysis, as outlined in the preceding example), when specifying model parameter values in model statements (for example, specifying <code>bf=p1*0.8</code> for a bipolar model parameter, <code>bf</code>), or when specifying initial conditions and nodesets for individual circuit nodes. </p>

<h4>
<a id="pgfId-186456"></a>Operators</h4>

<p>
<a id="pgfId-186457"></a>The operators in the following table are supported, listed in order of decreasing precedence. Parentheses can be used to change the order of evaluation. For a binary expression like <code>a+b</code>, <code>a</code> is the first operand and <code>b</code> is the second operand. All operators are left associative, with the exceptions of the &#8220;to the power of&#8221; operator (<code>**</code>) and the ternary operator ( <code>? :</code> ), which are right associative. For logical operands, any nonzero value is considered true. The relational and equality operators return a value of 1 to indicate true or 0 to indicate false. There is no short-circuiting of logical expressions involving <code>&amp;&amp;</code> and <code>||</code>.</p>

<p>
<a id="pgfId-208592"></a></p>
<table class="webflareTable" id="#id208597">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id208599">
<a id="pgfId-208599"></a>Operator</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id208601">
<a id="pgfId-208601"></a>Symbol(s)</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id208603">
<a id="pgfId-208603"></a>Value</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208605"></a>Unary +, Unary &#8211;</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208607"></a><code>+</code>, <code>&#8211;</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208609"></a>Value of the operand, negative of the operand.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208611"></a>To the power of</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208613"></a><code>**</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208615"></a>First operand to be raised to the power of the second operand.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208617"></a>Multiply, Divide</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208619"></a><code>*</code>, <code>/</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208621"></a>Product, quotient of the operands.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208623"></a>Binary Plus/Minus</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208625"></a>+, &#8211;</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208627"></a>Sum, difference of the operands.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208629"></a>Shift</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208631"></a><code>&lt;&lt;</code>, <code>&gt;&gt;</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208633"></a>First operand shifted left by the number of bits specified by the second operand; first operand shifted right by the number of bits specified by the second operand.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208635"></a>Relational</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208637"></a><code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208639"></a>Less than, less than or equal, greater than, greater than or equal, respectively.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208641"></a>Equality</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208643"></a><code>==</code>, <code>!=</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208645"></a>True if the operands are equal; true if the operands are not equal.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208647"></a>Bitwise AND</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208649"></a><code>&amp;</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208651"></a>Bitwise AND (of integer operands).</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208653"></a>Bitwise Exclusive NOR</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208655"></a><code>~^</code> (or <code>^~</code>)</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208657"></a>Bitwise exclusive NOR (of integer operands).</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208659"></a>Bitwise OR</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208661"></a><code>|</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208663"></a>Bitwise OR (of integer operands).</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-267693"></a>Bitwise Exclusive OR</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-267695"></a><code>^</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-267697"></a>Bitwise exclusive OR (of integer operands).</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-267745"></a>Bitwise NOT</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-267747"></a><code>~</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-267749"></a>Bitwise NOT (of integer operand).</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208665"></a>Logical AND</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208667"></a><code>&amp;&amp;</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208669"></a>True only if both operands true.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208671"></a>Logical OR</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208673"></a>||</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208675"></a>True if either operand is true.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208677"></a>Conditional selection</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208679"></a><code>(</code><span class="webflare-courier-new" style="white-space:pre"><em>cond</em></span><code>) ? </code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code> : </code><span class="webflare-courier-new" style="white-space:pre"><em>y</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208681"></a>Returns <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> if <span class="webflare-courier-new" style="white-space:pre"><em>cond</em></span> is true, <span class="webflare-courier-new" style="white-space:pre"><em>y</em></span> if not; where <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> and <span class="webflare-courier-new" style="white-space:pre"><em>y</em></span> are expressions.</p>
</td>
</tr>
</tbody></table>
<h4>
<a id="pgfId-186543"></a><a id="17954"></a>Alge<a id="marker-195412"></a><a id="marker-196265"></a>braic and Tri<a id="algebra"></a>gonometric Functions</h4>

<p>
<a id="pgfId-186544"></a>The trigonometric and hyp<a id="marker-195413"></a>erbolic functions expect their operands to be specified in radians. The <code>atan2()</code> and <code>hypot()</code> functions are useful for converting from Cartesian to polar form. </p>

<p>
<a id="pgfId-208685"></a></p>
<table class="webflareTable" id="#id208690">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id208692">
<a id="pgfId-208692"></a>Function</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id208694">
<a id="pgfId-208694"></a>Description</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id208696">
<a id="pgfId-208696"></a>Domain</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208698"></a><code>log(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208700"></a>Natural logarithm</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208702"></a><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> &gt; 0</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208704"></a><code>log10(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208706"></a>Decimal logarithm</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208708"></a><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> &gt; 0</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208710"></a><code>exp(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208712"></a>Exponential</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208714"></a><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> &lt; 80</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208716"></a><code>sqrt(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208718"></a>Square root</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208720"></a><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> &gt; 0</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208722"></a><code>min(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>,</code><span class="webflare-courier-new" style="white-space:pre"><em>y</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208724"></a>Minimum value</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208726"></a>All <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span>, all <span class="webflare-courier-new" style="white-space:pre"><em>y</em></span></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208728"></a><code>max(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>,</code><span class="webflare-courier-new" style="white-space:pre"><em>y</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208730"></a>Maximum value</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208732"></a>All <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span>, all <span class="webflare-courier-new" style="white-space:pre"><em>y</em></span></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208734"></a><code>abs(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208736"></a>Absolute value</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208738"></a>All <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208740"></a><code>pow(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>,</code><span class="webflare-courier-new" style="white-space:pre"><em>y</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208742"></a><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> to the power of <span class="webflare-courier-new" style="white-space:pre"><em>y</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208744"></a>All <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span>, all <span class="webflare-courier-new" style="white-space:pre"><em>y</em></span></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208746"></a><code>sin(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208748"></a>Sine</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208750"></a>All <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208752"></a><code>cos(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208754"></a>Cosine</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208756"></a>All <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208758"></a><code>tan(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208760"></a>Tangent</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208765"></a>All <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span>, except <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> = n*(<img width="12" height="18" src="images/chap5-4.gif" />
/2), where n is odd</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208767"></a><code>asin(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208769"></a>Arc-sine</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208771"></a>-1 &lt;= <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> &lt;= 1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208773"></a><code>acos(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208775"></a>Arc-cosine</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208777"></a>-1 &lt;= <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> &lt;= 1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208779"></a><code>atan(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208781"></a>Arc-tangent</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208783"></a>All <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208785"></a><code>atan2(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>,</code><span class="webflare-courier-new" style="white-space:pre"><em>y</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208787"></a>Arc-tangent of <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span>/<span class="webflare-courier-new" style="white-space:pre"><em>y</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208789"></a>All <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span>, all <span class="webflare-courier-new" style="white-space:pre"><em>y</em></span></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208791"></a><code>hypot(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>,</code><span class="webflare-courier-new" style="white-space:pre"><em>y</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208793"></a><code>sqrt(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>*</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code> + </code><span class="webflare-courier-new" style="white-space:pre"><em>y</em></span><code>*</code><span class="webflare-courier-new" style="white-space:pre"><em>y</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208795"></a>All <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span>, all <span class="webflare-courier-new" style="white-space:pre"><em>y</em></span></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208797"></a><code>sinh(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208799"></a>Hyperbolic sine</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208801"></a>All <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208803"></a><code>cosh(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208805"></a>Hyperbolic cosine</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208807"></a>All <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208809"></a><code>tanh(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208811"></a>Hyperbolic tangent</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208813"></a>All <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208815"></a><code>asinh(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208817"></a>Arc-hyperbolic sine</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208819"></a>All <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208821"></a><code>acosh(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208823"></a>Arc-hyperbolic cosine</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208825"></a><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> &gt;= 1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208827"></a><code>atanh(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208829"></a>Arc-hyperbolic tangent</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208831"></a>-1 &lt;= <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> &lt;= 1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208833"></a><code>int(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208835"></a>Integer part of <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> (number before the decimal)</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208837"></a></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208839"></a><code>ceil(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208841"></a>Smallest integer greater than or equal to <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208843"></a>All <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208845"></a><code>floor(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208847"></a>Largest integer less than or equal to <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208849"></a>All <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208851"></a><code>fmod(</code><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><code>,</code><span class="webflare-courier-new" style="white-space:pre"><em>y</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208853"></a>Floating-point remainder of <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span>/<span class="webflare-courier-new" style="white-space:pre"><em>y</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208855"></a><span class="webflare-courier-new" style="white-space:pre"><em>y</em></span>  0</p>
</td>
</tr>
</tbody></table>
<h4>
<a id="pgfId-186702"></a>Using Expressions in Vectors</h4>

<p>
<a id="pgfId-186703"></a>Expressions can be used as vector elements, as in the following example:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-186704"></a>dc_sweep dc param=p1 values=[0.5 1 +p2 (sqrt(p2*p2)) ]&#160;&#160;// sweep p1 </pre>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-186705"></a>When expressions are used within vectors, anything other than constants, parameters, or unary expressions (unary +, unary -) must be surrounded by parentheses. Vector elements should be space separated. The preceding <code>dc_sweep</code> example shows a vector of four elements: <code>0.5</code>, <code>1</code>, <code>+p2</code>, and <code>sqrt(p2*p2)</code>. Note that the square root expression is surrounded by parentheses. </div>

<h3>
<a id="pgfId-204659"></a><a id="22817"></a>Behavioral Expressions <a id="marker-213044"></a></h3>

<p>
<a id="pgfId-257912"></a>Behavioral source enables you to model a resistor, inductor, capacitor, voltage or current source as a behavioral component. Using bsource, you can express the value of a resistance, capacitance, voltage or current as a combination of device operating points, node voltages, branch currents, and built in Spectre<sup>&#174;</sup> circuit simulator expressions. <code>bsource</code> simulation performance has now been improved by compiling the bsource devices. This is explained in more detail in the bsource compilation section below.</p>
<p>
<a id="pgfId-257913"></a>The syntax for bsource is:</p>

<a id="pgfId-257914"></a><pre class="webflare-courier-new webflare-syx-syntax codeContent">
<code><em>name</em></code> (<code><em>node1</em></code> <code><em>node2</em></code>) bsource <code><em>behav_param</em></code> <code><em>param_list</em></code></pre>

<p>
<a id="pgfId-257915"></a>where <span class="webflare-courier-new" style="white-space:pre"><em>behav_param</em></span> can be </p>

<p>
<a id="pgfId-257962"></a></p>
<table class="webflareTable" id="#id257916">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257918"></a><code>c=</code><span class="webflare-courier-new" style="white-space:pre"><em>simple_expr</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257920"></a>Capacitance between the nodes. </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257922"></a><code>g=</code><span class="webflare-courier-new" style="white-space:pre"><em>simple_expr</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257924"></a>Conductance between the nodes. </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257926"></a><code>i=</code><span class="webflare-courier-new" style="white-space:pre"><em>generic_expr</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257928"></a>Current through bsource. </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257930"></a><code>l=</code><span class="webflare-courier-new" style="white-space:pre"><em>simple_expr</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257932"></a>Inductance between the nodes. </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257934"></a><code>phi=</code><span class="webflare-courier-new" style="white-space:pre"><em>simple_expr</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257936"></a>Flux in the bsource device. </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257938"></a><code>q=</code><span class="webflare-courier-new" style="white-space:pre"><em>simple_expr</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257940"></a>Charge in bsource. </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257942"></a><code>r=</code><span class="webflare-courier-new" style="white-space:pre"><em>simple_expr</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257944"></a>Resistance between the nodes. </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257946"></a><code>v=</code><span class="webflare-courier-new" style="white-space:pre"><em>generic_expr</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257948"></a>Voltage across bsource. </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id257950">
<a id="pgfId-257950"></a><code>simple_expr</code></blockquote>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257952"></a>A Spectre expression containing: </p>

<ul><li>
<a id="pgfId-257953"></a>netlist parameters</li><li>
<a id="pgfId-257954"></a>current simulation time, <code>$time</code></li><li>
<a id="pgfId-261828"></a>current frequency, <code>$freq</code></li><li>
<a id="pgfId-257955"></a>node voltages, <code>v(</code><span class="webflare-courier-new" style="white-space:pre"><em>a</em></span><code>,</code><span class="webflare-courier-new" style="white-space:pre"><em>b</em></span><code>)</code> where <span class="webflare-courier-new" style="white-space:pre"><em>a </em></span>and <span class="webflare-courier-new" style="white-space:pre"><em>b</em></span> are nodes or in the netlist or <code>v(</code><span class="webflare-courier-new" style="white-space:pre"><em>a</em></span><code>)</code> which is the voltage between node <span class="webflare-courier-new" style="white-space:pre"><em>a</em></span> and ground.<br /><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-260814"></a>In case of a bsource resistor, if <span class="webflare-courier-new" style="white-space:pre"><em>simple_expression</em></span> is of the form <code>a/b</code>, where <code>b=0</code>, then bsource clamps the value to <code>a*1e5</code>. For example, the value of <code>Res1</code> will be clamped to <code>1e5</code> in the following expression:</div><pre class="webflare-pre-block webflare-courier-new" id="#id260815">
<a id="pgfId-260815"></a>Res1 (vdd2 0) resistor r=1/v(0);</pre>
<a id="pgfId-260831"></a>The resistor value can be controlled by using the global options <code>rclamp</code> and <code>rcut</code>. Refer to the <em>Spectre Circuit Simulator Reference</em> manual for more information on these options.</li><li>
<a id="pgfId-257956"></a>branch currents, <code>i(</code>&#8220;<span class="webflare-courier-new" style="white-space:pre"><em>inst_id</em></span><code>:</code><span class="webflare-courier-new" style="white-space:pre"><em>index</em></span>&#8220;<code>)</code>, where <span class="webflare-courier-new" style="white-space:pre"><em>inst_id</em></span> is an instance name given in the netlist and <span class="webflare-courier-new" style="white-space:pre"><em>index</em></span> is the port index. The default value for index is <code>0</code>.</li></ul>







<p>
<a id="pgfId-257957"></a>For more information, type <code>spectre -h expressions</code> in a terminal window.</p>

</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id257959">
<a id="pgfId-257959"></a><code>generic_expr</code></blockquote>
</td>
<td class="webflareTd" colspan="1" rowspan="1">

<p>
<a id="pgfId-257961"></a>A simple expression that may contain <span class="webflare-courier-new" style="white-space:pre"><em>idt ()</em></span> or <span class="webflare-courier-new" style="white-space:pre"><em>ddt() </em></span>as well.</p>

</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-257963"></a><code>param_list</code> is <code>param_name=value</code> </p>
<p>
<a id="pgfId-257964"></a><code>param_name</code> can be</p>

<p>
<a id="pgfId-258034"></a></p>
<table class="webflareTable" id="#id257965">
<tbody><tr>
<td class="webflareTd" colspan="2" rowspan="1">
<p>
<a id="pgfId-257967"></a>Multiplicity factor</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257971"></a>m</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257973"></a>The value of m defaults to 1.</p>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-260683"></a>When <code>m</code> is greater than 1, Spectre reports the current as the sum of all <code>m</code> parallel devices for all elements except voltage sources. For voltage sources, Spectre reports the current for <code>m=1</code> only. This is because voltage sources are also used in current-controlled sources and there the requirement is to use the current from <code>m=1</code>. </div>

<p>
<a id="pgfId-260696"></a>Spectre reports the power for all elements as the sum of all <code>m</code> parallel devices.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="2" rowspan="1">
<p>
<a id="pgfId-257975"></a>Temperature Parameters</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257979"></a>tc1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257981"></a>Linear temperature co-efficient. Valid for all behavioural elements.<br />Default value is 0 1/C.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257983"></a>tc2</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257985"></a>Quadratic temperature co-efficient. Valid for all behavioural elements.<br />Default value is 0 C^-2</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-261841"></a>temp</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-261843"></a>Parameter for ambient temperature. Valid for all behavioral elements. Default value is $temperature - 273.15.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257987"></a>tnom</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257989"></a>Parameters measurement temperature. Valid for all behavioural elements.<br />Default value is 0.0.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257991"></a>trise</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257993"></a>Temperature rise for ambient. Valid for all behavioural elements.<br />Default value is 0.0</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-261857"></a>T</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-261871"></a>Effective value of temperature. Valid for all behavioral elements. Default value is <code>temp+trise-tnom</code>.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-261861"></a>tc1c</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-261884"></a>Linear temperature coefficient of capacitor. Valid for resistor type behavioral element. Default value is 0 1/C.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-261865"></a>tc2c</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-261897"></a>Quadratic temperature coefficient of capacitor. Valid for resistor type behavioral element. Default value is 0 C-2.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="2" rowspan="1">
<p>
<a id="pgfId-257995"></a>Clipping Parameters </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257999"></a>max_val</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258001"></a>Maximum value of bsource expression. Valid for all behavioural elements, but generally used with i and v elements for clipping the current or voltage between the specified values.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258003"></a>min_val</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258005"></a>Minimum value of bsource expression. Valid for all behavioural elements, but generally used with i and v elements for clipping the current or voltage between the specified values. </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-261920"></a>bv_max</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-261926"></a>Generate a warning when bsource voltage of two terminals exceeds the value specified by bv_max. Valid for resistor and capacitor.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="2" rowspan="1">
<p>
<a id="pgfId-258007"></a>Noise Parameters </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258011"></a><code>af</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258013"></a>Flicker noise exponent. Valid for <code>r</code> and <code>g</code> elements.<br />Default value is <code>2</code>.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258015"></a>fexp</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258017"></a>Flicker noise frequency exponent. Valid for <code>r</code>, <code>g</code>, <code>v</code>, and <code>i</code> elements.<br />Default value is <code>1</code>.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-261946"></a>ef</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-261948"></a>Alias of <code>fexp</code>.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-261961"></a>ldexp</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-261967"></a>Flicker (1/f) noise L exponent. Valid for r and g elements. Default value is 1.0.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-261980"></a>lf</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-261982"></a>Alias of <code>ldexp</code>.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-261990"></a>wdexp</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-261996"></a>Flicker (1/f) noise W exponent. Valid for r and g elements. Default value is 1.0.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262009"></a>wf</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262011"></a>Alias of <code>wdexp</code>.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258019"></a>isnoisy</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258021"></a>Specifies whether to generate noise. Valid for <code>r</code>, <code>g</code>, <code>i</code>, and <code>v</code> elements.<br />Valid values are <code>yes</code> and <code>no</code>.<br />Default value is <code>yes</code>.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258023"></a><code>kf</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258025"></a>Flicker noise co-efficient. Valid for <code>r</code> and <code>g</code> elements.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258027"></a>white_noise</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258029"></a>White noise expression. Valid for <code>v</code> and <code>i</code> elements.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258031"></a><code>flicker_noise</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258033"></a>Flicker noise expression. Valid for <code>v</code> and <code>i</code> elements.</p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-258035"></a>where</p>

<p>
<a id="pgfId-258057"></a></p>
<table class="webflareTable" id="#id258036">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id258038">
<a id="pgfId-258038"></a>Element</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id258040">
<a id="pgfId-258040"></a>is a bsource with</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258042"></a><code>r</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258044"></a>resistance specified.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258046"></a><code>g</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258048"></a>conductance specified.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258050"></a><code>v</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258052"></a>voltage specified.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258054"></a><code>i</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-258056"></a>current specified.</p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-258058"></a>All the parameters in the <code>param_name</code> table are instance parameters. <span class="webflare-courier-new" style="white-space:pre"><em>white_noise</em></span> and <span class="webflare-courier-new" style="white-space:pre"><em>flicker_noise</em></span> may be assigned behavioural expressions; the other parameters must be assigned constant or parametric expressions. </p>
<p>
<a id="pgfId-258241"></a>A bsource can also be declared as an instance of a model of a resistor, inductor, or capacitor. However, the behavioral expression can only be present on the instance of the model and not on the model itself.</p>
<p>
<a id="pgfId-258245"></a>Example:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-258248"></a>simulator lang=spectre<br />vsrc s 0 vsource type=sine ampl=500.0 freq=100k  <br />// declare a model of a resistor<br />model model_res resistor tc1=0.01 tc2=0.003<br />// declare an instance of the above model with a behavioral expression assigned to //the r parameter<br />res1 s 0 model_res r=100*(1+(1/2)*v(s,0)+(1/3)*pow(v(s,0),2)) tc1=0.01<br />tran1 tran stop=50u </pre>

<p>
<a id="pgfId-265419"></a>A bsource can also refer to the current of another instance. For example:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-265502"></a>Ibsrc2 (0 net01) bsource i=i(&quot;Imon:1&quot;)</pre>

<p>
<a id="pgfId-265520"></a>In such cases, the instances are searched as follows:</p>
<ul><li>
<a id="pgfId-265576"></a>If the name of the referenced instance starts with a dot (.), the tool searches for the instance at the top level and generates an error if the instance is not found. For example:<br /><pre class="webflare-pre-block webflare-courier-new" id="#id265837">
<a id="pgfId-265837"></a>Ibsrc2 (0 out) bsource i=i(&quot;.Imon:1&quot;).</pre></li><li>
<a id="pgfId-265739"></a>If the name of the referenced instance contains a dot (.), the tool first searches for the instance at the top level. If the instance is not found at the top level, it searches for the instance at the local level. For example:<br /><pre class="webflare-pre-block webflare-courier-new" id="#id266017">
<a id="pgfId-266017"></a>Ibsrc2 (0 out) bsource i=i(&quot;Iinst.Imon:1&quot;)</pre></li><li>
<a id="pgfId-266032"></a>For any other scenario, the tool first searches for the referenced instance at the local level and then the top level.</li></ul>




<p>
<a id="pgfId-266157"></a>Here is an example:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-266185"></a>subckt INVD0BWP I ZN VDD VSS</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-266186"></a>    M1 (ZN I VSS VSS) nch_mac l=40n w=155.00n multi=1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-266187"></a>    M0 (ZN I VDD VDD) pch_mac l=40n w=205.00n multi=1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-266188"></a>ends INVD0BWP</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-266189"></a>// End of subcircuit definition.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-266190"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-266191"></a>subckt sim_bsource_inst out</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-266192"></a>    Ibsrc2 (0 out) bsource i=i(&quot;.Imon:1&quot;)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-266193"></a>    V4 (net2 0) vsource dc=1.1 type=dc</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-266194"></a>    Ibsrc3 (0 out) bsource i=i(&quot;Imon:1&quot;)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-266195"></a>    Ibsrc4 (0 out) bsource i=i(&quot;Imon.M1:1&quot;)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-266196"></a>    Imon (0 net010 DVDD1P1 DGND) INVD0BWP</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-266197"></a>ends sim_bsource_inst</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-266198"></a>// End of subcircuit definition.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-266199"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-266200"></a>// Library name: zz_sadayoshi_ban</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-266201"></a>// Cell name: sim_bsource</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-266202"></a>// View name: schematic_case3</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-266203"></a>Imon (0 net010 DVDD1P1 DGND) INVD0BWP</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-266181"></a>Iinst (net02) sim_bsource_inst</pre>

<p>
<a id="pgfId-266218"></a>In the above example:</p>
<p>
<a id="pgfId-266245"></a><code>Iinst.Ibsrc2</code> reference will find <code>Imon.</code></p>
<p>
<a id="pgfId-266246"></a><code>Iinst.Ibsrc3</code> reference will find <code>Iinst.Imon.</code></p>
<p>
<a id="pgfId-266241"></a><code>Iinst.Ibsrc4</code> reference will find <code>Imon.M1.</code></p>
<p>
<a id="pgfId-258278"></a>Altergroup is not supported for models that have behavioral instances.</p>

<h4>
<a id="pgfId-258062"></a><a id="marker-258060"></a>Parameters Supported</h4>

<p>
<a id="pgfId-258380"></a>A model that is to be instantiated as a behavioral resistor, capacitor or inductor, can only have those parameters that are already supported for these behavioral primitives. The list of supported parameters is given below. Some of these parameters may only be allowed on instances. For those parameters that are valid on both the instance and model levels, the instance parameter is given priority if it is specified on both the model and the instance of the model.</p>

<h4><em>
<a id="pgfId-258064"></a>Resistor</em></h4>

<p>
<a id="pgfId-258065"></a>bsource supports <code>isnoisy</code>, <code>m</code>, <code>r</code>, <code>tc1</code>, <code>tc2</code>, <code>trise,</code> <code>kf, af, fexp,</code> <code>ldexp,</code> <code>wdexp, l, w, mr, tc1c, tc2c.</code></p>
<p>
<a id="pgfId-261283"></a>The resistor type bsource model has two capacitors between each ports with ground. The parameter <code>tc1c</code> is the first-order temperature parameter of that capacitor, and <code>tc2c</code> is the second-order temperature parameter.</p>
<p>
<a id="pgfId-261284"></a>The final capacitor value is <code>C = C0*(1+tc1c*T+tc2c*T*T)</code>, where T is the temperature,&#160;&#160;C<sub>0</sub> is capacitor when T is 0.</p>

<h4><em>
<a id="pgfId-258067"></a>Capacitor</em></h4>

<p>
<a id="pgfId-258068"></a>bsource supports <code>c</code>, <code>m</code>, <code>tc1</code>, <code>tc2</code>, ic, <code>trise</code>, and <code>ctype</code>.</p>

<h4><em>
<a id="pgfId-258070"></a>Inductor</em></h4>

<p>
<a id="pgfId-261479"></a>bsource supports <code>l</code>, <code>m</code>, tc1, tc2, and <code>trise</code>.</p>

<h4>
<a id="pgfId-261481"></a>Examples of bsource<a id="marker-261480"></a></h4>
<h4><em>
<a id="pgfId-261482"></a>Nonlinear Resistor/Capacitor/Inductor Instance</em></h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258098"></a>res&#160;&#160;(n1 n2)&#160;&#160;bsource r=100*(1+(1/2)*v(n1,n2))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258099"></a>cond (n1 n2)&#160;&#160;bsource g=0.01*(1+(1/2)*v(n1,n2))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258100"></a>cap&#160;&#160;(n1 n2)&#160;&#160;bsource c=1.0e-6*(1+(1/2)*v(n1,n2))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258101"></a>ind&#160;&#160;(n1 n2)&#160;&#160;bsource l=0.1*(1+(1/2)*v(n1,n2))</pre>
<h4><em>
<a id="pgfId-258102"></a>Charge Model for Capacitor</em></h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258103"></a>cap&#160;&#160;(n1 n2) bsource q=1.0e-6*v(n1,n2)</pre>
<h4><em>
<a id="pgfId-258104"></a>Magnetic Flux Model for Inductor</em></h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258105"></a>ind&#160;&#160;(n1 n2) bsource phi=0.1*i(n1,n2)</pre>
<h4><em>
<a id="pgfId-258106"></a>Voltage and Current (Sinewave) Source </em></h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258107"></a>vsrc (n1 n2) bsource v=10.0*sin(2*pi*freq*$time)</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258108"></a>isrc (n1 n2) bsource i=1.0e-3*sin(2*pi*freq*$time)</pre>
<h4><em>
<a id="pgfId-258109"></a>Current Controlled Current Sources</em></h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258110"></a>vsrc (n1 n2) vsource v=10</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258111"></a>cccs1 (n3 n4) bsource i=gain*i(&quot;vsrc:0&quot;)</pre>
<h4><em>
<a id="pgfId-258112"></a>Current Controlled Voltage Sources</em></h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258113"></a>vsrc (n1 n2) vsource v=10</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258114"></a>ccvs1 (n3 n4) bsource v=100*i(&quot;vsrc:0&quot;)</pre>
<h4><em>
<a id="pgfId-258115"></a>Voltage Controlled Voltage Source</em></h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258116"></a>vsrc (n1 n2) resistor r=100k</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258117"></a>vcvs1 (n3 n4) bsource v=gain*v(n1,n2)</pre>
<h4><em>
<a id="pgfId-258118"></a>Voltage Controlled Current Source </em></h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258119"></a>vsrc (n1 n2) resistor r=100k</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258120"></a>vcvs1 (n3 n4) bsource i=v(n1,n2)/2000.0</pre>
<h4><em>
<a id="pgfId-258121"></a>Giving Maximum and Minimum Range for an Expression</em></h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258122"></a>res (n1 n2) bsource r=100*(1+(1/2)*v(n1,n2)) max_val=105 min_val=95</pre>
<h4><em>
<a id="pgfId-258123"></a>Giving Temperature Co-efficient for Resistor</em></h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258124"></a>res (n1 n2) bsource r=100&#160;&#160;tc1=0.01 tc2=0.003 trise=10 tnom=30</pre>
<h4><em>
<a id="pgfId-258125"></a>Giving Flicker Noise Co-efficient for Resistor</em></h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258126"></a>res (n1 n2) bsource r=100 kf=1 af=1 fexp=1</pre>
<h4><em>
<a id="pgfId-258127"></a>Doing Altergroup with Bsource </em></h4>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258128"></a>vsrc1 (n1 n2) bsource v=10*sin(2*pi*freq1*$time)<br />vsrc2 (n3 n4) bsource v=10*cos(2*pi*freq2*$time)<br />cccs1 (n5 n6) bsource i=gain*i(&quot;vsrc1:0&quot;)<br />res&#160;&#160; (n5 n6) bsource r=100*(1+(1/2)*v(n5,n6))</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258129"></a>tran1 tran stop=1u</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258130"></a>altAnal altergroup {<br />cccs1 (n5 n6) bsource i=gain*i(&quot;vsrc2:0&quot;)<br />res   (n5 n6) bsource r=100*(1+(1/3)*pow(v(n5,n6),2))<br />}</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-258131"></a>tran2 tran stop=1u</pre>
<h4>
<a id="pgfId-258132"></a>bsource Compilation</h4>

<p>
<a id="pgfId-260981"></a>Spectre automatically translates bsource components into verilogA models for simulation. As such, they are compiled prior to simulation just like any other verilogA model.</p>

<h3>
<a id="pgfId-260993"></a>Built-in Co<a id="buconstants"></a>nsta<a id="marker-260990"></a>nts</h3>

<p>
<a id="pgfId-186745"></a>You can use built-in constants to specify parameter values.</p>
<p>
<a id="pgfId-186747"></a>The Spectre Netlist Language contains the built-in mathematical and physical constants listed in the following table. Mathematical constants start with <code>M_</code>, and physical constants start with <code>P_</code>.</p>

<p>
<a id="pgfId-208862"></a></p>
<table class="webflareTable" id="#id208874">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id208876">
<a id="pgfId-208876"></a>Constant Name</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id208878">
<a id="pgfId-208878"></a>Value</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id208880">
<a id="pgfId-208880"></a>Description</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208882"></a><code>M_E</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208884"></a>2.7182818284590452354</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208886"></a>e or escp(1)</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208888"></a><code>M_LOG2E</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208890"></a>1.4426950408889634074</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208892"></a>log2(e)</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208894"></a><code>M_LOG10E</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208896"></a>0.43429448190325182765</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208898"></a>log10(e)</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208900"></a><code>M_LN2</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208902"></a>0.69314718055994530942</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208904"></a>ln(2)</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208906"></a><code>M_LN10</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208908"></a>2.30258509299404568402</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208910"></a>ln(10)</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208912"></a><code>M_PI</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208914"></a>3.14159265358979323846</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208916"></a></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208918"></a><code>M_TWO_PI</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208920"></a>6.28318530717958647652</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208922"></a>2</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208924"></a><code>M_PI_2</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208926"></a>1.57079632679489661923</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208928"></a>/2</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208930"></a><code>M_PI_4</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208932"></a>0.78539816339744830962</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208934"></a>/4</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208936"></a><code>M_1_PI</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208938"></a>0.31830988618379067154</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208940"></a>1/</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208942"></a><code>M_2_PI</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208944"></a>0.63661977236758134308</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208946"></a>2/</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208948"></a><code>M_2_SQRTPI</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208950"></a>1.12837916709551257390</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208952"></a>2/</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208954"></a><code>M_SQRT2</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208956"></a>1.41421356237309504880</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208961"></a><img width="21" height="21" src="images/chap5-5.gif" /></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208963"></a><code>M_SQRT1_2</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208965"></a>0.70710678118654752440</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208970"></a><img width="37" height="21" src="images/chap5-6.gif" /></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208972"></a><code>M_DEGPERRAD</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208974"></a>57.2957795130823208772</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208976"></a>Number of degrees per radian (equal to 180/)</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208978"></a><code>P_Q</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208980"></a>1.6021918x10<sup>-19</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208982"></a>Charge of electron in coulombs</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208984"></a><code>P_C</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208986"></a>2.997924562x10<sup>8</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208988"></a>Speed of light in vacuum in meters/second</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208990"></a><code>P_K</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208992"></a>1.3806226x10<sup>-23</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208994"></a>Boltzman&#8217;s constant in joules/Kelvin</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208996"></a><code>P_H</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-208998"></a>6.6260755x10<sup>-34</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-209000"></a>Planck&#8217;s constant in joules times seconds</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-209002"></a><code>P_EPS0</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-209004"></a>8.85418792394420013968x10<sup>-12</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-209006"></a>Permittivity of vacuum in farads/meter</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-209008"></a><code>P_U0</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-209013"></a><code><img width="12" height="18" src="images/chap5-7.gif" /><br /></code>x(4.0x10<sup>-7</sup>)</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-209015"></a>Permeability of vacuum in henrys/meter</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-209017"></a><code>P_CELSIUS0</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-209019"></a>273.15</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-209021"></a>Zero Celsius in Kelvin</p>
</td>
</tr>
</tbody></table>
<h3>
<a id="pgfId-199347"></a>User-Defi<a id="marker-199344"></a>ned Functions</h3>

<p>
<a id="pgfId-199348"></a>The user-defined function capability allows you to build upon the provided set of built-in mathematical and trigonometric functions. You can write your own functions and call these functions from within any expression. The Spectre function syntax resembles that of C. </p>

<h4>
<a id="pgfId-186917"></a>Defining the Function </h4>

<p>
<a id="pgfId-186918"></a>The following is a simple example of defining a function with arguments of type real and results of type real:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-186919"></a>real myfunc( real a, real b ) {
&#160;&#160;&#160;&#160;return a+b*2+sqrt(a*sin(b));<br />}</pre>

<p>
<a id="pgfId-186920"></a>When you define a function, follow these rules:</p>
<ul><li>
<a id="pgfId-186921"></a>Functions can be declared only at the top level and cannot be declared within subcircuits. </li><li>
<a id="pgfId-186922"></a>Arguments to user-defined functions can only be real values, and the functions can only return real values. You must use the keyword <code>real</code> for data typing.</li><li>
<a id="pgfId-186923"></a>The Spectre function syntax does not allow references to netlist parameters within the body of the function, unless the netlist parameter is passed in as a function argument.</li><li>
<a id="pgfId-186924"></a>The function must contain a single <code>return</code> statement. </li></ul>



<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-195378"></a>If you create a user-defined function with the same name as a built-in function, the Spectre simulator issues a warning and runs the user-defined function.</div>

<h4>
<a id="pgfId-186925"></a>Calling the Function</h4>

<p>
<a id="pgfId-186926"></a>Functions can be called from anywhere that an expression can currently be used in the Spectre simulator. Functions can call other functions; however, the function must be declared <em>before</em> it can be called. The following example defines the function <code>myfunc</code> and then calls it:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-186927"></a>real myfunc( real a, real b ) {
&#160;&#160;&#160;&#160;return a+b*2+sqrt(a*sin(b));<br />}</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-186928"></a></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-186929"></a>real yourfunc( real a, real b ) {
&#160;&#160;&#160;&#160;return a+b*myfunc(a,b);&#160;&#160;&#160;&#160;// call &quot;myfunc&quot;<br />}</pre>

<p>
<a id="pgfId-186930"></a>The next example shows how a user-defined function can be called from an expression in the Spectre netlist:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-186931"></a>r1 (1 0) resistor r=myfunc(2.0, 4.5)</pre>
<h3>
<a id="pgfId-186943"></a>Predef<a id="marker-186942"></a>ined Netlist Parameters</h3>

<p>
<a id="pgfId-186948"></a>There are two predefined netlist parameters:</p>
<ul><li>
<a id="pgfId-186950"></a><code>temp</code> is the circuit temperature (in degrees Celsius) and can be used in expressions.<a id="marker-186949"></a></li><li>
<a id="pgfId-186952"></a><code>tnom</code><a id="marker-186951"></a> is the <em>measurement</em> (<em>nominal</em>) temperature (in degrees Celsius) and can be used in expressions.</li></ul>

<p>
<a id="pgfId-186953"></a>For example:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-186954"></a>r1 1 0 res r=(temp-tnom)*15+10k</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-186955"></a>o1 options TEMP=55</pre>

<p>
<a id="pgfId-186956"></a>For behavioral expressions, the values of temp and tnom are specified by the Spectre circuit simulator rather than being passed by the netlist.</p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-257022"></a>If you change <code>temp</code> or <code>tnom</code> using a <code>set</code> statement, <code>alter</code> statement, or simulator options card, all expressions with <code>temp</code> or <code>tnom</code> are reevaluated. Hence, you can use the <code>temp</code> parameter for temperature-dependent modeling (this does not include self-heating, however).</div>

<h2>
<a id="pgfId-187149"></a>Subcircuits<a id="41460"></a><a id="subcircuits"></a><a id="definesub"></a><a id="marker-187148"></a></h2>

<p>
<a id="pgfId-187150"></a>The Spectre simulator helps you simplify netlists by letting you define subcircuits that you can place any number of times in the circuit. You can nest subcircuits, and a subcircuit definition can contain both instances and definitions of other subcircuits. The main applications of subcircuits are to describe the circuit hierarchy and to perform parameterized modeling. In this section, you learn to define subcircuits and to call them into the main circuit.</p>

<h3>
<a id="pgfId-187152"></a>Formatting Subcircuit Definitions<a id="marker-187151"></a></h3>

<p>
<a id="pgfId-197820"></a>You format subcircuit definitions as follows:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-197821"></a>subckt <code><em>SubcircuitName</em></code> [(] <code><em>node1</em></code> ... <code><em>nodeN</em></code> [)]</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-197822"></a> [ <code><em>parameters</em></code> <code><em>name1</em></code>=<code><em>value1</em></code> ... [<code><em>nameN</em></code>=<code><em>valueN</em></code>]]
&#160;&#160;&#160;&#160;.
&#160;&#160;&#160;&#160;.
&#160;&#160;&#160;&#160;.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-187156"></a> <code><em>instance, model, ic, or nodeset statements&#8212;or
&#160;&#160;&#160;&#160; further subcircuit definitions<br /></em></code> .<br /> .<br /> .</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-187157"></a>ends [<code><em>SubcircuitName</em></code>]</pre>
<table class="webflareTable" id="#id262032">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262034"></a><code>subckt</code> </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262036"></a>The keyword <code>subckt</code> (<code>.subckt</code> is used in SPICE mode).</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262038"></a><span class="webflare-courier-new" style="white-space:pre"><em>SubcircuitName</em></span> </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262040"></a>The unique name you give to the subcircuit. Note: The subcircuit name cannot start with a number. For example, if you specify <code>100_sub1</code> as the subcircuit name, the simulator will issue a warning message.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262042"></a><code>(</code><span class="webflare-courier-new" style="white-space:pre"><em>node1</em></span><code>&#8230;</code><span class="webflare-courier-new" style="white-space:pre"><em>nodeN</em></span><code>)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262044"></a>The external or connecting nodes of the subcircuit to the main circuit.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262046"></a><code>parameters </code><span class="webflare-courier-new" style="white-space:pre"><em>name1</em></span><code>=</code><span class="webflare-courier-new" style="white-space:pre"><em>value1</em></span><code>&#8230;</code><span class="webflare-courier-new" style="white-space:pre"><em>nameN</em></span><code>=</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262048"></a>This is an optional parameter specification field. You can specify default values for subcircuit calls that refer to this subcircuit. The field contains the keyword <code>parameters</code> followed by the names and values of the parameters you want to specify.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262050"></a><span class="webflare-courier-new" style="white-space:pre"><em>component instance statement</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262052"></a>The instance statements of your subcircuit, other subcircuit definitions, component statements, analysis statements, or <code>model</code> statements.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262054"></a><code>ends </code><span class="webflare-courier-new" style="white-space:pre"><em>SubcircuitName</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262056"></a><code> </code>The keyword <code>ends</code> (or <code>.ends</code> in SPICE mode), optionally followed by the subcircuit name.</p>
</td>
</tr>
</tbody></table>
<h3>
<a id="pgfId-187183"></a>A Subcircuit Definition Exa<a id="marker-187182"></a>mple</h3>

<p>
<a id="pgfId-187184"></a>The following subcircuit named <code>twisted</code> models a twisted pair. It has four terminals&#8212;<code>p1</code>, <code>n1</code>, <code>p2</code>, and <code>n2</code>. The parameter specification field for the subcircuit sets subcircuit call default values for parameters <code>zodd</code>, <code>zeven</code>, <code>veven</code>, <code>vodd</code>, and <code>len</code>. Remember that the specified parameters are defaults for subcircuit calls, not for the instance statements in the subcircuit. For example, if the subcircuit call leaves the <code>zodd</code> parameter unspecified, the value of <code>zodd</code> in <code>odd</code> is 50. If, however, the subcircuit call sets <code>zodd</code> to 100, the value of <code>zodd</code> in <code>odd</code> is 100.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-187185"></a>subckt twisted (p1 n1 p2 n2)
 &#160;&#160;&#160;&#160;parameters zodd=50 zeven=50 veven=1 vodd=1 len=0
 &#160;&#160;&#160;&#160;odd (p1 n1 p2 n2) tline z0=zodd vel=vodd len=len
 &#160;&#160;&#160;&#160;tf1a (p1 0 e1 c1) transformer t1=2 t2=1
 &#160;&#160;&#160;&#160;tf1b (n1 0 c1 0) transformer t1=2 t2=1
 &#160;&#160;&#160;&#160;even (e1 0 e2 0) tline z0=zeven vel=veven len=len
 &#160;&#160;&#160;&#160;tf2a (p2 0 e2 c2) transformer t1=2 t2=1
 &#160;&#160;&#160;&#160;tf2b (n2 0 c2 0) transformer t1=2 t2=1<br />ends twisted </pre>

<p>
<a id="pgfId-190796"></a>Indenting the contents of a subcircuit definition is not required. However, it is recommended to make the subcircuit definition more easily identifiable.</p>

<h3>
<a id="pgfId-187187"></a>Subcircuit Example<a id="marker-187186"></a></h3>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-187191"></a>GaAs Traveling Wave Amplifier<br />// GaAs Traveling-wave distributed amplifier (2-26.5GHz)<br />// Designed by Jerry Orr, MWTD Hewlett-Packard Co.<br />// 1986 MTT symposium; unpublished material.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-187192"></a>global gnd vdd<br />simulator lang=spectre</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-187193"></a>// Models<br />model nGaAs gaas type=n vto=-2 beta=0.012 cgs=.148p cgd=.016p fc=0.5</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-187194"></a>subckt cell (o g1 g2)
&#160;&#160;&#160;&#160;TL   (o    gnd  d    gnd)  tline len=355u vel=0.36
&#160;&#160;&#160;&#160;Gt   (d    g2   s)         nGaAs
&#160;&#160;&#160;&#160;Ctgd (d    s)              capacitor c=0.033p
&#160;&#160;&#160;&#160;Cgg  (g2   gnd)            capacitor c=3p
&#160;&#160;&#160;&#160;Gb   (s    g1   gnd)       nGaAs
&#160;&#160;&#160;&#160;Cbgd (s    gnd)            capacitor c=0.033p
&#160;&#160;&#160;&#160;Ro   (d    c)              resistor r=4k
&#160;&#160;&#160;&#160;Co   (c    gnd)            capacitor c=0.165p<br />ends cell</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-187195"></a>subckt stage (i0 o8)
&#160;&#160;&#160;&#160;// Devices
&#160;&#160;&#160;&#160;Q1      (o1      i1      b2)      cell
&#160;&#160;&#160;&#160;Q2      (o2      i2      b2)      cell
&#160;&#160;&#160;&#160;Q3      (o3      i3      b2)      cell
&#160;&#160;&#160;&#160;Q4      (o4      i4      b2)      cell
&#160;&#160;&#160;&#160;Q5      (o5      i5      b2)      cell
&#160;&#160;&#160;&#160;Q6      (o6      i6      b2)      cell
&#160;&#160;&#160;&#160;Q7      (o7      i7      b2)      cell<br /></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-190804"></a>// Transmission lines
&#160;&#160;&#160;&#160;TLi1   (i0    gnd     i1    gnd)    tline   len=185u  z0=96  vel=0.36
&#160;&#160;&#160;&#160;TLi2   (i1    gnd     i2    gnd)    tline   len=675u  z0=96  vel=0.36
&#160;&#160;&#160;&#160;TLi3   (i2    gnd     i3    gnd)    tline   len=675u  z0=96  vel=0.36
&#160;&#160;&#160;&#160;TLi4   (i3    gnd     i4    gnd)    tline   len=675u  z0=96  vel=0.36
&#160;&#160;&#160;&#160;TLi5   (i4    gnd     i5    gnd)    tline   len=675u  z0=96  vel=0.36
&#160;&#160;&#160;&#160;TLi6   (i5    gnd     i6    gnd)    tline   len=675u  z0=96  vel=0.36
&#160;&#160;&#160;&#160;TLi7   (i6    gnd     i7    gnd)    tline   len=675u  z0=96  vel=0.36
&#160;&#160;&#160;&#160;TLi8   (i7    gnd     i8    gnd)    tline   len=340u  z0=96  vel=0.36
&#160;&#160;&#160;&#160;TLo1   (o0    gnd     o1    gnd)    tline   len=360u  z0=96  vel=0.36
&#160;&#160;&#160;&#160;TLo2   (o1    gnd     o2    gnd)    tline   len=750u  z0=96  vel=0.36
&#160;&#160;&#160;&#160;TLo3   (o2    gnd     o3    gnd)    tline   len=750u  z0=96  vel=0.36
&#160;&#160;&#160;&#160;TLo4   (o3    gnd     o4    gnd)    tline   len=750u  z0=96  vel=0.36
&#160;&#160;&#160;&#160;TLo5   (o4    gnd     o5    gnd)    tline   len=750u  z0=96  vel=0.36
&#160;&#160;&#160;&#160;TLo6   (o5    gnd     o6    gnd)    tline   len=750u  z0=96  vel=0.36
&#160;&#160;&#160;&#160;TLo7   (o6    gnd     o7    gnd)    tline   len=750u  z0=96  vel=0.36
&#160;&#160;&#160;&#160;TLo8   (o7    gnd     o8    gnd)    tline   len=220u  z0=96  vel=0.36<br /></pre>

<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-187197"></a>// Bias network<br />// drain bias<br />Ldd     (vdd     o0)      inductor        l=1u<br />R1      (o0      b1)      resistor        r=50<br />C1      (b1      gnd)     capacitor       c=9p<br />// gate 2 bias<br />R2      (b1      b2)      resistor        r=775<br />R3      (b2      gnd)     resistor        r=465<br />C2      (b2      gnd)     capacitor       c=21p<br />// gate 1 bias<br />R4      (i8      b3)      resistor        r=50<br />R5      (b3      gnd)     resistor        r=500<br />C3      (b3      gnd)     capacitor       c=12p<br /></pre>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-187200"></a>ends stage</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-187201"></a>// Two stage amplifier<br />P1      (in      gnd)     port      r=50    num=1   mag=0<br />Cin     (in      in1)     capacitor         c=1n<br />X1      (in1     out1)    stage<br />Cmid    (out1    in2)     capacitor         c=1n<br />X2      (in2     out2)    stage<br />Cout    (out2    out)     capacitor         c=1n<br />P2      (out     gn)      port      r=50    num=2<br /></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-187202"></a>// Power Supply <br />Vpos vdd gnd vsource dc=5</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-187203"></a>// Analyses<br />OpPoint dc<br />Sparams sp start=100M stop=100G dec=100</pre>
<h3>
<a id="pgfId-187204"></a>Rules to Remember</h3>

<p>
<a id="pgfId-187205"></a>When you use subcircuits, </p>
<ul><li>
<a id="pgfId-187206"></a>You must place the same number of nodes in the same order in subcircuit definitions and their respective subcircuit calls.</li><li>
<a id="pgfId-187211"></a>Models and subcircuits defined within a subcircuit definition are accessible only from within that subcircuit. You cannot use the model names in a subcircuit definition in statements from outside the subcircuit. You can, however, use both the model name and the subcircuit definitions in new subcircuits within the original subcircuit. Local models or subcircuits hide nodes or subcircuits with the same names defined outside the subcircuit.</li><li>
<a id="pgfId-187213"></a>When you use model statements within subcircuit definitions, where model parameters are expre<a id="marker-192017"></a>ssions of subcircuit parameters definitions, a new model is created for every instance of the subcircuit. These different models are &#8220;expanded models,&#8221; which are derived from the original <code>model</code> statement. Each of the new models has a unique name, and component instances created from the original <code>model</code> statement are instances of the new model created for the subcircuit. The full name of each new model is the flattened name of the subcircuit, followed by a dot (<code>.</code>), followed by the name of the model as given in the <code>model</code> statement. If you request the output of model data, you can see these expanded models in the output.</li><li>
<a id="pgfId-187214"></a>Subcircuit parameter names are local only. You cannot access the value of a subcircuit parameter outside of the scope of the subcircuit in which it was declared.</li><li>
<a id="pgfId-187215"></a>Parameter names must be lowercase if you want to instantiate components from SPICE mode.</li></ul>





<h3>
<a id="pgfId-187217"></a>Calling Subcircuits<a id="marker-187216"></a></h3>

<p>
<a id="pgfId-187218"></a>To call a subcircuit, place an instance statement in your netlist. The nodes for this instance statement are the connections to the subcircuit, and the master field in the subcircuit call contains the name of the subcircuit. You can enter parameters in a subcircuit call to override the parameters in the subcircuit definition for that subcircuit call. </p>
<p>
<a id="pgfId-187219"></a>The following example shows a subcircuit call and its corresponding subcircuit definition. <code>cell</code> is the name of the subcircuit being called; <code>Q1</code> is the unique name of the subcircuit call; and <code>o1</code>, <code>i1</code>, and <code>b2</code> are the connecting nodes to the subcircuit from the subcircuit call. When you call the subcircuit, the Spectre simulator substitutes these connecting node names in the subcircuit call for the connecting nodes in the subcircuit definition: <code>o1</code> is substituted for <code>o</code>, <code>i1</code> is substituted for <code>g1</code>, and <code>b2</code> is substituted for <code>g2</code>. The length of transmission line <code>TL</code> is changed to 500 m for this subcircuit call from its 355 m default value in the subcircuit definition.</p>

<p>
<a id="pgfId-209025"></a></p>
<div class="webflare-div-image">
<img width="675" height="80" src="images/chap5-8.gif" /></div>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-187239"></a> parameters length=355um</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-187240"></a> TL   o    gnd  d    gnd  tline len=length vel=0.36<br /> Gt   d    g2   s         nGaAs<br /> Ctgd d    s              capacitor c=0.033p<br /> Cgg  g2   gnd            capacitor c=3p<br /> Gb   s    g1   gnd       nGaAs<br /> Cbgd s    gnd            capacitor c=0.033p<br /> Ro   d    c              resistor r=10k<br /> Co&#160;&#160; c&#160;&#160;  gnd            capacitor c=0.165p</pre>
<pr-prog id="#id187241">
<a id="pgfId-187241"></a>ends cell</pr-prog>
<h3>
<a id="pgfId-187243"></a><a id="32920"></a>Modifying Subcircuit Parameter Values</h3>

<p>
<a id="pgfId-187244"></a>The following example is a passive Bessel three-pole bandpass filter with default parameter values for bandwidth, termination resistance, and center frequency. The <code>bw</code>, <code>r0</code>, and <code>fc</code> parameters are given default values in the subcircuit, but you can change these values when you call the subcircuit. Changing the value of <code>bw</code>, <code>r0</code>, and <code>fc</code> in a subcircuit call changes the values of many parameters in instance statements that refer to these three parameters.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-187251"></a>// define passive 3-pole bandpass filter</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-187252"></a>subckt filter (n1 n2)     
&#160;&#160;&#160;&#160;parameters bw=1 r0=1 fc=1     
&#160;&#160;&#160;&#160;C1  (n1  0)   capacitor c=0.3374 / (6.2832 * bw * r0)     
&#160;&#160;&#160;&#160;L1  (n1  0)   inductor l=(r0 * bw) / (0.3374 * 6.2832 * fc * fc)
&#160;&#160;&#160;&#160;C2  (n1  n12) capacitor c=bw / (0.9705 * 6.2832 * fc * fc * r0)<br /></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-187253"></a> L2  (n12 n2)  inductor l=(r0 * 0.9705) / (6.2832 * bw)     <br /> C3  (n2  0)   capacitor c=2.2034 / (6.2832 * bw * r0) <br /> L3  (n2  0)   inductor l=(r0 * bw)/(2.2034 * 6.2832 * fc * fc) <br />ends filter</pre>
<div class="webflare-div-image">
<img width="668" height="106" src="images/chap5-9.gif" /></div>

<p>
<a id="pgfId-187265"></a>You can use such parameterized subcircuits when the Spectre simulator is reading either Spectre or SPICE syntax. Unlike subcircuit calls in SPICE, the names of Spectre subcircuit calls do not have to start with an <code>x</code>. This is useful if you want to replace individual components in an existing netlist with subcircuits for more detailed modeling.</p>

<h3>
<a id="pgfId-187283"></a><a id="10416"></a>Checking for In<a id="marker-261581"></a>valid Parameter Values</h3>

<p>
<a id="pgfId-187286"></a>When you define subcircuits such as the one in <a href="chap5.html#32920">Modifying Subcircuit Parameter Values</a>, you might want to put error checking on the subcircuit parameter values. Such error checking prevents you from entering invalid parameter values for a given subcircuit call. </p>
<p>
<a id="pgfId-259443"></a>The Spectre <code>paramtest</code> component lets you test parameter values and generate necessary error, warning, and informational messages. For example, in the example of the bandpass filter in <a href="chap5.html#32920">Modifying Subcircuit Parameter Values</a>, the center frequency needs to be greater than half the bandwidth. </p>
<p>
<a id="pgfId-259449"></a>Here is a version of the previous three-pole filter that issues an error message if the center frequency is less than or equal to half the bandwidth:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-187296"></a>* define passive 3-pole bandpass filter 
subckt filter (n1 n2)     
&#160;&#160;&#160;&#160;parameters bw=1 r0=1 fc=1 </pre>
<p>
<a id="pgfId-204028"></a></p>
<div class="webflare-div-image">
<img width="667" height="38" src="images/chap5-10.gif" /></div>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-204029"></a>  message=&quot;center frequency must be greater than half the<br />   bandwidth&quot;     <br /> C1  n1  0   capacitor c=0.3374 / (6.2832 * bw * r0)     <br /> L1  n1  0   inductor l=(r0 * bw) / (0.3374 * 6.2832 * fc * fc)     <br /> C2  n1  n12 capacitor   c=bw / (0.9705 * 6.2832 * fc * fc * r0) <br /> L2  n12 n2  inductor l=(r0 * 0.9705) / (6.2832 * bw)     <br /> C3  n2  0   capacitor c=2.2034 / (6.2832 * bw * r0)     <br /> L3  n2  0   inductor l=(r0 * bw) / (2.2034 * 6.2832 * fc * fc) <br />ends filter</pre>

<p>
<a id="pgfId-187308"></a>The <code>paramtest</code> component <code>checkFreqs</code> has no terminals and no effect on the simulation results. It monitors its parameters and issues a message if a given condition is satisfied by evaluating to a nonzero number. In this case, <code>errorif</code> specifies that the Spectre simulator issues an error message and stops the simulation. If you specify <code>printif</code>, the Spectre simulator prints an informational message and continues the simulation. If you specify <code>warnif</code>, the Spectre simulator prints a warning and continues.</p>
<p>
<a id="pgfId-187309"></a>For more information about specific parameters available with the <code>paramtest</code> component, see the parameter listings in the Spectre online help (<code>spectre -h</code>).</p>

<h3>
<a id="pgfId-262089"></a>Enabling/Disabling N<a id="subckt_noise"></a>oise in Subcircuits</h3>

<p>
<a id="pgfId-262103"></a>You can enable or disable noise in subcircuit instances by using the global <code>noiseon_inst</code> and <code>noiseoff_inst</code> options or the <code>isnoisy</code> parameter. </p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-263739"></a>The global <code>noiseon_inst</code> and <code>noiseoff_inst</code> options, if specified for the same instance, override the settings of the <code>isnoisy</code> parameter.</div>
<p>
<a id="pgfId-263731"></a>The <code>isnoisy</code> parameter can be specified in both subcircuit definitions and subcircuit instances. However, if the parameter is specified in both, the <code>isnoisy</code> parameter specified in the subcircuit instance gets higher priority. If the <code>isnoisy</code> parameter is also specified for a device instance, it gets the highest priority. In addition, if the <code>isnoisy</code> parameter is specified at different hierarchy levels, the parameter at the higher hierarchy level gets higher priority.</p>
<p>
<a id="pgfId-262130"></a><strong>Example1</strong></p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-262144"></a>subckt sub1 a b</pre>

<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-262337"></a>parameters isnoisy=no</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-262627"></a>r1 a b 1k</pre>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-262344"></a>ends</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-262187"></a>X1 1 0 sub1 isnoisy=yes<br />X2 1 0 sub1<br />X3 1 0 sub1 isnoisy=no</pre>

<p>
<a id="pgfId-262234"></a>In the above example, noise will be enabled in <code>X1</code>.</p>
<p>
<a id="pgfId-262244"></a><strong>Example 2</strong></p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-262251"></a>subckt sub1 a b</pre>

<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-262310"></a>parameters isnoisy=no</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-262640"></a>X1 a 1 sub2 isnoisy=yes</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-262317"></a>X2 1 b sub2</pre>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-262324"></a>ends</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-262285"></a>subckt sub2 a b</pre>

<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-262354"></a>R1 a b 1K</pre>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-262361"></a>ends</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-262368"></a>X1 1 0 sub1</pre>

<p>
<a id="pgfId-262381"></a>In the above example, noise in <code>X1.X1</code> will be enabled whereas noise in <code>X1.X2</code> will be disabled.</p>
<p>
<a id="pgfId-262434"></a><strong>Example3</strong></p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-262453"></a>subckt sub1 a b</pre>

<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-262454"></a>parameters isnoisy=no</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-262649"></a>X1 a 1 sub2</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-262455"></a>X2 1 b sub3</pre>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-262456"></a>ends</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-262458"></a>subckt sub2 a b</pre>

<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-262459"></a>parameters isnoisy=yes</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-262658"></a>R1 a b 1K</pre>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-262460"></a>ends</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-262462"></a>subckt sub3 a b</pre>

<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-262463"></a>R1 a b 1K</pre>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-262464"></a>ends</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-262445"></a>X1 1 0 sub1</pre>

<p>
<a id="pgfId-262502"></a>In the above example, noise in <code>X1.X1</code> will be enabled. Noise in <code>X1.X2</code> will be disabled.</p>
<p>
<a id="pgfId-262512"></a><strong>Example4</strong></p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-262519"></a>subckt sub1 a b</pre>

<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-262539"></a>parameters isnoisy=no</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-262670"></a>R1 a 1 1K isnoisy=yes</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-262550"></a>R2 1 b 1K </pre>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-262557"></a>ends</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-262564"></a>X1 1 0 sub1</pre>

<p>
<a id="pgfId-262571"></a>In the above example noise will be enabled for <code>X1.R1</code>. It will be disabled for <code>X1.R2</code>.</p>
<p>
<a id="pgfId-262755"></a>The relation between <code>noiseon_inst</code>, <code>noiseoff_inst</code>, and <code>isnoisy</code> parameters for an instance (say X1) is shown below.</p>

<p>
<a id="pgfId-262696"></a></p>
<table class="webflareTable" id="#id262705">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262707"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262709"></a><code>noiseon_inst=[X1]</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262711"></a><code>noiseoff_inst=[X1]</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262713"></a>noiseon_inst and noiseoff_inst not specified for X1, but noiseon_inst is specified for other instances</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262810"></a>noiseon_inst and noiseoff_inst are not specified for X1, but noiseoff_inst is specified for other instances</p>
<p>
<a id="pgfId-262715"></a></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262717"></a>isnoisy=yes specified for X1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262719"></a>Enable noise in X1</p>
<p>
<a id="pgfId-262837"></a>A message is displayed stating that isnoisy is also specified for X1.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262721"></a>Disable noise in X1</p>
<p>
<a id="pgfId-262844"></a>A message is displayed stating that isnoisy is also specified for X1 and noiseoff_inst will override the isnoisy setting.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262723"></a>Enable noise in X1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262725"></a>Enable noise in X1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262727"></a>isnoisy=no is specified for X1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262729"></a>Enable noise in X1</p>
<p>
<a id="pgfId-262863"></a>A message is displayed stating that isnoisy is also specified for X1 and noiseon_inst will override the isnoisy setting.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262731"></a>Disable noise in X1</p>
<p>
<a id="pgfId-262882"></a>A message is displayed stating that isnoisy is also specified for X1.</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262733"></a>Disable noise in X1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262735"></a>Disable noise in x1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262737"></a>isnoisy is not specified for X1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262739"></a>Enable noise in X1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262741"></a>Disable noise in x1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262743"></a>Disable noise in X1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262745"></a>Enable noise in X1</p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-263196"></a>By default, all noise sources are enabled in all the devices in Spectre. The global <code>noiseon_inst</code> and <code>noiseoff_inst</code> options and the <code>isnoisy</code> parameter can only enable or disable all noise sources in a subcircuit instance. For example:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-263229"></a>X1 a b c sub1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-263230"></a>X2 a b c sub1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-263231"></a>X3 a b c sub1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-263221"></a>opt options noiseoff_inst=[X1]</pre>

<p>
<a id="pgfId-263246"></a>In the above example, all noise sources in instance <code>X1</code> are disabled and all noise sources in instances X2 and X3 are enabled.</p>
<p>
<a id="pgfId-263279"></a>You can use the global <code>noiseon_type</code> or <code>noiseoff_type</code> options to partially enable or disable the specific noise sources for a subcircuit instance. When you specify the <code>noiseon_type</code> option, it indicates that only the specified noise source is enabled and rest of the noise sources are disabled. Similarly, when you specify the <code>noiseoff_type</code> option, it indicates that only the specified noise source is disabled and rest of the noise sources are enabled.</p>
<p>
<a id="pgfId-263560"></a>Possible values for the <code>noiseon_type</code> and <code>noiseoff_type</code> options are <code>thermal</code>, <code>flicker</code>, <code>shot</code>, <code>ign</code>, and <code>all</code>.</p>
<p>
<a id="pgfId-263313"></a><strong>Examples</strong></p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-263347"></a>X1 a b c sub1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-263348"></a>X2 a b c sub1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-263349"></a>X3 a b c sub1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-263350"></a>opt1 options noiseoff_inst=[X1]</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-263320"></a>opt2 options noiseoff_type=[flicker]</pre>

<p>
<a id="pgfId-263373"></a>In the above example, the flicker noise source in <code>X1</code> is disabled. Rest of the noise sources in <code>X1</code> are enabled. All noise sources in <code>X2</code> and <code>X3</code> are enabled.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-263436"></a>X1 a b c sub1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-263437"></a>X2 a b c sub1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-263438"></a>X3 a b c sub1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-263439"></a>opt1 options noiseoff_inst=[X1]</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-263440"></a>opt2 options noiseoff_type=[flicker]</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-263476"></a>opt3 options noiseon_type=[thermal]</pre>

<p>
<a id="pgfId-263477"></a>In the above example, the flicker noise source in <code>X1</code> is disabled. The rest of the noise sources in <code>X1</code> are enabled. In addition, only the thermal noise source in <code>X2</code> and <code>X3</code> is enabled.The rest of the noise sources in <code>X2</code> and <code>X3</code> are disabled.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-263605"></a>X1 a b c sub1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-263606"></a>X2 a b c sub1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-263607"></a>X3 a b c sub1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-263608"></a>opt1 options noiseoff_type=[flicker]</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-263593"></a>opt2 options noiseon_type=[thermal]</pre>

<p>
<a id="pgfId-263620"></a>In the above example, <code>opt1</code> <code>options</code> will have no effect because no noise has been disabled using <code>noiseon_inst</code>, <code>noiseoff_inst</code>, or <code>isnoisy</code>. The thermal noise source will be enabled for the <code>X1</code>, <code>X2</code>, and <code>X3</code> instances and rest of the noise sources will be disabled.</p>

<h3>
<a id="pgfId-263479"></a>Conditional Sub<a id="condsub"></a>circuits</h3>

<p>
<a id="pgfId-259771"></a>You can specify different conditions that determine which subcircuits the Spectre simulator instantiates for a given simulation. The determining conditions are computed from the values of parameters. You specify these conditions with the structural if statement. This statement lets you specify if-else statements in the netlist.</p>
<p>
<a id="pgfId-259793"></a>You can also define a subcircuit in a file and include the file inside the conditional statement using the <code>include</code> statement.</p>

<h2>
<a id="pgfId-187312"></a><a id="28198"></a>Inline Subcircuits<a id="marker-187311"></a></h2>

<p>
<a id="pgfId-187313"></a>An inline subcircuit is a special case where one of the instantiated devices or models within the subcircuit does not get its full hierarchical name but inherits the subcircuit call name. The inline subcircuit is called in the same manner as a regular subcircuit. You format inline subcircuit definitions as follows:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-187314"></a>inline subckt <code><em>SubcircuitName</em></code> [(] <code><em>node1</em></code> ... <code><em>nodeN</em></code> [)]</pre>

<p>
<a id="pgfId-187315"></a>Depending on the use model, the body of the inline subcircuit typically contains one of the following:</p>
<ul><li>
<a id="pgfId-187316"></a>Multiple device instances, one of which is the <code>inline</code> component</li><li>
<a id="pgfId-187317"></a>Multiple device instances (one of which is the <code>inline</code> component) and one or more parameterized models</li><li>
<a id="pgfId-187318"></a>A single <code>inline</code> device instance and a parameterized model to which the device instance refers</li><li>
<a id="pgfId-187319"></a>Only a single parameterized model</li></ul>



<p>
<a id="pgfId-187320"></a>The <code>inline</code> component is denoted by giving it the same name as the inline subcircuit itself. When the subcircuit is flattened, as shown in the following section, the <code>inline</code> component does not acquire a hierarchical name such as <code>X1.M1</code> but rather acquires the name of the subcircuit call itself, <code>X1</code>. Any noninline components in the subcircuit acquire the regular hierarchical name, just as if the concept of inline subcircuits never existed.</p>
<p>
<a id="pgfId-187321"></a>Typically, a modeling engineer writes inline subcircuit definitions for a circuit design engineer to use.</p>

<h3>
<a id="pgfId-187324"></a><a id="33900"></a>Modeling Par<a id="marker-187323"></a>asitics</h3>

<p>
<a id="pgfId-187325"></a>You can model parasitics by adding parasitics components to a base component using inline subcircuits. The body of the inline subcircuit contains one <code>inline</code> component, the base component, and several regular components, which are taken to represent parasitics.</p>
<p>
<a id="pgfId-187326"></a>The following example of an inline subcircuit contains a MOSFET instance and two parasitic capacitances:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-204057"></a>inline subckt s1 (a b) &#160;&#160;&#160;&#160;      // &quot;s1&quot; is name of subcircuit<br /> parameters l=1u w=2u<br /> s1 (a b 0 0) mos_mod l=l w=w      // &quot;s1&quot; is &quot;inline&quot; component<br /> cap1 (a 0) capacitor c=1n<br /> cap2 (b 0) capacitor c=1n<br />ends s1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-187328"></a>The following circuit creates a simple MOS device instance <code>M1</code> and calls the inline subcircuit <code>s1</code> twice (<code>M2</code> and <code>M3</code>):</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-187329"></a>M1 (2 1 0 0) mos_mod<br />M2(5 6) s1 l=6u w=7u<br />M3(6 7) s1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-187330"></a>This circuit flattens to the following equivalent circuit:</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-204062"></a>M1 (2 1 0 0) mos_mod
M2 (5 6 0 0) mos_mod l=6u w=7u&#160;&#160;&#160;&#160;      // the &quot;inline&quot; component<br />       // inherits call name<br />M2.cap1 (5 0) capacitor c=1n&#160;&#160;&#160;&#160;      // a regular hierarchical name<br />M2.cap2 (6 0) capacitor c=1n</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-204063"></a>M3 (6 7 0 0) mos_mod l=1u w=2u&#160;&#160;&#160;&#160;      // the &quot;inline&quot; component<br />       // inherits call name<br />M3.cap1 (6 0) capacitor c=1n&#160;&#160;&#160;&#160;    <br />M3.cap2 (7 0) capacitor c=1n</pre>

<p>
<a id="pgfId-187333"></a>The final flattened names of each of the three MOSFET instances are <code>M1</code>, <code>M2</code> and <code>M3</code>. (If <code>s1</code> was a regular subcircuit, the final flattened names would be <code>M1</code>, <code>M2.s1</code>, and <code>M3.s1</code>.) However, the parasitic capacitors have full hierarchical names.</p>
<p>
<a id="pgfId-187334"></a>You can create an instance of the inline subcircuit cell in the same way as creating an instance of the specially tagged inline device. You can use <code>save</code> statements to probe this instance in the same way as a regular device, without having to</p>
<ul><li>
<a id="pgfId-187335"></a>Realize that the instance is actually embedded in a subcircuit</li><li>
<a id="pgfId-187336"></a>Know that there are possible additional parasitic devices present</li><li>
<a id="pgfId-187337"></a>Figure out the hierarchical name of the device of interest</li></ul>


<p>
<a id="pgfId-187338"></a>A modeling engineer can create several of these inline subcircuits and place them in a library for the design engineer to use. The library then includes a symbol cell view for each inline subcircuit. The design engineer then places a symbol cell view on a design, which behaves just as if a primitive were being used. The design engineer can then probe the device for terminal currents and operating-point information.</p>

<h4>
<a id="pgfId-187340"></a>Probing the De<a id="marker-187339"></a>vice</h4>

<p>
<a id="pgfId-187341"></a>The Spectre simulator allows the following list of items to be saved or probed for primitive devices, including devices modeled as the inline components of inline subcircuits:</p>
<ul><li>
<a id="pgfId-187342"></a>All terminal currents <br /><pre class="webflare-pre-block webflare-courier-new" id="#id187343">
<a id="pgfId-187343"></a>save m1:currents</pre></li><li>
<a id="pgfId-187344"></a>Specific (index) terminal current <br /><pre class="webflare-pre-block webflare-courier-new" id="#id187345">
<a id="pgfId-187345"></a>save m1:1   //#1=drain</pre></li><li>
<a id="pgfId-187346"></a>Specific (named) terminal current <br /><pre class="webflare-pre-block webflare-courier-new" id="#id187347">
<a id="pgfId-187347"></a>save m1:s   //&quot;s&quot;=source</pre></li><li>
<a id="pgfId-187348"></a>Save all operating-point information <br /><pre class="webflare-pre-block webflare-courier-new" id="#id187349">
<a id="pgfId-187349"></a>save m1:oppoint</pre></li><li>
<a id="pgfId-187350"></a>Save specific operating-point information<br /><pre class="webflare-pre-block webflare-courier-new" id="#id187351">
<a id="pgfId-187351"></a>save m1:vbe</pre></li><li>
<a id="pgfId-187352"></a>Save all currents and operating-point information<br /><pre class="webflare-pre-block webflare-courier-new" id="#id187353">
<a id="pgfId-187353"></a>save m1</pre></li></ul>











<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-187354"></a>If the device is embedded in a regular subcircuit, you have to know that the device is a subcircuit and find out the appropriate hierarchical name of the device in order to save or probe the device. However, with inline components, you can use the subcircuit call name, just as if the device were not in a subcircuit.</div>
<p>
<a id="pgfId-192035"></a>Operating-point information for the inline component is reported with respect to the terminals of the inline component itself and not with respect to the enclosing subcircuit terminals. This results in the following cautions.</p>

<h4>
<a id="pgfId-187356"></a>Caution: Parasitic Elements in Series with Device Terminals</h4>

<p>
<a id="pgfId-187357"></a>If the parasitic elements are in series with the device terminals, the reported operating-point currents are correct, but reported operating-point voltages might be incorrect. For example, consider the case of an inline MOSFET device with parasitic source and drain resistances:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-187358"></a>inline subckt mos_r (d g s b)
&#160;&#160;&#160;&#160;parameters p1=1u p2=2u
&#160;&#160;&#160;&#160;mos_r (dp g sp b) mos_mod l=p1 w=p2&#160;&#160;&#160;&#160;      // &quot;inline&quot; component<br /> rd (d dp) resistor r=10       // series drain resistance<br /> rs (s sp) resistor r=10       // series source resistance<br />ends mos_r</pre>

<p>
<a id="pgfId-187359"></a>If an instance <code>M1</code> is created of this <code>mos_r</code> inline subcircuit and the operating point of <code>M1</code> is probed, the drain-to-source current <code>ids</code> is reported correctly. However, the reported <code>vds</code> is not the same as V(d) &#8211; V(s), the two wires that connect the subcircuit drain and source terminals. Instead, <code>vds</code> is V(dp) &#8211; V(sp), which are nodes internal to the inline subcircuit.</p>

<h4>
<a id="pgfId-187361"></a>Caution: Parasitic Elements in Parallel with Device Terminals</h4>

<p>
<a id="pgfId-187362"></a>If the parasitic elements are in parallel with the device terminals, the reported voltages are correct, but the reported currents might be incorrect. For example, consider the following case of a MOSFET with source-to-bulk and drain-to-bulk diodes:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-187363"></a>inline subckt mos_d (d g s b)
&#160;&#160;&#160;&#160;parameters p1=1u p2=2u
&#160;&#160;&#160;&#160;mos_d (d g s b) mos_mod l=p1 w=p2&#160;&#160;&#160;&#160; &#160;&#160;&#160;&#160;     // &quot;inline&quot; component<br /> d1(d b) diode1 r=10       // drain-bulk diode<br /> d2(s b) diode1 r=10       // source-bulk diode<br />ends mos_d</pre>

<p>
<a id="pgfId-187364"></a>Here, the operating-point <code>vds</code> for the inline component is reported correctly because there are no extra nodes introduced by the inline subcircuit model. However, the reported <code>ids</code> for the inline device is not the same as the current flowing into terminal <code>d</code> because some of the current flows into the transistor and some through diode <code>d1</code>.</p>

<h3>
<a id="pgfId-187367"></a><a id="27791"></a>Para<a id="marker-187366"></a>meterized Models</h3>

<p>
<a id="pgfId-187368"></a>Inline subcircuits can be used in the same way as regular subcircuits to implement parameterized models. When an inline subcircuit contains both a parameterized model and an inline device referencing that model, you can create instances of the device, and each instance automatically gets an appropriately scaled model assigned to it. </p>
<p>
<a id="pgfId-187369"></a>For example, the instance parameters of an inline subcircuit can represent emitter width and length of a BJT device. Within that subcircuit, a model statement can be created that is parameterized for emitter width and length and scales accordingly. When you instantiate the subcircuit, you supply the values for the emitter width and length, and the device is instantiated with an appropriate geometrically scaled model. Again, the inline device does <em>not</em> get a hierarchical name and can be probed in the same manner as if it were a simple device and not actually embedded in a subcircuit.</p>
<p>
<a id="pgfId-187370"></a>In the following example, a parameterized model is declared within an inline subcircuit for a bipolar transistor. The model parameters are the emitter width, emitter length, emitter area, and the temperature delta (<code>trise</code>) of the device above nominal. Ninety-nine instances of a 4x4 transistor are then placed, and one instance of a transistor with <code>area=50</code> is placed. Each transistor gets an appropriately scaled model.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-187371"></a>* declare a subcircuit, which instantiates a transistor with 
* a parameterized model. The parameters are emitter width
* and length.

inline subckt bjtmod (c b e s)
&#160;&#160;&#160;&#160;parameters le=1u we=2u area=le*we trise=0
&#160;&#160;&#160;&#160;model mod1 bjt type=npn bf=100+(le+we)/2*(area/1e-12) \ 
&#160;&#160;&#160;&#160;         is=1e-12*(le/we)*(area/1e-12) <br /> bjtmod (c b e s) mod1 trise=trise        //&quot;inline&quot; component<br />ends bjtmod

* some instances of this subck
q1 (2 3 1 0) bjtmod le=4u we=4u&#160;&#160;&#160;&#160;        / trise defaults to zero<br />q2 (2 3 2 0) bjtmod le=4u we=4u trise=2<br />q3 (2 3 3 0) bjtmod le=4u we=4u<br />.<br />.<br />q99 (2 3 99 0) bjtmod le=4u we=4u<br />q100 (2 3 100 0) bjtmod le=1u area=50e-12 </pre>

<p>
<a id="pgfId-194923"></a>Since <em>each</em> device instance now gets its own unique model, this approach lends itself to statistical modeling of on-chip mismatch distributions, in which each device is taken to be slightly different than all the others on the same chip. The value of <code>bf</code> is the same for the first 99 transistors.</p>

<h3>
<a id="pgfId-194928"></a>Inline Subcirc<a id="marker-194927"></a>uits Containing Only Inline model Statements</h3>

<p>
<a id="pgfId-194934"></a>You can create an inline subcircuit that contains only a single model statement (and nothing else), where the model name is identical to the subcircuit name. This syntax is used to generate a parameterized model statement for a given set of parameters, where the model is then exported and can be referenced from one level outside the subcircuit. Instantiating the inline subcircuit in this case merely creates a model statement with the same name as the subcircuit call. The Spectre simulator knows that because the subcircuit definition contains only a <code>model</code> statement and no other instances, the definition is to be used to generate named models that can be accessed one level outside of the subcircuit. Regular device instances one level outside of the subcircuit can then refer to the generated model. </p>
<p>
<a id="pgfId-192189"></a>Because these are now instances of a model rather than of a subcircuit, you can specify device instance parameters with enumerated types such as <code>region=fwd</code>.</p>
<p>
<a id="pgfId-192190"></a>This technique is shown in the following example:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-187386"></a>* declare an inline subcircuit that &quot;exports&quot; a parameterized model
inline subckt bjtmod 
&#160;&#160;&#160;&#160;parameters le=1u we=2u area=le*we 
&#160;&#160;&#160;&#160;model bjtmod bjt type=npn bf=100+(le+we)/2*(area/1e-12) \ 
&#160;&#160;&#160;&#160;         is=1e-12*(le/we)*(area/1e-12) <br />ends bjtmod<br />
* now create two &quot;instances&quot; of the inline subcircuit, that is,
* create two actual models, called mod1, mod2

mod1 bjtmod le=4u we=4u
mod2 bjtmod le=1u area=50e-12 

* 99 instances of mod1 (all share mod1) 
* and 1 instance of mod2. 
q1 (2 3 1 0) mod1 region=fwd
q2 (2 3 2 0) mod1 trise=2
.
.
q99 (2 3 99 0) mod1
q100 (2 3 100 0) mod2</pre>

<p>
<a id="pgfId-190316"></a>Because the syntax of creating an instance of a model is the same as the syntax of creating an instance of a subcircuit in the Spectre netlist, you can easily replace model instances with more detailed subcircuit instances. To do this, replace the <code>model</code> statement itself with a subcircuit definition of the same name.</p>
<p>
<a id="pgfId-192043"></a>When you do this in the Spectre Netlist Language, you do not have to change the instance statements. In SPICE, inline subcircuits start with <code>x</code>, so you need to rename all instance statements to start with <code>x</code> if you replaced a model with a subcircuit.</p>

<h3>
<a id="pgfId-190523"></a><a id="18016"></a>Process Model<a id="marker-190522"></a>ing Using Inline Subcircuits</h3>

<p>
<a id="pgfId-190524"></a>Another modeling technique is to specify geometrical parameters, such as widths and lengths, to a device such as a bipolar transistor and then to create a parameterized model based on that geometry. In addition, the geometry can be modified according to certain process equations, allowing you to model nonideal etching effects, for example.</p>
<p>
<a id="pgfId-190525"></a>You use inline subcircuits and some <code>include</code> files for process and geometric modeling, as in the following example files. The <code>ProcessSimple.h</code> file defines the process parameters and the bipolar and resistor devices:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-190527"></a>// File: Proces<a id="processsimpleh"></a>sSimple.h

simulator lang=spectre

// define process parameters, including mismatch effects

parameters RSHSP=200 RSHPI=5k // sheet resistance, pinched sheet res
+&#160;&#160;&#160;&#160;SPDW=0 SNDW=0 // etching variation from ideal
+&#160;&#160;&#160;&#160;XISN=1 XBFN=1 XRSP=1 // device &quot;mismatch&quot; (mm)
parameters
+&#160;&#160;&#160;&#160;XISNafac=100m XISNbfac=1m // IS scaling factors for mm eqns
+ &#160;&#160;&#160;&#160;XBFNafac=100m XBFNbfac=1m    // BF &quot;       &quot;     &quot;     &quot;       &quot;
+ &#160;&#160;&#160;&#160;XRSPafac=100m XRSPbfac=1m    // RS &quot;       &quot;     &quot;     &quot;       &quot; 
+ &#160;&#160;&#160;&#160;RSHSPnom=200 RSHPInom=5k     // sheet resistance nom. values
+ &#160;&#160;&#160;&#160;FRSHPI=RSHPI/RSHPInom        // ratio of PI sheet res to nom

// define &quot;simple&quot; bipolar and resistor devices

// a &quot;base&quot; TNSA subckt, that is, a simple &quot;TNSA&quot; bipolar transistor
//  subcircuit, with model statement
inline subckt TNSA_B (C B E S)
&#160;&#160;&#160;&#160;parameters MULT=1 IS=1e-15 BF=100
&#160;&#160;&#160;&#160;model modX bjt type=npn is=IS bf=BF   // a model statement
&#160;&#160;&#160;&#160;TNSA_B (C B E S) modX m=MULT          // &quot;inline&quot; device instance
ends TNSA_B

// a &quot;base&quot; resistor
// a simple &quot;RPLR&quot; resistor subcircuit
inline subckt RPLR_B (A B)
&#160;&#160;&#160;&#160;parameters R MULT=1
&#160;&#160;&#160;&#160;RPLR_B (A B) resistor r=R m=MULT    // &quot;inline&quot; device
ends RPLR_B

// define process/geometry dependent bipolar and resistor devices

// a &quot;geometrical/process&quot; TNSA subcircuit
// a BJT subcircuit, with process and geometry effects modeled
// bipolar model parameters IS and BF are functions of effective 
// emitter area/perimeter taking process factors (for example, 
// nonideal etching) into account
inline subckt TNSA_PR (C B E S)
&#160;&#160;&#160;&#160;parameters WE LE MULT=1 dIS=0 dBF=0
+            WEA=WE+SNDW    // effective or &quot;Actual&quot; emitter width
+            LEA=LE+SNDW    // effective or &quot;Actual&quot; emitter length
+            AE=WEA*LEA     // effective emitter area
+            IS=1e-18*FRSHPI*AE*(1+(XISNafac/sqrt(AE)+XISNbfac)
+                             *(dIS/2+XISN-1)/sqrt(MULT))
+            BF=100*FRSHPI*(1+(XBFNafac/sqrt(AE)+XBFNbfac)
+                             *(dBF/2+XBFN-1)/sqrt(MULT))

&#160;&#160;&#160;&#160;TNSA_PR (C B E S) TNSA_B IS=IS BF=BF MULT=MULT        // &quot;inline&quot;
ends TNSA_PR

// a &quot;geometrical/process&quot; RPLR resistor subcircuit
// resistance is function of effective device geometry, taking
// process factors (for example, nonideal etching) into account
inline subckt RPLR_PR (A B)
&#160;&#160;&#160;&#160;parameters Rnom WB MULT=1 dR=0
+            LB=Rnom*WB/RSHSPnom
+            AB=LB*(WB+SPDW)

&#160;&#160;&#160;&#160;RPLR_PR (A B) RPLR_B R=RSHSP*LB/(WB+SPDW)*
+&#160;&#160;&#160;&#160; (1+(XRSPafac/sqrt(AB)+XRSPbfac)*(dR/2+XRSP-1)/sqrt(MULT))<br />
ends RPLR_PR</pre>

<p>
<a id="pgfId-190528"></a>The following file, <code>Plain.h</code>, provides the designer with a plain device interface without geometrical or process modeling:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-190529"></a>// File: Plain.h

simulator lang=spectre

// plain TNSA, no geometrical or process modeling
inline subckt TNSA (C B E S)
&#160;&#160;&#160;&#160;parameters MULT=1 IS=1e-15 BF=100
&#160;&#160;&#160;&#160;TNSA (C B E S) TNSA_B IS=IS BF=BF MULT=MULT       // call TNSA_B
ends TNSA

// plain RPLR no geometrical or process modeling
inline subckt RPLR (A B)
&#160;&#160;&#160;&#160;parameters R=1 MULT=1
&#160;&#160;&#160;&#160;RPLR (A B) RPLR_B R=R MULT=MULT<br />ends RPLR</pre>

<p>
<a id="pgfId-190530"></a>The following file, <code>Process.h</code>, provides the designer with the geometrical device interface:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-190531"></a>// File: Process.h

simulator lang=spectre

// call to the geometrical TNSA model
inline subckt TNSA (C B E S)
&#160;&#160;&#160;&#160;parameters WE=1u LE=1u MULT=1 dIS=0 dBF=0
&#160;&#160;&#160;&#160;TNSA (C B E S) TNSA_PR WE=WE LE=LE \
                 MULT=MULT dIS=dIS dBF=dBF      // call TNSA_PR
ends TNSA

// call to the geometrical RPLR model
inline subckt RPLR (A B)
&#160;&#160;&#160;&#160;parameters Rnom=1 WB=10u MULT=1 dR=0
&#160;&#160;&#160;&#160;RPLR (A B) RPLR_PR Rnom=Rnom WB=WB \<br />             MULT=MULT dR=dR                    // call RPLR_PR<br />ends RPLR</pre>

<p>
<a id="pgfId-190532"></a>The following example is a differential amplifier netlist showing how a design can combine process modeling with process and geometry effects:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-190533"></a>// a differential amplifier, biased with a 1mA current source<br />simulator lang=spectre<br />
include &quot;ProcessSimple.h&quot;
include &quot;Process.h&quot;

E1 (1 0) vsource dc=12

// pullup resistors, 4k ohms nominal
R1 (1 2) RPLR Rnom=4k WB=5 // 5 units wide, model will calc length
R2 (1 3) RPLR Rnom=4k WB=10 // 10 units wide, model will calc length

// the input pair
TNSA1 (2 4 5 0) TNSA WE=10 LE=10
TNSA2 (3 4 5 0) TNSA WE=10 LE=10

// no differential input voltage, both inputs tied to same source
E4 (4 0) vsource dc=5

// current source biasing
J5 (5 0) isource dc=1m

dcop dc</pre>
<h2>
<a id="pgfId-260390"></a><a id="40553"></a><a id="13255"></a>Binn<a id="marker-260389"></a>ing</h2>

<p>
<a id="pgfId-187811"></a>Binning is the process of partitioning a device with different sizes into different models. Before BSIM 3v3, it was very difficult to fit all the devices with a single <code>model</code> statement over very wide ranges of device sizes. To improve fitting accuracy, you might characterize devices into several models with each model valid only for a limited range of device sizes.</p>
<p>
<a id="pgfId-187812"></a>For example, suppose you have a device with a length (L) from 0.25 m to 100 m and a width (W) from 0.25 m to 100 m. You might want to divide your device as follows (not drawn to scale).</p>
<p>
<a id="pgfId-187880"></a></p>

<div class="webflare-div-image">
<img width="643" height="350" src="images/chap5-11.gif" /></div>

<p>
<a id="pgfId-187881"></a>In this example, nine models are used. These devices are divided into <em>bins</em>. For devices whose length lies between 1 m and 10 m and width lies between 10 m and 100 m, Mod6 is used. The model name within a group can be of type string as well as a number.</p>
<p>
<a id="pgfId-187882"></a>The process of generating these models is called binning. The binning process is usually identical for all simulators because the equations for binning are always the same:</p>
<p>
<a id="pgfId-187883"></a>     P = P0 + Pl/Leff + Pw/Weff + Pp/(Leff*Weff)</p>
<p>
<a id="pgfId-187884"></a>There are two ways to do binning with the Spectre simulator:</p>
<ul><li>
<a id="pgfId-192054"></a>Auto model selection<br />
<a id="pgfId-192057"></a>For more information on auto model selection, see the following section.</li><li>
<a id="pgfId-187885"></a>Conditional instances<br />
<a id="pgfId-259482"></a>For more information on using conditional instances, see <a href="chap5.html#23014">Conditional Instances</a>. For more information on using inline subcircuits for model selection, see <a href="chap5.html#17880">Scaling Physical Dimensions of Components and Device Model Technology</a>.</li></ul>




<h3>
<a id="pgfId-259487"></a>Auto Model Selec<a id="marker-259486"></a>tion</h3>

<p>
<a id="pgfId-192068"></a>Automatic model selection is a simulator feature that automatically assigns the correct models to devices based on their device sizes without using conditional instantiation.</p>
<p>
<a id="pgfId-192070"></a>Binning is usually used together with automatic model selection. Model selection is now automatic for MOSFETs, BSIM1, BSIM2, and BSIM3. Help on any one of these devices (for example, <code>spectre -h mos1</code>) gives you more details.</p>
<p>
<a id="pgfId-192071"></a>For the auto model selector program to find a specific model, the models to be searched need to be grouped together within braces. Such a group is called a model group. An opening brace is required at the end of the line defining each model group. Every model in the group is given a name followed by a colon and the list of parameters. Also, you need to specify the device length and width using the four geometric parameters <code>lmax</code>, <code>lmin</code>, <code>wmax</code>, and <code>wmin</code>. The selection criteria to choose a model is as follows: </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-192072"></a><code>lmin &lt;= inst_length &lt; lmax</code> and&#160;&#160; <code>wmin &lt;= inst_width &lt; wmax</code> </pre>

<p>
<a id="pgfId-192073"></a>For example:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-192074"></a>model ModelName ModelType { 
&#160;&#160;&#160;&#160;1:     lmin=2 lmax=4 wmin=1 wmax=2 vto=0.8
&#160;&#160;&#160;&#160;2:     lmin=1 lmax=2 wmin=2 wmax=4 vto=0.7
&#160;&#160;&#160;&#160;3:     lmin=2 lmax=4 wmin=4 wmax=6 vto=0.6<br />}</pre>

<p>
<a id="pgfId-192075"></a>Then for a given instance </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-192076"></a>M1 1 2 3 4 ModelName w=3 l=1.5 </pre>

<p>
<a id="pgfId-192077"></a>the program searches all the models in the model group with the name <code>ModelName</code> and then picks the first model whose geometric range satisfies the selection criteria. In the preceding example, the auto model selector program chooses <code>ModelName.2</code>. </p>
<p>
<a id="pgfId-256824"></a>The following example shows multiple lines for each model statement within a group:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-256909"></a>model pch mos2 {
&#160;&#160;&#160;&#160;1:type=p vto=-0.65 gamma=0.47 lambda=0.09 \
&#160;&#160;&#160;&#160; ld=0.45E-6 kp=0.33E-4 tox=0.21E-7 is=0.0 \<br />  lmin=0.5u lmax=1.5u wmin=1u wmax=3u \<br />  tnom=25 xl=3e-08 af=0.8824<br /> 2:type=p vto=-0.69 gamma=0.44 lambda=0.09 \<br />  ld=0.45E-6 kp=0.33E-4 tox=0.21E-7 is=0.0 \<br />  lmin=1.5u lmax=2.5u wmin=3u wmax=5u<br /> 3:type=p vto=-0.73 gamma=0.37 lambda=0.09 \<br />  ld=0.45E-6 kp=0.33E-4 tox=0.21E-7 is=0.0 \<br />  lmin=2.5u lmax=3.5u wmin=1u wmax=3u<br /> 4:type=p vto=-0.77 gamma=0.34 lambda=0.09 \<br />  ld=0.45E-6 kp=0.33E-4 tox=0.21E-7 is=0.0 \<br />  lmin=3.5u lmax=4u wmin=3u wmax=5u</pre>

<p>
<a id="pgfId-256910"></a>Then for the given instances,</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-256911"></a>m0 (nd ng ns nb) pch m=1.0 w=4u l=2u<br />m1 (pd pg ps pb) pch m=1.0 w=4u l=4u</pre>

<p>
<a id="pgfId-256902"></a>the auto model selector selects <code>pch.2</code> for <code>m0</code> and <code>pch.4</code> for <code>m1</code>.</p>

<h3>
<a id="pgfId-190581"></a>Conditional Instances<a id="23014"></a><a id="con_inst"></a><a id="marker-190580"></a></h3>

<p>
<a id="pgfId-190582"></a>You can specify different conditions that determine which components the Spectre simulator instantiates for a given simulation. The determining conditions are computed from the values of parameters. You specify these conditions with the structural <code>if</code> statement. This statement lets you put <code>if</code>-<code>else</code> statements in the netlist.</p>
<p>
<a id="pgfId-190583"></a>You can also use conditional instantiation with inline subcircuits. For more information on using inline subcircuits, see <a href="chap5.html#17880">Scaling Physical Dimensions of Components and Device Model Technology</a>.</p>

<h4>
<a id="pgfId-190595"></a>Form<a id="marker-190593"></a>atting the if Statement</h4>

<p>
<a id="pgfId-204093"></a>You format the structural <code>if</code> statement as follows:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-204094"></a>i<a id="marker-261665"></a>f <code><em>condition</em></code> <code><em>statement1</em></code> [<code><em>else</em></code> <code><em>statement2</em></code>]</pre>
<table class="webflareTable" id="#id262070">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262072"></a><span class="webflare-courier-new" style="white-space:pre"><em>condition</em></span> </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262074"></a>The <span class="webflare-courier-new" style="white-space:pre"><em>condition</em></span> fields are Boolean-valued expressions where any nonzero value is taken as &#8220;true.&#8221;</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262076"></a><span class="webflare-courier-new" style="white-space:pre"><em>statement</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-262078"></a>The <span class="webflare-courier-new" style="white-space:pre"><em>&lt;statement1&gt;</em></span> and <span class="webflare-courier-new" style="white-space:pre"><em>&lt;statement2&gt; </em></span>fields contain one or more instance statements or <code>if</code> statements. The <code>else</code> part of the statement is optional.</p>
</td>
</tr>
</tbody></table>
<h4>
<a id="pgfId-204109"></a>An if Statement Example</h4>

<p>
<a id="pgfId-190601"></a>The following example illustrates the use of the <code>if</code> statement. There are additional <code>if</code> statements in the <span class="webflare-courier-new" style="white-space:pre"><em>statement1</em></span> and <span class="webflare-courier-new" style="white-space:pre"><em>statement2</em></span> fields.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-190602"></a>if (rseries == 0) {
&#160;&#160;&#160;&#160;c1 (a b) capacitor c=c
&#160;&#160;&#160;&#160;if (gparallel != 0) gp1 a b resistor r=1/gparallel
} else {
&#160;&#160;&#160;&#160;r2 (a x) resistor r=rseries
&#160;&#160;&#160;&#160;c2 (x b) capacitor c=c
&#160;&#160;&#160;&#160;if (gparallel != 0) gp2 x b resistor r=1/gparallel</pre>
<pr-prog id="#id190603">
<a id="pgfId-190603"></a>}</pr-prog>

<p>
<a id="pgfId-190604"></a>In this example, the Spectre simulator puts different instance statements into the simulation depending on the values of two parameters, <code>rseries</code> and <code>gparallel</code>. </p>
<ul><li>
<a id="pgfId-190605"></a>If both <code>rseries</code> and <code>gparallel</code> are zero, the Spectre simulator includes the instance statement for capacitor <code>c1</code>.If <code>rseries</code> is zero and <code>gparallel</code> is nonzero, the Spectre simulator includes the instance statements for capacitor <code>c1</code> and resistor <code>gp1</code>.</li><li>
<a id="pgfId-190607"></a>If <code>rseries</code> is nonzero and <code>gparallel</code> is zero, the Spectre simulator includes the instance statements for resistor <code>r2</code> and capacitor <code>c2</code>.</li><li>
<a id="pgfId-190608"></a>If neither <code>rseries</code> nor <code>gparallel</code> is zero, the Spectre simulator includes the instance statements for resistor <code>r2</code>, capacitor <code>c2</code>, and resistor <code>gp2</code>.</li></ul>



<h4>
<a id="pgfId-190609"></a>Rules to Remember</h4>

<p>
<a id="pgfId-190610"></a>When you use the <code>if</code> statement, </p>
<ul><li>
<a id="pgfId-190611"></a>If the <span class="webflare-courier-new" style="white-space:pre"><em>statement1</em></span> or <span class="webflare-courier-new" style="white-space:pre"><em>statement2</em></span> fields contain multiple statements, place these fields within braces (<code>{}</code>).</li><li>
<a id="pgfId-190612"></a>End the <span class="webflare-courier-new" style="white-space:pre"><em>statement1</em></span> and <span class="webflare-courier-new" style="white-space:pre"><em>statement2</em></span> fields with newlines.</li><li>
<a id="pgfId-190613"></a>Use a continuation character if you want to place a newline between the <code>if</code> and <code>condition</code> statements.</li><li>
<a id="pgfId-190614"></a>When the <span class="webflare-courier-new" style="white-space:pre"><em>statement1</em></span> or <span class="webflare-courier-new" style="white-space:pre"><em>statement2</em></span> field is a single instance or <code>if</code> statement, an <code>else</code> statement is associated with the closest previous <code>if</code> statement.</li><li>
<a id="pgfId-260089"></a>Do not use the parameters specified with the <code>options</code> statement inside the <code>if</code> expression, otherwise, you might get unexpected results. For example, do not use the following:<br /><pre class="webflare-pre-block webflare-courier-new" id="#id260205">
<a id="pgfId-260205"></a>simOptions options tnom=25</pre><pre class="webflare-pre-block webflare-courier-new" id="#id260206">
<a id="pgfId-260206"></a>if (tnom == 27) { //27 is the default value of tnom</pre><pre class="webflare-pre-block webflare-courier-new" id="#id260207">
<a id="pgfId-260207"></a>r1 0 1 resistor r=10</pre><pre class="webflare-pre-block webflare-courier-new" id="#id260208">
<a id="pgfId-260208"></a>} else {</pre><pre class="webflare-pre-block webflare-courier-new" id="#id260209">
<a id="pgfId-260209"></a>r1 0 1 resistor r=20</pre><pre class="webflare-pre-block webflare-courier-new" id="#id260210">
<a id="pgfId-260210"></a>}</pre></li></ul>











<h4>
<a id="pgfId-192106"></a>Binni<a id="marker-194961"></a><a id="marker-196237"></a>ng by Conditional Instantiation</h4>

<p>
<a id="pgfId-192107"></a>You can use conditional instantiation to select an appropriate model based on certain ranges of specified parameters (model binning). This technique lets you decide and implement which parameters to bin on and is valid for any device that supports a model.</p>
<p>
<a id="pgfId-192108"></a>The Spectre Netlist Language has conditional instantiation. For example:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-192112"></a>subckt s1 (d g s b)
&#160;&#160;&#160;&#160;parameters l=1u w=1u
&#160;&#160;&#160;&#160;if (l &lt; 0.5u) {
&#160;&#160;&#160;&#160; m1 (d g s b) shortmod l=l w=w             // short-channel model<br /> } else {<br />  m2 (d g s b) longmod l=l w=w            // long-channel model<br /> }<br /> model shortmod vto=0.6 gamma=2 ..etc<br /> model longmod vto=0.8 gamma=66 ..etc<br />ends s1</pre>

<p>
<a id="pgfId-192113"></a>Based on the value of parameter <code>l</code>, one of the following is chosen:</p>
<ul><li>
<a id="pgfId-192114"></a>A short-channel model</li><li>
<a id="pgfId-192115"></a>A long-channel model</li></ul>

<p>
<a id="pgfId-192116"></a>Previously, the transistor instances had to have unique names (such as <code>m1</code> and <code>m2</code> in the preceding example), even though only one of them could actually be chosen. Now, you can use the same name for both instances, provided certain conditions are met. The following example shows a powerful modeling approach that combines model binning (based on area) with inline subcircuits for a bipolar device:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-192117"></a>// general purpose binning and inline models

simulator lang=spectre
parameters VDD=5

vcc (2 0) vsource dc=VDD
vin (1 0) vsource dc=VDD

q1 (1 2 0 0) npn_mod area=350e-12         // gets 20x20 scaled model
q2 (1 3 0 0) npn_mod area=25e-12          // gets 10x10 scaled model
q3 (1 3 0 0) npn_mod area=1000e-12        // gets default model

inline subckt npn_mod (c b e s) //generalized binning, based on area
&#160;&#160;&#160;&#160;parameters area=5e-12
&#160;&#160;&#160;&#160;if ( area &lt; 100e-12 ) {
&#160;&#160;&#160;&#160; npn_mod (c b e s) npn10x10  // 10u * 10u, inline device<br /> } else if ( area &lt; 400e-12 ) {<br />  npn_mod (c b e s) npn20x20  // 20u * 20u, inline device<br /> } else {<br />  npn_mod (c b e s) npn_default       // 5u * 5u, inline device<br /> }<br /> model npn_default bjt is=3.2e-16 va=59.8<br /> model npn10x10 bjt is=3.5e-16 va=61.5<br /> model npn20x20 bjt is=3.77e-16 va=60.5<br />ends npn_mod</pre>

<p>
<a id="pgfId-257612"></a>The transistors end up having the name that they were called with (<code>q1</code>, <code>q2</code>, and <code>q3</code>), but each has the correct model chosen for its respective area. Model binning can be now achieved based on <em>any</em> parameter and for <em>any</em> device, such as <code>resistor</code> or <code>bjt</code>. </p>

<h4>
<a id="pgfId-257614"></a>Changing <a id="marker-257613"></a>the Condition Value In Conditional Instantiation</h4>

<p>
<a id="pgfId-257790"></a>Changing the value of a parameter that results in a change of boolean if condition value is allowed only if there is no actual topology change and the following conditions are met:</p>
<ul><li>
<a id="pgfId-257817"></a>The number of instances in the <code>if</code> and <code>else</code> blocks are the same.</li><li>
<a id="pgfId-257818"></a>The names of the instances in the <code>if</code> and <code>else</code> blocks are the same.</li><li>
<a id="pgfId-257653"></a>Corresponding instances (with the same name) in the <code>if</code> and <code>else</code> blocks are instances of the same model or sub-circuit, or instances of two different models of the same primitive type.</li></ul>


<p>
<a id="pgfId-257695"></a>For example, you can do the following:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-257701"></a>model mos1 bsim3v3  &lt;model-params-1&gt;<br />model mos2 bsim3v3  &lt;model-params-2&gt;<br />model mos3 bsim3v3&#160;&#160;&lt;model-params-3&gt;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-257705"></a>if  (p&lt;=1)
&#160;&#160;&#160;&#160;m1 1 1 0 0 mos1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-257707"></a>else if (p&lt;=2)
&#160;&#160;&#160;&#160;m1 1 1 0 0 mos2</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-257709"></a>else
&#160;&#160;&#160;&#160;m1 1 1 0 0 mos3</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-257712"></a>sweep1 sweep param=p values=[1 2 3]</pre>

<p>
<a id="pgfId-257697"></a>The following example does not satisfy the second condition above, so the Spectre simulator errors out even though there is no actual topology change:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-257757"></a>parameters p=1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-257779"></a>if (p&lt;=1)
&#160;&#160;&#160;&#160;r1 1 0 resistor r=1K</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-257780"></a>else
&#160;&#160;&#160;&#160;r2 1 0 resistor r=10K</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-257781"></a>al1 alter param=p value=2</pre>
<h4>
<a id="pgfId-192123"></a>Rules for General-Purpose Model Bin<a id="marker-192122"></a>ning</h4>

<p>
<a id="pgfId-192124"></a>The following set of rules exists for general-purpose model binning. Allowing multiple &#8220;instances&#8221; or &#8220;references&#8221; to the same-named device is possible only under the following conditions:</p>
<ul><li>
<a id="pgfId-192125"></a>The reference to the same-named device is possible only in a structural <code>if</code> statement that has both an <code>if</code> part and an <code>else</code> part.</li><li>
<a id="pgfId-257904"></a>The conditions of the if statements must evaluate to a single device instance with a unique name in that scope. </li></ul>

<p>
<a id="pgfId-257906"></a>Multiple references to the same-named device are only possible if there can only ever be one single instance of this device after all expressions have been evaluated, and each instance must be connected to the same nodes and represent the same device.</p>

<h4>
<a id="pgfId-190655"></a>Examples of Conditional Instances</h4>

<p>
<a id="pgfId-190656"></a>The following two examples show how to use conditional instances.</p>

<h4><em>
<a id="pgfId-190662"></a><a id="88511"></a>Fully Di<a id="marker-190658"></a>fferential CMOS Operatio<a id="cmos"></a>nal Amplifier</em></h4>

<p>
<a id="pgfId-194977"></a>This netlist describes and analyzes a CMOS operational amplifier and demonstrates several sophisticated uses of Spectre features. The example includes top-level netlist parameters, model library/section statements, multiple analyses, and configuring a test circuit with the <code>alter</code> statement.</p>
<p>
<a id="pgfId-190672"></a>The first file in the example is the main file for the circuit. This file contains the test circuit and the analyses needed to measure the important characteristics of the amplifier. </p>
<p>
<a id="pgfId-190673"></a>The main file is followed by files that describe the amplifier and the various models that can be selected. These additional files are placed in the netlist with <code>include</code> statements. </p>
<p>
<a id="pgfId-190675"></a>Voltage-controlled voltage sources transform single-ended signals to differential- and common-mode signals and vice versa. This approach does not generate or dissipate any power. The power dissipation reported by the Spectre simulator is that of the differential amplifier.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-193680"></a>// Fully Differential Operational Amplifier Test Circuit<br />#define PROCESS_CORNER TYPICAL</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-193684"></a>simulator lang=spectre<br />global gnd vdd vss</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-193687"></a>parameters VDD=5.0_V GAIN=0.5</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-193689"></a>include &quot;cmos.mod&quot;      section=typical<br />include &quot;opamp.ckt&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-193692"></a>// power supplies<br />Vdd   (vdd   gnd)   vsource dc=VDD<br />Vss   (vss   gnd)   vsource dc=-VDD<br />// compute differential input<br />Vcm   (cmin  gnd)   vsource type=dc dc=0 val0=0 val1=2 width=1u \<br />        delay=10ns<br />Vdif  (in    gnd)   vsource type=dc dc=0 val0=0 val1=2 width=1u \<br />        delay=10ns<br />Ridif (in    gnd)   resistor<br />Eicmp (pin   cmin  in    gnd)   vcvs gain=GAIN<br />Eicmn (nin   cmin  in    gnd)   vcvs gain=-GAIN<br />// feedback amplifier<br />A1    (pout  nout  pvg        nvg)    opamp<br />Cf1   (pout  t1)    capacitor  c=8p<br />Cf2   (nout  t2)    capacitor  c=8p<br />Vt1   (t1    nvg)   vsource    mag=0<br />Vt2   (t2    pvg)   vsource    mag=0<br />Cl1   (pout  gnd)   capacitor  c=8p<br />Cl2   (out  gnd)    capacitor  c=8p<br />Ci1   (pin   pvg)   capacitor  c=2p<br />Ci2   (nin   nvg)   capacitor  c=2p<br />// compute differential output<br />Edif  (out   gnd   pout  nout) vcvs gain=1<br />Rodif (out   gnd)  resistor<br />Ecmp  (cmout mid   pout  gnd) vcvs gain=GAIN<br />Ecmn  (mid   gnd   nout  gnd) vcvs gain=GAIN<br />Rocm  (cmout gnd)  resistor<br />//<br />// Perform measurements<br />//<br />spectre options save=lvlpub nestlvl=1<br />printParams info what=output where=logfile<br />// operating point<br />opPoint dc readns=&quot;%C:r.dc&quot; write=&quot;%C:r.dc&quot;<br />printOpPoint info what=oppoint where=logfile<br />// differential-mode characteristics<br />      // closed-loop gain, Av = Vdif:p<br />       // power supply rejection ratio, Vdd PSR = Vdd:p, Vss PSR = Vss:p<br />      dmXferFunctions xf start=1k stop=1G dec=10 probe=Rodif<br />dmNoise noise start=1k stop=1G dec=10 \<br />        oprobe=Edif oportv=1 iprobe=Vdif iportv=1<br />// step response<br />dmEnablePulse alter dev=Vdif param=type value=pulse annotate=no<br />dmStepResponse tran stop=2us errpreset=conservative<br />dmDisablePulse alter dev=Vdif param=type value=dc annotate=no<br />// loop gain, Tv = -t1/nvg<br />// open-loop gain, av = out/(pvg-nvg)<br />dmEnableTest1 alter dev=Vt1 param=mag value=1 annotate=no<br />dmEnableTest2 alter dev=Vt2 param=mag value=-1 annotate=no<br />dmLoopGain ac start=1k stop=1G dec=10<br />dmDisableTest1 alter dev=Vt1 param=mag value=0 annotate=no<br />dmDisableTest2 alter dev=Vt2 param=mag value=0 annotate=no<br />// common-mode characteristics<br />      // closed-loop gain, Av = Vcm:p<br />       // power supply rejection ratio, Vdd PSR = Vdd:p, Vss PSR =Vss:p<br />      cmXferFunctions xf start=1k stop=1G dec=10 probe=Rocm<br />      cmNoise noise start=1k stop=1G dec=10 \<br />                oprobe=Rocm oportv=1 iprobe=Vcm iportv=1<br />// step response<br />cmEnablePulse alter dev=Vcm param=type value=pulse annotate=no<br />cmStepResponse tran stop=2us errpreset=conservative<br />cmDisablePulse alter dev=Vcm param=type value=dc annotate=no<br />// loop gain, Tv = -t1/nvg<br />// open-loop gain, av = 2*cmout/(pvg+nvg)<br />cmEnableTest1 alter dev=Vt1 param=mag value=1 annotate=no<br />cmEnableTest2 alter dev=Vt2 param=mag value=1 annotate=no<br />cmLoopGain ac start=1k stop=1G dec=10<br />cmDisableTest1 alter dev=Vt1 param=mag value=0 annotate=no<br />cmDisableTest2 alter dev=Vt2 param=mag value=0 annotate=no</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-193762"></a>The following file, <code>opamp.ckt</code>, contains the differential amplifier.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-193764"></a>// opamp.ckt: Fully Differential CMOS Operational Amplifier<br />//<br />// This circuit requires the use of the cmos process models<br />simulator lang=spectre<br />// Folded-Cascode Operational Amplifier<br />subckt opamp (pout nout pin nin)<br />        // input differential pair<br />        M1   (4    pin  1    1)    nmos w=402.4u l=7.6u<br />        M2   (5    nin  1    1)    nmos w=402.4u l=7.6u<br />        M18  (1   12   vss  vss)   nmos w=242.4u l=7.6u<br />// upper half of folded cascode<br />        M3   (4    11   vdd  vdd)  pmos w=402.4u l=7.6u<br />        M4   (5    11   vdd  vdd)  pmos w=402.4u l=7.6u<br />        M5   (nout 16   4    vdd)  pmos w=122.4u l=7.6u<br />        M6   (pout 16   5    vdd)  pmos w=122.4u l=7.6u<br />// lower half of folded cascode<br />        M7   (nout 13   8    vss)  nmos w=72.4u l=7.6u<br />        M8   (pout 13   9    vss)  nmos w=72.4u l=7.6u<br />        M9   (8    12   vss  vss)  nmos w=122.4u l=7.6u<br />        M10  (9    12   vss  vss)  nmos w=122.4u l=7.6u<br />// common-mode feedback amplifier<br />        M11  (10   nout vss  vss)  nmos w=12.4u l=62.6u<br />        M12  (10   pout vss  vss)  nmos w=12.4u l=62.6u<br />        M13a (11   gnd  vss  vss)  nmos w=12.4u l=62.6u<br />        M13b (11   gnd  vss  vss)  nmos w=12.4u l=62.6u<br />        M14  (10   10   vdd  vdd)  pmos w=52.4u l=7.6u<br />        M15  (11   10   vdd  vdd)  pmos w=52.4u l=7.6u<br />        Cc1  (nout 11)   capacitor c=1p<br />        Cc2  (pout 11)  capacitor c=1p<br />// bias network<br />        M16  (12   12   vss  vss)  nmos w=22.4u l=11.6u<br />        M17  (21   12   vss  vss)  nmos w=22.4u l=11.6u<br />        M19  (13   13   14   vss)  nmos w=22.4u l=21.6u<br />        M20  (13   21   16   vdd)  pmos w=52.4u l=7.6u<br />        M21  (21   16   17   vdd)  pmos w=26.4u l=11.6u<br />        M22  (16   16  17    vdd)  pmos w=26.4u l=11.6u<br />        D1   (15   vss)  dnp area=400n<br />        D2   (14   15)   dnp area=400n<br />        D3   (18   17)   dnp area=400n<br />        D4   (vdd  18)   dnp area=400n<br />        Ib   (gnd  12)   isource dc=10u<br />ends opamp</pre>

<p>
<a id="pgfId-193807"></a>The following file, <code>cmos.mod</code>, contains the models and uses the <code>library</code> and <code>section</code> statements to bin models into various process &#8220;corners.&#8221; See <a href="chap5.html#55114">Process File</a><a id="marker-194997"></a><a id="marker-196325"></a> for a more sophisticated example, which also includes automatic model selection.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-193813"></a>// cmos.mod: Spectre MOSFET model parameters  ---  CMOS process<br />//<br />// Empirical parameters, best, typical, and worst cases.<br />//<br />//<br />simulator lang=spectre<br />library cmos_mod</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-193821"></a>  section fast // MOSFETS and DIODES for process corner &quot;FAST&quot;<br />    model nmos mos3 type=n vto=1.04 gamma=1.34 phi=.55 nsub=1e15 \<br />            cgso=290p cgdo=290p cgbo=250p cj=360u tox=700e-10 \<br />                    pb=0.914 js=1e-4 xj=1.2u ld=1.2u wd=0.9u uo=793 bvj=14<br />     model pmos mos3 type=p vto=-0.79 gamma=0.2 phi=.71 nsub=1.7e16\<br />            cgso=140p cgdo=140p cgbo=250p cj=80u tox=700e-10 \<br />                    pb=0.605 js=1e-4 xj=0.8u ld=0.9u wd=0.9u uo=245 bvj=14<br />     model dnp diode is=3.1e-10 n=1.12 cjo=3.1e-8 pb=.914 m=.5 bvj=45 \<br />            imax=1000<br />     model dpn diode is=1.3e-10 n=1.05 cjo=9.8e-9 pb=.605 m=.5 bvj=45 \<br />            imax=1000<br />  endsection fast</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-193834"></a>  section typical // MOSFETS and DIODES for process corner &quot;TYPICAL&quot;<br />    model nmos mos3 type=n vto=1.26 gamma=1.62 phi=.58 nsub=1e15 \<br />          cgso=370p cgdo=370p cgbo=250p cj=400u tox=750e-10 \<br />                      pb=0.914 js=1e-4 xj=1u ld=0.8u wd=1.2u uo=717 bvj=14<br />      model pmos mos3 type=p vto=-1.11 gamma=0.39 phi=.72 nsub=1.7e16 \<br />          cgso=220p cgdo=220p cgbo=250p cj=100u tox=750e-10 \<br />                  pb=0.605 js=1e-4 xj=0.65u ld=0.5u wd=1.2u uo=206 bvj=14<br />     model dnp diode is=3.1e-10 n=1.12 cjo=3.1e-8 pb=.914 m=.5 bvj=45 \<br />           imax=1000<br />     model dpn diode is=1.3e-10 n=1.05 cjo=9.8e-9 pb=.605 m=.5 bvj=45 \<br />           imax=1000<br />  endsection typical</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-193847"></a>  section slow // MOSFETS and DIODES for process corner &quot;SLOW&quot;<br />    model nmos mos3 type=n vto=1.48 gamma=1.90 phi=.59 nsub=1e15 \<br />          cgso=440p cgdo=440p cgbo=250p cj=440u tox=800e-10 \<br />                  pb=0.914 js=1e-4 xj=0.8u ld=0.38u wd=1.5u uo=641 bvj=14<br />      model pmos mos3 type=p vto=-1.42 gamma=0.58 phi=.73 nsub=1.7e16 \<br />          cgso=300p cgdo=300p cgbo=250p cj=120u tox=800e-10 \<br />                    pb=0.605 js=1e-4 xj=0.5u ld=0.1u wd=1.5u uo=167 bvj=14<br />     model dnp diode is=3.1e-10 n=1.12 cjo=3.1e-8 pb=.914 m=.5 bvj=45 \<br />           imax=1000<br />     model dpn diode is=1.3e-10 n=1.05 cjo=9.8e-9 pb=.605 m=.5 bvj=45 \<br />           imax=1000<br />  endsection slow</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-193678"></a>endlibrary</pre>
<h4><em>
<a id="pgfId-190727"></a><a id="55114"></a>P<a id="processfile"></a>r<a id="marker-190724"></a>ocess File</em></h4>

<p>
<a id="pgfId-194306"></a>This example of automatic <a id="marker-194305"></a>model selection with the conditional <code>if</code> statement is more sophisticated than the previous example (in section <a href="chap5.html#88511">Fully Differential CMOS Operational Amplifier</a>). With this example, you ask for an <code>nmos</code> transistor, and the Spectre simulator automatically selects the appropriate model according to the process corner, the circuit temperature, and the device width and length. The selection is done by the parameterized inline subcircuit and the conditional <code>if</code> statement.</p>
<p>
<a id="pgfId-194313"></a>The <code>paramtest</code><a id="marker-194312"></a> statements create warnings if the model selection parameters are out of range. Models are assigned to instances depending on the initial values of their parameters when the circuit is input. Note that the instances are not reassigned to new models if the selection parameters later change. However, the models are updated if the circuit temperature is changed. Notice that even though <code>nmos</code> is defined as a subcircuit, it is called as if it is a MOSFET primitive.</p>
<p>
<a id="pgfId-194314"></a>The MOSFET model parameters are deleted to keep this example to a reasonable length, and ordinarily both the N- and P-channel models are in the same file. If you added the model parameters and a <code>pmos</code> model, this file could replace <code>cmos.mod</code> in the previous example.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-194342"></a>// N-CHANNEL MOS --- 1u NMOS PROCESS<br />//<br />//<br />// The following group of models represent N-channel MOSFETs over<br />// the following ranges:<br />//     1u &lt;= l &lt;= oo<br />//     1u &lt;= w &lt;= oo<br />//     0 &lt;= T &lt;= 55<br />//     process corners = {FAST, TYPICAL, SLOW}<br />// Warnings are issued if these limits are violated.<br />//<br />// This model takes 4 parameters, l, w, ls, and ld.  The defaults for<br />// each of these parameters is 1um.<br />//<br />//              +-----------+<br />//     +--------+           +--------+ ---<br />//     |        |           |        |  ^<br />//     |        |           |        |  |<br />//     |&lt;- ls -&gt;|&lt;--- l ---&gt;|&lt;- ld -&gt;|  w<br />//     |        |           |        |  |<br />//     |        |           |        |  v<br />//     +--------+           +--------+ ---<br />//&#160;&#160;            +-----------+</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-194592"></a>//       Source      Gate       Drain<br />//<br />simulator lang=spectre<br />//<br />// Complain if global constants are out-of-range.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-194606"></a>//<br />TooCold paramtest warnif=(temp &lt; 0) \<br />        message=&quot;The nmos model is not accurate below 0 C.&quot;<br />TooHot paramtest warnif=(temp &gt; 55) \<br />        message=&quot;The nmos model is not accurate above 55 C.&quot;<br />//<br />// Define inline subcircuit that implements automatic model selection<br />// this uses user-supplied parameters l and w which represent device<br />// geometry, and the built-in parameter temp, to perform model binning<br />// based on both geometry and temperature.<br />//<br />inline subckt nmos (d g s b)<br />        parameters l=1um w=1um ls=1um ld=1um<br />//<br />// Complain if subcircuit parameters are out-of-range.<br />//<br />TooShort paramtest warnif=(l &lt; 1um) \<br />        message=&quot;Channel length for nmos must be greater than 1u.&quot;<br />TooThin paramtest warnif=(w &lt; 1um) \<br />        message=&quot;Channel width for nmos must be greater than 1u.&quot;<br />TooNarrow paramtest warnif=(ls &lt; 1um) warnif=(ld &lt; 1um) \<br />        message=&quot;Stripe width for nmos must be greater than 1u.&quot;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-194393"></a>//<br />// Model selection</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-194396"></a>include &quot;models.scs&quot;                      // include all model definitions<br />include &quot;select_model.scs &quot; section=typical // include code to auto<br />// choose models</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-194402"></a>ends nmos<br />//<br />// Set the temperature<br />//<br />nmosSetTempTo27C alter param=temp value=27</pre>

<p>
<a id="pgfId-194410"></a>The following file, <code>models.scs</code>, contains the models, which depend on circuit temperature (<code>temp</code>). Each model parameter can take on one of two values, depending on the value of parameter <code>temp</code>.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-194413"></a>//<br />// Fast models.<br />//<br />model fast_1x1 mos3 type=n vto=(temp &gt;= 27_C) ? 0.8 : 0.77   // ...etc<br />model fast_1x3 mos3 type=n vto=(temp &gt;= 27_C) ? 0.9 : 0.78   // ...etc<br />model fast_3x1 mos3 type=n vto=(temp &gt;= 27_C) ? 0.95 : 0.79  // ...etc<br />model fast_3x3 mos3 type=n vto=(temp &gt;= 27_C) ? 0.98 : 0.81  // ...etc<br />//<br />// Typical models.<br />//<br />model typ_1x1 mos3 type=n vto=(temp &gt;= 27_C) ? 0.90 : 0.75   // ...etc<br />model typ_1x3 mos3 type=n vto=(temp &gt;= 27_C) ? 0.91 : 0.73   // ...etc<br />model typ_3x1 mos3 type=n vto=(temp &gt;= 27_C) ? 0.97 : 0.77   // ...etc<br />model typ_3x3 mos3 type=n vto=(temp &gt;= 27_C) ? 0.99 : 0.84   // ...etc<br />//<br />// Slow models.</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-194726"></a>//<br />model slow_1x1 mos3 type=n vto=(temp &gt;= 27_C) ? 0.92 : 0.76  // ...etc<br />model slow_1x3 mos3 type=n vto=(temp &gt;= 27_C) ? 0.93 : 0.74  // ...etc<br />model slow_3x1 mos3 type=n vto=(temp &gt;= 27_C) ? 0.98 : 0.78  // ...etc<br />model slow_3x3 mos3 type=n vto=(temp &gt;= 27_C) ? 0.98 : 0.89&#160;&#160;// ...etc</pre>

<p>
<a id="pgfId-194437"></a>The following file, <code>select_models.scs</code>, uses the structural <code>if</code> statement to select models based on parameters <code>l</code> and <code>w</code>. Note that for MOS devices, this could also be achieved by using auto model selection (see <code>spectre -h mos3</code>), but this example illustrates model binning and model selection based on the structural <code>if</code> statement, which can be used to bin based on any combination of parameters, (not necessarily predefined device geometry models) and for any device type (that is, not limited to MOS devices only).</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-194446"></a>library select_models</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-194448"></a>section fast // select models for fast device, based on subckt <br />//parameters l,w<br />    if (l &lt;= 3um) {<br />        if (w &lt;= 3um) {<br />             nmos (d g s b) fast_1x1 l=l w=w ls=ls ld=ld<br />        } else {<br />             nmos (d g s b) fast_1x3 l=l w=w ls=ls ld=ld<br />        }<br />    } else {<br />        if (w &lt;= 3um) {<br />             nmos (d g s b) fast_3x1 l=l w=w ls=ls ld=ld<br />        } else {<br />             nmos (d g s b) fast_3x3 l=l w=w ls=ls ld=ld<br />        }<br />    }<br />endsection fast</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-194465"></a>section typical<br />    if (l &lt;= 3um) {<br />        if (w &lt;= 3um) {<br />             nmos (d g s b) typ_1x1 l=l w=w ls=ls ld=ld<br />        } else {<br />             nmos (d g s b) typ_1x3 l=l w=w ls=ls ld=ld<br />        }<br />    } else {<br />        if (w &lt;= 3um) {<br />             nmos (d g s b) typ_3x1 l=l w=w ls=ls ld=ld<br />        } else {<br />             nmos (d g s b) typ_3x3 l=l w=w ls=ls ld=ld<br />        }<br />    }<br />endsection typical</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-194481"></a>section slow<br />    if (l &lt;= 3um) {<br />        if (w &lt;= 3um) {<br />             nmos (d g s b) slow_1x1 l=l w=w ls=ls ld=ld<br />        } else {<br />             nmos (d g s b) slow_1x3 l=l w=w ls=ls ld=ld<br />        }<br />    } else {<br />        if (w &lt;= 3um) {<br />             nmos (d g s b) slow_3x1 l=l w=w ls=ls ld=ld<br />        } else {<br />             nmos (d g s b) slow_3x3 l=l w=w ls=ls ld=ld<br />        }<br />    }<br />endsection slow</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-194303"></a>endlibrary</pre>
<h2>
<a id="pgfId-194297"></a><a id="17880"></a><a id="25171"></a><a id="36798"></a><a id="11351"></a>Scaling Physical Dimensions of Components<a id="marker-194298"></a> and Device Model Technology</h2>

<p>
<a id="pgfId-191880"></a>Selected components allow their physical dimensions to be scaled with global scale factors. When you want to scale the physical dimensions of these instances and models, you use the <code>scale</code><a id="marker-191881"></a> and <code>scalem</code> parameters in the <code>options</code> statement. Use <code>scale</code> for instances and <code>scalem</code> for models. The default value for both <code>scale</code> and <code>scalem</code> is 1.0. (For more information about the <code>options</code> statement, see<a href="chap8.html#38382">options Statement Format</a> and the documentation for the <code>options</code> statement in Spectre online help <code>spectre <br />-h options</code>.) </p>
<p>
<a id="pgfId-191885"></a>You can scale the following devices with <code>scale</code> and <code>scalem</code>: </p>
<ul><li>
<a id="pgfId-191886"></a>Capacitors&#8212;length (<code>l</code>) or width (<code>w</code>)</li><li>
<a id="pgfId-195574"></a>Diodes&#8212;length (<code>l</code>) or width (<code>w</code>)</li><li>
<a id="pgfId-191887"></a>Resistors&#8212;length (<code>l</code>) or width (<code>w</code>)</li><li>
<a id="pgfId-191888"></a>Physical resistors (<code>phy_res</code>)&#8212;length (<code>l</code>) or width (<code>w</code>)</li><li>
<a id="pgfId-191889"></a>MOSFET&#8212;length or width</li></ul>





<h4>
<a id="pgfId-191890"></a>Finding Default Measurement Units</h4>

<p>
<a id="pgfId-191891"></a>The effects of <code>scale</code> and <code>scalem</code> depend on the default measurement units of the components you scale. To find the default measur<a id="marker-191892"></a>ement units for a component parameter, look up that parameter in the parameter listings of your Spectre online help (<code>spectre -h</code>). The default for measurement units is in parentheses. For example, the (<code>m</code>) in this entry from the <code>mos8</code> parameter descriptions in the Spectre online help (<code>spectre -h</code>) tells you that the default measurement unit for channel width is meters.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-191893"></a>w (m)&#160;&#160;&#160;&#160; Channel width</pre>
<h4>
<a id="pgfId-191897"></a>Effects of scale and scalem with Different Default Units</h4>

<p>
<a id="pgfId-197947"></a><code>scale</code> and <code>scalem</code> affect only parameters whose default measurement units are in meters. For example, <code>vmax</code> is affected because its units are <em>m/sec</em>, but <code>ucrit</code> is not affected because its units are V/cm. Similarly, <code>nsub</code> is not affected because its units are 1/cm3. You can check the effects of <code>scale</code> and <code>scalem</code> by adding an <code>info</code> statement with <code>what=output</code> and look for the effective length (<code>leff</code>) or width (<code>weff</code>) of a device. For more information about the <code>info</code> statement, see <a href="chap8.html#26626">The info Statement</a>.</p>
<p>
<a id="pgfId-198006"></a>The following table shows you the effects of <code>scale</code> and <code>scalem</code> with different units:</p>

<p>
<a id="pgfId-257534"></a></p>
<table class="webflareTable" id="#id257479">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id257481">
<a id="pgfId-257481"></a>scale or scalem</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id257483">
<a id="pgfId-257483"></a>Units</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id257485">
<a id="pgfId-257485"></a>Scaling action</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257487"></a><code>scale</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257489"></a>meters (m)</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257491"></a>Multiplied by <code>scale</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257493"></a><code>scalem</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257495"></a>meters (m) </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257497"></a>Multiplied by <code>scalem</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257499"></a><code>scale</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257501"></a>meters<sup>n</sup> (m<sup>n</sup>) <br />(With n a real number)</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257503"></a>Multiplied by <code>scale</code><span class="webflare-courier-new" style="white-space:pre"><em>n</em></span></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257505"></a><code>scalem</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257507"></a>meters<sup>n</sup> (m<sup>n</sup>) <br />(With n a real number)</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257509"></a>Multiplied by <code>scalem</code><span class="webflare-courier-new" style="white-space:pre"><em>n</em></span></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257511"></a><code>scale</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257513"></a>1/ meters (1/m)</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257515"></a>Divided by <code>scale</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257517"></a><code>scalem</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257519"></a>1/ meters (1/m)</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257521"></a>Divided by <code>scalem</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257523"></a><code>scale</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257525"></a>1/meters<sup>n</sup> (1/m<sup>n</sup>) <br />(With n a real number)</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257527"></a>Divided by <code>scale</code><span class="webflare-courier-new" style="white-space:pre"><em>n</em></span></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257529"></a><code>scalem</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257531"></a>1/meters<sup>n</sup> (1/m<sup>n</sup>)<br /> (With n a real number)</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-257533"></a>Divided by <code>scale</code><span class="webflare-courier-new" style="white-space:pre"><em>n</em></span></p>
</td>
</tr>
</tbody></table>
<h4>
<a id="pgfId-257542"></a>Scaling Device Model Technology</h4>

<p>
<a id="pgfId-257543"></a>The <code>scalefactor</code><a id="marker-257567"></a> parameter in the <code>options</code> statement enables device model providers to scale device technology independent of the design dimension scaling done by circuit designers. The resulting device instance scaling is defined by <code>scale</code> * <code>scalefactor</code>. If the foundry uses a technology scale factor of 0.9 (<code>scalefactor=0.9</code>), and the circuit designer uses a design scale factor of 1e-6 (<code>scale=1e-6</code>), then the compounded scaling of the device instance dimension is 0.9e-6. Unlike the <code>scale</code> parameter, the <code>scalefactor</code> parameter cannot be used as a netlist parameter and cannot be altered or used in sweep statements.</p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-260071"></a>The <code>scalefactor</code> parameter does not apply to BJT devices.</div>

<h4>
<a id="pgfId-257540"></a>String Parameters<a id="marker-257535"></a></h4>

<p>
<a id="pgfId-257537"></a>You can use quoted character strings as parameter values. String values you might use as Spectre parameter values include filenames and labels. When you use a string as a parameter, enclose the string in quotation marks. In the following example, the value for the parameter named <code>file</code> is the character string <code>Spara.data</code>.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-191961"></a>model sp_data nport file=&quot;Spara.data&quot;</pre>
<h2>
<a id="pgfId-256709"></a><a id="13932"></a>Multi-Technology Simulation <a id="MTS"></a></h2>

<p>
<a id="pgfId-256711"></a>The Spectre circuit simulator supports a multi-technology simulation (MTS) mode that enables the simulation of a system consisting of blocks designed with different processes. Under this mode, models and modelgroups referenced using <code>include</code> or <code>ahdl_include</code> statements in a subcircuit are locally scoped to that subcircuit only. In addition, process options parameters (<code>temp</code>, <code>tnom</code>, <code>scale</code>, and <code>scalem</code>), when specified in a subcircuit, are locally scoped to that subcircuit only.</p>
<p>
<a id="pgfId-257106"></a>MTS mode is enabled by default across all Spectre simulators. To turn the MTS mode off, use the <code>-mts</code> command-line option.<a id="38761"></a><a id="12501"></a></p>
<p>
<a id="pgfId-257107"></a>Here is an example of a system consisting of blocks designed with different processes:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-257284"></a>globaloptions options tnom=26 scale=1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-261208"></a>subckt chip1 ( in out )
&#160;&#160;&#160;&#160; ahdl_include &#8220;a.va&#8221;<br /> include &#8220;pmos_mode.scs&#8221;<br /> scopedoption1 options tnom=27 scale=0.1<br /> subckt inv ( in out )<br /> mp ( out in vdd vdd ) pmos w=1u l=3u<br /> mn ( out in 0 0 ) nmos w=1u l=3u<br /> ends inv<br /> subckt buffer ( in out )<br /> x1 ( in mid ) inv<br /> x2 ( mid out ) inv<br /> ends buffer<br /> xa ( in out ) buffer<br /> model nmos bsim3v3 type=n<br />ends chip1</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-257072"></a>subckt chip2 ( in out )
&#160;&#160;&#160;&#160;ahdl_include &#8220;b.va&#8221;
&#160;&#160;&#160;&#160;scopedoption2 options tnom=25 scale=0.2
&#160;&#160;&#160;&#160;subckt inv ( in out )
&#160;&#160;&#160;&#160;mp ( out in vdd vdd ) pmos w=1u l=3u
&#160;&#160;&#160;&#160;mn ( out in 0 0 ) nmos w=1u l=3u
&#160;&#160;&#160;&#160;ends inv
&#160;&#160;&#160;&#160;subckt buffer ( in out )
&#160;&#160;&#160;&#160;x1 ( in mid ) inv
&#160;&#160;&#160;&#160;x2 ( mid out ) inv
&#160;&#160;&#160;&#160;ends buffer
&#160;&#160;&#160;&#160;xa ( in out ) buffer
&#160;&#160;&#160;&#160;model pmos bsim3v3 type=p
&#160;&#160;&#160;&#160;model nmos bsim3v3 type=n<br />ends chip2</pre>

<p>
<a id="pgfId-259611"></a>In the log file, you will see the following user options:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-261034"></a>Global user options:</pre>

<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-261035"></a>tnom = 26</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-261036"></a>scale = 1</pre>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-261038"></a>Scoped user options:</pre>

<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-261181"></a>tnom = 27&#160;&#160;     subckt=chip1</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-261182"></a>scale = 0.1&#160;&#160;   subckt=chip1</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-261183"></a>tnom = 25&#160;&#160;     subckt=chip2</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-261026"></a>scale = 0.2&#160;&#160;   subckt=chip2</pre>
<p>
<a id="pgfId-261058"></a>You may disable some of the instances and subcircuits by using the <code>skip</code> option with the scope specified for MTS. For example,</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-259614"></a>Opt1 options skip=cut inst=[x1 x2] </pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-259615"></a>Opt1 options skip=cut subckt=[sub1 sub2]</pre>

<p>
<a id="pgfId-259617"></a>The possible values for the <code>skip</code> option are <code>none</code>, <code>load</code>, and <code>cut</code>. The default value is <code>none</code>. When you set the <code>skip</code> option to <code>cut</code>, the simulator leaves the instance terminals or subcircuit ports disconnected, when MTS is enabled.</p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-259674"></a>Spectre/ Spectre APS does not support <code>skip=load</code>.</div>

<h3>
<a id="pgfId-262907"></a>Specifying cmin</h3>

<p>
<a id="pgfId-264140"></a>By default, the Spectre circuit simulator considers all options specified for a node as global options, and all nodes in the design share the same options. However, you can use <code>cmin</code> as a scoped option or with the <code>node</code> statement and use this capability to apply this option to the nodes in a certain scope to aid convergence. </p>

<h4>
<a id="pgfId-264239"></a>Specifying cmin as a scoped option</h4>

<p>
<a id="pgfId-262921"></a>You can specify cmin as a scoped option, as shown in the following examples:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-264649"></a>Opt1 options cmin=0.001 sub=[sub1]</pre>

<p>
<a id="pgfId-264741"></a>Here, the <code>cmin</code> value 0.001 will be applied to all nodes of the subcircuit instances whose master is <code>sub1</code></p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-264717"></a>Opt2 options cmin=0.002 inst=[x1]</pre>

<p>
<a id="pgfId-264764"></a>Here, the <code>cmin</code> value 0.002 will be applied to all nodes of the subcircuit instance <code>X1</code>.</p>
<p>
<a id="pgfId-262938"></a>The supported scope types for the <code>cmin</code> option are: <code>sub/subckt</code> and <code>dev/inst</code>. </p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-263165"></a>The scoped <code>cmin</code> option takes precedence over the global <code>cmin</code> option.</div>
<p>
<a id="pgfId-263101"></a>The scoped options are displayed under the Scoped user options section in the Spectre log file, as shown below.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-263105"></a>Scoped user options:</pre>

<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-263106"></a>cmin = 0.001&#160;&#160;     sub=sub1</pre>

<h4>
<a id="pgfId-264787"></a>Specifying cmin with the Node Statement</h4>

<p>
<a id="pgfId-264845"></a>You can specify <code>cmin</code> with the <code>node</code> statement, as shown below.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-264941"></a>Node1 (n1) node cmin=0</pre>

<p>
<a id="pgfId-264965"></a>In the above example, the <code>cmin</code> value on node <code>n1</code> will be 0.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-264993"></a>node1 (n1) node cmin=0 sub=[sub1 sub2 ..]</pre>

<p>
<a id="pgfId-265008"></a>In the above example, <code>cmin=0</code> is applied to the internal node or port with the name <code>n1</code> for subcircuit instances whose master is <code>sub1</code> or <code>sub2</code>.</p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-265068"></a>You can specify <code>cmin</code> both as a scoped option and in the <code>node</code> statement. However, if there is a conflict, the <code>cmin</code> option specified in the <code>node</code> statement gets higher precedence than the scoped <code>cmin</code> option. If there is no conflict, their scope is merged.</div>

<br /><a href="#pagetop">Return to top</a><br /></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="chap4.html" id="prev" title="Spectre Netlists">Spectre Netlists</a></em></b><b><em><a href="chap6.html" id="nex" title="Modeling for Signal Integrity">Modeling for Signal Integrity</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2020, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
</body></html>