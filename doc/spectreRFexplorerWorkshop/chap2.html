
<html><head><title>Simulating Low Noise Amplifiers</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="jommy" />
<meta name="CreateDate" content="2020-01-08" />
<meta name="CreateTime" content="1578555317" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Provides user information for Virtuoso Spectre Circuit Simulator and Accelerated Parallel Simulator RF Analysis" />
<meta name="DocTitle" content="Spectre Circuit Simulator and Accelerated Parallel Simulator RF Analysis in ADE Explorer Workshop" />
<meta name="DocType" content="User Guide" />
<meta name="FileTitle" content="Simulating Low Noise Amplifiers" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-3.1" />
<meta name="Keyword" content="spectreRFexplorerWorkshop" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2020-01-08" />
<meta name="ModifiedTime" content="1578555317" />
<meta name="NextFile" content="chap3.html" />
<meta name="Group" content="SpectreRF" />
<meta name="Platform" content="Custom IC Design" />
<meta name="PrevFile" content="DesignWorkshop.html" />
<meta name="Product" content="Spectre" />
<meta name="ProductFamily" content="Spectre" />
<meta name="ProductVersion" content="19.1" />
<meta name="RightsManagement" content="Copyright 2012-2020 Cadence Design Systems Inc." />
<meta name="Title" content="Spectre Circuit Simulator and Accelerated Parallel Simulator RF Analysis in ADE Explorer Workshop -- Simulating Low Noise Amplifiers" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="product_feature" content="" />
<meta name="product_subfeature" content="" />
<meta name="Version" content="19.1" />
<meta name="SpaceKey" content="spectreRFexplorerWorkshop191" />
<meta name="webflare-version" content="1.4" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" /></head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="spectreRFexplorerWorkshopTOC.html">Contents</a></li><li><a class="prev" href="DesignWorkshop.html" title="Introduction">Introduction</a></li><li style="float: right;"><a class="viewPrint" href="spectreRFexplorerWorkshop.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="chap3.html" title="Simulating Oscillators">Simulating Oscillators</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Spectre Circuit Simulator and Accelerated Parallel Simulator RF Analysis in ADE Explorer Workshop<br />Product Version 19.1, January 2020</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;"><a name="#firstpage"></a>

<h1>2
<a id="pgfId-1065082"></a></h1>
<h1>
<a id="pgfId-1065083"></a><hr />
Simulating Low Noise Amplifiers<hr />
</h1>

<p>
<a id="pgfId-1225451"></a>The SpectreRF simulator can simulate very linear circuits, such as Low Noise Amplifiers (LNA). This section uses the lna Simple circuit to illustrate how the SpectreRF simulator can determine the characteristics of an LNA design.</p>
<p>
<a id="pgfId-1225452"></a>The first stage of a receiver is typically an LNA, whose main function is to set the boundary as well as to provide enough gain to overcome the noise of subsequent stages (for example, in the mixer and IF Amplifier). Apart from providing enough gain in addition to introducing as little noise as possible, an LNA should accommodate large signals without distortions, offer a large dynamic range, and provide good matching to its input and output. Good matching is extremely important if a passive band-select and image-reject filter precedes and succeeds the LNA because the transfer characteristics of many filters are sensitive to the quality of the termination.</p>
<p>
<a id="pgfId-1081648"></a>In the LNA example that follows, you will plot the following characteristics of the low noise amplifier.</p>
<table class="webflareTable" id="#id1081649">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1081651">
<a id="pgfId-1081651"></a>LNA Measurements (lnaSimple</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1081653">
<a id="pgfId-1081653"></a>Analyses</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081655"></a><h-hot>S-Parameter Analysis, Small Signal Gain</h-hot></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1081657">
<a id="pgfId-1081657"></a>sp</blockquote>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081659"></a><h-hot>Stability, Stability Circles</h-hot></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1081661">
<a id="pgfId-1081661"></a>sp</blockquote>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081663"></a>Linear two-port Noise Frequency Measurements, Noise Circles</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1081665">
<a id="pgfId-1081665"></a>sp+noise</blockquote>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081667"></a>Third-Order Intercept Measurement</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1081669">
<a id="pgfId-1081669"></a>hb</blockquote>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1081671"></a><h-hot>Rapid IP3 Using Specialized AC Analysis</h-hot></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1081673">
<a id="pgfId-1081673"></a>ac </blockquote>
</td>
</tr>
</tbody></table>
<p>
<a id="pgfId-1081702"></a>To use this section, you must be familiar with the SpectreRF simulator analyses as well as know about LNA designs. For more information about the SpectreRF simulator analyses, refer to the various chapters in this user guide and also the <em><a actuate="user" class="URL" href="../spectreRFTheory/chap1.html#firstpage" show="replace" xml:link="simple">SpectreRF Simulation Option Theory.</a></em></p>

<h2>
<a id="pgfId-1081705"></a>The lnaSimple Low Noise Amplifier C<a id="ne600p Circuit Description"></a>ircuit</h2>

<p>
<a id="pgfId-1081706"></a>The lnaSimple circuit can be found in the <em>ExampleLibRF</em> library. Refer to the <a href="DesignWorkshop.html#59142">Introduction</a> chapter for the instructions on accessing the <em>ExampleLibRF </em>library. The schematic for the lnaSimple circuit is shown below. It is a differential low noise amplifier.</p>

<p><strong>Figure 2-1
<a id="pgfId-1081707"></a>Schematic for the lnaSimple Low Noise Amplifier</strong></p>
<p>
<a id="pgfId-1112913"></a></p>
<div class="webflare-div-image">
<img width="668" height="535" src="images/chap2-2.gif" /></div>

<p>
<a id="pgfId-1112914"></a>The following tables list some measured values for different aspects of the lnaSimple low noise amplifier.</p>

<p>
<a id="pgfId-1112972"></a></p>
<table class="webflareTable" id="#id1112915">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1112917">
<a id="pgfId-1112917"></a>Measurement</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1112919">
<a id="pgfId-1112919"></a>Measured</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1112925">
<a id="pgfId-1112925"></a>RF frequencies (Hz)</blockquote>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1112927">
<a id="pgfId-1112927"></a>900M</blockquote>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1112929">
<a id="pgfId-1112929"></a>Output frequency (Hz)</blockquote>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1112931">
<a id="pgfId-1112931"></a> 900M</blockquote>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1112933">
<a id="pgfId-1112933"></a>RF voltage</blockquote>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1112935">
<a id="pgfId-1112935"></a>200mV peak</blockquote>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1112937">
<a id="pgfId-1112937"></a>RF power</blockquote>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1112939">
<a id="pgfId-1112939"></a>-10 dBm</blockquote>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1112941">
<a id="pgfId-1112941"></a>Gain</blockquote>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1112943">
<a id="pgfId-1112943"></a>measurement needed</blockquote>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1112945">
<a id="pgfId-1112945"></a>Stability Factor</blockquote>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1112947">
<a id="pgfId-1112947"></a><em>measurement needed</em></blockquote>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1112949">
<a id="pgfId-1112949"></a>Noise figure</blockquote>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1112951">
<a id="pgfId-1112951"></a><em>measurement needed</em></blockquote>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1112953">
<a id="pgfId-1112953"></a>1dB compression point</blockquote>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1112955">
<a id="pgfId-1112955"></a><em>measurement needed</em></blockquote>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1112957">
<a id="pgfId-1112957"></a>Input IP3 (from swept power)</blockquote>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1112959">
<a id="pgfId-1112959"></a><em>measurement needed</em></blockquote>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1112961">
<a id="pgfId-1112961"></a>Input IP3 (from AC analysis)</blockquote>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1112963">
<a id="pgfId-1112963"></a><em>measurement needed</em></blockquote>
</td>
</tr>
</tbody></table>
<p>
<a id="pgfId-1081789"></a></p>
<table class="webflareTable" id="#id1081772">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1081774">
<a id="pgfId-1081774"></a>Design Variable</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1081776">
<a id="pgfId-1081776"></a>Default Value</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1081778">
<a id="pgfId-1081778"></a>prf (RF power)</blockquote>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1081780">
<a id="pgfId-1081780"></a>-10 dBm</blockquote>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1081782">
<a id="pgfId-1081782"></a>frf1 (RF frequency)</blockquote>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<blockquote id="#id1081784">
<a id="pgfId-1081784"></a>900M</blockquote>
</td>
</tr>
</tbody></table>
<h2>
<a id="pgfId-1081790"></a>Setting Up to Simulate the lnaSimple Low Noise Amplifier</h2>
<h3>
<a id="pgfId-1081792"></a>Opening the lnaSimple Circuit in the Schematic W<a id="Opening ne600p Schematic"></a>indow</h3>

<ol><li>
<a id="pgfId-1081793"></a>In CIW, choose <em>File &#8211; Open</em>.<br />
<a id="pgfId-1083605"></a>The <em>Open File</em> form is displayed.</li><li>
<a id="pgfId-1083606"></a>Choose<em> ExampleLibRF from the Library </em>drop-down list. </li><li>
<a id="pgfId-1083607"></a>Choose <em>lnaSimple</em> from the <em>Cells</em> list box. </li><li>
<a id="pgfId-1081797"></a>Choose <em>schematic</em> from the <em>View </em>drop-down list.<br />
<a id="pgfId-1081798"></a>The completed <em>Open File</em> form will look like the one below.<br /><strong class="webflare-fig-line-height">Figure 2-2
<a id="pgfId-1081799"></a>Open File Form</strong>
<a id="pgfId-1081803"></a><div class="webflare-div-image">
<img width="615" height="403" src="images/chap2-3.gif" /></div></li><li>
<a id="pgfId-1081804"></a>Click <em>OK</em>.<br />
<a id="pgfId-1081805"></a>The Schematic window for the <em>lnaSimple </em>circuit<em> </em>is displayed.<br /><strong class="webflare-fig-line-height">Figure 2-3
<a id="pgfId-1081806"></a>lnaSimple Schematic</strong>
<a id="pgfId-1081810"></a><div class="webflare-div-image">
<img width="666" height="428" src="images/chap2-4.gif" /></div></li><li>
<a id="pgfId-1081811"></a>In the Schematic window, choose <em>Launch&#8211; ADE Explorer</em>.</li><li>
<a id="pgfId-1293993"></a>In the <em>Launch ADE Explorer</em> dialog, select <em>Create New View</em>.<br />
<a id="pgfId-1293994"></a>The <em>Create new ADE Explorer view</em> form is displayed.<br /><strong class="webflare-fig-line-height">Figure 2-4
<a id="pgfId-1293995"></a>Create new ADE Explorer view</strong>
<a id="pgfId-1293999"></a><div class="webflare-div-image">
<img width="613" height="355" src="images/chap2-5.gif" /></div></li><li>
<a id="pgfId-1293978"></a>Leave each option to the default selections and click <em>OK</em>.<br />
<a id="pgfId-1081812"></a>The <em>Virtuoso ADE Explorer </em>window is displayed, as shown below.<br /><strong class="webflare-fig-line-height">Figure 2-5
<a id="pgfId-1081813"></a>ADE Explorer Window</strong>
<a id="pgfId-1081817"></a><div class="webflare-div-image">
<img width="671" height="392" src="images/chap2-6.gif" /></div></li></ol>































<h3>
<a id="pgfId-1081819"></a>Choosing Simulator O<a id="Choosing Simulator Options"></a>ptions</h3>

<ol><li>
<a id="pgfId-1081820"></a>Choose <em>Setup &#8211; Simulator </em>in the <em>ADE Explorer</em><br />
<a id="pgfId-1081821"></a>The <em>Choosing Simulator </em>form is displayed.<br /><strong class="webflare-fig-line-height">Figure 2-6
<a id="pgfId-1260511"></a>Choosing Simulator Form</strong>
<a id="pgfId-1260538"></a><div class="webflare-div-image">
<img width="384" height="96" src="images/chap2-7.gif" /></div></li><li>
<a id="pgfId-1260539"></a>Choose <em>spectre</em> from the <em>Simulator</em> drop-down list.</li><li>
<a id="pgfId-1081834"></a>Click <em>OK</em>.</li><li>
<a id="pgfId-1081836"></a>Now, set up the High-Performance Simulation Options, as follows:<br />
<a id="pgfId-1081837"></a>In ADE Explorer, select <em>Setup-High Performance Simulation</em>. The <em>High Performance Simulation Options</em> window is displayed.<br /><strong class="webflare-fig-line-height">Figure 2-7
<a id="pgfId-1081838"></a>High Performance Simulation Options</strong>
<a id="pgfId-1081843"></a><div class="webflare-div-image">
<img width="668" height="635" src="images/chap2-8.gif" /></div>
<a id="pgfId-1081844"></a>In the <em>High Performance Simulation Options</em> window, select <em>APS </em>for <em>Simulation Performance Mode</em>. Note that <em>Auto</em> is selected for <em>Multithreading options. </em>The effect of this is to detect the number of cores on the system (up to 64) and then multi-thread on all the available cores. <br /><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1084274"></a>The bigger the circuit, the more threads you should use. For a small circuit such as this, you may want to set the number of threads to 2. Using 16 threads on a small circuit might actually slow things down because of the overhead associated with multithreading. For more information, refer to the <a actuate="user" class="URL" href="../spectreuser/spectreuserTOC.html#firstpage" show="replace" xml:link="simple">Spectre Classic Simulator, Spectre APS, Spectre X, and Spectre XPS</a>.</div>
<a id="pgfId-1084262"></a>Click <em>OK</em>.</li><li>
<a id="pgfId-1081847"></a>In ADE Explorer, select<em> Outputs &#8211; Save All</em>.<br />
<a id="pgfId-1081848"></a>The <em>Save Options</em> form is displayed.<br /><strong class="webflare-fig-line-height">Figure 2-8
<a id="pgfId-1084440"></a>Save Options Form</strong><div class="webflare-div-image">
<img width="665" height="824" src="images/chap2-9.gif" /></div></li><li>
<a id="pgfId-1084353"></a>In the <em>Select signals to output(save) </em>section, ensure that <em>allpub</em> is selected.<br />
<a id="pgfId-1084359"></a>This is the default selection. This saves all of the node voltages at all levels of the hierarchy, but it does not include the node voltages inside the device models.<br />
<a id="pgfId-1081856"></a>To save the currents, select <em>nonlinear</em> in the <em>Select device currents (currents) </em>section if you just want to save the device currents, or select <em>all</em> if you want to save all the currents in the circuit. </li><li>
<a id="pgfId-1081858"></a>Click <em>OK</em> to close the <em>Save Options</em> form.</li></ol>





























<h4>
<a id="pgfId-1081861"></a>Setting Up Model L<a id="Setting Up Model Libs"></a>ibraries</h4>

<ol><li>
<a id="pgfId-1212329"></a>In <em>ADE Explorer</em>, choose<em> Setup - Simulation Files</em>. The S<em>imulation Files Setup</em> form is displayed.<br /><strong class="webflare-fig-line-height">Figure 2-9
<a id="pgfId-1212330"></a>Simulation Files Setup Form</strong><div class="webflare-div-image">
<img width="670" height="453" src="images/chap2-10.gif" /></div></li><li>
<a id="pgfId-1212335"></a>Verify that the <em>Include Path</em> is set, as shown above, and click <em>OK</em> to close the form. </li><li>
<a id="pgfId-1212326"></a>In <em>ADE Explorer</em>, choose <em>Setup &#8211; Model Libraries.</em><br />
<a id="pgfId-1081869"></a>The <em>Model Library Setup</em> form is displayed. </li><li>
<a id="pgfId-1081870"></a>Type in the name of the model file, as follows:<br /><pre class="webflare-pre-block webflare-courier-new" id="#id1081871">
<a id="pgfId-1081871"></a><code>models/modelsRF.scs</code></pre></li><li>
<a id="pgfId-1081872"></a>Click <em>Add</em>.<br />
<a id="pgfId-1084947"></a>The <em>Model Library Setup</em> form will look like the following:<br /><strong class="webflare-fig-line-height">Figure 2-10
<a id="pgfId-1084951"></a>Model Library Setup</strong><div class="webflare-div-image">
<img width="660" height="283" src="images/chap2-11.gif" /></div></li><li>
<a id="pgfId-1084995"></a>Click <em>OK</em>.</li></ol>



















<h3>
<a id="pgfId-1084997"></a>SP Analysis and Small Signal Gain</h3>

<p>
<a id="pgfId-1212317"></a>The S-Parameter (sp) analysis is the most useful linear small signal analysis for low noise amplifiers. In this section, you will set up an <em>sp</em> analysis by specifying the input and output ports and the range of sweep frequencies.</p>
<p>
<a id="pgfId-1212318"></a>The S-parameter analysis linearizes the circuit about the DC operating point and computes the S-parameters of the circuit taken as an N-port. In the netlist, the port statements define the ports of the circuit. Each active port is turned on sequentially, and a linear small-signal analysis is performed. Spectre converts the response of the circuit at each active port into S-parameters and outputs these parameters. There must be at least one active port statement in the circuit.</p>
<p>
<a id="pgfId-1114044"></a>Three power gain definitions appear in the literature and are commonly used in LNA design.</p>
<p>
<a id="pgfId-1114049"></a>The following gain quantities are valid only for two-port circuits:</p>
<ul><li>
<a id="pgfId-1114040"></a><em>GA</em> (available gain) is the power gain obtained by optimally matching the output of the network.</li><li>
<a id="pgfId-1081885"></a><em>GP</em> (power gain) is the power gain obtained by optimally matching the input of the network.</li><li>
<a id="pgfId-1212310"></a><em>GT</em> (transducer gain) shows the insertion effect of a two-port circuit. This quantity is used in amplifier design.</li></ul>


<p>
<a id="pgfId-1212311"></a>Besides these three gain definitions, there are three additional gain definitions you can use to evaluate the LNA design.</p>
<ul><li>
<a id="pgfId-1081888"></a><em>Gumx</em> (maximum unilateral transducer power gain)</li><li>
<a id="pgfId-1081889"></a><em>Gmax</em> (maximum available gain) shows the transducer power gain when a simultaneous conjugate match exists at both ports.</li><li>
<a id="pgfId-1081890"></a><em>Gmsg</em> (maximum stable gain) shows the gain that can be achieved by resistively loading the two-port such that <code>k = 1</code> and then simultaneously conjugately matching the input and output ports. For conditionally stable two-ports, you can approach the maximum stable gain as you reduce the input and output mismatch. If you attempt a simultaneous conjugate match and <code>k &lt; 1</code>, the two-port oscillates.</li></ul>


<p>
<a id="pgfId-1081891"></a>There are also two gain circles that are helpful to the design of input and output matching networks.</p>
<ul><li>
<a id="pgfId-1081892"></a> <em>GPC</em>: power gain circle</li><li>
<a id="pgfId-1081893"></a> <em>GAC</em>: available gain circle</li></ul>

<p>
<a id="pgfId-1081894"></a>The next steps will walk you through these simulations and measurements.</p>

<h4>
<a id="pgfId-1085075"></a>Editing the Schematic</h4>

<ol><li>
<a id="pgfId-1085076"></a>In the Schematic window, click the RF voltage source. This is the input port to lnaSimple.<br /><strong class="webflare-fig-line-height">Figure 2-11
<a id="pgfId-1081897"></a>RF Voltage Source in lnaSimple</strong><div class="webflare-div-image">
<img width="501" height="317" src="images/chap2-12.gif" /></div>
<a id="pgfId-1081902"></a>Note that when you select the port, the <em>Property Editor</em> populates with the instance properties on the port. Note that the RF port has a <em>Port Number</em> of 1 and input <em>Resistance</em> of 50 Ohms. Leave the <em>Source type</em> parameter set to <code>sine</code> and disable the frequency source in the <em>Design Variables</em> section of ADE Explorer</li><li>
<a id="pgfId-1081903"></a>Next, click the port on the right side of the schematic. This is the output port of lnaSimple. The <em>Property Editor</em> shows the instance properties on the output port.<br /><strong class="webflare-fig-line-height">Figure 2-12
<a id="pgfId-1081904"></a>lnaSimple Output Port</strong><div class="webflare-div-image">
<img width="668" height="306" src="images/chap2-13.gif" /></div>
<a id="pgfId-1081910"></a>Note that the output <em>Port Number</em> is 2 and the reference <em>Resistance</em> (real part of the reference impedance) is 50 Ohms. The <em>Source type</em> is set to <em>dc</em>, as there is no large signal generated on this port.</li></ol>












<h4>
<a id="pgfId-1081912"></a><strong>Setting Design Variables</strong><a id="Setting Design Variables"></a></h4>

<p>
<a id="pgfId-1212301"></a>Perform the following steps to set the design variables to the values required for each simulation. The <em>Design Variables</em> section is located in the Setup pane of the ADE Explorer simulation window:</p>

<p><strong>Figure 2-13
<a id="pgfId-1212302"></a>Design Variables Section of ADE Explorer Window</strong></p>
<div class="webflare-div-image">
<img width="283" height="233" src="images/chap2-14.gif" /></div>
<ol><li>
<a id="pgfId-1212307"></a>Change the design variables <em>frf1</em> and <em>frf2</em> to <code>0</code>. To edit the value, simply click  the value to the right of the variable name, and type in a value. Then press <em>Enter</em>. Setting the input frequency to 0 disables the production of waveforms for the large-signal analyses like tran, pss, and hb (harmonic balance.)<br /><strong class="webflare-fig-line-height">Figure 2-14
<a id="pgfId-1081919"></a>Edited Design Variables Section of ADE Explorer Window</strong><div class="webflare-div-image">
<img width="274" height="99" src="images/chap2-15.gif" /></div>
<a id="pgfId-1081924"></a>The small-signal analysis begins by linearizing the circuit about an operating point. By default, this analysis computes the operating point, if it is not known, or recomputes it if any significant component or circuit parameter has changed. </li><li>
<a id="pgfId-1085316"></a>In the ADE Explorer window, select <em>Analysis - Choose </em>or click  the <em>Choosing Analyses</em> icon (<img width="26" height="24" src="images/chap2-16.gif" /><span>)on the right side of the ADE Explorer window. </span><br />
<a id="pgfId-1085320"></a>The <em>Choosing Analyses</em> form is displayed.<br /><p class="webflare-indent1"><strong>Figure 2-15
<a id="pgfId-1081930"></a>Choosing Analyses Form</strong></p><div class="webflare-div-image">
<img width="632" height="485" src="images/chap2-17.gif" /></div></li><li>
<a id="pgfId-1081935"></a>In the <em>Analysis</em> section, select the <em>sp</em> radio button. The form expands.<br /><strong class="webflare-fig-line-height">Figure 2-16
<a id="pgfId-1081936"></a>sp Choosing Analyses Form</strong><div class="webflare-div-image">
<img width="668" height="823" src="images/chap2-18.gif" /></div></li><li>
<a id="pgfId-1081941"></a>In the <em>Ports</em> section, click <em>Select</em>. Next, click the input (<em>RF</em>) port, followed by the output port (<em>PORT0</em>). When finished with the two selections, press the <em>Esc</em> key. The form and schematic will look like the following:<br /><strong class="webflare-fig-line-height">Figure 2-17
<a id="pgfId-1081942"></a>Choosing Analyses Form with Ports Selected</strong><div class="webflare-div-image">
<img width="668" height="418" src="images/chap2-19.gif" /></div>
<a id="pgfId-1081948"></a>If the list of active ports is specified with in the Ports field, the ports are numbered sequentially from one in the order given. Otherwise, all ports present in the circuit are active, and the port numbers used are those that were assigned on the port statements in the netlist (or in the <em>Edit Properties</em> form).<br />
<a id="pgfId-1081949"></a>Spectre can perform AC/SP analysis while sweeping a parameter. The parameter can be frequency, temperature, component instance parameter, component model parameter, or netlist parameter. If changing a parameter affects the DC operating point, the operating point is recomputed at each step. After the analysis is complete, the modified parameter returns to its original value.<br />
<a id="pgfId-1081950"></a>You can define sweep limits by specifying the end points or the center value and span of the sweep. Steps can be linear or logarithmic, and you can specify the number of steps or the size of each step. If you do not specify a step size parameter, the sweep is linear when the ratio of stop to start values is less than 10 and logarithmic when this ratio is 10 or greater. All frequencies are in Hertz.</li><li>
<a id="pgfId-1081951"></a>You will be sweeping frequency in this simulation. In the <em>Sweep Variable</em> section of the <em>Choosing Analyses</em> form, select <em>Frequency</em> (this is the default value).</li><li>
<a id="pgfId-1081952"></a>In the <em>Sweep Range</em> section, select <em>Start-Stop</em>. Enter 500M in the <em>Start</em> field and 4.0G in the <em>Stop</em> field.</li><li>
<a id="pgfId-1081953"></a>Set <em>Sweep Type </em>to <em>Linear</em>. Select <em>Number of Steps</em> and set that to <em>50</em>. </li><li>
<a id="pgfId-1081954"></a>In the <em>Do Noise</em> field, select <em>yes</em>. This sets up the small signal (linear 2 port) noise analysis. The small signal assumption is valid when the input power level is low (at least 10dB below the 1dB compression point) and the circuit is operating in the linear range.<br />
<a id="pgfId-1081955"></a>When <code>donoise=yes</code> is specified, the noise correlation matrix is computed. If in addition, the output is specified using Output probe (oprobe), the amount that each noise source contributes to the output is computed. Finally, if an input is also specified (iprobe), the two-port noise parameters are computed (F, Fmin, NF, NFmin, Gopt, Bopt, and Rn). When an input port is specified, the two-port noise parameters are computed (F, Fmin, NF, NFmin, Gopt, Bopt, and Rn).</li><li>
<a id="pgfId-1081956"></a>Click <em>Select</em> to the right of <em>Output port </em>and click the output port (PORT0) in the schematic. </li><li>
<a id="pgfId-1229160"></a>Click <em>Select</em> to the right of <em>Input port</em> and click the input port in the schematic (RF). Alternately, you can type <code>/PORT0 </code>in the <em>Output port</em> field and<em> </em><code>/RF </code>in the <em>Input port </em>field.</li><li>
<a id="pgfId-1114950"></a>In the <em>Mode</em> section, select <em>Single-Ended</em>. If you are simulating mixed-mode parameters, select the <em>Mixed In/Out</em><code> </code>option. For more information, see the <a actuate="user" class="URL" href="../spectreuser/spectreuserTOC.html#firstpage" show="replace" xml:link="simple">Spectre Circuit Simulator and Accelerated Parallel Simulator User Guide</a> or type  <code>spectre -h sp</code> at the command prompt<code>.</code></li><li>
<a id="pgfId-1085841"></a>Click <em>OK</em> at the bottom of the form. The <em>Choosing Analyses</em> form will look like the one below.<br /><strong class="webflare-fig-line-height">Figure 2-18
<a id="pgfId-1081960"></a>sp Choosing Analyses Form</strong><div class="webflare-div-image">
<img width="414" height="824" src="images/chap2-20.gif" /></div></li><li>
<a id="pgfId-1081965"></a>Click <em>OK</em>. <br />
<a id="pgfId-1261431"></a>Your ADE Explorer Setup Assistant will look like the following:<br /><strong class="webflare-fig-line-height">Figure 2-19
<a id="pgfId-1261432"></a>ADE Explorer</strong><div class="webflare-div-image">
<img width="668" height="352" src="images/chap2-21.gif" /></div></li></ol>










































<h4>
<a id="pgfId-1212294"></a>Running the Simulation and Plotting the Results</h4>

<p>
<a id="pgfId-1212298"></a>Start the analyses by clicking the green arrow icon <img width="36" height="33" src="images/chap2-22.gif" /><span> in ADE Explorer or in the Schematic Editor.</span></p>

<p>
<a id="pgfId-1212283"></a>This netlists the design and runs the simulation. A SpectreRF status window is displayed (<code>spectre.out</code> log file). When the analysis has completed, you may iconify the status window.</p>
<ol><li>
<a id="pgfId-1212284"></a>In <em>ADE Explorer</em>, select <em>Results - Direct Plot - Main Form</em>. <br /><strong class="webflare-fig-line-height">Figure 2-20
<a id="pgfId-1212272"></a>Invoking the Direct Plot Form</strong><div class="webflare-div-image">
<img width="515" height="199" src="images/chap2-23.gif" /></div>
<a id="pgfId-1261598"></a>The <em>Direct Plot Form</em> is displayed. Alternately, you can click the <em>Direct Plot</em> icon <img width="48" height="40" src="images/chap2-24.gif" /><span> in the Schematic window.</span><br /><p class="webflare-indent1"><strong>Figure 2-21
<a id="pgfId-1229261"></a>sp Direct Plot Form</strong></p><div class="webflare-div-image">
<img width="316" height="613" src="images/chap2-25.gif" /></div></li><li>
<a id="pgfId-1081993"></a>In the <em>Direct Plot Form</em>, leave the <em>Plotting Mode</em> set to <em>Append</em> (this is the default). </li><li>
<a id="pgfId-1081994"></a>In the <em>Function</em> section, select <em>GT</em> (for Transducer Gain). Transducer power gain, <em>GT</em>, is defined as the ratio between the power delivered to the load and the power available from the source. <br /><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1081995"></a>When using the S-parameter <em>Direct Plot Form</em>, the Analog Design Environment assumes that the source (Γ<sub>S</sub>) and load (Γ<sub>L</sub>) reflection coefficients are zero. <em>GT</em>, therefore, plots the insertion gain assuming source and load impedances are matched.</div></li></ol>












<p><strong>(2-1)
<a id="pgfId-1081999"></a><strong>Transducer Gain with Source and Load Impedances Matched</strong></strong></p>
<div class="webflare-div-image">
<img width="660" height="60" src="images/chap2-26.gif" /></div>

<ol><li>
<a id="pgfId-1115399"></a>In the <em>Modifier</em> section, select <em>dB10</em> because you are plotting power.</li><li>
<a id="pgfId-1115400"></a>The sp <em>Direct Plot Form</em> will look like the following:<br /><strong class="webflare-fig-line-height">Figure 2-22
<a id="pgfId-1115401"></a>sp Direct Plot Form</strong><div class="webflare-div-image">
<img width="668" height="556" src="images/chap2-27.gif" /></div></li><li>
<a id="pgfId-1082007"></a>Click <em>Plot</em>. </li><li>
<a id="pgfId-1082008"></a>In the <em>Function</em> section, select <em>GA</em> (for Available Power Gain). Available power gain, <em>GA</em>, is defined as the ratio between the power available from the network and the power available from the source.<br /><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1221172"></a>When you use the S-parameter <em>Direct Plot Form</em>, Γ<sub>S</sub> is set to zero, and therefore available gain (<em>GA</em>) is plotted as:</div></li></ol>









<p><strong>(2-2)
<a id="pgfId-1221173"></a><strong>Available Gain with Ts=0</strong></strong></p>
<div class="webflare-div-image">
<img width="668" height="88" src="images/chap2-28.gif" /></div>

<ol><li>
<a id="pgfId-1082016"></a>Click <em>Plot</em> again. </li><li>
<a id="pgfId-1082017"></a>In the <em>Function</em> section, select <em>GP</em> (for Power Gain). Power Gain is defined as the ratio between the power delivered to the load and the power input to the network.<br /><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1082018"></a>The ADE Explorer environment assumes that Γ<sub>in</sub>=0 (the input is matched) so the equation for power gain (<em>GP</em>) reduces to the equation below:</div></li></ol>



<p><strong>(2-3)
<a id="pgfId-1082022"></a><strong>Power Gain with TL=0</strong>.</strong></p>
<div class="webflare-div-image">
<img width="668" height="73" src="images/chap2-29.gif" /></div>

<ol><li>
<a id="pgfId-1212256"></a>Click <em>Plot</em> once more. All three gains (<em>GT, GA, GP</em>) plots are displayed on one window, as shown below.<br /><strong class="webflare-fig-line-height">Figure 2-23
<a id="pgfId-1082025"></a>Transducer, Available, and Power Gain</strong><div class="webflare-div-image">
<img width="668" height="502" src="images/chap2-30.gif" /></div>
<a id="pgfId-1115592"></a>Note that <em>GT</em> is the smallest gain. Because the power available from the source is greater than the power input to the LNA network, the Power Gain is greater than the Transducer gain (<em>GP</em> &gt; <em>GT</em>). The closer the two gains are, the better the input matching is. Similarly, because the power available from the LNA network is greater than the power delivered to the load , <em>GA</em> &gt; <em>GP</em>. The closer these two gains are, the better the output matching is. The power gain <em>GP</em> is closer to the transducer gain <em>GT</em> than the available gain <em>GA</em> which means the input matching network is properly designed. That is, S11 is close to zero.</li><li>
<a id="pgfId-1082031"></a>In the <em>Direct Plot Form</em>, change the <em>Plot Mode</em> to <em>New SubWin</em> (new subwindow).<br /><strong class="webflare-fig-line-height">Figure 2-24
<a id="pgfId-1082032"></a>Changing Plot Mode to New SubWindow</strong><div class="webflare-div-image">
<img width="668" height="178" src="images/chap2-31.gif" /></div></li><li>
<a id="pgfId-1082037"></a>In the <em>Function</em> section, select <em>Gmax</em> (for maximum Transducer Power Gain) and click <em>Plot</em>. </li><li>
<a id="pgfId-1082038"></a>Change the <em>Plotting Mode</em> to <em>Append</em>. </li><li>
<a id="pgfId-1082039"></a>In the <em>Function</em> section, select <em>Gmsg</em> (for Maximum Stability Gain), and Click <em>Plot</em>. </li><li>
<a id="pgfId-1082040"></a>In the <em>Function</em> section, select <em>Gumx</em> (for maximum Unilateral Transducer Power Gain), and click <em>Plot</em> again.<br />
<a id="pgfId-1082041"></a>The three waveforms are appended to the previous graph, as shown below.<br /><strong class="webflare-fig-line-height">Figure 2-25
<a id="pgfId-1082042"></a>Adding Maximum Available, Maximum Stable, and Maximum Unilateral Gain Plots</strong><div class="webflare-div-image">
<img width="792" height="513" src="images/chap2-32.gif" /></div><ul><li>
<a id="pgfId-1082047"></a>Maximum unilateral transducer power gain (<em>Gumx</em>) is the transducer power gain when you assume that the reverse coupling of the LNA S<sub>12</sub>, is zero, and the source and load impedances are conjugately matched to the LNA. That is S11=Γ<sub>s</sub> and S22= Γ <sub>L</sub></li></ul></li></ol>























<p>
<a id="pgfId-1086960"></a>In the plots above, the maximum unilateral transducer power gain (<em>Gumx)</em> is very close to the maximum transducer power gain (<em>Gmax)</em> which means the reverse coupling S12 is small. The maximum stable gain (<em>Gmsg</em>) is the largest of the six gains plotted.</p>
<ol><li>
<a id="pgfId-1086989"></a>In the ViVA waveform window, choose <em>File -Close All Windows</em> to close the waveform window.</li><li>
<a id="pgfId-1086990"></a>Next, you plot the gain circles. There are two types of gain circles: Power Gain Circles and Available Gain Circles. In the <em>Function</em> section of the <em>Direct Plot Form</em>, select <em>GAC</em> (Available Gain Circles). The form expands.<br /><strong class="webflare-fig-line-height">Figure 2-26
<a id="pgfId-1082054"></a>Direct Plot Form for Available Gain Circles</strong><div class="webflare-div-image">
<img width="668" height="735" src="images/chap2-33.gif" /></div>
<a id="pgfId-1082059"></a><strong>Available Gain Circle (GAC)</strong><br />
<a id="pgfId-1082060"></a>Available Gain (GA) is solely a function of the source reflection coefficient Γ<sub>S</sub> . Thus, you can draw available gain contours on the Smith chart of Γ<sub>S</sub> . The location for the peak of the contour corresponds to Γ<sub>S</sub> producing the maximum available gain (<em>GA</em>). You can move the peak location by changing the design of the input matching network. The best location for the contour peak is at the center of the Smith chart, where Γ<sub>S</sub>=0.</li><li>
<a id="pgfId-1082061"></a>In the <em>Plot Type </em>section, choose<em> Z-Smith</em>. You will be plotting Gain Circles on the Impedance Smith Chart. (<em>Y-Smith </em>plots on the Admittance Smith Chart).</li><li>
<a id="pgfId-1082062"></a>In the <em>Sweep</em> section, you can either choose <em>Gain Level (dB) </em>or<em> Frequency (Hz). </em>In this case, you will be sweeping Gain Level. The Frequency you specify depends on the operating frequency of your design. Since the lnaSimple circuit operates at 900MHz, enter that value in the <em>Frequency (Hz)</em> field. </li><li>
<a id="pgfId-1082063"></a>In the <em>Level Range (dB)</em> section, set <em>Start</em> to 4, <em>Stop</em> to 14, and <em>Step</em> to 2.<br />
<a id="pgfId-1082064"></a>The <em>Direct Plot Form</em> should look like the following:<br /><strong class="webflare-fig-line-height">Figure 2-27
<a id="pgfId-1082065"></a>Direct Plot Form for Plotting Available Gain Circles at a Constant Frequency</strong><div class="webflare-div-image">
<img width="668" height="734" src="images/chap2-34.gif" /></div></li><li>
<a id="pgfId-1082070"></a>Click <em>Plot</em>. The available gain circles are plotted in the waveform window, as shown below.<br /><strong class="webflare-fig-line-height">Figure 2-28
<a id="pgfId-1082071"></a>Available Gain Circles on Z-Smith Chart</strong><div class="webflare-div-image">
<img width="668" height="511" src="images/chap2-35.gif" /></div>
<a id="pgfId-1082076"></a>As you move your cursor around one of the Available Gain Circles, notice that the Tracking Cursor will read out both the Real and Imaginary part or the reflection coefficient directly from the Smith Chart in the <em>Tracking Info</em> section on the left side of the Smith Chart. The impedance or admittance at that point is also shown in the <em>Reference point values</em> section of the Legend.</li><li>
<a id="pgfId-1082077"></a>In the <em>Direct Plot Form</em>, change the <em>Plot Mode</em> to <em>New Window. </em>Next,  plot the Power gain circle (<em>GPC</em>). <br />
<a id="pgfId-1082078"></a>Power Gain (<em>GP</em>) is solely a function of the load reflection coefficient Γ<sub>L</sub>. Thus, you can draw the power gain contours on the Smith chart of Γ<sub>L</sub>. The location for the peak of the contour corresponds to Γ<sub>L</sub> producing the maximum power gain (<em>GP</em>). You can move the peak location by changing the design of the output matching network. The best location for the contour peak is at the center of the Smith chart, where Γ<sub>L</sub>  = 0.</li><li>
<a id="pgfId-1082079"></a>In the sp <em>Direct Plot Form</em>, select<em>GPC</em> in the <em>Function</em> section.</li><li>
<a id="pgfId-1082080"></a>In the <em>Plot Type</em> section, select <em>Z-Smith</em> (it should be the default). You will be plotting Gain Circles on the Impedance Smith Chart.</li><li>
<a id="pgfId-1082081"></a>In the <em>Sweep</em> section, your choices are <em>frequency</em> and <em>Gain Level (dB)</em>. Choose <em>Gain</em> <em>Level (dB)</em>. Since the lnaSimple operates at 900MHz, enter 900M in the <em>Frequency (Hz) </em>field. </li><li>
<a id="pgfId-1082082"></a>In the <em>Gain Level (dB) </em>section, set <em>Start</em> to 4<code>,</code> set <em>Stop</em> to 14<code>, </code>and <em>Step</em> to 2. The <em>Direct Plot Form</em> should look like the following:<br /><strong class="webflare-fig-line-height">Figure 2-29
<a id="pgfId-1082083"></a>Direct Plot Form for Power Gain Circles</strong><div class="webflare-div-image">
<img width="668" height="734" src="images/chap2-36.gif" /></div></li><li>
<a id="pgfId-1082088"></a>Click <em>Plot</em>. The power gain circles are plotted on the Smith Chart, as shown below.<br /><strong class="webflare-fig-line-height">Figure 2-30
<a id="pgfId-1082089"></a>Power Gain Circles</strong><div class="webflare-div-image">
<img width="828" height="518" src="images/chap2-37.gif" /></div></li></ol>




































<p>
<a id="pgfId-1082094"></a>Next, you will look at circuit stability and plot Stability Circles.</p>

<h3>
<a id="pgfId-1082095"></a>Stability</h3>

<p>
<a id="pgfId-1212247"></a>After running an sp analysis, you can plot stability factor and stability circles.</p>
<p>
<a id="pgfId-1212248"></a><em>Kf</em>, the stability factor, is valid for two-port circuits only. Kf is defined as:</p>

<p><strong>Figure 2-31
<a id="pgfId-1212249"></a>Equation for Kf, stability factor</strong></p>
<div class="webflare-div-image">
<img width="668" height="167" src="images/chap2-38.gif" /></div>

<p>
<a id="pgfId-1082104"></a>The above equation is valid for small-signal stability only. Under large signal conditions, the circuit is less likely to be stable. In the presence of feedback paths from the output to the input, the circuit might become unstable for certain combinations of source and load impedances. An LNA design that is normally stable might oscillate at the extremes of the manufacturing or voltage variations, and perhaps at unexpectedly high or low frequencies. When K &gt; 1 and D &lt; 1, the circuit is unconditionally stable. That is, the circuit does not oscillate with any combination of source and load impedances. You should perform the stability evaluation for the S parameters over a wide frequency range to ensure that K remains greater than one at all frequencies.</p>
<ol><li>
<a id="pgfId-1082105"></a>In the <em>Function</em> section of the sp Direct Plot form, select <em>Kf</em>.</li><li>
<a id="pgfId-1082106"></a>Set the <em>Plotting Mode</em> to <em>New Window</em>.<br />
<a id="pgfId-1082107"></a>The sp <em>Direct Plot Form</em> should look like the following:<br /><strong class="webflare-fig-line-height">Figure 2-32
<a id="pgfId-1212238"></a>Plotting Kf from the sp Direct Plot Form</strong><div class="webflare-div-image">
<img width="668" height="488" src="images/chap2-39.gif" /></div></li><li>
<a id="pgfId-1212243"></a>Click <em>Plot</em>.<br />
<a id="pgfId-1212244"></a>The waveform window is displayed, as shown below.<br /><strong class="webflare-fig-line-height">Figure 2-33
<a id="pgfId-1082113"></a>Plotting Stability Factor Kf vs Input Frequency</strong><div class="webflare-div-image">
<img width="668" height="529" src="images/chap2-40.gif" /></div>
<a id="pgfId-1212235"></a>The stability factor <em>Kf i</em>s greater than 1 for all frequencies viewed, indicating that the circuit is stable at these frequencies. As the coupling (S12) decreases (reverse isolation increases), stability improves. You might use techniques, such as resistive loading and neutralization to improve stability for an LNA. <br />
<a id="pgfId-1212231"></a>Next, plot the Stability Circles. </li><li>
<a id="pgfId-1212232"></a>Close the waveform window by choosing <em>File - Close All Windows </em>and go back to the <em>Direct Plot Form</em>. </li><li>
<a id="pgfId-1082121"></a>In the <em>Function</em> section, select <em>LSB</em> (Load Stability Circles). The form changes.</li><li>
<a id="pgfId-1082122"></a>In the <em>Plot Type </em>section, choose<em> Z-Smith </em>(this is the default). You will be plotting Load Stability Circles (<em>LSB</em>) on the Impedance Smith Chart. (<em>Y-Smith </em>plots on the Admittance Smith Chart).</li><li>
<a id="pgfId-1082123"></a>In the <em>Frequency Range (Hz) </em>section, enter <em>Start</em> 500M, <em>Stop</em> 4G, and <em>Step</em> 200M. The <em>Direct Plot</em> form should look like the following:<br /><strong class="webflare-fig-line-height">Figure 2-34
<a id="pgfId-1082124"></a>Direct Plot Form for Plotting Load Stability Circles </strong><div class="webflare-div-image">
<img width="668" height="671" src="images/chap2-41.gif" /></div></li><li>
<a id="pgfId-1082129"></a>Click <em>Plot</em>. The Load Stability Circles are plotted, as shown below.<br /><strong class="webflare-fig-line-height">Figure 2-35
<a id="pgfId-1082130"></a>Load Stability Circles</strong><div class="webflare-div-image">
<img width="668" height="510" src="images/chap2-42.gif" /></div>
<a id="pgfId-1082135"></a>By default, the graph is zoomed out to show all traces. Zoom into the Smith Chart by holding down the right mouse button and dragging a square around the section of the Smith Chart you would like to view. When you release the button, the graph redraws. You can also determine which trace belongs to which frequency by clicking on the <em>+ </em>button to the left of <em>LSB</em> in the upper left section of the graph legend. This is shown in the next figure.<br /><strong class="webflare-fig-line-height">Figure 2-36
<a id="pgfId-1082136"></a>Zoomed in Load Stability Circles</strong><div class="webflare-div-image">
<img width="668" height="493" src="images/chap2-43.gif" /></div>
<a id="pgfId-1082141"></a>Next, you will be plotting the Source Stability Circles.</li><li>
<a id="pgfId-1082142"></a>In the <em>Function</em> section, select <em>SSB</em> (Source Stability Circles). The form changes.</li><li>
<a id="pgfId-1082143"></a>In the <em>Plot Type </em>section, choose<em> Z-Smith</em>. You will be plotting Source Stability Circles on the Impedance Smith Chart.</li><li>
<a id="pgfId-1116639"></a>In the <em>Frequency Range (Hz) </em>section, enter <em>Start</em> 500M, <em>Stop</em> 4G, and <em>Step</em> 200M. The <em>Direct Plot Form</em> should look like the following:<br /><strong class="webflare-fig-line-height">Figure 2-37
<a id="pgfId-1116640"></a>Direct Plot Form for Source Stability Circles</strong><div class="webflare-div-image">
<img width="668" height="670" src="images/chap2-44.gif" /></div></li><li>
<a id="pgfId-1082150"></a>Click Plot. The Source Stability Circles are plotted, as shown below.<br /><strong class="webflare-fig-line-height">Figure 2-38
<a id="pgfId-1082151"></a>Source Stability Circles for lnaSimple</strong><div class="webflare-div-image">
<img width="620" height="493" src="images/chap2-45.gif" /></div>
<a id="pgfId-1082156"></a>By default, the graph is zoomed out to show all traces. Zoom into the Smith Chart by holding down the right mouse button and dragging a square around the section of the Smith Chart you would like to view. When you release the button, the graph redraws. You can also determine which trace belongs to which frequency by clicking on the <em>+</em> button to the left of <em>SSB</em> in the upper left section of the graph legend. This is shown in the next figure.<br /><strong class="webflare-fig-line-height">Figure 2-39
<a id="pgfId-1082157"></a>Zoom in Source Stability Circles</strong><div class="webflare-div-image">
<img width="668" height="503" src="images/chap2-46.gif" /></div>
<a id="pgfId-1212223"></a>When you release the mouse button, the plot redraws, as shown in the next figure.<br /><strong>Figure 2-40
<a id="pgfId-1212224"></a>Zoomed in View of Source Stability Circles</strong>
<a id="pgfId-1082167"></a><div class="webflare-div-image">
<img width="668" height="518" src="images/chap2-47.gif" /></div>
<a id="pgfId-1082168"></a>The source and load stability circles are also useful for checking for LNA stability. The input stability circle draws the circle Γ<sub>out</sub> = 1 out on the Smith chart of Γ<sub>S</sub> . The output stability circle draws the circle Γ<sub>in</sub> = 1 on the Smith chart of Γ<sub>L</sub>.<br />
<a id="pgfId-1212215"></a>The non-stable regions of the two circles should be far away from the center of the Smith chart. In fact, it is better if the non-stable regions are located outside the Smith chart circles. This is the case for both Load and Source Stability circles.</li><li>
<a id="pgfId-1212216"></a>In the ViVA waveform window, select <em>File - Close All Windows</em>. The waveform window closes.</li></ol>



























































<p>
<a id="pgfId-1082171"></a>The next measurement you will make is Noise Figure.</p>

<h3>
<a id="pgfId-1082172"></a>Linear 2-port noise analysis (NF, NFmin) and Noise circles</h3>

<p>
<a id="pgfId-1212204"></a>For cascaded stages, the overall noise figure is mainly determined by the first amplification stage, provided that it has sufficient gain. You achieve low noise performance by carefully selecting the low noise transistor, DC biasing point, and noise-matching at the input. The noise performance is characterized by noise factor, F, which is defined as the ratio between the input signal-to-noise ratio and the output signal-to-noise ratio. For equations to Noise Figure and minimum Noise Figure, see the <h-hot><a actuate="user" class="URL" href="../spectreuser/spectreuserTOC.html#noiseCalc" show="replace" xml:link="simple">Noise Calculations in the Simulator</a></h-hot> section in the Spectre&#174; Circuit Simulator and Accelerated Parallel Simulator RF Analysis User Guide.</p>
<p>
<a id="pgfId-1262655"></a>You have already run the simulation for linear two-port noise as part of the sp analysis. Now, you will plot the results.</p>
<ol><li>
<a id="pgfId-1262656"></a>In the sp <em>Direct Plot Form,</em> select <em>NF </em>in the <em>Function</em> section. The form changes.</li><li>
<a id="pgfId-1262657"></a>In the <em>Modifier</em> section, select <em>dB10</em> to plot Noise Figure. (If you want to plot Noise Factor instead, select <em>Magnitude</em>). The sp <em>Direct Plot Form</em> should look like the figure below.<br /><strong class="webflare-fig-line-height">Figure 2-41
<a id="pgfId-1082176"></a>sp Direct Plot Form for Plotting Noise Figure</strong><div class="webflare-div-image">
<img width="668" height="571" src="images/chap2-48.gif" /></div></li><li>
<a id="pgfId-1082181"></a>Click <em>Plot</em>. The noise figure is plotted, as shown below. <br /><strong class="webflare-fig-line-height">Figure 2-42
<a id="pgfId-1082182"></a>lnaSimple Noise Figure Plot</strong><div class="webflare-div-image">
<img width="668" height="519" src="images/chap2-49.gif" /></div></li><li>
<a id="pgfId-1082187"></a>In the <em>Direct Plot Form</em>, change the <em>Plotting Mode </em>to <em>Append</em>. </li><li>
<a id="pgfId-1082188"></a>In the <em>Function</em> section, select <em>NFmin</em>. You will be plotting minimum noise figure.</li><li>
<a id="pgfId-1082189"></a>Set the <em>Modifier</em> to <em>dB10</em> to plot minimum noise figure. (Leave the modifier at the default value of magnitude to plot minimum noise factor).<br />
<a id="pgfId-1082190"></a>The <em>Direct Plot Form</em> should look like the following figure:<br /><strong class="webflare-fig-line-height">Figure 2-43
<a id="pgfId-1082191"></a>sp Direct Plot Form for Minimum Noise Figure</strong><div class="webflare-div-image">
<img width="668" height="557" src="images/chap2-50.gif" /></div></li><li>
<a id="pgfId-1082196"></a>Click <em>Plot</em> to plot minimum noise figure. The noise figure is plotted, as shown below.<br /><strong class="webflare-fig-line-height">Figure 2-44
<a id="pgfId-1082197"></a>lnaSimple Minimum Noise Figure</strong><div class="webflare-div-image">
<img width="685" height="518" src="images/chap2-51.gif" /></div><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1082202"></a>The y-axis label for Noise Figure and Minimum Noise Figure both show &#8220;Noise Factor (dB)&#8221;. View the legend at the upper left side of the plot. You will see NF dB10 and NFmin dB10. This shows that noise figure (rather than noise factor) is being plotted.</div>
<a id="pgfId-1082203"></a>The Noise Figure plots are at a minimum at the frequency of operation.<br />
<a id="pgfId-1082204"></a>Next you will plot Noise Circles.</li><li>
<a id="pgfId-1082205"></a>In the <em>Direct Plot Form</em>, change the <em>Plotting Mode </em>to <em>New SubWin.</em></li><li>
<a id="pgfId-1082206"></a>In the <em>Function</em> section, select <em>NC</em>. The form changes.</li><li>
<a id="pgfId-1082207"></a>In the <em>Plot Type</em> section, select <em>Z-Smith</em>. This plots the noise circles on the Impedance Smith Chart (Choosing Y-Smith plots the noise circles on the Admittance Smith Chart.)</li><li>
<a id="pgfId-1082208"></a>In the <em>Sweep</em> section, select <em>Noise Level (dB)</em>. You will be plotting circles of constant noise level at a single frequency.</li><li>
<a id="pgfId-1082209"></a>In the <em>Frequency(Hz)</em> field, type 900M. This is the operating frequency of the lnaSimple circuit.</li><li>
<a id="pgfId-1082210"></a>In the Level Range (dB) section, set <em>Start</em> to 4, <em>Stop</em> to 8, and <em>Step</em> to 0.5. The <em>Direct Plot Form</em> should look like the figure below.<br /><strong class="webflare-fig-line-height">Figure 2-45
<a id="pgfId-1082211"></a>Direct Plot Form for Noise Circles</strong><div class="webflare-div-image">
<img width="586" height="729" src="images/chap2-52.gif" /></div></li><li>
<a id="pgfId-1082216"></a>Click <em>Plot</em>. The Noise Circle plot is displayed, as shown below.<br /><strong class="webflare-fig-line-height">Figure 2-46
<a id="pgfId-1082217"></a>Noise Circle Plot</strong><div class="webflare-div-image">
<img width="668" height="484" src="images/chap2-53.gif" /></div>
<a id="pgfId-1212196"></a>The optimum location for the center of the noise circle is at the center of the Smith chart. However, it is hard to center both the available gain circle, GAC, and the noise circle, NC, in the Smith chart. When you design an LNA, plot NC, GAC, and the source stability circle, SSB, together in the same plot. Use this plot to trade-off the gain, noise, and stability for the input matching network design.</li><li>
<a id="pgfId-1082253"></a>Clean up the screen for the next set of measurements.<ol><li>
<a id="pgfId-1082254"></a>Close the <em>Results Display</em> window by choosing <em>Window - Close</em>. </li><li>
<a id="pgfId-1082255"></a>Close the <em>ADE Explorer </em>window by choosing <em>Session - Quit.</em></li><li>
<a id="pgfId-1082257"></a>In the Schematic window, choose <em>File - Close.</em></li></ol></li></ol>

















































<h3>
<a id="pgfId-1082259"></a>Summary</h3>

<p>
<a id="pgfId-1088939"></a><a actuate="user" class="URL" href="../spectreRFinExplorer/Chap3.html" show="replace" xml:link="simple">In this section, you have looked at common measurements made on Low Noise Amplifier circuits, specifically Gain, Stability, and Noise. For other examples of Measurements, see </a><h-hot>Chapter 3: Frequency Domain Analyses: Harmonic Balance</h-hot> in the Virtuoso&#174; Spectre&#174; Circuit Simulator and Accelerated Parallel Simulator RF Analysis User Guide and the LNA Workshop located in the MMSIM hierarchy.</p>
<p>
<a id="pgfId-1082260"></a>In the next section, you will measure the 1dB Compression Point and IP3 using two different methods.</p>

<h3>
<a id="pgfId-1212186"></a>Third-Order Intercept measurement with HB (2 tone HB)</h3>

<p>
<a id="pgfId-1212187"></a>In narrowband circuits, distortion is commonly measured by applying two pure sinusoids with frequencies well within the bandwidth of the circuit (call these frequencies f1 and f2). The harmonics of these two frequencies would be outside the bandwidth of the circuit, however, there are distortion products that fall at the frequencies 2f<sub>1</sub>-f<sub>2,</sub> 2f<sub>2</sub>-f<sub>1</sub>, and so on. These frequencies are within the bandwidth of the circuit and can be used to measure the intermodulation distortion, or IMD, produced by the circuit.</p>
<p>
<a id="pgfId-1088967"></a>IP3 is an important RF specification. The IP3 measurement is defined as the cross point of the power for the 1st order tones, f<sub>1</sub> and f<sub>2</sub>, and the power for the 3rd order tones, 2f<sub>1</sub>−f<sub>2</sub> and 2f<sub>2</sub>−f<sub>1</sub>, on the load.</p>

<p>
<a id="pgfId-1089021"></a> </p>
<div class="webflare-div-image">
<img width="698" height="317" src="images/chap2-54.gif" /></div>

<p>
<a id="pgfId-1089036"></a>Assuming the input amplitudes are equal, the output first order terms will have the same amplitude and the output third order terms will also have the same amplitude.</p>
<p>
<a id="pgfId-1089073"></a>As the first order components grow linearly and the third order components grow cubically, they eventually intersect as the input power level increases.</p>
<p>
<a id="pgfId-1089232"></a>The third order intercept point is where the two output power curves intersect, as shown in the figure below.</p>

<p><strong>Figure 2-47
<a id="pgfId-1089238"></a>1dB Compression Point and IP3 Curves</strong></p>
<div class="webflare-div-image">
<img width="668" height="284" src="images/chap2-55.gif" /></div>

<p>
<a id="pgfId-1089239"></a>SpectreRF provides several different ways of simulating IP3 for a low noise amplifier. You will measure IIP3 (input IP3) using two different ways.</p>
<p>
<a id="pgfId-1212183"></a>The first way is to use hb analysis with two RF tones applied. Generally, the RF power is swept over a range in the small-signal region. Hb is a large-signal simulation that calculates all the harmonics. Because the third-order product is quite small at low-input power, the accuracy of the simulation result must be kept quite high. This usually requires lengthy simulations.</p>
<p>
<a id="pgfId-1082327"></a>The fastest approach is to select Rapid IP3 from the AC analysis. This is the fastest approach but it is limited to small-signal (at least 10dB below the 1dB compression point) IP3 measurements. In a small-signal application, both techniques produce answers typically within 0.1dB of each other.</p>

<h4>
<a id="pgfId-1082328"></a>Opening the lnaSimple LNACircuit in the Schematic Window</h4>

<ol><li>
<a id="pgfId-1082329"></a>In the CIW, choose <em>File &#8211; Open.</em><br />
<a id="pgfId-1082330"></a>The <em>Open File</em> form is displayed.</li><li>
<a id="pgfId-1082331"></a>Choose <em>ExampleLibRF</em> from the <em>Library</em> drop-down list. </li><li>
<a id="pgfId-1082332"></a>Choose <em>lnaSimple</em> from the <em>Cells</em> list box. Leave the rest of the fields at their default values.</li><li>
<a id="pgfId-1082333"></a>The completed <em>Open File</em> form appears like the one below.<br /><strong class="webflare-fig-line-height">Figure 2-48
<a id="pgfId-1082334"></a>Open File Form</strong><div class="webflare-div-image">
<img width="590" height="393" src="images/chap2-56.gif" /></div></li><li>
<a id="pgfId-1082339"></a>Click <em>OK</em>.<br />
<a id="pgfId-1082340"></a>The Schematic window for lnaSimple is displayed.<br /><strong class="webflare-fig-line-height">Figure 2-49
<a id="pgfId-1082341"></a>lnaSimple Schematic</strong><div class="webflare-div-image">
<img width="664" height="418" src="images/chap2-57.gif" /></div></li><li>
<a id="pgfId-1082346"></a>In the Schematic, click on the RF port on the left side of the schematic. <br /><strong class="webflare-fig-line-height">Figure 2-50
<a id="pgfId-1082347"></a>RF Port Selected</strong><div class="webflare-div-image">
<img width="549" height="740" src="images/chap2-58.gif" /></div>
<a id="pgfId-1082352"></a>Note that when you do this, the RF port properties are populated in the <em>Property Editor</em> pane. Examine the input port settings.<ol><li>
<a id="pgfId-1082353"></a><em>Source type</em> <code>sine</code> means generate large signals for the time domain (transient, pss-shooting, qpss-shooting, envlp-shooting, and so on) or frequency domain (HB or envlp-HB) analyses. <br />
<a id="pgfId-1082354"></a>The port can generate one or two large signals. In this example, it is generating two signals. You need to specify a name for all of the large signals. This is done in the <em>Frequency name 1</em> and <em>Frequency name 2</em> property fields. The frequencies are set to a variable name. The value of the variables is set in ADE Explorer. This allows sweeps to be done in the Analog Design Environment. The amplitudes can be set in volts peak or in dBm. In this case, the amplitudes are set to a variable named <em>prf</em>. When the amplitude is set in dBm, the amplitude in volts cannot selected. <br />
<a id="pgfId-1082355"></a>The <em>Display second sinusoid</em> option is a display function only. If there is an entry there and the display option is off, the second waveform will still be generated. To switch to a single input, remove all the entries, or set the amplitude or frequency to zero in the <em>Amplitude</em> field or the <em>Design Variables</em> section of ADE Explorer.<br />
<a id="pgfId-1082356"></a>The amplitude for the small-signal analyses AC and PAC are set in the source. To view the small signal values, scroll down the form to the <em>Display small signal parameter </em>drop-down list and select <em>true</em>. The amplitude for AC and PAC can be either in Volts peak or dBm, but not both at the same time.<br /><strong class="webflare-fig-line-height">Figure 2-51
<a id="pgfId-1082357"></a>RF Port Display small signal parameters.</strong><div class="webflare-div-image">
<img width="361" height="381" src="images/chap2-59.gif" /></div>
<a id="pgfId-1212170"></a>The form expands, as shown below.<br /><strong>Figure 2-52
<a id="pgfId-1212171"></a>Expanded RF Port Display Small Signal Parameters</strong><div class="webflare-div-image">
<img width="341" height="410" src="images/chap2-60.gif" /></div>
<a id="pgfId-1212163"></a>The frequency of these signals will be set in the small-signal setup form in ADE Explorer. The amplitude for PAC can be either in volts peak or in dBm, again with the form not allowing both to be set at the same time. </li></ol></li><li>
<a id="pgfId-1294110"></a>In the Schematic window, choose <em>Launch </em>&#8211; <em>ADE Explorer</em>.</li><li>
<a id="pgfId-1294137"></a>In the <em>Launch ADE Explorer</em> dialog, select <em>Create New View</em>.<br />
<a id="pgfId-1294138"></a>The <em>Create new ADE Explorer view</em> form is displayed.<br /><strong class="webflare-fig-line-height">Figure 2-53
<a id="pgfId-1294139"></a>Create new ADE Explorer view</strong><div class="webflare-div-image">
<img width="613" height="345" src="images/chap2-61.gif" /></div></li><li>
<a id="pgfId-1294111"></a>Leave each option to the default selections and click <em>OK</em>.<br />
<a id="pgfId-1294112"></a>The Virtuoso ADE Explorer window opens.<br /><strong class="webflare-fig-line-height">Figure 2-54
<a id="pgfId-1082371"></a>Analog Design Environment Window</strong><div class="webflare-div-image">
<img width="659" height="442" src="images/chap2-62.gif" /></div></li></ol>












































<h3>
<a id="pgfId-1082377"></a>Choosing Simulator O<a id="Choosing Simulator Options"></a>ptions</h3>

<ol><li>
<a id="pgfId-1263726"></a>Choose <em>Setup &#8211; Simulator </em>in the Virtuoso Analog Design Environment window.<br />
<a id="pgfId-1263727"></a>The <em>Choosing Simulator</em> form is displayed.<br /><strong class="webflare-fig-line-height">Figure 2-55
<a id="pgfId-1263741"></a>Choosing Simulator Form</strong><div class="webflare-div-image">
<img width="365" height="88" src="images/chap2-63.gif" /></div></li><li>
<a id="pgfId-1263728"></a>Choose <em>spectre</em> from the <em>Simulator </em>drop-down list.</li><li>
<a id="pgfId-1263707"></a>Click <em>OK</em>.</li><li>
<a id="pgfId-1263781"></a>Select <em>Setup - High Performance Simulation</em>. The <em>High Performance Simulation Options</em> window is displayed.<br /><strong class="webflare-fig-line-height">Figure 2-56
<a id="pgfId-1082394"></a>High Performance Simulation Options</strong><div class="webflare-div-image">
<img width="668" height="612" src="images/chap2-64.gif" /></div></li><li>
<a id="pgfId-1082400"></a>In the <em>High Performance Simulation Options</em> window, select <em>APS</em> as the <em>Simulation Performance Mode.</em> Note that <em>Auto</em> is selected for <em>Multi Threading</em>. The effect of this is to detect the number of cores on the system (up to 16) and then multi-thread on all the available cores. </li><li>
<a id="pgfId-1082401"></a>Click <em>OK</em>.</li><li>
<a id="pgfId-1082402"></a>In ADE Explorer, select <em>Outputs &#8211; Save All</em>.<br />
<a id="pgfId-1082403"></a>The <em>Save Options</em> form is displayed.<br /><strong class="webflare-fig-line-height">Figure 2-57
<a id="pgfId-1263856"></a>Save Options Form</strong><div class="webflare-div-image">
<img width="645" height="769" src="images/chap2-65.gif" /></div></li><li>
<a id="pgfId-1090010"></a>In the <em>Select signals to output </em>section, ensure that <em>allpub</em> is selected.<br />
<a id="pgfId-1090016"></a>This is the default selection. This saves all the node voltages at all levels of the hierarchy, but it does not include the node voltages inside the device models.</li><li>
<a id="pgfId-1082413"></a>Click <em>OK</em>.</li></ol>
























<h4>
<a id="pgfId-1212157"></a>Setting Up Model L<a id="Setting Up Model Libs"></a>ibraries</h4>

<p>
<a id="pgfId-1212158"></a>In ADE Explorer choose<em> Setup - Simulation Files</em>. </p>
<p>
<a id="pgfId-1212159"></a>The <em>Simulation Files Setup</em> form is displayed.</p>

<p><strong>Figure 2-58
<a id="pgfId-1212160"></a>Simulation Files Setup Form</strong></p>
<div class="webflare-div-image">
<img width="675" height="393" src="images/chap2-66.gif" /></div>

<ol><li>
<a id="pgfId-1082422"></a>Verify that the <em>Include Path</em> is set as shown above and close the form.</li><li>
<a id="pgfId-1264000"></a>Select <em>Setup &#8211; Model Libraries.</em><br />
<a id="pgfId-1264001"></a>The <em>Model Library Setup</em> form is displayed. </li><li>
<a id="pgfId-1264002"></a>In the <em>Model Library File</em> field, type in the name of the model file, as shown below.<br /><pre class="webflare-pre-block webflare-courier-new" id="#id1082426">
<a id="pgfId-1082426"></a><code>models/modelsRF.scs</code></pre></li><li>
<a id="pgfId-1212151"></a>Click <em>Add</em>.<br />
<a id="pgfId-1264005"></a>The <em>Model Library Setup</em> form looks like the following:<br /><strong class="webflare-fig-line-height">Figure 2-59
<a id="pgfId-1264006"></a>Model Library Setup</strong><div class="webflare-div-image">
<img width="668" height="263" src="images/chap2-67.gif" /></div></li><li>
<a id="pgfId-1264011"></a>Click <em>OK</em>.<br />
<a id="pgfId-1212133"></a>Alternately, you can click the <em>Browse</em> button and select the<code> modelsRF.scs</code> model file.</li><li>
<a id="pgfId-1212134"></a>Select <em>Analyses - Choose</em>. Alternately, you can click the <em>Choose Analyses</em> icon <img width="34" height="33" src="images/chap2-68.gif" /><span>.</span><br />
<a id="pgfId-1090233"></a>The <em>Choosing Analyses</em> form is displayed.<br /><p class="webflare-indent1"><strong>Figure 2-60
<a id="pgfId-1082441"></a>Choosing Analyses Form </strong></p><div class="webflare-div-image">
<img width="470" height="502" src="images/chap2-69.gif" /></div></li><li>
<a id="pgfId-1082446"></a>In the Analyses section, select <em>hb</em>. The form expands, as shown below.<br /><strong class="webflare-fig-line-height">Figure 2-61
<a id="pgfId-1082447"></a>hb Choosing Analyses Form</strong><div class="webflare-div-image">
<img width="560" height="821" src="images/chap2-70.gif" /></div>
<a id="pgfId-1212118"></a>Harmonic balance can set the harmonics automatically for the signal that causes the most distortion. This is recommended in the general case. To enable this, select <em>Decide automatically</em> or <em>Yes</em> from the <em>Run Transient? </em>drop-down list in the <em>Transient-Aided Options</em> section. This single action will cause a transient analysis to be run until steady-state is detected, and then from the transient analysis, the number of harmonics for <em>Tone1</em> (when <em>Frequencies</em> is selected) or for the tone that has tstab enabled (when <em>Names</em> is selected).</li><li>
<a id="pgfId-1082453"></a>In the Transient-Aided Options section of the form, select the following<ol><li>
<a id="pgfId-1082454"></a>For <em>Run transient?</em> select <em>Decide automatically</em><code>.</code> (this is the default)<br />
<a id="pgfId-1082455"></a><em>Run transient?</em> will run the large signal using the transient (In SpectreRF, this is called the <em>tstab</em> interval) for a short period of time. At the end of <em>tstab</em>, an FFT is performed, and this is used as the starting point in the harmonic balance analysis. Doing this improves the convergence of hb by giving it a better starting point at the cost of a short transient analysis.</li><li>
<a id="pgfId-1082456"></a>For <em>Stop time (tstab),</em> <em>auto</em> is automatically populated in the field<br />
<a id="pgfId-1082457"></a>When <em>auto</em> is selected for <em>Stop Time</em>, a small number of periods of the large signal is run using the transient analysis. During this time, the signal is checked for steady-state conditions. If steady-state is not reached in the initial number of periods, more periods can be added automatically by the simulator. Using this feature allows an accurate FFT for the starting point in the hb iterations.<br />
<a id="pgfId-1082458"></a>When <em>Run transient? </em>is set to <em>Decide automatically</em>, the <em>Detect Steady State</em> option is checked automatically. When this is set, the simulator stops the transient analysis when steady-state is detected in the <em>tstab</em> interval, runs the FFT, and starts iterating in the frequency domain. Using <em>Decide automatically</em> simplifies the setup for harmonic balance, and produces correct answers from hb without needing to know how to set hb up manually.</li><li>
<a id="pgfId-1082459"></a>For <em>Save Initial Transient Results (saveinit),</em> select <code>yes</code>.<br />
<a id="pgfId-1082460"></a>During the transient-assisted HB simulation, a transient simulation runs before the frequency domain iteration of harmonic balance. The large signal in <em>Tone1</em> is enabled for this measurement. At the end of the <em>tstab</em>, an FFT is run and its result is used as the starting point for the frequency domain iterations<br />
<a id="pgfId-1212110"></a>All the signals are applied and the simulation is done in the frequency domain.Only the signal and its harmonics are calculated. <br /><strong class="webflare-fig-line-height">Figure 2-62
<a id="pgfId-1264204"></a>Transient Assisted Harmonic Balance</strong><div class="webflare-div-image">
<img width="668" height="147" src="images/chap2-71.gif" /></div></li></ol></li><li>
<a id="pgfId-1212115"></a>In the <em>Tones</em> section, select <em>Names</em>. When <em>Names</em> is selected, the <em>Tones</em> portion of the form expands. All the sources in the top-level schematic are read into the form automatically. <br />
<a id="pgfId-1082466"></a>Note that there are two large tones. The frequency names for all large signal tones are automatically populated from the schematic. You viewed the tones earlier when viewing <em>Property Editor </em>for the RF port.<br />
<a id="pgfId-1082467"></a>The frequency values for the frf1 and<code> </code>frf2 tones are set in the <em>Design Variables</em> section of the ADE Explorer, which will be shown later.</li><li>
<a id="pgfId-1082468"></a>Select the<em> frf1 </em>tone in the<em> Tones </em>field. </li><li>
<a id="pgfId-1082469"></a>Set the <em>Mxham</em> value to <code>auto</code> and click <em>Change</em>. <br />
<a id="pgfId-1264234"></a>The form updates. Spectre will choose the appropriate number of harmonics for you.<br /><strong class="webflare-fig-line-height">Figure 2-63
<a id="pgfId-1082470"></a>Tones Section of hb Choosing Analyses Form</strong><div class="webflare-div-image">
<img width="549" height="322" src="images/chap2-72.gif" /></div></li><li>
<a id="pgfId-1264355"></a>When you set harms to <code>auto</code>, leave <em>OvSap</em> (oversample factor) set to the default value of <code>1</code>.</li><li>
<a id="pgfId-1264356"></a>Leave <em>Tstab</em> set to the default value of <em>yes</em>.<br />
<a id="pgfId-1082477"></a>Because you are using auto-tstab, you do not need to set <em>Tstab</em> to yes in the <em>Tones</em> section for one of the large signal tones. The signal with <code>tstab=yes</code> is the signal that is used for transient-assisted harmonic balance. Only one signal can have transient assist, that being the signal with <em>Tstab</em> set to <code>yes</code>.<br /><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1082478"></a>If for some reason you are not using auto-tstab, set <em>tstab</em> to <em>yes</em> on the signal that causes the largest amount of distortion in the system. </div>
<a id="pgfId-1264359"></a>During the tstab interval, a transient analysis is run before the frequency domain iteration of harmonic balance. At the end of the tstab, an FFT is run and its result is used as the starting point for the frequency domain iterations. All the signals are applied and the simulation is performed in the frequency domain. </li><li>
<a id="pgfId-1264362"></a>Leave the <em>Harmonics</em> field set to <em>Default</em>.</li><li>
<a id="pgfId-1082483"></a>In the Accuracy Defaults section, verify that <em>moderate</em><code> is selected</code>. For most normal measurements <em>errpreset</em> should be set to <em>moderate</em>. When you need to measure really small distortions, use <em>conservative</em>.</li><li>
<a id="pgfId-1090965"></a>To set up a sweep analysis, select the <em>Sweep</em> check box and set the value for <em>Sweep</em> to 1 (thi<code>s is the default value).</code></li><li>
<a id="pgfId-1090966"></a>For <em>Frequency Variable?</em> select <em>no</em>. You will be sweeping input power rather than frequency.</li><li>
<a id="pgfId-1082486"></a>Type <code>prf</code> in <em>Variable Name</em>.</li><li>
<a id="pgfId-1082487"></a>In the<em> Sweep Range</em>, type -50 in the <em>Start</em> field and -20 in the <em>Stop</em> field. Typically, you want to choose an input power that is at between 20-40 dB below the 1dB CP.</li><li>
<a id="pgfId-1082488"></a>Select <em>Linear </em>from the<em> Sweep Type section </em>and enter 5 in the <em>Step Size</em> field.</li><li>
<a id="pgfId-1082489"></a>Leave the rest of the form set to the default values. The hb <em>Choosing Analyses</em> Form should look like the following figure:<br /><strong class="webflare-fig-line-height">Figure 2-64
<a id="pgfId-1082490"></a>Choosing Analyses Form for Two Tone Swept HB Analysis</strong><div class="webflare-div-image">
<img width="668" height="802" src="images/chap2-73.gif" /></div></li><li>
<a id="pgfId-1082496"></a>Click <em>Apply</em>.</li><li>
<a id="pgfId-1264530"></a>View the <em>Design Variables</em> section in ADE Explorer. Verify that your <em>frf1</em> and <em>frf2</em> values are <code>900M</code> and <code>920M</code> respectively. Your ADE Explorer window should look like the following:<br /><strong class="webflare-fig-line-height">Figure 2-65
<a id="pgfId-1082500"></a>Analog Design Environment Window</strong><div class="webflare-div-image">
<img width="661" height="380" src="images/chap2-74.gif" /></div></li><li>
<a id="pgfId-1091249"></a>Start the simulation by choosing <em>Simulation - Netlist and Run</em> or by clicking  the green arrow icon <img width="27" height="27" src="images/chap2-75.gif" />
 on the right side of the simulation window.<br />
<a id="pgfId-1212102"></a>This netlists the design and runs the simulation. A SpectreRF status window appears (spectre.out logfile). Note the simulation time in the Spectre output logfile.<br />
<a id="pgfId-1212106"></a><div class="webflare-div-image">
<img width="668" height="98" src="images/chap2-76.gif" /></div></li><li>
<a id="pgfId-1212107"></a>When the analysis has completed, you may iconify the status window.</li><li>
<a id="pgfId-1082510"></a>In ADE Explorer, select <em>Results - Direct Plot - Main Form</em>. <br /><div class="webflare-div-image">
<img width="668" height="195" src="images/chap2-77.gif" /></div>
<a id="pgfId-1082518"></a>Alternately, you can click the <em>Direct Plot</em> icon from the schematic window.<br /><div class="webflare-div-image">
<img width="668" height="193" src="images/chap2-78.gif" /></div></li><li>
<a id="pgfId-1082522"></a>The Direct Plot Form is displayed.<br /><div class="webflare-div-image">
<img width="360" height="797" src="images/chap2-79.gif" /></div></li><li>
<a id="pgfId-1082523"></a>In the <em>Analysis</em> Section, select <em>hb_mt</em><code>.</code> <em>hb_mt.</em> It refers to multitone harmonic balance.</li><li>
<a id="pgfId-1082524"></a>In the <em>Function</em> Section, select <em>I</em><em>PN Curves</em><em>.</em></li><li>
<a id="pgfId-1082525"></a>Select <em>Net (Specify R)</em>. Leave the <em>Resistance</em> set to the default value of <code>50</code>.</li><li>
<a id="pgfId-1082526"></a>Select <em>Variable Sweep (&#8220;prf&#8221;)</em><em> </em>for <em>Circuit Input Power</em>.</li><li>
<a id="pgfId-1082527"></a>Leave <em>Input Power Extrapolation Point (dBm)</em><em> </em>set to the default (first point in the sweep which is -50). The extrapolation point is where the ideal curves and the data are drawn through the same point. Pick an area where the third order curves have a slope of 3. </li><li>
<a id="pgfId-1082528"></a>Select <em>Input Referred IP3.</em></li><li>
<a id="pgfId-1264720"></a><em>Select 3rd from the Order </em>drop-down list.</li><li>
<a id="pgfId-1082529"></a>For the <em>3rd Order Harmonic</em>, select <em>940M</em>.</li><li>
<a id="pgfId-1082530"></a>For the<em> 1st Order Harmonic,</em> select <em>900M</em>. <br />
<a id="pgfId-1082531"></a>Alternately, you can select <em>880M</em> and <em>920M </em>for the third and first order harmonics, respectively.</li><li>
<a id="pgfId-1212094"></a>Select the <em>out1</em> node on the right side of the schematic<br /><strong class="webflare-fig-line-height">Figure 2-66
<a id="pgfId-1212095"></a>Selecting the out1 Net on the lnaSimple Schematic.</strong><div class="webflare-div-image">
<img width="668" height="177" src="images/chap2-80.gif" /></div>
<a id="pgfId-1212091"></a>The IP3 plot is displayed. Note the IP3 readout.<br /><strong>Figure 2-67
<a id="pgfId-1212077"></a>The IP3 Plot</strong><div class="webflare-div-image">
<img width="668" height="538" src="images/chap2-81.gif" /></div><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1212082"></a>If you do not see the IP3 readout, click in the graphics area to deselect the marker, then select and move the <em>Input Referred IP3</em> readout so that it is positioned in the visible area of the graph. </div>
<a id="pgfId-1091851"></a>Intermodulation products increase at rates that are multiples of the fundamentals. In the small-signal region, third order terms increase 3dB per dB.<br />
<a id="pgfId-1082544"></a>In the above plot, you can see that the circuit is operating within the small signal region. The third order curve is following a 3dB/dB slope. Note the IP3 measurement. In the next section, you will compare this to the IP3 measurement using the Rapid IP3 methodology.</li><li>
<a id="pgfId-1082545"></a>In the Waveform window, select <em>File</em><em> - </em><em>Close All Windows</em>.</li><li>
<a id="pgfId-1212068"></a>In ADE Explorer, deselect the hb analysis in the <em>Setup Assistant</em>.<br /><strong class="webflare-fig-line-height">Figure 2-68
<a id="pgfId-1212069"></a>ADE Explorer Setup Assistant</strong><div class="webflare-div-image">
<img width="406" height="130" src="images/chap2-82.gif" /></div></li></ol>


































































































































<h3>
<a id="pgfId-1212065"></a>Measuring IP3 with Rapid IP3</h3>

<ol><li>
<a id="pgfId-1212051"></a>In ADE Explorer select <em>Analyses</em> - <em>Choose</em>.<br />
<a id="pgfId-1082562"></a>The <em>Choosing Analyses</em> form is displayed.<br /><strong class="webflare-fig-line-height">Figure 2-69
<a id="pgfId-1082566"></a>Choosing Analyses Form</strong><div class="webflare-div-image">
<img width="668" height="761" src="images/chap2-83.gif" /></div></li><li>
<a id="pgfId-1092113"></a>Select <em>ac</em> from the <em>Analysis</em> section.</li><li>
<a id="pgfId-1092114"></a>At the bottom of the form, set <em>Specialized Analysis</em> to <em>Rapid IP3</em><code>.</code> The form expands.</li><li>
<a id="pgfId-1092115"></a>Select <em>port</em> for <em>Source Type</em>.</li><li>
<a id="pgfId-1082569"></a>Select the<em> Input Sources 1</em> field.</li><li>
<a id="pgfId-1082570"></a>Click the <em>Select</em> button just above that field.</li><li>
<a id="pgfId-1082571"></a>Select the Port source /RF at the left of the schematic.<br /><strong class="webflare-fig-line-height">Figure 2-70
<a id="pgfId-1082572"></a>Select Input Port</strong><div class="webflare-div-image">
<img width="668" height="179" src="images/chap2-84.gif" /></div></li><li>
<a id="pgfId-1082577"></a>Press the &lt;Esc&gt; key.</li><li>
<a id="pgfId-1082578"></a>Type 900M in the <em>Freq</em> field to the right of <em>Input Sources 1</em>.</li><li>
<a id="pgfId-1082579"></a>Type <em>/RF</em> in the <em>Input Sources 2</em> field. (Alternately, you could select the RF port in the schematic by first clicking the <em>Select</em> button and then selecting the RF source in the schematic).</li><li>
<a id="pgfId-1082580"></a>Type 920M in the <em>Freq</em> field the to the right of <em>Input Sources 2</em>.</li><li>
<a id="pgfId-1082581"></a>Type -50 in the I<em>nput Power (dBm)</em> field.</li><li>
<a id="pgfId-1082582"></a>Type 940M in the <em>Frequency of IM Output Signal</em> field.</li><li>
<a id="pgfId-1082583"></a>Type 900M in the <em>Frequency of Linear Output Signal</em> field.</li><li>
<a id="pgfId-1082584"></a>Type <em>/out1</em> in the <em>Out+</em> field. Because you are leaving the <em>Out-</em> field blank, it will default to ground.</li><li>
<a id="pgfId-1082585"></a>Leave the rest of the form at their default values. The <em>Choosing Analyses</em> form should look like the following: <br /><strong class="webflare-fig-line-height">Figure 2-71
<a id="pgfId-1082589"></a>Rapid IP3 AC Analysis Form</strong><div class="webflare-div-image">
<img width="668" height="790" src="images/chap2-85.gif" /></div></li><li>
<a id="pgfId-1082590"></a>Click <em>OK</em>.</li><li>
<a id="pgfId-1082591"></a>Start the simulation by choosing <em>Simulation - Netlist and Run</em> or by clicking  the green arrow icon <img width="18" height="18" src="images/chap2-86.gif" />
 on the right side of the simulation window. <br />
<a id="pgfId-1092392"></a>This netlists the design and runs the simulation. A SpectreRF status window appears (spectre.out logfile). Note the simulation time in the Spectre output logfile.<br />
<a id="pgfId-1092404"></a><div class="webflare-div-image">
<img width="668" height="276" src="images/chap2-87.gif" /></div>
<a id="pgfId-1265054"></a>Note that the simulation time is faster than using two tone hb analysis to simulate rapid IP3.</li><li>
<a id="pgfId-1082600"></a>When the analysis has completed, you may iconify the status window.</li><li>
<a id="pgfId-1082601"></a>In ADE Explorer, select <em>Results - Direct Plot - Main Form</em>. Alternately, you can press the <em>Direct Plot </em>icon from the schematic window.<br />
<a id="pgfId-1082611"></a>The <em>Direct Plot Form</em> is displayed.<br /><strong class="webflare-fig-line-height">Figure 2-72
<a id="pgfId-1082615"></a>AC Direct Plot Form</strong><div class="webflare-div-image">
<img width="668" height="443" src="images/chap2-88.gif" /></div></li><li>
<a id="pgfId-1092579"></a>In the <em>Direct Plot Form</em>, select <em>Rapid IP3</em>. The form changes.<br /><strong class="webflare-fig-line-height">Figure 2-73
<a id="pgfId-1092583"></a>AC Direct Plot Form - Rapid IP3</strong><div class="webflare-div-image">
<img width="668" height="372" src="images/chap2-89.gif" /></div></li><li>
<a id="pgfId-1092584"></a>Leave the rest of the form at the default values. Click <em>Plot</em>. The IP3 plot is displayed.<br /><strong class="webflare-fig-line-height">Figure 2-74
<a id="pgfId-1082622"></a>IP3 Plot Using Rapid IP3</strong><div class="webflare-div-image">
<img width="667" height="568" src="images/chap2-90.gif" /></div></li></ol>























































<p>
<a id="pgfId-1082628"></a>Note that the value of Rapid IP3 (2.36dBm) is very close to that measured by two toned hb analysis (2.30dBm). Although simulating using both methods was relatively quick, rapid IP3 was faster.</p>
<p>
<a id="pgfId-1082630"></a>In this section you measured IP3 on a low noise amplifier using two methods: two tone harmonic balance and rapid IP3 using AC analysis. Both gave good accuracy but rapid IP3 was faster. </p>

<h3>
<a id="pgfId-1082632"></a>Summary</h3>

<p>
<a id="pgfId-1082633"></a>The LNA section of Appendix A shows how to simulate and make typical measurements on a low noise amplifier</p>
<p>
<a id="pgfId-1082634"></a>In the LNA section, the following measurements were shown:</p>
<ul><li>
<a id="pgfId-1082635"></a>S-Parameter Analysis, Gain</li><li>
<a id="pgfId-1082636"></a>Stability, Stability Circles</li><li>
<a id="pgfId-1082637"></a>Linear 2 port Noise Figure measurements, Noise Circles</li><li>
<a id="pgfId-1082638"></a>Third Order Intercept measurement using 2 tone harmonic balance</li><li>
<a id="pgfId-1082639"></a>Rapid IP3 using specialized ac analysis</li></ul>




<p>
<a id="pgfId-1082640"></a>For more information on simulating low noise amplifiers, please refer to the chapters in the <em>Virtuoso Spectre Circuit Simulator and Accelerated Parallel Simulator RF Analysis User Guide</em> and the <em><a actuate="user" class="URL" href="../spectreRFTheory/chap1.html#firstpage" show="replace" xml:link="simple">Spectre Circuit Simulator RF Analysis Theory</a></em> guide.</p>

<br /><a href="#pagetop">Return to top</a><br /></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="DesignWorkshop.html" id="prev" title="Introduction">Introduction</a></em></b><b><em><a href="chap3.html" id="nex" title="Simulating Oscillators">Simulating Oscillators</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2020, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
</body></html>