
<html><head><title>Basic Reference Information</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="jommy" />
<meta name="CreateDate" content="2020-02-25" />
<meta name="CreateTime" content="1582698047" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes the theory underpinning Virtuoso Spectre Circuit Simulator RF Analysis (Spectre RF)." />
<meta name="DocTitle" content="Spectre Circuit Simulator RF Analysis Theory" />
<meta name="DocType" content="Reference" />
<meta name="FileTitle" content="Basic Reference Information" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-3.1" />
<meta name="Keyword" content="spectreRFTheory" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2020-02-25" />
<meta name="ModifiedTime" content="1582698047" />
<meta name="NextFile" content="chap2.html" />
<meta name="Group" content="SpectreRF" />
<meta name="Platform" content="Custom IC Design" />
<meta name="PrevFile" content="preface.html" />
<meta name="Product" content="Spectre" />
<meta name="ProductFamily" content="Spectre" />
<meta name="ProductVersion" content="19.1" />
<meta name="RightsManagement" content="Copyright 2012-2020 Cadence Design Systems Inc." />
<meta name="Title" content="Spectre Circuit Simulator RF Analysis Theory -- Basic Reference Information" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="product_feature" content="" />
<meta name="product_subfeature" content="" />
<meta name="Version" content="19.1" />
<meta name="SpaceKey" content="spectreRFTheory191" />
<meta name="webflare-version" content="1.5" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" /></head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="spectreRFTheoryTOC.html">Contents</a></li><li><a class="prev" href="preface.html" title="Preface">Preface</a></li><li style="float: right;"><a class="viewPrint" href="spectreRFTheory.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="chap2.html" title="The Spectre RF Analyses">The Spectre RF Analyses</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Spectre Circuit Simulator RF Analysis Theory<br />Product Version 19.1, January 2020</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;"><a name="#firstpage"></a>

<h1>1
<a id="pgfId-428099"></a><a id="marker-451721"></a></h1>
<h1>
<a id="pgfId-1020886"></a><hr />
Basic Reference Information<hr />
</h1>

<p>
<a id="pgfId-1032001"></a>Spectre<sup>&#174; </sup>circuit simulator RF analysis (Spectre RF) adds capabilities to the Spectre circuit simulator (Spectre) that are particularly useful to analog and RF designers, including the ability to</p>
<ul><li>
<a id="pgfId-1023878"></a>Efficiently and directly compute a steady-state solution</li><li>
<a id="pgfId-1047978"></a>Characterize circuits that translate frequency</li></ul>

<p>
<a id="pgfId-1047979"></a>You can use Spectre RF simulation in combination with both the accurate Fourier analysis capability of Spectre and the Verilog<sup>&#174;</sup>-A behavioral modeling language to simulate RF circuits. This book describes the theory of operation of Spectre RF simulation.</p>
<p>
<a id="pgfId-1015535"></a>Spectre RF simulation brings many concepts to the Spectre simulator.</p>
<ul><li>
<a id="pgfId-1044390"></a><a id="PSS"></a>Periodic Steady-State analysis &#8212; PSS (a large-signal analysis)</li><li>
<a id="pgfId-1023424"></a>Periodic Small-Signal analyses &#8212; PAC, PSP, PXF, and Pnoise</li><li>
<a id="pgfId-1044384"></a><a id="QPSS"></a>Quasi-Periodic Steady-State analysis &#8212; QPSS (a large-signal analysis previously called pdisto analysis)</li><li>
<a id="pgfId-1023886"></a>Quasi-Periodic Small-Signal analyses&#8212;QPAC, QPSP, QPXF, and QPnoise</li><li>
<a id="pgfId-1044378"></a><a id="ENVLP"></a>Envelope analysis</li><li>
<a id="pgfId-1026283"></a>The Harmonic Balance simulation engine</li></ul>






<h2>
<a id="pgfId-1023413"></a>Periodic Analyses</h2>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1054239"></a>Modulated periodic noise, time domain noise and jitter analyses have been deprecated. For more information on the current use model of periodic noise, refer to the <em><a actuate="user" class="URL" href="../spectreRFinExplorer/Chap4.html" show="replace" xml:link="simple">Spectre Circuit Simulator and Accelerated Parallel Simulator RF Analysis in ADE Explorer User Guide</a></em>.</div>
<p>
<a id="pgfId-1026240"></a><strong><em>Periodic Steady-State (PSS) analysis</em></strong> is a large-signal analysis that directly computes the periodic steady-state response of a circuit with a simulation time that is independent of the time constants of the circuit. PSS quickly computes the steady-state response of circuits that exhibit extremely long time constants, such as high-Q filters and oscillators.</p>
<p>
<a id="pgfId-1015536"></a><strong><em>Periodic Small-Signal (PAC, PSP, PXF, Pnoise and PSTB) analyses</em></strong> are similar to the conventional small-signal analyses (AC, SP, XF, Noise and STB) but you can apply them to periodic circuits where frequency conversion plays a critical role. The conventional small-signal analyses (AC, SP, XF, Noise and STB) linearize about the DC or time-invariant operating point and they do not include frequency conversion effects.</p>
<p>
<a id="pgfId-1026284"></a>After a PSS analysis, the circuit is linearized about a periodic (time varying) operating point with frequency conversion effects included. After the PSS analysis, you can perform one or more of the periodic small-signal analyses. Example circuits where you might use the periodic small-signal analyses include conversion gain in mixers, noise in oscillators, and switched-capacitor filters.</p>

<h2>
<a id="pgfId-1026243"></a>Quasi-Periodic Analyses</h2>

<p>
<a id="pgfId-1026241"></a><strong><em>Quasi-Periodic Steady-State (QPSS) analysis</em></strong> is a large signal analysis you can use for circuits with multiple large tones. QPSS analysis computes the steady-state responses of a circuit driven by two or more signals at unrelated frequencies. You select one sinusoidal or pulse signal as the large signal. Any additional signals, called moderate signals, must be sinusoids.</p>
<p>
<a id="pgfId-1026815"></a><strong><em>Quasi-Periodic Small-Signal (QPAC, QPSP, QPXF, and QPnoise) analyses</em></strong> are similar to the periodic small-signal analyses (PAC, PSP, PXF, and Pnoise) but they extend to circuits where frequency conversion and intermodulation effects both play a critical role.</p>
<p>
<a id="pgfId-1026816"></a>After a QPSS analysis to determine the quasi-periodic operating point and to linearize the circuit about the quasi-periodic operating point, you can perform one or more of the quasi-periodic small-signal analyses. It is the quasi-periodically time-varying nature of the linearized circuit that accounts for the frequency conversion and intermodulation. Example circuits where you might use the quasi-periodic small-signal analyses include conversion gain in mixers, noise in oscillators, switched-capacitor filters and other periodically or quasi-periodically driven circuits.</p>

<h2>
<a id="pgfId-1026250"></a>Envelope Analysis</h2>

<p>
<a id="pgfId-1026248"></a><strong><em>Envelope analysis</em></strong> allows RF circuit designers to efficiently and accurately predict the envelope transient response of the RF circuits used in communication systems.</p>

<h2>
<a id="pgfId-1031375"></a>The Simulation Engines</h2>

<p>
<a id="pgfId-1037538"></a>Spectre RF provides a choice of simulation engines between the <em>shooting method</em> and the <em>harmonic balance</em> <em>method</em> (HB) with most analyses. The harmonic balance engine complements the capabilities of the shooting method.</p>

<h3>
<a id="pgfId-1037539"></a>Harmonic Balance (HB) Engine</h3>

<p>
<a id="pgfId-1031703"></a>The harmonic balance engine supports frequency domain harmonic balance analyses. It provides efficient and robust simulation for linear and weakly nonlinear circuits. The harmonic balance engine is supported on the Solaris, Linux, HP and IBM platforms for both 32 and 64 bit architectures. See <a href="chap1.html#80688">&#8220;The Harmonic Balance Engine&#8221;</a> for more information on this simulation engine.</p>

<h3>
<a id="pgfId-1026271"></a>Time Domain (TD) Engine</h3>

<p>
<a id="pgfId-1026359"></a>The Spectre RF simulator has traditionally used an engine known as the shooting method [kundert90] to implement periodic and quasi-periodic analyses and the envelope analysis. The shooting method is a time domain method and it is used in most descriptions and examples in this manual.</p>

<h2>
<a id="pgfId-1015538"></a>Periodic Steady-State Analysis</h2>

<p>
<a id="pgfId-1015539"></a>Periodic Steady-State (PSS) analysis directly computes the periodic steady-state response of a circuit. Spectre RF simulation has traditionally used an engine known as the shooting method [kundert90] to implement PSS analysis. Now, Spectre RF supports a choice of simulation engines between the shooting method and the harmonic balance method. See <a href="chap1.html#80688">&#8220;The Harmonic Balance Engine&#8221;</a> for more information.</p>

<h3>
<a id="pgfId-1031746"></a>The Shooting Method</h3>

<p>
<a id="pgfId-1026307"></a>The shooting method is used in the majority of examples in this manual. The shooting method is a time domain method that operates by efficiently finding an initial condition that directly results in steady state, as illustrated in Figure <h-hot>1-1</h-hot>.</p>

<p><strong>Figure 1-1
<a id="pgfId-1023976"></a><a id="19612"></a>The Shooting Method</strong></p>
<p>
<a id="pgfId-1039634"></a></p>
<div class="webflare-div-image">
<img src="images/ShootingMethod.gif" /></div>

<p>
<a id="pgfId-1023440"></a>The shooting method is an iterative method that begins with an estimation of the desired initial condition. The shooting method computes the initial condition that results in the signals being periodic as defined by <em>
v</em>
<sub><em>f</em></sub>  &#8211; <em>
v</em>
<sub><em>i</em></sub> = Δ<em>
v</em>
 = 0. The circuit is evaluated for one period starting from the initial condition. The final state (vf) of the circuit is computed along with the sensitivity of the final state with respect to the initial state (∂¹¹vf / ∂vi). The nonperiodicity (Δv = vf &#8211; vi) and the sensitivities are used to compute a new initial condition. If the final state is a linear function of the initial state, then the new initial condition directly results in periodicity. Otherwise, additional iterations are needed.</p>
<p>
<a id="pgfId-1015566"></a>Shooting methods require few iterations if the final state of the circuit after one period is a near-linear function of the initial state. This is generally true even for circuits that react in a strongly nonlinear fashion to large stimuli (such as the clock or local oscillator) applied to the circuit. Because the circuit is assumed to be periodic over the shooting interval, then the stimulus must also be periodic over that same period. The shooting method integrates over a whole number of periods of the stimulus, which minimizes the nonlinearity in the relationship between the initial and final state and minimizes the number of iterations needed for convergence. Typically, shooting methods need about five iterations on an average circuit and have little difficulty with the strongly nonlinear behavior that occurs within the shooting interval. This is a strength of shooting methods over other steady-state methods such as harmonic balance [kundert90]. See <a href="chap1.html#80688">&#8220;The Harmonic Balance Engine&#8221;</a> for information on the Spectre RF harmonic balance engine.</p>
<p>
<a id="pgfId-1015567"></a>One reason why shooting methods are not commonly used is that they can become quite slow on larger problems. Shooting methods form a full <em>N × N</em> sensitivity matrix, where <em>N</em> is the number of equations needed to represent the circuit. During the course of the algorithm, this matrix must be inverted. This requires <em>N </em>3 operations. For a large circuit, doubling the size of the circuit increases the simulation time by 8. The cubic rise in computational complexity as a function of circuit size makes this algorithm impractical for larger circuits.</p>
<p>
<a id="pgfId-1023463"></a>Spectre RF simulation uses proprietary algorithms that eliminate the superlinear rise in computation time with problem size [telichevesky95]. Typically, the time required to directly compute the periodic steady-state response of a circuit is about the same as the time required to compute 4 to 5 periods of the circuit&#8217;s transient response. As a result, the PSS analysis is capable of directly finding the periodic steady state of very large circuits.</p>

<h3>
<a id="pgfId-1015568"></a>Distributed Components and Hidden State in PSS Analysis</h3>

<p>
<a id="pgfId-1026500"></a>PSS analysis does not support distributed components or components with hidden state. The difficulty with distributed components results from the fact that the state of a distributed component is a waveform, not a simple number, as with capacitors and inductors. To know the state of a distributed component, it is necessary to know the voltage and current along the whole length of the component. The sensitivity of the final state with respect to the initial state would be an infinite dimensional matrix. All of this greatly complicates the shooting method. This limitation prevents the use of ideal delays, transmission lines, microstrip lines, and nports with the PSS analysis.</p>
<p>
<a id="pgfId-1026505"></a>The Transmission Line Modeler (LMG), which is available with Spectre RF, generates transmission line models that you can use in Spectre RF simulations. See the <em><a actuate="user" class="URL" href="../spectreRFinExplorer/spectreRFinExplorerTOC.html#firstpage" show="replace" xml:link="simple">Spectre Circuit Simulator and Accelerated Parallel Simulator RF Analysis in ADE Explorer User Guide</a></em> for more information.</p>
<p>
<a id="pgfId-1015569"></a>The problem of components with hidden state results more from practical difficulties than from computational difficulties. Some components have an internal state that is hidden from the PSS analysis. Because the PSS analysis cannot access this hidden state, it cannot set it at the beginning of the period, nor can it compute the sensitivity of the final state to the initial state. Components that contain hidden state include the z-blocks and some components described using the Verilog-A<sup>&#174;</sup> behavioral modeling language. Components described in the Verilog-A language that use values computed from a previous time step and saved in local variables to affect the behavior at a later time step are said to have hidden internal state. (Conversely, there is no problem if the only state is that held on internal or external nodes using the <em>integ</em> and <em>dot</em> operators.) You cannot use Verilog-A language components that use internal hidden state with the PSS analysis.</p>

<h3>
<a id="pgfId-1015570"></a>Fundamental Assumptions for PSS Analysis</h3>

<p>
<a id="pgfId-1015571"></a>There are two fundamental assumptions that apply to PSS analysis</p>
<ul><li>
<a id="pgfId-1023467"></a>Periodicity</li><li>
<a id="pgfId-1023468"></a>Linearity</li></ul>

<p>
<a id="pgfId-1023466"></a>Understanding these two assumptions and their consequences allows you to anticipate whether you can apply PSS successfully to your problem.</p>

<h4>
<a id="pgfId-1015572"></a>Periodicity Assumption</h4>

<p>
<a id="pgfId-1015573"></a>PSS analysis assumes that during the shooting interval, all stimuli are periodic and that the circuit supports a <em>T</em>-periodic response, where <em>T</em> is the period specified for the PSS analysis. If the circuit is driven with more than one periodic stimulus, then the frequencies must all be commensurate or co-periodic, and <em>T</em> must be the common period or some integer multiple of the common period. Efficiency of the simulation drops when the <em>T</em> is long compared to the periods of the stimuli.</p>
<p>
<a id="pgfId-1015574"></a>In rare cases, circuits with a periodic stimulus generate subharmonics, which PSS can handle if you set the period to be that of the subharmonic. In other cases, periodically driven circuits respond chaotically, such as do delta-sigma modulators. In this case, you must use transient analysis rather than PSS analysis.</p>
<p>
<a id="pgfId-1015575"></a>If the period <em>T</em> used by PSS is not an integral multiple of the period specified for each <em>built</em>-<em>in</em> time-varying independent source present in the circuit, the simulator issues a warning message and skips the PSS analysis. If you use the Verilog-A language to describe independent sources, then <em>you</em> must ensure that sources are co-periodic with the analysis period <em>T</em>. Failure to do so generally prevents PSS analysis from converging, although PSS analysis rarely converges to an incorrect result.</p>
<p>
<a id="pgfId-1015576"></a>If the circuit is driven by <em>T</em>-periodic stimuli but does not have a <em>T</em>-periodic solution (for example, if the solution is chaotic), PSS analysis fails to converge. In this case, you should use transient analysis to simulate the circuit. Occasionally a circuit generates subharmonics, as is the case with frequency dividers. In this situation, you should specify the PSS period to be equal to that of the subharmonics.</p>
<p>
<a id="pgfId-1015577"></a>If PSS analysis fails to converge because the circuit does not have a <em>T</em>-periodic solution (which might result if the circuit is not driven by<em> T</em>-periodic stimuli), it is considered a user error, so you are responsible for finding and fixing the problem.</p>

<h4>
<a id="pgfId-1015578"></a>Linearity Assumption</h4>

<p>
<a id="pgfId-1015579"></a>In the circuit under simulation, the relationship between the initial and final points over the shooting interval should be near-linear. The more nonlinear the relationship between initial and final points, the greater number of iterations needed by the PSS analysis, which causes the PSS analysis to take longer. If the relationship is sufficiently nonlinear, PSS analysis might not converge.</p>
<p>
<a id="pgfId-1023991"></a>If convergence is achieved, then there are no further consequences (no degradation of accuracy). Failing to converge in this situation is considered a failure of the simulator and should be reported to Cadence. (Send a description of the problem along with the input files [netlist, Verilog-A files, model files] and the log file to <code>spectrerf@cadence.com</code>). Occasionally delaying the starting time of the shooting interval can improve convergence. Arrange for the shooting interval to start at a time when signals are quiescent or changing slowly.</p>

<h2>
<a id="pgfId-1015581"></a>Periodic Small-Signal Analyses</h2>

<p>
<a id="pgfId-1015582"></a>The conventional Spectre small-signal analyses (AC, SP, XF, and Noise) are useful for characterizing a wide variety of analog circuits [kundert95]. For example, you can use them to determine the frequency response, input and output impedances, loop gain characteristics, and supply rejection of circuits such as amplifiers and filters.</p>
<p>
<a id="pgfId-1023469"></a>However, from an RF perspective, an important shortcoming of the Spectre small-signal analyses is that you cannot apply them to circuits that strongly exhibit frequency translation, either as a desired or inadvertent consequence of the design of the circuit. Commonly, you find these circuits in both analog and RF designs.</p>
<ul><li>
<a id="pgfId-1023996"></a>Circuits designed to translate from one frequency to another include<ul><li>
<a id="pgfId-1024012"></a>mixers</li><li>
<a id="pgfId-1024016"></a>detectors</li><li>
<a id="pgfId-1024017"></a>samplers</li><li>
<a id="pgfId-1048319"></a>frequency multipliers</li><li>
<a id="pgfId-1048320"></a>phase-locked loops</li><li>
<a id="pgfId-1048321"></a>parametric oscillators</li></ul><br />
<a id="pgfId-1024013"></a>Such circuits are commonly found in wireless communication systems.</li><li>
<a id="pgfId-1024014"></a>Circuits that translate energy between frequencies as a side effect include<ul><li>
<a id="pgfId-1024015"></a>oscillators</li><li>
<a id="pgfId-1024025"></a>switched-capacitor and switched-current filters</li><li>
<a id="pgfId-1024026"></a>chopper-stabilized and parametric amplifiers</li><li>
<a id="pgfId-1024027"></a>sample-and-hold circuits</li></ul></li></ul>












<p>
<a id="pgfId-1015583"></a>You cannot simulate any of the circuits listed in the previous paragraphs with conventional small-signal analyses because they exhibit a nonnegligible amount of frequency translation. The conventional analyses begin by linearizing the circuit about a quiescent operating point (the DC solution). A linear time-invariant model of the circuit is then constructed by the small-signal analyses and the steady-state solution is computed using phasor analysis. These conventional analyses cannot handle frequency translation because they analyze a linear time-invariant representation of the circuit, and linear time-invariant networks do not exhibit frequency translation.</p>
<p>
<a id="pgfId-1015584"></a>Spectre RF simulation provides the <em>periodic small-signal analyses</em>: PAC, PSP, PXF, and Pnoise [telichevesky96b]. These analyses start by linearizing the circuit about the <em>periodically time-varying operating point</em> computed by a preceding PSS analysis. A periodically time-varying circuit does exhibit frequency translation, so the periodic small-signal analyses can accurately model frequency translation effects. Instead of using conventional small-signal analyses on amplifiers and filters, you can now make measurements on periodic circuits that exhibit frequency translation using the periodic small-signal analyses.</p>
<p>
<a id="pgfId-1015585"></a>Applying a periodic small-signal analysis is a two-step process.</p>
<ul><li>
<a id="pgfId-1024040"></a>First, the small input or noise signals are ignored and a PSS analysis computes the periodic steady-state response to the remaining large signals (such as the clock or the LO).<br />
<a id="pgfId-1024041"></a>During the course of the PSS analysis, the circuit is linearized about the periodic large-signal operating point.</li><li>
<a id="pgfId-1023498"></a>Then the subsequent periodic small-signal analyses use this periodic operating point to predict the response of the circuit to a small sinusoid at an arbitrary frequency. After you know the periodic large-signal operating point, you can perform any number of periodic small-signal analyses.</li></ul>


<p>
<a id="pgfId-1023499"></a>For the two-step process of applying the periodic small-signal analyses to be accurate, the input signals applied in the second step must be small enough so that the circuit does not respond to these signals in a nonlinear fashion in any significant way. This is not true of the signals applied in the first step. The only restriction on the large signals used in the initial PSS analysis is that they must be periodic.</p>
<p>
<a id="pgfId-1023502"></a>This two-step process is widely applicable because most circuits that translate frequency are designed to react in a strongly nonlinear manner to one stimulus (the LO or the clock), while at the same time they react in a nearly linear manner to other stimuli (the inputs). A mixer is a typical example. Its noise and conversion characteristics improve if it is discontinuously switched between two states by the LO, yet it must respond linearly to the input signal over a very wide dynamic range.</p>
<p>
<a id="pgfId-1015586"></a>Because the periodic small-signal analyses are performed on a linear representation of the circuit, the computed response is a linear function of the stimulus, regardless of the size of the stimulus. In the real circuit, the input must be small enough to avoid violating the assumptions of the small-signal analysis. However, after the circuit has been linearized, the amplitude chosen for the small stimuli is arbitrary. Typically the stimulus is given an amplitude of 1 and a phase of 0 (zero) to allow transfer functions to be computed directly. In this regard, the periodic small-signal analyses are similar to conventional small-signal analyses.</p>
<p>
<a id="pgfId-1015587"></a>Conventional small-signal analyses do not model frequency translation, so between any input and output there is only one frequency-dependent transfer function. However, with the periodic small-signal analyses, there are many transfer functions between any single input and output. In fact, there are as many transfer functions as there are harmonics in the periodic operating point, which is always zero, one, or infinite.</p>
<p>
<a id="pgfId-1023507"></a>In practice, usually only one or two transfer functions are interesting. For example, when analyzing the down-conversion mixers found in receivers, the desired transfer function is the one that maps the input signal at the RF to the output signal at the IF, which is usually the LO minus the RF. The Spectre RF simulator using the shooting method, unlike harmonic balance simulators, internally computes the response of the circuit in the time domain and converts the results into the frequency domain using the new Fourier Integral approach to Fourier analysis [kundert94].</p>
<p>
<a id="pgfId-1031801"></a>The accuracy of the internal time-domain solution is completely independent of the number of harmonics requested. In addition, because Spectre RF analyses use the Fourier Integral rather than Discrete Fourier Transforms the accuracy of the frequency-domain results are also independent of the number of harmonics requested. With Spectre RF analyses, you are free to request as few or as many harmonics as desired without concern for the accuracy of the final result. The only exception to this general rule is the periodic noise analysis, Pnoise. Pnoise analysis models the noise folding that occurs in periodically varying circuits. If you request fewer harmonics, fewer folds are included in the accumulated total.</p>
<p>
<a id="pgfId-1015588"></a>Another important advantage that the combination of the PSS analysis using the shooting method and the periodic small-signal analyses has over methods based on harmonic balance is that it is efficient even if the circuit is responding in a strongly nonlinear manner to the LO or the clock. As a result, you can apply Spectre RF analyses to such strongly nonlinear circuits as switched-capacitor filters, switching mixers, chopper-stabilized amplifiers, PLL-based frequency multipliers, sample-and-holds, and samplers [konrath96]. Note that the combination of the PSS analysis using the harmonic balance method and the periodic small-signal analyses efficiently analyze weakly nonlinear circuits.</p>

<h3>
<a id="pgfId-1015589"></a>Fundamental Assumptions for the Periodic Small-Signal Analyses</h3>

<p>
<a id="pgfId-1015590"></a>There are two fundamental assumptions that apply to the periodic small-signal analyses</p>
<ul><li>
<a id="pgfId-1024054"></a>Linearity</li><li>
<a id="pgfId-1024056"></a>Frequency</li></ul>

<p>
<a id="pgfId-1024055"></a>Understanding these assumptions and their consequences lets you anticipate whether you can apply the periodic small-signal analyses to your problem.</p>

<h4>
<a id="pgfId-1015591"></a>Linearity</h4>

<p>
<a id="pgfId-1015592"></a>The periodic small-signal analyses all assume that the circuit responds linearly to the sinusoidal (PAC or PXF) or noise (PNoise) stimulus, or it involves both sinusoidal and noise (PSP) stimuli. There is no such assumption concerning the periodic signals (such as the LO or clock) applied in the initial PSS analysis. Spectre RF simulation is not capable of computing the distortion caused by the small signals, although you can use the small signals to measure distortion caused by the large signals present in the PSS analysis.</p>
<p>
<a id="pgfId-1015593"></a>If the signals present in the circuit during a periodic small-signal analysis are large enough to drive the circuit to nonlinear behavior, then the results computed by simulation differ from the results produced by the circuit. If you consider PAC and PXF analyses to be computing transfer functions, which by definition assume arbitrarily small input signals, then this is not an issue. However, Spectre RF simulation can compute inaccurate results on strongly nonlinear circuits that exhibit very high levels of noise, such as when a circuit exhibits high levels of jitter (low-Q, highly nonlinear circuits such as relaxation and ring oscillators).</p>

<h4>
<a id="pgfId-1015594"></a>Analysis Frequency</h4>

<p>
<a id="pgfId-1015595"></a>Internally, the periodic small-signal analyses compute transfer functions using time domain techniques. The time-steps used in these time-domain computations are the same as those used in the preceding PSS analysis. In order for the transfer function to be accurate, the period of the small sinusoidal stimulus must be large compared with the largest time-step used during the PSS analysis.</p>
<p>
<a id="pgfId-1015596"></a>If the analysis frequency of the periodic small-signal analysis is too high, the accuracy of the results degrade. The Spectre RF simulator warns you when it determines that you are requesting a frequency that is too high. You can use the <em>maxacfreq</em> parameter of the PSS analysis to specify the highest frequency that Spectre RF simulation can use in subsequent periodic small-signal analyses. PSS analysis then chooses the time-step in order to assure the results computed by the small-signal analyses are accurate. Specifying a very large <em>maxacfreq</em> causes both the PSS and small-signal analyses to run slowly and requires a large amount of memory.</p>

<h2>
<a id="pgfId-1015597"></a>Quasi-Periodic Steady-State Analysis</h2>

<p>
<a id="pgfId-1015598"></a>The Quasi-Periodic Steady-State (QPSS) analysis calculates the response due to multiple input frequencies. All of the input signals are treated in the same way as the PSS drive source so that the calculated output includes all the intermodulation distortion effects caused by frequency translation of all harmonics of the input signals. You can analyze the response of a circuit to a sum of signal sinusoids with PSS analysis by including them as components of the PSS drive source, but the resulting sum must be periodic. Spectre RF now supports a choice of simulation engines between the shooting method and the harmonic balance method. See <a href="chap1.html#80688">&#8220;The Harmonic Balance Engine&#8221;</a> for more information.</p>
<p>
<a id="pgfId-1015599"></a>Because QPSS analysis allows arbitrary signal inputs, including sums of sinusoids that may not be periodic, you can think of it as a quasi-periodic extension of PSS analysis. You can also think of QPSS analysis as an extension of PAC analysis that allows signal inputs capable of producing third-order products.</p>
<p>
<a id="pgfId-1015600"></a>Choose QPSS analysis when you need to compute the steady-state responses of a circuit driven by two or more signals at unrelated frequencies. Unlike PSS analysis, QPSS analysis does not require that multiple periodic stimuli be coperiodic. When you use QPSS analysis, you declare one signal as large. That signal can be a sinusoid or a pulse. Any additional-signals, called moderate signals, must be sinusoids. You must specify the number of harmonics to be simulated on all moderate tones.</p>

<h2>
<a id="pgfId-1024080"></a>Quasi-Periodic Noise Analysis</h2>

<p>
<a id="pgfId-1024309"></a>The Quasi-Periodic Noise (QPnoise) analysis is similar to the conventional Pnoise analysis, except that, in addition, it includes frequency conversion and intermodulation effects. You can use QPnoise analysis to predict the noise behavior of mixers, switched-capacitor filters, and other periodically or quasi-periodically driven circuits.</p>
<p>
<a id="pgfId-1024310"></a>QPnoise analysis linearizes the circuit about the quasi-periodic operating point computed in the prerequisite QPSS analysis. It is the quasi-periodically time-varying nature of the linearized circuit that accounts for the frequency conversion and intermodulation.</p>
<p>
<a id="pgfId-1024340"></a>In addition, QPnoise analysis also includes the effect of a quasi-periodically time-varying bias point on the noise generated by the various components in the circuit. The time-average of the noise at the output of the circuit is computed in the form of a spectral density versus frequency. The output of the circuit is specified with either a pair of nodes or a probe component.</p>

<h2>
<a id="pgfId-1043607"></a>Envelope Analysis</h2>

<p>
<a id="pgfId-1043681"></a>Envelope (ENVLP) analysis allows RF circuit designers to efficiently and accurately predict the envelope transient response of the RF circuits used in communication systems. For example, you can apply ENVLP analysis to efficiently and accurately analyze modulation signals in large communication circuits.</p>
<p>
<a id="pgfId-1043712"></a>Important applications of ENVLP analysis include</p>
<ul><li>
<a id="pgfId-1043614"></a>Predicting the spectral regrowth of amplifiers or mixers</li><li>
<a id="pgfId-1043615"></a>Designing feedback loops</li><li>
<a id="pgfId-1043616"></a>Predicting the transient behavior of switched capacitor filters</li><li>
<a id="pgfId-1043617"></a>Simulating large transients in phase lock loops</li><li>
<a id="pgfId-1043618"></a>Helping the oscillator designer to identify the load pull effect for the communication systems with VCO and power amplifier</li></ul>




<p>
<a id="pgfId-1043749"></a>As a typical example, a designer might be interested in simulating a receiver signal path involving a mixer, in particular, to predict the spectral regrowth of the mixer. As shown in Figure <a href="chap1.html#23060">1-2</a>, the inputs to a mixer can be one complete digital low-frequency (not necessarily periodic) modulation and one high frequency LO. The result of the mixing is a modulated high-frequency signal as shown in Figure <a href="chap1.html#23060">1-2</a>. However, due to the nonlinearity of the mixer, unwanted harmonics might be generated and it is important to predict the signal level at these unwanted harmonics in order to validate the design.</p>

<p><strong>Figure 1-2
<a id="pgfId-1043635"></a><a id="23060"></a>Time-Domain Modulation</strong></p>
<p>
<a id="pgfId-1043639"></a></p>
<div class="webflare-div-image">
<img src="images/EnvlpFig1.gif" /></div>

<p>
<a id="pgfId-1043643"></a>Figure <a href="chap1.html#20565">1-3</a> shows a typical scenario in the receiver signal path. Due to the nonlinearity of the mixer, it is important to predict the resulting spectral regrowth. Spectral regrowth is extraordinarily expensive to simulate using the traditional transient analysis because spectral regrowth requires a very long time interval to resolve the required frequency resolution.</p>

<p><strong>Figure 1-3
<a id="pgfId-1043645"></a><a id="20565"></a>Spectral Regrowth Simulated Using Envelope Analysis</strong></p>
<p>
<a id="pgfId-1043649"></a></p>
<div class="webflare-div-image">
<img src="images/EnvlpFig2.gif" /></div>

<p>
<a id="pgfId-1043650"></a>ENVLP analysis overcomes this difficulty with traditional transient analysis. ENVLP analysis reduces simulation time without compromising accuracy by exploiting the property that the behavior of a circuit in a given high frequency clock cycle is similar, but not identical, to its behavior in the preceding and following cycles. In particular, the envelope of the high-frequency clock by accurately computing the circuit behavior over occasional cycles, which accurately capture the fast transient behavior. The slow varying modulation is accurately followed by a smooth curve. As a result, you can obtain the spectrum of the circuit response by combining the spectrum of the smooth curve and the spectrum of occasional clock cycles.</p>
<p>
<a id="pgfId-1043651"></a>The RF analysis types such as PSS (periodic steady-state analysis) [1] or QPSS (quasi-periodic steady-state analysis) [2] might not work directly because the modulation signal might be neither periodic nor quasi-periodic.</p>
<p>
<a id="pgfId-1043652"></a>For switched-capacitor filters, the clock signal is referred to as the clock. For some other applications the clock signal might be referred to differently.</p>
<ul><li>
<a id="pgfId-1043653"></a>For mixers, the clock signal is called the LO</li><li>
<a id="pgfId-1043654"></a>For detectors, the clock signal is called the carrier</li></ul>

<p>
<a id="pgfId-1043608"></a>The clock signal is normally the most rapidly changing signal in the circuit and thus causes the most nonlinearity.</p>
<p>
<a id="pgfId-1043800"></a>Spectre RF now supports a choice of simulation engines between the shooting method and the harmonic balance method.</p>

<h2>
<a id="pgfId-1043811"></a><a id="80688"></a>The Harmonic Balance Engine</h2>

<p>
<a id="pgfId-1026974"></a>The harmonic balance (HB) engine supports the frequency-domain harmonic balance analyses and complements the existing analyses which use the time-domain shooting method (TD) engine. The harmonic balance engine performs efficient and robust simulation of linear and weakly nonlinear circuits on all platforms for both 32 and 64 bit architectures.</p>
<p>
<a id="pgfId-1026972"></a>The harmonic balance engine (HB) is available for</p>
<ul><li>
<a id="pgfId-1031844"></a>Driven PSS, PAC, PXF, PSP, and Pnoise analyses</li><li>
<a id="pgfId-1031853"></a>Driven QPSS, QPAC, QPXF, QPSP, and Qpnoise analyses</li><li>
<a id="pgfId-1026866"></a>Autonomous PSS, PAC, PXF, and Pnoise analyses<br />
<a id="pgfId-1031862"></a>These autonomous harmonic balance analyses are good candidates for simulating mildly-nonlinear oscillators with resonators, for example, LC oscillators, negative-gain oscillators, and crystal oscillators.</li><li>
<a id="pgfId-1026854"></a>Envelope Analysis ENVLP<br />
<a id="pgfId-1031869"></a>For linear and weakly non-linear circuits, the harmonic balance Envlp analysis has better performance than the shooting method Envlp analysis.</li><li>
<a id="pgfId-1027028"></a>The HB engine also supports corresponding swept harmonic balance analyses.</li></ul>






<p>
<a id="pgfId-1041781"></a>The HB engine is supported on the Solaris, Linux, HP, and IBM platforms for both 32 and 64 bit architectures.</p>

<h3>
<a id="pgfId-1038576"></a>HB Method Theory</h3>

<p>
<a id="pgfId-1038580"></a>In the time-domain method, the signal waveform <em>
u</em>
(<em>
t</em>
) is solved according to Circuit Equation <a href="chap1.html#83741">1-1</a> where <em>
s</em>
 is the source.</p>

<p>
<a id="pgfId-1038589"></a></p>
<table class="webflareTable" id="#id1038581">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-1)
<a id="pgfId-1038583"></a><a id="83741"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1038588"></a><img width="206" height="56" src="images/chap1-5.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1041794"></a>At the steady state, the solution <em>
u</em>
(<em>
t</em>
), the current <em>i</em>, and the charge <em>q</em> are represented by harmonics as shown in Equations <a href="chap1.html#67989">1-2</a>, <a href="chap1.html#77003">1-3</a> and <a href="chap1.html#42640">1-4</a> where ω is the fundamental frequency.</p>

<p>
<a id="pgfId-1038625"></a></p>
<table class="webflareTable" id="#id1038603">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-2)
<a id="pgfId-1038605"></a><a id="67989"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1038610"></a><img width="189" height="69" src="images/chap1-6.gif" /></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-3)
<a id="pgfId-1038612"></a><a id="77003"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1038617"></a><img width="179" height="61" src="images/chap1-7.gif" /></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-4)
<a id="pgfId-1038619"></a><a id="42640"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1038624"></a><img width="185" height="66" src="images/chap1-8.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1038638"></a>Coefficients <em>
U</em>
(<em>
k</em>
), <em>
I</em>
(<em>
k</em>
), and <em>
Q</em>
(<em>
k</em>
) are Fourier transforms of <em>
u</em>
(<em>
t</em>
), <em>
i</em>
(<em>
t</em>
), and <em>
q</em>
(<em>
t</em>
) respectively at the <em>
k</em>
<spti-sups-times-italic>
th</spti-sups-times-italic>
 harmonic. Notice that <em>
I</em>
(<em>
k</em>
) and <em>
Q</em>
(<em>
k</em>
) are functions of <em>
U</em>
(<em>
k</em>
) determined by <em>
i</em>
(<em>
u</em>
) and <em>
q</em>
(<em>
u</em>
).</p>
<p>
<a id="pgfId-1041831"></a>Equivalent to the time-domain circuit <a href="chap1.html#83741">Equation&#160;1-1</a>, the circuit equation in the frequency-domain is shown in Equation <a href="chap1.html#84421">1-5</a> where <em>
S</em>
(<em>
k</em>
) is the Fourier transform of periodic source <em>
s</em>
.</p>

<p>
<a id="pgfId-1038675"></a></p>
<table class="webflareTable" id="#id1038667">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-5)
<a id="pgfId-1038669"></a><a id="84421"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1038674"></a><img width="206" height="41" src="images/chap1-9.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1041853"></a>The fundamental concept of the harmonic balance (HB) method is to solve for <em>
U</em>
(<em>
k</em>
) (the frequency-domain waveform) according to Equation <a href="chap1.html#84421">1-5</a>, rather than solving for <em>
u</em>
(<em>
t</em>
) (the time-domain waveform) according to Equation <a href="chap1.html#83741">1-1</a>. With the frequency-domain solution <em>
U</em>
(<em>
k</em>
) obtained from Equation <a href="chap1.html#84421">1-5</a>, the HB method uses Equation <a href="chap1.html#67989">1-2</a> to solve for the time-domain waveform <em>
u</em>
(<em>
t</em>
).</p>
<p>
<a id="pgfId-1041566"></a>The HB method is very efficient for simulating circuits such as low-noise amplifiers that have only low order harmonics. In these cases, the HB solution is small because only a few <em>
U</em>
(<em>
k</em>
) coefficients are needed to give the waveform <em>
u</em>
(<em>
t</em>
) accurately. Mixers with a low moderate-tone power level can also be represented with low order harmonics. In general, problems related to multi-tone simulation in QPSS can be reduced in scope or even eliminated by using the HB method.</p>
<p>
<a id="pgfId-1041920"></a>The HB method also effectively supports frequency-dependent components. These are usually provided as frequency dependent scalar data such as in an S-parameter format file.</p>

<h3>
<a id="pgfId-1038711"></a>HB Convergence Criteria</h3>

<p>
<a id="pgfId-1047267"></a>HB is designed to solve nonlinear equations. For example, you might have the equation</p>

<p>
<a id="pgfId-1047319"></a></p>
<table class="webflareTable" id="#id1047327">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-6)
<a id="pgfId-1047330"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1047335"></a><img width="206" height="56" src="images/chap1-10.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1047274"></a>which can be solved by using the Newton method:</p>

<p>
<a id="pgfId-1047277"></a></p>
<table class="webflareTable" id="#id1047347">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-7)
<a id="pgfId-1047350"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1047355"></a><img width="283" height="56" src="images/chap1-11.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1047278"></a>When the following two conditions are met the iterations are assumed to have converged.</p>

<p>
<a id="pgfId-1047370"></a></p>
<table class="webflareTable" id="#id1047363">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-8)
<a id="pgfId-1047365"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1047369"></a><img width="298" height="56" src="images/chap1-12.gif" /></p>
</td>
</tr>
</tbody></table>
<p>
<a id="pgfId-1047381"></a></p>
<table class="webflareTable" id="#id1047374">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-9)
<a id="pgfId-1047376"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1047380"></a><img width="308" height="56" src="images/chap1-13.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1047281"></a>To understand Spectre RF HB convergence, it is useful to know of the following two norms:</p>
<ul><li>
<a id="pgfId-1047283"></a><code>Resd_Norm</code><br />
<a id="pgfId-1047284"></a>The <code>Resd_Norm</code> measures<br />
<a id="pgfId-1047404"></a><table class="webflareTable" id="#id1047397">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-10)
<a id="pgfId-1047399"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1047403"></a><img width="206" height="56" src="images/chap1-14.gif" /></p>
</td>
</tr>
</tbody></table><br />
<a id="pgfId-1047285"></a>by taking on the value<br />
<a id="pgfId-1047417"></a><table class="webflareTable" id="#id1047410">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-11)
<a id="pgfId-1047412"></a><a id="29257"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1047416"></a><img width="388" height="56" src="images/chap1-15.gif" /></p>
</td>
</tr>
</tbody></table><br />
<a id="pgfId-1047287"></a>in which <em>Cr</em> is a function designed to get the relative errors.<br />
<a id="pgfId-1047610"></a><a href="chap1.html#29257">Equation&#160;1-11</a> gives a rough determination of the relationship between <em>Resd_Norm</em> and <em>tolerance_residual</em>.</li><li>
<a id="pgfId-1047290"></a><code>Delta_Norm</code><br />
<a id="pgfId-1047291"></a>The Delta_Norm measures<br />
<a id="pgfId-1047433"></a><table class="webflareTable" id="#id1047426">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-12)
<a id="pgfId-1047428"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1047432"></a><img width="206" height="56" src="images/chap1-16.gif" /></p>
</td>
</tr>
</tbody></table><br />
<a id="pgfId-1047292"></a>by taking on the value<br />
<a id="pgfId-1047448"></a><table class="webflareTable" id="#id1047441">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-13)
<a id="pgfId-1047443"></a><a id="48008"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1047447"></a><img width="452" height="56" src="images/chap1-17.gif" /></p>
</td>
</tr>
</tbody></table><br />
<a id="pgfId-1047294"></a>in which <em>Cd</em> is a function designed to get the relative errors.<br />
<a id="pgfId-1047295"></a><a href="chap1.html#48008">Equation&#160;1-13</a> gives a rough determination of the relationship between <em>Delta_Norm</em> and <em>tolerance_delta</em>.</li></ul>

























<p>
<a id="pgfId-1047297"></a>In the HB Newton method, iterations are assumed to have converged when</p>

<p>
<a id="pgfId-1047520"></a></p>
<table class="webflareTable" id="#id1047512">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-14)
<a id="pgfId-1047514"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1047519"></a><img width="206" height="56" src="images/chap1-18.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1047540"></a>and</p>

<p>
<a id="pgfId-1047525"></a></p>
<table class="webflareTable" id="#id1047527">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-15)
<a id="pgfId-1047529"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1047534"></a><img width="206" height="56" src="images/chap1-19.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1047521"></a>The <em>tolerance_residual</em> is determined by the product of the <code>reltol</code> and <code>residualtol</code> parameters.</p>
<p>
<a id="pgfId-1047522"></a>The <em>tolerance_delta</em> is determined by the product of the <code>reltol</code>, <code>lteratio</code>, and <code>steadyratio</code> parameters.</p>
<p>
<a id="pgfId-1047301"></a>Occasionally, <em>Resd_Norm</em> becomes smaller than 1 but <em>Delta_Norm</em> remains large. To achieve convergence in a case like this, consider setting a bigger <code>steadyratio</code> value so that the <em>tolerance_delta</em> is larger. This approach is recommended because</p>
<ul><li>
<a id="pgfId-1047304"></a>The infinity norm is defined as<br />
<a id="pgfId-1047477"></a><table class="webflareTable" id="#id1047470">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-16)
<a id="pgfId-1047472"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1047476"></a><img width="235" height="56" src="images/chap1-20.gif" /></p>
</td>
</tr>
</tbody></table><br />
<a id="pgfId-1047311"></a>so that the norm of the vector x depends on its maximum element.</li><li>
<a id="pgfId-1047312"></a>In HB, the high order harmonics of some nodes are occasionally quite small. During iterations, these small high-order harmonics vary greatly, which makes <em>Delta_Norm</em> large. Because these harmonics contribute little to the whole circuit state, you can set a larger steadyratio, which solves the problem.</li></ul>







<h3>
<a id="pgfId-1047266"></a>HB Large Signal Simulation for Driven Circuits</h3>

<p>
<a id="pgfId-1042027"></a>The following parameters are provided to specify the HB method for large signal simulations of driven circuits.</p>

<p>
<a id="pgfId-1046523"></a></p>
<table class="webflareTable" id="#id1046492">
<caption style="text-align:left;"><p>
<ft-figtabl-title id="#id1046497">
<a id="pgfId-1046497"></a><a id="74528"></a>Basic HB Parameters for Driven HB Analysis </ft-figtabl-title>
</p></caption>
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046501"></a><strong>flexbalance</strong><code>=no</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046503"></a>The HB engine shares the same PSS and QPSS analysis statement with the time-domain engine. To run the harmonic balance engine, set <strong>flexbalance</strong><code>=yes</code> in the analysis statement, or in the graphical user interface, select <em>Harmonic Balance</em> for <em>Engine</em>.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046506"></a><strong>harms<br /></strong>and<br /><strong>maxharms</strong><code> </code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046508"></a>Determines how many harmonics are used to expand the waveform in Equation <a href="chap1.html#67989">1-2</a>.</p>
<p>
<a id="pgfId-1046512"></a>In PSS, specify the maximum harmonic with <strong>harms</strong>. In QPSS, specify the maximum harmonic for each tone with <strong>maxharms</strong>.</p>
<p>
<a id="pgfId-1046513"></a>It is important to point out that <strong>harms</strong> in PSS and the first value in the <strong>maxharms</strong> vector in QPSS are output parameters in the time-domain method but they are input parameters in the HB method and have a direct impact on the accuracy and performance of the HB simulation.</p>
<p>
<a id="pgfId-1046514"></a>The best choice for the <strong>harms</strong> or <strong>maxharms</strong> value depends on the signal waveform and circuit nonlinearity. The faster the signal varies with time, or the more nonlinear the circuit, the more harmonics are required to accurately represent the solution. In multi-tone mixers, the large LO tone has a higher power level than the moderate RF tones and causes more nonlinear effects, so you should usually use more harmonics for the large LO tone than for the moderate tones.</p>
<p>
<a id="pgfId-1046515"></a>The best <strong>harms</strong> or <strong>maxharms</strong> value also depends on the order of nonlinear effect that you want to study. For example, for a mixer IP3 measurement, the <strong>maxharms</strong> value for the moderate tones must be 2 or more to capture the IM3 mode at frequency 2ω<sub>1</sub>−ω<sub>2</sub>−ω<sub>LO</sub>. </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046517"></a><strong>tstab</strong> </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046519"></a><strong>tstab</strong> is a valid parameter for the initial transient analysis in HB. The default <strong>tstab</strong> value for both PSS and QPSS is one cycle of the signal period. For QPSS analysis, you can choose a specific tone for the <strong>tstab</strong> integration and only one tone is allowed. One additional cycle is used for the FFT. When you set <strong>tstab</strong> to 0, the DC results are used as the initial condition for HB.</p>
<p>
<a id="pgfId-1046520"></a>The following are example HB statements.</p>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1046521"></a>pss0 pss fund=1G harms=10 flexbalance=yes</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1046522"></a>qpss0 qpss funds=[&quot;LO&quot; &quot;RF1&quot; &quot;RF2&quot;] maxharms=[5 3 3] flexbalance=yes </pre>
</td>
</tr>
</tbody></table>
<p>
<a id="pgfId-1046549"></a><a id="60355"></a><a id="62294"></a></p>
<table class="webflareTable" id="#id1046526">
<caption style="text-align:left;"><p>
<ft-figtabl-title id="#id1046528">
<a id="pgfId-1046528"></a><a id="43998"></a>Optional HB Parameters for Driven HB Analysis </ft-figtabl-title>
</p></caption>
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046532"></a><strong>oversamplefactor</strong><a id="oversamplefactorDriverAnalysis"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046534"></a>In the HB method the nonlinear parts of functions <em>
i</em>
(<em>
u</em>
) and <em>
q</em>
(<em>
u</em>
) are evaluated at a series of sample time points <em>
t</em>
<sub><em>n </em></sub><sup>. </sup><em>
I</em>
(<em>
k</em>
) and the <em>
Q</em>
(<em>
k</em>
) values are obtained from Fourier transforms of <em>
i</em>
(<em>
t</em>
<sub><em>n</em></sub>) and <em>
q</em>
(<em>
t</em>
<sub><em>n</em></sub>). In a regular Fourier transform, <em>
t</em>
<sub><em>n</em></sub> equals the number of harmonics <em>
N</em>
<sub><em>k</em></sub>. For highly nonlinear functions <em>
i</em>
(<em>
u</em>
) or <em>
q</em>
(<em>
u</em>
), if <em>
i</em>
(<em>
t</em>
) or <em>
q</em>
(<em>
t</em>
) is under-sampled by <em>
t</em>
<sub><em>n</em></sub>, aliasing effects cause inaccuracy in <em>
I</em>
(<em>
k</em>
) or <em>
Q</em>
(<em>
k</em>
). Aliasing can be prevented by increasing <em>
N</em>
<sub><em>k</em></sub> but this also increases the number of unknown <em>
U</em>
(<em>
k</em>
). Another way to prevent aliasing is to use the same <em>
N</em>
<sub><em>k</em></sub> but to oversample <em>
i</em>
(<em>
t</em>
) and <em>
q</em>
(<em>
t</em>
) by <em>
m</em>
⋅ <em>
N</em>
<sub><em>k</em></sub> time points, where the integer <em>
m</em>
 is the oversample factor. Notice that although the oversampling method does not change the solution size, it does increase the size of the Fourier transform and the number of evaluations of <em>
i</em>
(<em>
t</em>
<sub><em>n</em></sub>) and <em>
q</em>
(<em>
t</em>
<sub><em>n</em></sub>).</p>
<p>
<a id="pgfId-1046646"></a>In the PSS or QPSS analysis statement, use <strong>oversamplefactor</strong><code>=</code><em>
m</em>
 to specify the oversample factor. Spectre RF oversamples <em>
i</em>
(<em>
u</em>
) and <em>
q</em>
(<em>
u</em>
) by a factor of <em>
m</em>
 for each tone. As a result, the size of the Fourier transform is increased by<em>
 m</em>
<spti-sups-times-italic>
number-of-tones</spti-sups-times-italic>
. For multi-tone cases, you can also specify <strong>oversample</strong>=[<em>
m</em>
<sub><em>1</em></sub>, <em>
m</em>
<sub><em>2</em></sub>, <em>
m</em>
<sub><em>3</em></sub>, ... ] to oversample the <em>
i</em>
<spti-sups-times-italic>
th</spti-sups-times-italic>
 tone by a factor of <em>
m</em>
<sub><em>i</em></sub>. The size of the Fourier transform is therefore increased by <em>
m</em>
<sub><em>1</em></sub> ⋅ <em>
m</em>
<sub><em>2</em></sub> ⋅ <em>
m</em>
<sub><em>3</em></sub> ⋅ ... . The default oversample factor is 1.</p>
<p>
<a id="pgfId-1046536"></a>Note that even with oversampling, you must make sure the maximum harmonic meets the accuracy requirement on results of interest. </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046538"></a><strong>itres</strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046540"></a>Controls the accuracy of the linear solution at each Newton update. It controls the convergence of the Newton iteration. The value is between [0, 1] and the default is 0.9. When you use the HB method for highly nonlinear circuits, Cadence recommends using the default value. For nearly linear circuits, using a small <strong>itres</strong> (for example,1e<sup>-2</sup>) can speed convergence.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046542"></a><strong>maximorder<br /></strong>and <br /><strong>selectharm</strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046544"></a>These two parameters determine the harmonics selected for multi-tone QPSS analysis. By default, Spectre RF uses a square cut determined by <strong>maxharms</strong>. A QPSS simulation with <code>M</code> tones will solve for all frequencies ω = <em>
k</em>
<sub><em>1</em></sub>ω<sub><em>1</em></sub> + <em>
k</em>
<sub><em>2</em></sub>ω<sub><em>2</em></sub> + ... where <em>
k</em>
<sub><em>i</em></sub> ≤ <em>
H</em>
<sub><em>i</em></sub> for each tone and <em>
H</em>
<sub><em>i</em></sub> is the maximum harmonic for tone <em>
i</em>
. For a diamond cut ∑<em>
k</em>
<sub><em>i</em></sub> ≤ <em>
P</em>
 where <em>
P</em>
 is the maximum order set by the <strong>maximorder </strong>parameter.&#160;&#160; The <strong>selectharm</strong> parameter determines the type of cut. The options for cut are: <strong>box</strong>, <strong>diamond</strong>, <strong>axis</strong>, or <strong>funnel</strong>.</p>

<ul><li>
<a id="pgfId-1048171"></a>The default cut is <strong>box</strong>.</li><li>
<a id="pgfId-1048172"></a>A <strong>diamond</strong> cut selects a diamond cut with order <em>
P</em>
.<br /><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1048178"></a>The diamond cut must not be used in a QPSS analysis that is followed by a QPAC, QPXD, QPNOISE, or QPSP analysis because some sidebands are not included in the small signal calculation.</div></li><li>
<a id="pgfId-1048194"></a>An <strong>axis</strong> cut selects harmonics along an axis. This means that there are no intermodulation harmonics, there are only harmonics of type ω = <em>
k</em>
<sub><em>1</em></sub>ω<sub><em>1</em></sub> where <em>
k</em>
<sub><em>i</em></sub> ≤ <em>
H</em>
<sub><em>i</em></sub>.</li><li>
<a id="pgfId-1048201"></a>A <strong>funnel</strong> cut combines the <strong>axis</strong> and <strong>diamond</strong> cuts. The <strong>funnel</strong> cut selects harmonics along an axis and intermodulation harmonics of order <em>
P</em>
 or less.</li></ul>





</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046546"></a><strong>freqdivide</strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046548"></a>The frequency division ratio of a large signal in QPSS analysis. The default is 1. Specify <strong>freqdivide</strong> when the circuit has a frequency divider on a large signal.</p>
</td>
</tr>
</tbody></table>
<h3>
<a id="pgfId-1046550"></a>The ADE Use Model</h3>

<p>
<a id="pgfId-1038859"></a>All the analysis features mentioned above are integrated into the Analog Design Environment (ADE). You can switch between the time domain shooting (TD) engine and the HB engine in the PSS, QPSS, and ENVLP Choosing Analyses forms. For example, Figure <a href="chap1.html#10427">1-4</a> shows the Choosing Analyses form set up for a large signal HB Quasi-Periodic Steady State Analysis. Notice the <em>Engine</em> field choices labeled <em>Shooting</em> and <em>Harmonic Balance</em>.</p>

<p><strong>Figure 1-4
<a id="pgfId-1043828"></a><a id="10427"></a>The HB QPSS Choosing Analyses Form</strong></p>
<p>
<a id="pgfId-1043831"></a></p>
<div class="webflare-div-image">
<img src="images/38_HBQPSSChoosing.gif" /></div>

<p>
<a id="pgfId-1038865"></a>For a detailed design example, refer to Lab 10, <em>IP3 Calculation</em> (QPSS with Shooting or Harmonic Balance Engine), in the workshop <em>Mixer Design Using SpectreRF</em>. The database for this workshop is available at</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1039365"></a>&lt;instdir&gt;/tools/spectre/examples/SpectreRFworkshop</pre>
<h3>
<a id="pgfId-1038866"></a>HB Large Signal Simulation for Autonomous Circuits</h3>

<p>
<a id="pgfId-1038867"></a>The harmonic balance (HB) engine is supported for oscillators and phase-noise simulation.&#160;&#160; HB is a frequency domain technique that solves the spectrum of each node voltage unlike the time-domain engines (such as shooting PSS) which solve the waveform of each node voltage over the period.</p>
<p>
<a id="pgfId-1038868"></a>The harmonic balance method is a good candidate for simulating mildly-nonlinear oscillators with resonators, such as LC oscillators, negative-gain oscillators, and crystal oscillators. The time-domain shooting PSS method is a good candidate for simulating strongly-nonlinear resonatorless oscillators, such as ring oscillators, relaxation oscillators, or oscillators containing digital control components.</p>

<h4>
<a id="pgfId-1038869"></a><a id="96600"></a>Basic HB Parameters</h4>

<p>
<a id="pgfId-1046734"></a>The following parameters are provided to specify the HB method for autonomous circuit large signal simulations.</p>

<p>
<a id="pgfId-1046745"></a></p>
<table class="webflareTable" id="#id1046747">
<caption style="text-align:left;"><p>
<ft-figtabl-title id="#id1046776">
<a id="pgfId-1046776"></a>Basic Parameters for Autonomous HB Analysis </ft-figtabl-title>
</p></caption>
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046749"></a>flexbalance</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046751"></a>Harmonic balance engine shares the same analysis form with time-domain engine and is invoked by setting flag flexbalance=yes in the analysis statement.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046753"></a>harms</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046755"></a>Determines how many harmonics will be used to expand the waveform in eq. (2). Similar to that in PSS analysis for driven circuit, maximum number of harmonics is specified by harms. It is input parameter in HB method and has direct impact on the accuracy and performance of the simulations.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046757"></a>oscmethod</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046759"></a>Currently, there are two methods implemented: onetier and twotier. They are set by parameter oscmethod. In onetier method, the frequency and voltage spectrum are solved simultaneously in one single set of nonlinear equations. In twotier method, the nonlinear equations are split into two sets: the inner set of nonlinear equations solves the spectrum of node voltage equations; the outer set of nonlinear equations solves the oscillation frequency. Physically it is equivalent to add a sinusoidal voltage probe to a pinning node and adjust its frequency and amplitude until it has no effect on the oscillator. Spectre RF automatically chooses the pinning node. By default, Spectre RF runs onetier first for n iterations; if necessary, it runs twotier for next n iterations (n is set by maxperiods). Users can also run only onetier or twotier by specifying oscmethod. Twotier has larger convergence zone as its convergence is slightly more robust. This method is however computationally more expensive than onetier method. </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046761"></a> tstab</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046763"></a>Specifies the length of the transient analysis used to assist the harmonic balance analysis. Spectre RF runs a transient analysis of the length specified by tstab and then switches to HB. Stable oscillation in the transient analysis can help HB to converge. Stable oscillation can be achieved by</p>

<ul><li style="list-style-type: none;background-image: none;"><ul><li>
<a id="pgfId-1046764"></a>Setting an initial condition for a particular node (for example: <code>ic net01=5.0</code>)</li><li>
<a id="pgfId-1046765"></a>Setting an initial condition for the inductor or capacitor in the resonator in OSC (for example: <code>L14 (Xtal02 net01) inductor l=6.m ic=0.5m</code>)</li><li>
<a id="pgfId-1046766"></a>Adding a damped current source in parallel to the resonator in OSC (for example: <code>Ikicker (net01 net02) isource type=sine freq=1.0G ampl=1m damp =1.0G</code>) </li><li>
<a id="pgfId-1046767"></a>Adding a voltage pulse (for example: <code>vdd (vdd 0) vsource type=pulse val0=0.0 val1=3.3 rise=1n</code>) </li></ul></li></ul>




</td>
</tr>
</tbody></table>
<p>
<a id="pgfId-1042317"></a></p>
<table class="webflareTable" id="#id1046789">
<caption style="text-align:left;"><p>
<ft-figtabl-title id="#id1046798">
<a id="pgfId-1046798"></a>Optional Parameters for Autonomous HB Analysis</ft-figtabl-title>
</p></caption>
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046791"></a>oversamplefactor</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046793"></a>The usage of oversamplefactor parameter is similar to the one in driven HB analysis. See <a href="chap1.html#oversamplefactorDriverAnalysis">&#8220;</a><strong>oversamplefactor</strong><a href="chap1.html#oversamplefactorDriverAnalysis">&#8221;</a>.</p>
</td>
</tr>
</tbody></table>
<h3>
<a id="pgfId-1043874"></a>The ADE Use Model</h3>

<p>
<a id="pgfId-1046865"></a>All the analysis features mentioned above are integrated into the Analog Design Environment (ADE). You can use the <em>Engine</em> field to switch between the time domain shooting (TD) engine and the HB engine in the PSS, QPSS, and ENVLP Choosing Analyses forms. For example, Figure <a href="chap1.html#52222">1-5</a> shows the Choosing Analyses form for a large signal HB autonomous PSS Analysis.</p>

<p><strong>Figure 1-5
<a id="pgfId-1043880"></a><a id="52222"></a>The Autonomous HB PSS Choosing Analyses Form</strong></p>
<p>
<a id="pgfId-1043884"></a></p>
<div class="webflare-div-image">
<img src="images/42_PSSHBAnalysisForm.gif" /></div>

<p>
<a id="pgfId-1038890"></a>For a detailed design example, refer to Lab 1, <em>Phase Noise Simulation with Shooting or Harmonic Balance Engine</em>, in the workshop <em>VCO Design Using SpectreRF</em>. The database for this workshop is available at</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1039381"></a>&lt;instdir&gt;/tools/spectre/examples/SpectreRFworkshop.</pre>
<h3>
<a id="pgfId-1038891"></a>HB Small Signal Setup</h3>

<p>
<a id="pgfId-1038892"></a>HB small signal analysis runs automatically if the large signal analysis uses the HB method. Hence, HB small signal analyses do not require special setup and use the same statement as a time-domain small signal analysis. The only difference is that the <strong>maxsideband</strong> setting is ignored in HB small signal analysis when the value is larger than the <strong>harms</strong> and <strong>maxharms</strong> value of the large signal analysis.</p>
<p>
<a id="pgfId-1038893"></a>There is no specific small signal set up for HB in ADE.</p>

<h3>
<a id="pgfId-1049333"></a>HB Envelope Analysis</h3>

<p>
<a id="pgfId-1049337"></a>See <a href="chap2.html#31878">The Time Domain and Harmonic Balance ENVLP Algorithms</a> for information about the HB ENVLP analysis.</p>

<h3>
<a id="pgfId-1043921"></a>The ADE Use Model</h3>

<p>
<a id="pgfId-1043922"></a>All the analysis features mentioned above are integrated into the Analog Design Environment (ADE). In the Choosing Analyses form, two buttons are available for you to switch between the time domain shooting (TD) engine and HB engine in the ADE PSS, QPSS and ENVLP Choosing Analyses forms. Figure <a href="chap1.html#52222">1-5</a> shows the HB Envlp GUI in ADE.</p>
<p>
<a id="pgfId-1046915"></a>All the analysis features mentioned above are integrated into the Analog Design Environment (ADE). You can use the <em>Engine</em> field to switch between the time domain shooting (TD) engine and the HB engine in the PSS, QPSS, and ENVLP Choosing Analyses forms. For example, Figure <a href="chap1.html#52222">1-5</a> shows the Choosing Analyses form for an HB Envlp analysis.</p>

<p><strong>Figure 1-6
<a id="pgfId-1043936"></a>The HB ENVLP Choosing Analyses Form</strong></p>
<p>
<a id="pgfId-1043940"></a></p>
<div class="webflare-div-image">
<img src="images/44_HB_ENVLPChoosingAnalysis.gif" /></div>

<p>
<a id="pgfId-1047121"></a>The following figure shows the multi-carrier HB envelope analysis set up in ADE.</p>

<p><strong>Figure 1-7
<a id="pgfId-1046968"></a>The HB ENVLP Multi-Carrier Choosing Analyses Form</strong></p>
<p>
<a id="pgfId-1046972"></a></p>
<div class="webflare-div-image">
<img src="images/45_HB_ENVLPMulti_CarrierSetup.gif" /></div>

<p>
<a id="pgfId-1043941"></a>For a detailed design example, refer to Lab 6, <em>Envelope Following Analysis</em>, in workshop <em>PA Design Using SpectreRF</em>. The database for this workshop is available at</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1043942"></a>&lt;instdir&gt;/tools/spectre/examples/SpectreRFworkshop.</pre>
<h3>
<a id="pgfId-1039031"></a>Multi-Thread Acceleration for Harmonic Balance Analysis</h3>

<p>
<a id="pgfId-1049089"></a>You can speed up HB large signal and small signal simulations if you have multiple CPUs. The earlier environment variable <code>CDS_SPECTRERF_MULTITHREAD</code> is no longer supported. Now, you can simply use the Spectre option <code>+mt=</code>.</p>
<p>
<a id="pgfId-1049090"></a>For example, if you have the number of CPUs as 4, you can give:</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1049091"></a>spectre +mt=4 input.scs</pre>
<h3>
<a id="pgfId-1039033"></a>Distributed Component Support</h3>

<p>
<a id="pgfId-1039034"></a>The distributed component models, which are usually provided in S-parameters scalar format, are directly computed in the frequency domain for HB analysis. The Spectre <code>nport</code> primitive is supported. If you specify the <em>rational fitting</em> method for the <code>nport</code>, an equivalent circuit is still used in HB and it might cause convergence issues due to an unstable model of the rational fitting method. Consequently, Cadence recommends using the default fitting method <code>spline</code> or <code>linear</code>.</p>
<p>
<a id="pgfId-1039035"></a>Other distributed components such as <code>mtline</code> and <code>delay</code> are also supported.</p>

<h3>
<a id="pgfId-1039036"></a>Hidden State Issue</h3>

<p>
<a id="pgfId-1039037"></a>The fundamental hidden state issue in Spectre RF still exists with the harmonic balance engine. Hidden states are not exposed to solution, so it is difficult to determine how sensitive other signals are to changes in those hidden states. This is required for predicting new iterations.</p>

<h3>
<a id="pgfId-1039038"></a>Frequently Asked Questions and Answers</h3>
<h4>
<a id="pgfId-1039039"></a>What are the parameters that affect accuracy in HB?</h4>

<p>
<a id="pgfId-1039040"></a>Maximum harmonic (<strong>harms</strong> in PSS and <strong>maxharms</strong> in QPSS) has the most impact on the accuracy of HB analysis. When you use too few harmonics, the spectrum outside of the maximum harmonic is folded back into harmonics inside by aliasing effects, causing errors. To obtain accurate results, set the maximum harmonic large enough to cover the signal bandwidth of interest.</p>
<p>
<a id="pgfId-1039041"></a>The <strong>reltol</strong> or <strong>errpreset</strong> parameters also affect simulation accuracy. HB uses the same convergence criteria as the TD shooting method.</p>

<h4>
<a id="pgfId-1039042"></a>Spectre RF offers both time-domain shooting and HB options. Which one should I use for my circuits?</h4>

<p>
<a id="pgfId-1039043"></a>The HB method is very efficient for simulating weakly nonlinear circuits such as LNAs. Only a few harmonics are needed to accurately represent the solution. For highly nonlinear circuits with sharply raising or falling signals, the TD shooting method is usually more appropriate. However, HB might still have an advantage when exploring design trade-offs using a few harmonics where accuracy is not the primary concern.</p>
<p>
<a id="pgfId-1039044"></a>For multi-tone cases such as mixers, HB is significantly more efficient than the shooting method with QPSS analysis due to its natural representation of circuit equations.</p>
<p>
<a id="pgfId-1039045"></a>The HB method is better than the TD method for handling frequency-dependent components. In post-layout circuits with many linear elements, HB has better performance than TD shooting.</p>

<h4>
<a id="pgfId-1039046"></a>Should I use HB PSS or HB QPSS for circuits driven by multi-tone stimulus? </h4>

<p>
<a id="pgfId-1039047"></a>Because HB multi-tone simulation does not have the convergence and speed issues encountered in TD shooting QPSS analysis, use HB QPSS analysis to simulate multi-tone circuits. HB PSS analysis using the <em>beat frequency</em> as the fundamental is very inefficient for multi-tone cases. When source frequencies are closely spaced, their common frequency is so low that you must use hundreds or even thousands of harmonics. In this situation, you should use QPSS analysis.</p>

<h4>
<a id="pgfId-1039048"></a>When should I use oversample factor?</h4>

<p>
<a id="pgfId-1039049"></a>In general, oversampling is not needed. However, for extremely nonlinear circuits driven by sources at a very high power level, oversampling might help with convergence. If the circuit has a frequency divider on the large signal, you might want to specify the oversample factor the same as the divide ratio.</p>

<h4>
<a id="pgfId-1039050"></a>How should I choose the number of harmonics for an HB envelope analysis?</h4>

<p>
<a id="pgfId-1039051"></a>The default value is 3 harmonics. The number of harmonics you choose depends on the linearity in one cycle of the fast signal (<code>LO</code> or <code>clock</code>). For linear cases, even 1 harmonic is enough for accurate results. However, for nonlinear cases, such as a circuit with a square clock, you might need 15 or even more harmonics.</p>

<h4>
<a id="pgfId-1039052"></a>In HB autonomous analysis, why would I set the OSC Newton Method rather than letting the simulator take care of it?</h4>

<p>
<a id="pgfId-1039053"></a>The default value for <strong>oscmethod</strong> is <strong>onetier</strong>. If Spectre RF fails to converge then it automatically switches to the <strong>twotier</strong> method. In these cases it might be more efficient to use the <strong>twotier</strong> method at the beginning by specifying <strong>oscmethod=twotier</strong>.</p>

<h2>
<a id="pgfId-1039120"></a>Perturbation Based Measurements</h2>

<p>
<a id="pgfId-1039297"></a>The perturbation-based approach solves weakly nonlinear circuits based on Born approximation. The perturbation method does not require explicit high order device derivatives and Its implementation is straightforward and is equivalent to successive small signal analysis. We analyze convergence properties for perturbation-based analyses and discuss the connection between the perturbation method and Volterra series.</p>
<p>
<a id="pgfId-1039304"></a>Rapid IP2 and IP3 measurements are calculated with 2nd and 3rd order Born approximation under weakly nonlinear conditions. Using the diagrammatic representation of nonlinear interaction, both Volterra series and Born approximation can be constructed in a systematic way. The method is generalized to calculate other high order nonlinear effects such as the IMn product. All equations are formulated as RF harmonics and they can be implemented in both the time and frequency domains.</p>

<h3>
<a id="pgfId-1039290"></a>Specialized PAC and AC Analyses for Measuring Distortion</h3>

<p>
<a id="pgfId-1039121"></a>Spectre RF supplies four specialized PAC and AC analyses based on perturbation methods that provide a basic set of rapid distortion measurements</p>
<ul><li>
<a id="pgfId-1039122"></a>Compression Distortion Summary</li><li>
<a id="pgfId-1039123"></a>Rapid IP3</li><li>
<a id="pgfId-1039124"></a>IM2 Distortion Summary</li><li>
<a id="pgfId-1039125"></a>Rapid IP2</li></ul>



<p>
<a id="pgfId-1039126"></a>These four perturbation-based analyses characterize </p><ul><li>
intermodulation</li></ul><p>
 distortion and compression distortion for RF circuits such as mixers and amplifiers.</p>
<p>
<a id="pgfId-1039127"></a>Distortion is an important issue in RF circuits such as mixers, low-noise amplifiers (LNAs) and power amplifiers (PAs). Compression and intermodulation distortion are the two aspects of distortion that are of greatest concern. At high frequencies, and particularly with narrowband circuits, it is common to characterize the distortion produced by a circuit in terms of a compression point (CP) or an intercept point (IP). These metrics characterize the circuit rather than the signal, and as such it is not necessary to specify the signal level at which the circuit is characterized.</p>

<h3>
<a id="pgfId-1039128"></a>About the IM2 Intermodulation Distortion Summary</h3>

<p>
<a id="pgfId-1039129"></a>The 3rd order intermodulation distortion occurs when input signals at frequencies <em>f</em><sub>1</sub> and <em>f</em><sub>2</sub> mix together to form the response at <em>2f</em><sub>1</sub><em> &#8211; f</em><sub>2</sub> and <em>2f</em><sub>2</sub><em> &#8211; f</em><sub>1</sub>. When <em>f</em><sub>1</sub> and <em>f</em><sub>2</sub> are close enough in frequency, the intermodulation products <em>2f</em><sub>1</sub><em> &#8211; f</em><sub>2</sub> and <em>2f</em><sub>2</sub><em> &#8211; f</em><sub>1</sub> will fall within the bandwidth of the circuit and will interfere with the input signal.</p>
<p>
<a id="pgfId-1044208"></a>Intermodulation distortion is typically measured in the form of an intercept point. As shown in Figure <a href="chap1.html#45220">1-8</a>, you can determine the 3rd order intercept point (IP3) by plotting the power of the fundamental and the 3rd order intermodulation product (IM3) versus the input power. You should plot both input and output power in some form of dB. Thus, when you measure IP3, the fundamental power curve is extrapolated from where the curve has a slope of 1 over a broad region. The 3rd order intermodulation product is extrapolated from a point where its curve has a slope of 3 over a broad region. Extrapolate both curves from a low power level and identify the intercept point as the point where they cross.</p>
<p>
<a id="pgfId-1044234"></a>For Rapid IP3 analysis in Spectre RF, the IP3 is obtained at an input power where the user is confident of 1st order and 3rd order linearity.</p>

<p><strong>Figure 1-8
<a id="pgfId-1039134"></a><a id="45220"></a>IP3 Measurement</strong></p>
<p>
<a id="pgfId-1039138"></a></p>
<div class="webflare-div-image">
<img src="images/IP3Theory.gif" /></div>

<p>
<a id="pgfId-1039139"></a>For some applications, such as direct conversion mixers, IP2 is important to characterize the circuit for the 2nd order intermodulation products (IM2) <em>f</em><sub>1</sub><em> &#8211; f</em><sub>2</sub><em> or f</em><sub>2</sub><em> &#8211; f</em><sub>1</sub> which will fall within the bandwidth of the output signal. The definition of IP2 is similar to IP3. The difference is that the 2nd order intermodulation product is extrapolated from a point where its curve has a slope of 2.</p>
<p>
<a id="pgfId-1044235"></a>For Rapid IP2 analysis in Spectre RF, the IP2 is obtained at an input power where you are confident of the 1st order and 2nd order linearity. </p>
<p>
<a id="pgfId-1039140"></a>Rapid IP2 analysis produces the value of IP2 for the whole circuit, while the IM2 Distortion Summary analysis produces a list of the various distortion contributors and how much distortion they contribute to the output. That is, IM2 Distortion Summary computes the contribution of each nonlinear device to the total IM2. The result is accurate because there is no presumption in computation.</p>

<h3>
<a id="pgfId-1039141"></a>About the Compression Distortion Summary</h3>

<p>
<a id="pgfId-1039145"></a>Consider the circuit in Figure <a href="chap1.html#65639">1-9</a>. The system has a time-dependent operating point <em>V</em>0(<em>t</em>) at frequency ω­<sub>LO</sub> (for an LNA or PA, the operating point is time-independent, so ­ω<sub>LO</sub> = <em>0</em>). </p>

<p><strong>Figure 1-9
<a id="pgfId-1044244"></a><a id="65639"></a>A Simple Circuit Representation </strong></p>
<p>
<a id="pgfId-1044248"></a></p>
<div class="webflare-div-image">
<img src="images/SimpleCircuitTheory.gif" /></div>

<p>
<a id="pgfId-1044239"></a>As shown in Equation <a href="chap1.html#38170">1-17</a>, when the RF input signal is applied, the output signal at ­ω<sub>RF</sub> + <em>n</em>­ω<sub>LO</sub> is a function of input magnitude <em>V</em><sub>RF</sub>. </p>

<p>
<a id="pgfId-1039158"></a></p>
<table class="webflareTable" id="#id1039149">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-17)
<a id="pgfId-1039152"></a><a id="38170"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1039157"></a><img width="335" height="57" src="images/chap1-27.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1039159"></a>The first term is the linear response to the RF input. Coefficient <em>c</em>1 can be obtained by small signal analysis. Other terms are distortion due to third and higher order nonlinear response. (For the Compression Distortion Summary analysis in Spectre RF, the highest nonlinear term concerned is the third order.) The total distortion, as represented in Equation <a href="chap1.html#73204">1-18</a>, is measured in dB. </p>

<p>
<a id="pgfId-1039172"></a></p>
<table class="webflareTable" id="#id1039163">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-18)
<a id="pgfId-1039166"></a><a id="73204"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1039171"></a><img width="188" height="74" src="images/chap1-28.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1039173"></a>While you want to know the contribution of each individual device to the total distortion, mathematically it is impossible to make such separation for third or higher order nonlinearity. To quantify the effect of nonlinear response at a particular device on the output signal, the Compression Distortion Summary assumes that the rest of the circuit responds to the RF signal linearly and computes the distortion in the output caused solely by the nonlinear response at this device. With this approach, although the circuit is hypothetical, the result provides useful information about how sensitive the device is to distortion. Effects of the nonlinear response of the device and the transfer function from the device nodes to output nodes are reflected in the calculation. What is missing is the interaction between the devices. </p>
<p>
<a id="pgfId-1039180"></a>It is important to point out that since the operating point is time-dependent, all the other devices are still nonlinear in the calculations. Only their response to the RF signal is linearized. In particular, for mixer cases, transistors in the LO block still function nonlinearly to generate the clock signal. However, their contribution to output distortion is expected to be very small in the distortion summary because the RF signal usually does not disturb the LO part of the circuit. Both linear and nonlinear responses in the LO block are almost zero. </p>

<h3>
<a id="pgfId-1039181"></a>About the Perturbation Method</h3>

<p>
<a id="pgfId-1039182"></a>SpectreRF supplies four specialized PAC analyses to solve weakly nonlinear circuits based on the perturbation approach. </p>
<ul><li>
<a id="pgfId-1039183"></a>Rapid IP3 </li><li>
<a id="pgfId-1039184"></a>Rapid IP2 </li><li>
<a id="pgfId-1039185"></a>IM2 Distortion Summary </li><li>
<a id="pgfId-1039186"></a>Compression Distortion Summary </li></ul>



<p>
<a id="pgfId-1039187"></a>In previous versions of SpectreRF, you could use either QPSS-based or QPAC-based methods to calculate IP3 for systems containing a mixer and a LO. In the QPSS-based method, three-tone QPSS analysis with LO, RF1 and RF2 tones at the frequencies ω<sub>LO</sub>, ω<sub>RF1</sub> and ω<sub>RF2</sub> respectively, is run at a given RF power level. IM3 of harmonic <em>2</em>ω<sub>RF1</sub> -&#160;&#160;ω<sub>RF2 </sub>- ω<sub>LO</sub> is obtained from the solution. Assuming RF power is low enough and IM3 is dominated by leading order <em>V</em><sub>RF</sub><sup>3</sup> terms, <em>log</em>(<em>V</em><sub>IM3</sub>) is expected to be a linear function of log(<em>V</em><sub>RF</sub>) with a slope of 3. IP3 is then extrapolated from <em>V</em><sub>IM3</sub>. Here <em>V</em><sub>IM3</sub> and <em>V</em><sub>RF</sub> are amplitudes of the IM3 and RF signals, respectively. The QPSS-based method requires very high accuracy to accommodate large dynamic range between RF and LO signals because they are mixed in the same solution vector. For large circuits, the QPSS-based method also relies on speed and convergence of the multi-tone QPSS analysis.</p>
<p>
<a id="pgfId-1039188"></a>In the QPAC-based method, a two-tone QPSS analysis at frequencies­ ω<sub>RF1</sub> and ω­<sub>LO</sub> is run first. Then RF2 input is included as a small signal by the QPAC analysis to calculate IM3 at 2ω­<sub>RF1</sub> -­ ω<sub>RF2</sub> - ω<sub>LO</sub>. As in the QPSS-based method, the QPAC-based method also has to cover dynamic range between RF1 and LO and depends on convergence of the two-tone QPSS analysis.</p>
<p>
<a id="pgfId-1039189"></a>Compared to the QPSS-based approach, the QPAC-based approach reduces computation from a three-tone QPSS analysis to a two-tone QPSS analysis plus a QPAC analysis by applying first order perturbation to the RF2 signal. You can further reduce the amount of computation by treating both RF signals as perturbation to the steady-state operating point at the LO frequency with zero RF input. In this way, leading order intermodulation between the RF1 and RF2 signals in IM3 can be computed directly from third-order perturbation. Since no multi-tone large signal simulation is needed, this can dramatically improve efficiency and avoid the convergence problem of multi-tone simulation.</p>
<p>
<a id="pgfId-1039190"></a>Now SpectreRF can use a perturbation-based approach to solve weakly nonlinear circuits based on Born approximation. The perturbation-based approach does not require explicit high order derivatives from the device model. All equations are formulated in the form of RF harmonics that can be implemented in both the time and frequency domains.</p>
<p>
<a id="pgfId-1039194"></a>For a nonlinear system, you can express the circuit equation as in Equation <a href="chap1.html#41428">1-19</a>. </p>

<p>
<a id="pgfId-1039204"></a></p>
<table class="webflareTable" id="#id1039195">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-19)
<a id="pgfId-1039198"></a><a id="41428"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1039203"></a><img width="166" height="43" src="images/chap1-29.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1039205"></a>in this equation </p>
<ul><li>
<a id="pgfId-1039206"></a>The first term is the linear part </li><li>
<a id="pgfId-1039207"></a>The second term is the nonlinear part </li><li>
<a id="pgfId-1039208"></a><em>s</em> is the RF input source </li><li>
<a id="pgfId-1039209"></a>ε is introduced to track the order of the perturbation expansion </li></ul>



<p>
<a id="pgfId-1039213"></a>Under weakly nonlinear conditions, the nonlinear part of Equation <a href="chap1.html#41428">1-19</a> is small compared to the linear part. This allows you to solve the equation using Born approximation iteratively as shown in Equation <a href="chap1.html#22962">1-20</a>. </p>

<p>
<a id="pgfId-1039226"></a></p>
<table class="webflareTable" id="#id1039217">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-20)
<a id="pgfId-1039220"></a><a id="22962"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1039225"></a><img width="264" height="54" src="images/chap1-30.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1039230"></a>In Equation <a href="chap1.html#22962">1-20</a>, <em>u</em><sup>(</sup>n) is the approximation of <em>v</em> and it is accurate to the order of <em>O </em>(ε<sup>n</sup>). </p>
<p>
<a id="pgfId-1039231"></a>Since the evaluation of <em>F</em><sub>NL</sub> takes full nonlinear device evaluation of <em>F</em> and its first derivative, no higher order derivatives are needed. This allows you to carry out higher order perturbation without modifying your current device models. Also, the dynamic range of perturbation calculations covers only RF signals. This gives the perturbation method advantages in terms of accuracy. </p>

<h3>
<a id="pgfId-1039232"></a>Frequently Asked Questions and Answers</h3>

<p>
<a id="pgfId-1039233"></a><strong>How do I select the input power for perturbation-based measurements?</strong></p>
<p>
<a id="pgfId-1039234"></a>The perturbation method works best under weakly nonlinear conditions. High input power which induces most nonlinearity will produce an unreasonable result. Input power that is too low will blend with the numerical noise floor. A recommended input power range for general circuits is -50 dBm to -20 dBm.</p>
<p>
<a id="pgfId-1039235"></a><strong>Why is dB the unit used in the Compression Distortion Summary while Volts is the unit used in the IM2 Distortion Summary?</strong></p>
<p>
<a id="pgfId-1039236"></a>Compression distortion evaluates distortion as the ratio of total output (linear and nonlinear) to the linear output. IM2 Distortion Summary computes the contribution of each nonlinear device to the total IM2. </p>
<p>
<a id="pgfId-1039237"></a><strong>How do I measure the IP2 of a double balanced mixer?</strong></p>
<p>
<a id="pgfId-1039238"></a>It is well known that the IP2 of an ideal double-balanced mixer is infinite. In practice, IP2 is a function of the matching between two branches. To measure IP2, add a small amount of mismatch, such as 2%, to the transistors and resistors between the two branches. Then run a worst case simulation.</p>
<p>
<a id="pgfId-1039239"></a><strong>Why should I set the RF input source to DC?</strong></p>
<p>
<a id="pgfId-1039240"></a>The perturbation method is a nonlinear small signal analysis. The analysis treats the RF signal as the small signal which is defined by <strong>pacmag</strong> (or <strong>pacdbm</strong>). If you set up the RF signal to be sinusoidal (or some other type of large signal), the PSS and small signal results will be affected.</p>
<p>
<a id="pgfId-1039241"></a><strong>Why might the Rapid IP2 result seem inaccurate, inconsistent, or just plain wrong?</strong></p>
<p>
<a id="pgfId-1039242"></a>Rapid IP2 is recommended to measure IP2 for direct-conversion mixers. For ordinary LNAs or mixers, the IM2 frequency is out of the work frequency band and the Rapid IP2 measurement produces a less meaningful result. </p>
<p>
<a id="pgfId-1039243"></a><strong>Why do the shooting and flexible balance PSS simulation engines produce different results?</strong></p>
<p>
<a id="pgfId-1039244"></a>Usually, the shooting and flexible balance engines produce results that match well. You can ensure the results will match by setting enough harmonics when you use the flexible balance engine. </p>
<p>
<a id="pgfId-1039245"></a><strong>Why do I see the error &#8220;More than one frequency matches are found&#8230;?&#8221;</strong></p>
<p>
<a id="pgfId-1039246"></a>For perturbation-based measurement, incommensurate frequencies should be used for all tones. If multiple combinations of tone frequencies match either Frequency of Linear Output Signal or Frequency of IM Output Signal, you will see this error message because perturbation-based measurement can&#39;t figure out which frequency you want to use as IM1, IM2 or IM3. In other words, each IM1, IM2 or IM3 frequency should be determined by a unique set of </p>
<p>
<a id="pgfId-1044341"></a>k1 * flo + k2 * frf1 + k3 * frf2 </p>
<p>
<a id="pgfId-1044344"></a>respectively. To avoid this problem, adjust the values of <em>frf1</em> and <em>frf2</em> slightly.</p>

<h3>
<a id="pgfId-1039247"></a>References</h3>

<a id="pgfId-1039261"></a>
<table class="webflareTable" id="#id1039248">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1039250"></a>[1] </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1039252"></a>Behzad Razavi. RF Microelectronics, Prentice Hall, c1998. Series: Prentice-Hall Communications Engineering &amp; Emerging Technologies Series.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1039254"></a>[2] </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1039256"></a>Thomas H. Lee. The Design of CMOS Radio-Frequency Integrated Circuits. Cambridge University Press, 1998.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1039258"></a>[3] </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1039260"></a>Ken Kundert, &#8220;Accurate and Rapid Measurement of IP2 and IP3&#8221;,<br /><code>www.designers-guide.org</code></p>
</td>
</tr>
</tbody></table>
<h2>
<a id="pgfId-1044410"></a><a id="_Toc122434383"></a><a id="_Toc131478138"></a>Large Signal S-Parameters</h2>

<p>
<a id="pgfId-1044411"></a>Characterizing <a id="LSSPs"></a>RF circuits with small-signal S-parameters is a well established practice. However, small-signal S-parameters are not sufficient to describe both strongly nonlinear circuits and circuits that exhibit frequency translation. This is especially true for designs that use power amplifiers and mixers.</p>
<p>
<a id="pgfId-1044412"></a>As a natural extension of small-signal S-parameters, large-signal S-parameters (LSSPs) are defined as the ratio of reflected (or transmitted) waves to incident waves. Since small-signal S-parameters are based on the simulation of a linearized circuit, they are independent of input power. This description illustrates how to measure LSSPs using Spectre and SpectreRF in the Analog Design Environment (ADE).</p>
<p>
<a id="pgfId-1044413"></a>LSSPs are based on large-signal steady state simulation techniques such as SpectreRF&#8217;s PSS analysis with both its time domain shooting Newton (TD) engine and it&#8217;s harmonic balance (HB) engine. LSSPs are sensitive to input power levels.</p>
<p>
<a id="pgfId-1044414"></a>For multi-port circuits, you can represent </p>
<ul><li>
<a id="pgfId-1044415"></a>The reflected wave, <em>
B</em>
<sbtib-subs-times-italic-bold>
i</sbtib-subs-times-italic-bold>
 at port <em>
i </em>
</li><li>
<a id="pgfId-1044416"></a>The incident wave, <em>
A</em>
<sbtib-subs-times-italic-bold>
i</sbtib-subs-times-italic-bold>
 at port <em>
i </em>
</li><li>
<a id="pgfId-1044417"></a>The frequency <em>
k</em>
ω (harmonic <em>
k</em>
)</li></ul>


<p>
<a id="pgfId-1044418"></a>by </p>
<ul><li>
<a id="pgfId-1044419"></a>The port voltage, <em>
V</em>
<sbtib-subs-times-italic-bold>
i</sbtib-subs-times-italic-bold>
 </li><li>
<a id="pgfId-1044420"></a>The current, <em>
I</em>
<sbtib-subs-times-italic-bold>
i</sbtib-subs-times-italic-bold>
 </li><li>
<a id="pgfId-1044421"></a>The termination impedance, <em>
R</em>
<sbtib-subs-times-italic-bold>
i</sbtib-subs-times-italic-bold>
 </li></ul>


<p>
<a id="pgfId-1044422"></a>The multi-port circuit representation is described as follows. </p>
<p>
<a id="pgfId-1044423"></a>The reflected wave, <em>
B</em>
<sub><em>i</em></sub>, at port <em>
i</em>
, and the frequency <em>
k</em>
ω (harmonic <em>
k</em>
) are characterized by Equation <a href="chap1.html#22082">1-21</a>. </p>

<p>
<a id="pgfId-1044436"></a></p>
<table class="webflareTable" id="#id1044427">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-21)
<a id="pgfId-1044430"></a><a id="22082"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1044435"></a><img width="227" height="79" src="images/chap1-31.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1044437"></a>The incident wave, <em>
A</em>
<sub><em>i</em></sub>, at port <em>
i</em>
, and the frequency <em>
k</em>
ω (harmonic <em>
k</em>
) are characterized by Equation <a href="chap1.html#95716">1-22</a>. </p>

<p>
<a id="pgfId-1044450"></a></p>
<table class="webflareTable" id="#id1044441">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-22)
<a id="pgfId-1044444"></a><a id="95716"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1044449"></a><img width="223" height="79" src="images/chap1-32.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1044451"></a>The LSSPs between port <em>
i</em>
 with harmonic <em>
m </em>
and port <em>
j</em>
 with harmonic <em>
n</em>
, are defined as in Equation <a href="chap1.html#36975">1-23</a>.</p>

<p>
<a id="pgfId-1044464"></a></p>
<table class="webflareTable" id="#id1044455">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-23)
<a id="pgfId-1044458"></a><a id="36975"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1044463"></a><img width="188" height="80" src="images/chap1-33.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1044465"></a>Where <em>
A</em>
<sub><em>i</em></sub>(<em>
k</em>
ω) = 0, for all ports other than <em>
j </em>
and for harmonics other than <em>
n</em>
.</p>

<h3>
<a id="pgfId-1044466"></a>Large-Signal S-Parameters for a Two-Port Circuit </h3>

<p>
<a id="pgfId-1044467"></a>Consider calculating LSSPs for a two-port circuit. When you apply a source at port 1 and terminate port 2, as shown in Figure <a href="chap1.html#62155">1-10</a>, you can measure <em>
S</em>
<sub><em>11</em></sub> and <em>
S</em>
<sub><em>12</em></sub> at a given input power P<sub><em>1</em></sub>.</p>

<p><strong>Figure 1-10
<a id="pgfId-1044472"></a><a id="62155"></a>Test Setup to Measure the Large-Signal S-Parameters S11 and S21</strong></p>
<p>
<a id="pgfId-1044476"></a></p>
<div class="webflare-div-image">
<img src="images/TestSetup1.gif" /></div>

<p>
<a id="pgfId-1044479"></a>Similarly, when you apply a source at port 2 and terminate port 1, as shown in the Figure <a href="chap1.html#65850">1-11</a>, you can measure two more LSSPs, <em>
S</em>
<sub><em>12</em></sub> and <em>
S</em>
<sub><em>22</em></sub>. </p>

<p><strong>Figure 1-11
<a id="pgfId-1044482"></a><a id="65850"></a>Test Setup to Measure the Large-Signal S-Parameters S12 and S22 </strong></p>
<p>
<a id="pgfId-1044486"></a></p>
<div class="webflare-div-image">
<img src="images/TestSetup2.gif" /></div>

<p>
<a id="pgfId-1044487"></a>To be consistent with the input power level measured for <em>
S</em>
<sub><em>11</em></sub> and <em>
S</em>
<sub><em>21</em></sub>, you can compute the power applied to port 2 in this stage using the relationship in Equation <a href="chap1.html#43556">1-24</a>. </p>

<p>
<a id="pgfId-1044500"></a></p>
<table class="webflareTable" id="#id1044491">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-24)
<a id="pgfId-1044494"></a><a id="43556"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1044499"></a><img width="135" height="59" src="images/chap1-36.gif" /></p>
</td>
</tr>
</tbody></table>
<h3>
<a id="pgfId-1044759"></a><a id="_Toc122434384"></a><a id="_Toc131478139"></a><a id="_Toc122434388"></a><a id="_Toc131478144"></a>References</h3>
<p>
<a id="pgfId-1044769"></a></p>
<table class="webflareTable" id="#id1044760">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1044762"></a>[1] </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1044764"></a>V. Rizzoli, A. Lipparini, F. Mastri, &#8220;Computation of Large-Signal S-parameters by Harmonic-Balance Techniques,&#8221; in <em>Electronics Letters</em>, Vol. 24, Issue 6, pp. 329-330, 17 Mar 1988. </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1044766"></a>[2] </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1044768"></a>Jan Verspecht, Frans Verbeyst, Marc Vanden Bossche, &#8220;Network Analysis Beyond S-parameters: Characterizing and Modeling Component Behavior under Modulated Large-Signal Operating Conditions,&#8221; in <em>56th ARFTG Conference Proceedings</em>, Broomfield, Colorado, USA, December 2000. </p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1044911"></a></p>

<h2>
<a id="pgfId-1044914"></a>Using the PSTB and STB Analyses with Linear Periodic Time-Varying Circuits </h2>

<p>
<a id="pgfId-1044915"></a>The Spectre stability analysis (STB) rapidly evaluates the stability of feedback circuits. As is true for all small signal analyses, the circuit under analysis must first be linearized about a DC operating point before the STB small signal analysis is performed. After the circuit is linearized about a DC operating point, the STB analysis then calculates the loop gain, gain margin and phase margin for the circuit using a subset of Nyquist criteria. </p>
<p>
<a id="pgfId-1044916"></a>it is also important to evaluate the stability of periodic steady state regimes of nonlinear circuits such as power amplifiers, injection locked oscillators and dividers. The STB analysis fails to predict the behavior of periodic steady state regimes of nonlinear circuits due to the nonlinear effects these circuits produce. </p>
<p>
<a id="pgfId-1044917"></a>Periodic stability analysis (PSTB) performs stability analysis for circuits with a periodically time-varying operating point, which must first be obtained using a PSS analysis. The small signal PSTB analysis calculates the loop gain, gain margin and phase margin for circuits with a periodically time-varying operating point.</p>

<h3>
<a id="pgfId-1044918"></a>A Linear Periodic Time-Varying (LPTV) Feedback Circuit </h3>

<p>
<a id="pgfId-1044922"></a>Figure <a href="chap1.html#92233">1-12</a> shows the topology of a general linear time-invariant (LTI) feedback circuit around a specific feedback loop. </p>

<p><strong>Figure 1-12
<a id="pgfId-1044924"></a><a id="92233"></a>Topology for a Linear Feedback Circuit</strong></p>
<p>
<a id="pgfId-1044928"></a></p>
<div class="webflare-div-image">
<img src="images/LinFeedPSTB1.gif" /></div>

<p>
<a id="pgfId-1044932"></a>Equation <a href="chap1.html#66832">1-25</a> defines the closed-loop transfer function </p>

<p>
<a id="pgfId-1044942"></a></p>
<table class="webflareTable" id="#id1044933">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-25)
<a id="pgfId-1044936"></a><a id="66832"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1044941"></a><img width="226" height="55" src="images/chap1-38.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1044943"></a>where X(s) and Y(s) represent input and output respectively. </p>
<p>
<a id="pgfId-1044947"></a>Equation <a href="chap1.html#78318">1-26</a> defines loop gain. </p>

<p>
<a id="pgfId-1044957"></a></p>
<table class="webflareTable" id="#id1044948">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-26)
<a id="pgfId-1044951"></a><a id="78318"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1044956"></a><img width="148" height="39" src="images/chap1-39.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1044961"></a>For the linear periodic time-variant (LPTV) feedback circuit shown in Figure <a href="chap1.html#80921">1-13</a> </p>
<ul><li>
<a id="pgfId-1044962"></a>The fundamental frequency is ω<sub>o</sub> </li><li>
<a id="pgfId-1044963"></a>The input is <strong><em>X</em></strong>(<em>
s</em>
) = [..., <em>
X</em>
<sub><em>m</em></sub>, ...] <br />
<a id="pgfId-1044964"></a>Where <em>
X</em>
<sub><em>m</em></sub> = <em>
X</em>
(<em>
s </em>
+ <em>
m</em>
∗ω<sub><em>o</em></sub>) and  <em>
m </em>
= 0, ±1,  ±2, ... , <em>
m</em>
 and <em>
n</em>
 represent different sidebands.</li><li>
<a id="pgfId-1044965"></a>The output is <strong><em>Y</em></strong>(<em>
s</em>
) = [..., <em>
Y</em>
<sub>n</sub>, ...] <br />
<a id="pgfId-1044966"></a>Where <em>
Y</em>
<sub><em>n</em></sub> = <em>
Y</em>
(<em>
s </em>
+ <em>
n</em>
∗ω<sub><em>o</em></sub>) and <em>
n </em>
= 0, ±1, ± 2, ... , <em>
m</em>
 and <em>
n</em>
 represent different sidebands. <br /><strong class="webflare-fig-line-height">Figure 1-13
<a id="pgfId-1044968"></a><a id="80921"></a>Topology for a Linear Periodic Time-Variant Feedback Circuit </strong>
<a id="pgfId-1044972"></a><div class="webflare-div-image">
<img src="images/PLTVfeedPSTB2.gif" /></div></li></ul>









<p>
<a id="pgfId-1044976"></a>Equation <a href="chap1.html#31382">1-27</a> expresses the closed-loop harmonic transfer matrix (<strong>HTM</strong>). </p>

<p>
<a id="pgfId-1044986"></a></p>
<table class="webflareTable" id="#id1044977">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-27)
<a id="pgfId-1044980"></a><a id="31382"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1044985"></a><img width="232" height="43" src="images/chap1-41.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1044987"></a>where <strong>A</strong>(s) and <strong>F</strong>(s) are matrixes and <strong>I</strong> is the identity matrix. </p>

<h3>
<a id="pgfId-1044988"></a>Evaluating the Stability of a LPTV Circuit Using PSTB Analysis</h3>

<p>
<a id="pgfId-1044992"></a>If you treat the feedback loop determined by Equation <a href="chap1.html#31382">1-27</a> as a multi-input multi-output (MIMO) system, the poles of any transfer function of the system are the same [1]. If you express a kind of transfer function of the zero sideband in the feedback loop as in Equation <a href="chap1.html#32722">1-28</a>, you can obtain an exact open-loop transfer function −μ(<em>
s</em>
) by applying the loop-based algorithm [2] to the zero sideband. </p>
<p>
<a id="pgfId-1044996"></a></p>

<p>
<a id="pgfId-1045006"></a></p>
<table class="webflareTable" id="#id1044997">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-28)
<a id="pgfId-1045000"></a><a id="32722"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045005"></a><img width="280" height="68" src="images/chap1-42.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1045007"></a>To evaluate stability, apply the Nyquist criteria to μ(<em>
s</em>
) (loop gain). This requires three steps you can perform using PSTB analysis. </p>
<ol><li>
<a id="pgfId-1045008"></a>Calculate μ(0 + <em>j</em>ω) by sweeping ω </li><li>
<a id="pgfId-1045009"></a>Plot μ(0 + <em>j</em>ω) in a Bode plot or a Nyquist plot </li><li>
<a id="pgfId-1045010"></a>Judge stability in one of the following two ways <ul><li>
<a id="pgfId-1045011"></a>By the magnitude and phase of the loop gain <br />
<a id="pgfId-1045012"></a>or </li><li>
<a id="pgfId-1045013"></a>By the number of clockwise encirclements of the (1, 0) point on the loop gain curve </li></ul></li></ol>







<p>
<a id="pgfId-1045014"></a>This stability check is restricted to local stability in the sense that the results are only valid under small perturbations of the steady state (that is, by small signal analysis). A large perturbation might induce the circuit to permanently jump to a different steady state. To account for the large perturbation requires a global stability analysis in the parameter space. </p>

<p>
<a id="pgfId-1045032"></a></p>
<table class="webflareTable" id="#id1045015">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-29)
<a id="pgfId-1045018"></a><a id="94123"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045023"></a><img width="120" height="37" src="images/chap1-43.gif" /></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-30)
<a id="pgfId-1045026"></a><a id="34202"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045031"></a><img width="161" height="37" src="images/chap1-44.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1045036"></a>Equation <a href="chap1.html#94123">1-29</a> is a PSS analysis equation. The parameter <em>A</em> can dramatically affect the circuit&#8217;s steady state solution, such as source power or amplitude. The bifurcation curves are the solutions in the (&#x2126;, A) space that meet Equation <a href="chap1.html#34202">1-30</a>. This means that to determine global stability, you can use a two-dimensional (&#x2126;, A) parameter sweep combining the PSS and PSTB analyses. This process might be time-consuming. </p>

<h3>
<a id="pgfId-1045042"></a>Example 1: Comparing the STB and PSTB Analyses </h3>

<p>
<a id="pgfId-1045046"></a>Figure <a href="chap1.html#97670">1-14</a>, the <code>oscHartley</code> schematic, is an inherently nonlinear VCO. You can use the STB and PSTB analyses on the Hartley VCO to compare the nonlinearity effect on circuit stability. </p>

<p><strong>Figure 1-14
<a id="pgfId-1045048"></a><a id="97670"></a>Hartley Oscillator (oscHartley)</strong></p>
<p>
<a id="pgfId-1045052"></a></p>
<div class="webflare-div-image">
<img src="images/HARTLEYoscPSTB3.gif" /></div>

<p>
<a id="pgfId-1045053"></a>This VCO has the basic Hartley oscillator topology and is tunable between 720 MHz and 1.15 GHz. The oscillation frequency (<em>
f</em>
<sub><em>0</em></sub>) is determined by the resonant circuit made up of inductors <em>L0</em>, <em>L1</em> and capacitor <em>C1</em>. In this particular VCO, the values of <em>L1</em> and <em>L2</em> are fixed whereas <em>C1</em> is a varactor diode. As a result, <code>Cvar</code>, the varactor diode s-junction capacitance, is a function of the applied voltage, as expressed in Equation <a href="chap1.html#88816">1-31</a>. </p>

<p>
<a id="pgfId-1045066"></a></p>
<table class="webflareTable" id="#id1045057">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-31)
<a id="pgfId-1045060"></a><a id="88816"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045065"></a><img width="153" height="101" src="images/chap1-46.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1045070"></a>In Equation <a href="chap1.html#88816">1-31</a> </p>
<ul><li>
<a id="pgfId-1045071"></a><em>
V</em>
 is the applied junction voltage (<em>V</em>) </li><li>
<a id="pgfId-1045072"></a><em>
C</em>
<sub><em>j0</em></sub> is the junction capacitance (<em>
F</em>
) for <em>
V</em>
 = <em>0V</em> </li><li>
<a id="pgfId-1045073"></a>Φ is the barrier potential (<em>V</em>) </li><li>
<a id="pgfId-1045074"></a>γ is the junction gradient coefficient </li></ul>



<p>
<a id="pgfId-1045075"></a>These variables have the following values </p>

<p>
<a id="pgfId-1045089"></a></p>
<table class="webflareTable" id="#id1045076">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045078"></a><em>
C</em>
<sub><em>j0 </em></sub></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045080"></a><code>8 pF</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045082"></a>Φ</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045084"></a><code>0.75 V</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045086"></a>γ</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045088"></a><code>0.4</code></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1045090"></a>Because <em>
C</em>
<sub><em>var</em></sub> is inversely proportional to <em>
V</em>
 and <em>
f</em>
<sub><em>o</em></sub> is inversely proportional to <em>
C</em>
<sub><em>var</em></sub>, the oscillation frequency is proportional to <em>
V</em>
. In other words, as you increase <em>
V</em>
, <em>
C</em>
<sub><em>var</em></sub> decreases and <em>
f</em>
<sub><em>o</em></sub> increases. </p>

<h4>
<a id="pgfId-1045091"></a>Set up for the STB and PSTB Analyses</h4>

<p>
<a id="pgfId-1045092"></a>Open the <code>oscHartley</code> schematic from your writable copy of the <em>rfExamples</em> library.</p>

<h4><em>
<a id="pgfId-1045093"></a><strong><em>Set the Initial Conditions</em></strong> for the STB Analysis</em></h4>

<ol><li>
<a id="pgfId-1045094"></a>Set up <em>V</em><sub>0</sub> as a dc voltage source (<em>Source type </em>= <em>dc</em>, <em>dc </em>= 5). </li><li>
<a id="pgfId-1045095"></a>Set the voltage on the <em>C</em><sub>var</sub> to 6 V (V_cntl = 6). The oscillator will oscillate at about 1.1 GHz. </li><li>
<a id="pgfId-1045096"></a>Set <code>reltol</code> to 1e<sup>-4</sup> (reltol = 1e<sup>-4</sup>) </li><li>
<a id="pgfId-1045097"></a>Insert a current probe in the feedback loop (IPRB0). </li></ol>




<h4><em>
<a id="pgfId-1045098"></a>Set Up the STB Analysis </em></h4>

<ol><li>
<a id="pgfId-1045099"></a><em>Sweep range</em> (<em>Start </em>= 1000M, Stop = 1200M) </li><li>
<a id="pgfId-1045100"></a><em>Sweep type</em>=<em>linear</em> </li><li>
<a id="pgfId-1045101"></a><em>Number of steps</em>=400 </li><li>
<a id="pgfId-1045102"></a><em>probe</em> = IPRB0 </li></ol>




<h4><em>
<a id="pgfId-1045103"></a>Run the simulation </em></h4>

<p>
<a id="pgfId-1045104"></a>In WaveScan, plot the dB20 (loop gain) and Phase (loop gain) of the STB results. (See Figure <a href="chap1.html#15613">1-15</a>.)</p>

<h4><em>
<a id="pgfId-1045108"></a>Set Up the PSS and PSTB Analyses </em></h4>

<p>
<a id="pgfId-1045109"></a><strong><em>Set the Initial Conditions</em></strong> </p>
<ol><li>
<a id="pgfId-1045110"></a>Change V<sub>0</sub> to a <em>pulse</em> source (<em>val1</em>=0, <em>val2</em>=5, <em>rise</em>=1n) to start the oscillator. </li><li>
<a id="pgfId-1045111"></a>Other parameters are the same as for the STB analysis. </li></ol>


<h4><em>
<a id="pgfId-1045112"></a>Set up a PSS Analysis </em></h4>

<ol><li>
<a id="pgfId-1045113"></a><em>Beat Frequency</em> =1.1G </li><li>
<a id="pgfId-1045114"></a><em>Number of Harmonics</em> =30 </li><li>
<a id="pgfId-1045115"></a><em>errpreset = moderate</em> </li><li>
<a id="pgfId-1045116"></a><em>tstab</em> =100n </li><li>
<a id="pgfId-1045117"></a>Enable the oscillator button </li><li>
<a id="pgfId-1045118"></a>Set <em>Oscillator node</em> = /Vout </li><li>
<a id="pgfId-1045119"></a>Set <em>Reference node</em> = /gnd! </li><li>
<a id="pgfId-1045120"></a>Set <em>Engine=shooting</em> </li></ol>








<h4><em>
<a id="pgfId-1045121"></a>Set up a PSTB Analysis </em></h4>

<ol><li>
<a id="pgfId-1045122"></a><em>Sweep range</em> (<em>Start</em>=1000M, <em>Stop</em>=1.2G)</li><li>
<a id="pgfId-1045123"></a><em>Sweep type=linear</em> </li><li>
<a id="pgfId-1045124"></a><em>Number of steps</em>=400 </li><li>
<a id="pgfId-1045125"></a><em>probe</em> = IPRB0 </li></ol>




<h4><em>
<a id="pgfId-1045126"></a>Run the Simulations </em></h4>

<p>
<a id="pgfId-1045127"></a>In WaveScan, plot the dB20 (loop gain) and Phase (loop gain). Append a Bode Plot of the PSTB results to the same window as the STB results. The plot in Figure <a href="chap1.html#15613">1-15</a> is displayed. </p>
<p>
<a id="pgfId-1045131"></a>For an ideal oscillator, the loop gain at oscillating frequency, <em>
f</em>
<sub><em>0</em></sub>, should be 1, so the dB20 (loopgain) and the Phase (loopgain) should both be zero at <em>
f</em>
<sub><em>0</em></sub> and the phase should change abruptly at <em>
f</em>
<sub><em>0</em></sub>. In practice, both dB20 (loopgain) and the Phase (loopgain) should be close to zero. </p>
<p>
<a id="pgfId-1045135"></a>For this autonomous circuit, the PSS analysis gives <em>
f</em>
<sub><em>0&#160;&#160;</em></sub>= 1.1035 G. From Figure <a href="chap1.html#15613">1-15</a>, the PSTB analysis gives dB20 (loopgain) = 0 and Phase (loopgain) = 0. From Figure <a href="chap1.html#15613">1-15</a>, the STB analysis gives dB20 (loopgain) and Phase (loopgain) far from zero. The results show that a PSTB analysis gives more accurate stability information for nonlinear circuits than does a STB analysis.&#160;&#160; </p>

<p><strong>Figure 1-15
<a id="pgfId-1045140"></a><a id="15613"></a>VCO Loop Gain </strong></p>
<p>
<a id="pgfId-1045144"></a></p>
<div class="webflare-div-image">
<img src="images/VCOloopGainPSTB4.gif" /></div>

<p>
<a id="pgfId-1045148"></a>In Figure <a href="chap1.html#15613">1-15</a> lines with boxes are from the STB analysis, lines without boxes are from the PSTB analysis, solid lines represent magnitude and dotted lines represent phase. </p>

<h3>
<a id="pgfId-1045149"></a>Example 2: Local Stability of an Injection-Locked Oscillator </h3>

<p>
<a id="pgfId-1045156"></a>Figure <a href="chap1.html#94748">1-16</a> shows an injection-locked oscillator based on the VCO in <a href="chap1.html#97670">Figure&#160;1-14</a>. The injection-locked oscillator also includes the following for injection: current source I0, resistor R4 and capacitor C7. The frequency and amplitude of I0 are the parameters <code>inj_freq</code> and <code>inamp</code>. </p>

<p><strong>Figure 1-16
<a id="pgfId-1045158"></a><a id="94748"></a>Schematic of the Injection-Locked Oscillator </strong></p>
<p>
<a id="pgfId-1045162"></a></p>
<div class="webflare-div-image">
<img src="images/InjectLockOscPSTB.gif" /></div>
<h4><em>
<a id="pgfId-1045163"></a>Set the Initial Conditions for the PSS and PSTB Analysis</em></h4>

<ol><li>
<a id="pgfId-1045164"></a>Set <code>inj_freq</code> = 1000M. </li><li>
<a id="pgfId-1045165"></a>Set <code>inamp</code> = 13mA </li><li>
<a id="pgfId-1045166"></a>Other parameters are the same as the PSTB analysis in section 3 a. </li></ol>



<h4><em>
<a id="pgfId-1045167"></a>Set Up the PSS Analysis </em></h4>

<ol><li>
<a id="pgfId-1045168"></a><em>Beat Frequency</em> =1G </li><li>
<a id="pgfId-1045169"></a><em>Number of Harmonics</em> =30 </li><li>
<a id="pgfId-1045170"></a><em>errpreset = moderate</em> </li><li>
<a id="pgfId-1045171"></a><em>tstab</em> =100n </li><li>
<a id="pgfId-1045172"></a><em>Engine=shooting</em></li></ol>





<h4><em>
<a id="pgfId-1045173"></a>Set Up a PSTB Analysis </em></h4>

<ol><li>
<a id="pgfId-1045174"></a><em>Sweep range</em> (<em>Start</em>=1000M, <em>Stop</em>=1.2G) </li><li>
<a id="pgfId-1045175"></a><em>Sweep type=linear</em> </li><li>
<a id="pgfId-1045176"></a><em>Number of steps</em>=400 </li><li>
<a id="pgfId-1045177"></a><em>probe</em> = IPRB0 </li></ol>




<h4><em>
<a id="pgfId-1045178"></a>Run the Simulation </em></h4>

<p>
<a id="pgfId-1045179"></a>In WaveScan, plot the real vs imag (loopgain) of the PSTB analysis. </p>
<p>
<a id="pgfId-1045180"></a>Run the same simulation again but change <code>inamp</code> to 13.85mA. </p>
<p>
<a id="pgfId-1045181"></a>Run the same simulation again but change <code>inamp</code> to 15mA. </p>
<p>
<a id="pgfId-1045185"></a>Plot the results of the three simulations in the same window. The plot in Figure <a href="chap1.html#71807">1-17</a> is displayed. </p>
<p>
<a id="pgfId-1045189"></a>You can see from Figure <a href="chap1.html#71807">1-17</a> when <code>inamp </code>= 13.85mA, the loopgain = 1. (From the Bode plot, the corresponding small signal frequency is 1.114GHz). It implies that there is a potential for a free-running oscillation at 1.114G. </p>

<p><strong>Figure 1-17
<a id="pgfId-1045191"></a><a id="71807"></a>Nyquist Plot of the Loopgain of the Injection-Locked Oscillator</strong></p>
<p>
<a id="pgfId-1045195"></a></p>
<div class="webflare-div-image">
<img src="images/NyquestPlotPSTB5.gif" /></div>

<p>
<a id="pgfId-1045199"></a>In Figure <a href="chap1.html#71807">1-17</a>, the dashed line represents <code>inamp </code>=13mA. The dotted line represents <code>inamp </code>= 13.85mA, The solid line represents <code>inamp </code>=15mA)</p>
<p>
<a id="pgfId-1045200"></a>When <code>inamp</code> is greater than 13.85mA, the loop gain curve does not encircle the (1, 0) point, which implies that the circuit is stable. When <code>inamp</code> is less than 13.85mA, the loop gain curve encircles the (1, 0) point clockwise, which implies that the circuit is unstable. In fact, when you run a PSS analysis with <code>inamp</code>=13mA and increase <code>tstab</code>, such as<code> tstab</code>=40 μs, the PSS analysis does not converge. If you run a long transient analysis, such as when <em>Stop</em>=350 μs, the resulting waveform is not periodic as you can see in Figure <a href="chap1.html#27773">1-18</a>. </p>

<p><strong>Figure 1-18
<a id="pgfId-1045205"></a><a id="27773"></a>The Output Waveform of the Injection-Locked Oscillator With Injection Current inamp = 13 mA </strong></p>
<p>
<a id="pgfId-1045209"></a></p>
<div class="webflare-div-image">
<img src="images/OutputWavePSTB6.gif" /></div>
<h3>
<a id="pgfId-1045210"></a>Example 3: Global Stability of Injection-Locked Oscillators </h3>

<p>
<a id="pgfId-1045214"></a>Equation <a href="chap1.html#10938">1-32</a> represents the locked oscillating condition. </p>

<p>
<a id="pgfId-1045224"></a></p>
<table class="webflareTable" id="#id1045215">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-32)
<a id="pgfId-1045218"></a><a id="10938"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045223"></a><img width="260" height="42" src="images/chap1-51.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1045228"></a>Equation <a href="chap1.html#33717">1-33</a> represents the free-running oscillator condition. </p>

<p>
<a id="pgfId-1045238"></a> </p>
<table class="webflareTable" id="#id1045229">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-33)
<a id="pgfId-1045232"></a><a id="33717"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045237"></a><img width="233" height="52" src="images/chap1-52.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1045245"></a>In Equations <a href="chap1.html#10938">1-32</a> and <a href="chap1.html#33717">1-33</a> </p>
<ul><li>
<a id="pgfId-1045246"></a><em>
inj_freq</em>
 represents the injection frequency </li><li>
<a id="pgfId-1045247"></a><em>
freq</em>
 represent the arbitrary small signal frequency </li><li>
<a id="pgfId-1045248"></a><em>
inamp1</em>
 and <em>
inamp2</em>
 are the amplitudes of the injection current </li></ul>


<p>
<a id="pgfId-1045255"></a>You can use the two curves determined by Equations <a href="chap1.html#10938">1-32</a> and <a href="chap1.html#33717">1-33</a> to evaluate the global stability of the circuit. Produce the curves using a PTSB analysis. </p>

<h4><em>
<a id="pgfId-1045256"></a>Set the Initial Conditions for the PSS and PSTB Analyses </em></h4>

<ol><li>
<a id="pgfId-1045257"></a>Set <code>inj_freq</code> = 1075M. </li><li>
<a id="pgfId-1045258"></a>Set <code>inamp</code> = 16mA </li><li>
<a id="pgfId-1045259"></a>Other parameters are the same as used for the previous PSTB analysis. </li></ol>



<h4><em>
<a id="pgfId-1045260"></a>Set Up the PSS Analysis </em></h4>

<ol><li>
<a id="pgfId-1045261"></a><code>Beat Frequency</code> =1075M </li><li>
<a id="pgfId-1045262"></a><code>Number of Harmonics</code> =30</li><li>
<a id="pgfId-1045263"></a><code>errpreset = moderate</code> </li><li>
<a id="pgfId-1045264"></a><code>tstab</code> =100n </li><li>
<a id="pgfId-1045265"></a><code>Engine=shooting</code> </li></ol>





<h4><em>
<a id="pgfId-1045266"></a>Set Up the PSTB Analysis </em></h4>

<ol><li>
<a id="pgfId-1045267"></a><code>Sweep range</code> (<code>Start</code>=1050M, <code>Stop</code>=1.2G) </li><li>
<a id="pgfId-1045268"></a><code>Sweep type=linear</code> </li><li>
<a id="pgfId-1045269"></a><code>Number of steps</code>=400 </li><li>
<a id="pgfId-1045270"></a><code>probe</code> = IPRB0 </li></ol>




<h4><em>
<a id="pgfId-1045271"></a>Set Up a Parametric Analysis to Evaluate Global Stability </em></h4>

<ol><li>
<a id="pgfId-1045272"></a><code>Variable name</code> = <code>inamp</code> </li><li>
<a id="pgfId-1045273"></a><code>Range Type</code> = <code>From/To </code></li><li>
<a id="pgfId-1045274"></a><code>From</code>=16mA </li><li>
<a id="pgfId-1045275"></a><code>To</code>=20mA </li><li>
<a id="pgfId-1045276"></a><code>Step Control</code> = <code>Linear steps </code></li><li>
<a id="pgfId-1045277"></a><code>Step Size</code> =0.5mA </li></ol>






<h4><em>
<a id="pgfId-1045278"></a>Run the simulation </em></h4>

<p>
<a id="pgfId-1045282"></a>In WaveScan, plot the loop gain as a Bode Plot similar to Figure <a href="chap1.html#67107">1-19</a>. </p>
<p>
<a id="pgfId-1045283"></a>You can see that when <code>inamp</code> = 16.5 mA and <code>loopgain</code>  = 1 at frequency 1.114 GHz, the circuit is a potential free-running oscillation. When <code>inamp</code> is less than 16.5 mA, the circuit is unstable (you can find this in a corresponding Nyquist Plot). When <code>inamp</code> increases, free-running oscillation disappears and the circuit tends to be locally stable. However, when <code>inamp</code> increases to 19.5 mA, another oscillation occurs at 1075 M, which implies that the circuit is locked to oscillate at the injection frequency. When <code>inamp</code> is greater than 19.5 mA, the circuit again tends to stabilize. From Figure <a href="chap1.html#10938">1-32</a>, you can clearly observe the injecting-locking process as you increase the injection current. </p>
<p>
<a id="pgfId-1045287"></a>Not all injection frequencies can be locked. Only those injection frequencies near a free-running frequency can be locked. A complete global stability evaluation requires a two dimensional sweep of (<code>inj_freq</code>, <code>inamp</code>). However, it is not easy to obtain two curves accurately around the locked area for the strong competition between locked mode and free running mode. This unstable property will lead to PSS analyses that cannot converge and PSTB analyses that cannot run. </p>

<p><strong>Figure 1-19
<a id="pgfId-1045289"></a><a id="67107"></a>Bode Plot of Loop Gain with inj_freq = 1075M </strong></p>
<p>
<a id="pgfId-1045293"></a></p>
<div class="webflare-div-image">
<img src="images/BodePlotPSTB7.gif" /></div>
<h2>
<a id="pgfId-1045294"></a>References </h2>
<p>
<a id="pgfId-1045304"></a></p>
<table class="webflareTable" id="#id1045295">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045297"></a>[1]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045299"></a>Ogata K, Modern control engineering, Printice-Hall, 1998. </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045301"></a>[2]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045303"></a>Michael Tian, V. Visvanathan, Jeffrey Hantgan, and Kenneth Kundert, &quot;striving for small-signal stability&quot;, IEEE Circuit &amp; Devices, Jan 2001(31). </p>
</td>
</tr>
</tbody></table>
<h2>
<a id="pgfId-1045386"></a>The Spectre/RF MATLAB Toolbox </h2>

<p>
<a id="pgfId-1045388"></a>The MATLAB<sup>&#174;</sup> Toolbox provides an interface between both the Spectre and UltraSim<sup>&#174;</sup> circuit simulation technologies and the MATLAB data manipulation environment. This section describes how to use the toolbox to read Spectre simulation results into MATLAB and to use MATLAB to perform some standard RF measurements. </p>
<p>
<a id="pgfId-1045389"></a>The toolbox provides all Spectre and SpectreRF users with an alternative method for post-processing simulation data and making standard RF measurements in MATLAB. The toolbox allows experienced SpectreRF users to use Simulink<sup>&#174;</sup> and MATLAB to make customized measurements on information extracted from Spectre simulation results. Experienced users can also perform high-level design tasks in Simulink<sup> </sup>and MATLAB. </p>
<p>
<a id="pgfId-1045390"></a>MATLAB, a powerful mathematical and graphic tool, provides rich data processing and display functionality. Many users want to customize their measurements and displays. The toolbox supports these use models.</p>
<p>
<a id="pgfId-1045391"></a>The MATLAB Toolbox includes a number of functions you can use to</p>
<ul><li>
<a id="pgfId-1045392"></a>Read Spectre simulation results in PSF or SST2 format into MATLAB</li><li>
<a id="pgfId-1045393"></a>Perform basic data filtering and plotting tasks </li><li>
<a id="pgfId-1045394"></a>Support typical RF measurements such as IP3 and compression point </li></ul>



<h3>
<a id="pgfId-1045397"></a>Install the Toolbox Package </h3>

<p>
<a id="pgfId-1045398"></a>The MATLAB Toolbox is a standalone package shipped with MMSIM version 6.1 and higher. The home directory for the toolbox is </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045399"></a><code>&lt;instdir&gt;/tools/spectre/matlab </code></pre>

<p>
<a id="pgfId-1045400"></a>where <code>&lt;instdir&gt;</code> is the installation directory for the MMSIM simulation software. In the MATLAB Toolbox there are 3 <code>MEX</code>-files and 12 <code>M</code>-files. </p>

<div class="webflare-information-macro webflare-macro-tip">
<a id="pgfId-1045401"></a>
Use the `<code>cds_root spectre</code>` command to determine the installation directory of your MMSIM simulation software. </div>
<h3>
<a id="pgfId-1045402"></a>Configure the Toolbox Package </h3>

<p>
<a id="pgfId-1045403"></a>The Spectre/RF Toolbox in MATLAB depends on the Spectre simulation run environment. It uses shared libraries located in the Spectre installation path.</p>
<ol><li>
<a id="pgfId-1045404"></a>Make sure you are running Spectre 6.0 or a higher version.</li><li>
<a id="pgfId-1045405"></a>Verify the dynamic library path by checking the <code>LD_LIBRARY_PATH</code> environment variable. Make sure that both <code>&lt;instdir&gt;/tools/dfII/lib</code> and <code>&lt;instdir&gt;/tools/lib</code> are in the path. For C shell users, use the following command </li></ol>


<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045406"></a>setenv LD_LIBRARY_PATH `cds_root spectre`/tools/dfII/lib:`cds_root spectre`/tools/lib:${LD_LIBRARY_PATH}</pre>

<ol><li>
<a id="pgfId-1045407"></a>Solaris users also need to add the toolbox installation path to <code>LD_LIBRARY_PATH</code>. For C shell users, use the following command</li></ol>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045408"></a>setenv LD_LIBRARY_PATH `cds_root spectre`/tools/spectre/matlab:${LD_LIBRARY_PATH}</pre>

<ol><li>
<a id="pgfId-1045409"></a>The MATLAB script sets the <code>MATLABPATH</code> environment variable to include the MATLAB toolbox directories and the user created directories. You need to add the toolbox installation path to the <code>MATLABPATH</code> environment variable. For C shell users, use the following command <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1045410">
<a id="pgfId-1045410"></a>setenv MATLABPATH `cds_root spectre`/tools/spectre/matlab:${MATLABPATH}</pre></li></ol>


<h3>
<a id="pgfId-1045411"></a>The Basic Toolbox Functions </h3>

<p>
<a id="pgfId-1045412"></a>Each toolbox function command has an associated help page which you can display by typing <code>help &lt;command_name&gt;</code> in MATLAB. This section introduces the basic toolbox functions, describes how to use each function and describes how to write measurement functions.</p>

<h4>
<a id="pgfId-1045413"></a>cds_srr</h4>

<p>
<a id="pgfId-1045414"></a>Lists the datasets in the result directory, lists signals in a dataset or reads a signal into MATLAB. </p>
<ol><li>
<a id="pgfId-1045415"></a>To list the datasets in the result directory, use the command <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1045416">
<a id="pgfId-1045416"></a><code><em>datalist</em></code> = cds_srr(&#8216;result_directory&#8217;)</pre>
<a id="pgfId-1045417"></a>All <code>dataset</code> names in the result directory are returned with <span class="webflare-courier-new" style="white-space:pre"><em>datalist</em></span> as a string vector. </li><li>
<a id="pgfId-1045418"></a>To list the signal names in a dataset, use the command <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1045419">
<a id="pgfId-1045419"></a><code><em>signals</em></code> = cds_srr(&#8216;result_directory&#8217;, &#8216;dataset_name&#8217;)</pre>
<a id="pgfId-1045420"></a>All <code>signal</code> names and <code>property</code> names in the <code>dataset</code> are returned with <span class="webflare-courier-new" style="white-space:pre"><em>signals</em></span> as a string vector.</li><li>
<a id="pgfId-1045421"></a>To read a signal into MATLAB, give both a <code>dataset</code> name and a <code>signal</code> name and use the command <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1045422">
<a id="pgfId-1045422"></a><code><em>signal</em></code> = cds_srr(&#8216;result_directory&#8217;, &#8216;dataset_name&#8217;, &#8216;signal_name&#8217;)</pre>
<a id="pgfId-1045423"></a>The value of the <code>signal</code> is returned with <span class="webflare-courier-new" style="white-space:pre"><em>signal</em></span>. The <code>signal</code> can be a single value or a structure containing a matrix.<br />
<a id="pgfId-1045424"></a>Normally, when you use <strong>cds_srr</strong> to read a signal into MATLAB, <strong>cds_srr</strong> returns a structure containing fields. The first field is <code>info</code>, a string vector of <code>name,</code> <code>unit</code> pairs. In each pair, the first value is the <code>name</code> of the field, the second value is the <code>unit</code> of the field. The first <code>name,</code> <code>unit</code> pair in the <code>info</code> field describes the final value, the other pairs describe the sweep information if the signal was swept. An inner sweep is always listed before an outer sweep in <code>name,</code> <code>unit</code> pairs in the <code>info</code> field. The innermost sweep can be a matrix with variable sizes in each column, the other sweeps have to be a vector of fixed size.</li></ol>









<p>
<a id="pgfId-1045425"></a>In MATLAB, </p>
<ul><li>
<a id="pgfId-1045426"></a>If a semi-colon (<code>;</code>) is at the end of a command, the system will not display the return results. </li><li>
<a id="pgfId-1045427"></a>Two single quotes (<strong>&#39; &#39;</strong>) mean empty data. <br /><div class="webflare-information-macro webflare-macro-tip">
<a id="pgfId-1045428"></a>
The <strong>cds_srr</strong> command normally returns informational messages. To turn off these messages, use a zero (0) as the fourth parameter. For example, the following command runs silently.</div><pre class="webflare-pre-block webflare-courier-new" id="#id1045429">
<a id="pgfId-1045429"></a>datalist = cds_srr(&#39;results_directory&#39;, &#39;&#39;, &#39;&#39;, 0); </pre></li></ul>





<p>
<a id="pgfId-1045430"></a>The <strong>cds_srr </strong>command supports both PSF and SST2 formats. <strong>cds_srr</strong> is an external function with <strong>cds_innersrr</strong> running in the background. The <strong>cds_srr</strong> and <strong>cds_innersrr</strong> commands have the same interface, but <strong>cds_srr</strong> adds some post processing to make the resulting matrix easier to read.</p>

<h4>
<a id="pgfId-1045431"></a>cds_evalsig</h4>

<p>
<a id="pgfId-1045432"></a>Filters the data from swept analyses. The command is </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045433"></a>v = cds_evalsig(signal, expression)</pre>

<p>
<a id="pgfId-1045434"></a>The first parameter <span class="webflare-courier-new" style="white-space:pre"><em>signal</em></span> is the result of the <strong>cds_srr</strong> command. The second parameter <span class="webflare-courier-new" style="white-space:pre"><em>expression </em></span>is a string expression. You can use both relational operators (<code>&lt;, &lt;=, ==, &gt;=, &gt;&gt;</code>) and logic operators (<code>&amp;,</code> <code>|)</code>. </p>
<p>
<a id="pgfId-1045435"></a>If the <span class="webflare-courier-new" style="white-space:pre"><em>signal</em></span> has the swept fields <code>prf</code> and <code>time</code>, you can write an expression like the following, </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045436"></a>prf &lt; -20 | prf == -10 &amp; time &gt;= 2e-8 </pre>

<p>
<a id="pgfId-1045437"></a>The logic operator <code>(|)</code> is only effective between expressions with the same field name. The following expression is meaningful.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045438"></a><code>prf==-10 | prf &gt;= -20</code> </pre>

<p>
<a id="pgfId-1045439"></a>When the logic operator <code>(|)</code> is used between two different field names, it is equivalent to the logic operator (<code>&amp;</code>). The following two expressions are equivalent.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045440"></a>prf==-10 | time &lt;= 2e-8 </pre>

<p>
<a id="pgfId-1045441"></a>and </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045442"></a>prf==-10 &amp; time &lt;= 2e-8 </pre>
<h4>
<a id="pgfId-1045443"></a>cds_plotsig</h4>

<p>
<a id="pgfId-1045444"></a>Plots swept signals. The command is </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045445"></a>cds_plotsig(signal, expression, sweep_name, type_id)</pre>

<p>
<a id="pgfId-1045446"></a>The first two parameters <span class="webflare-courier-new" style="white-space:pre"><em>signal</em></span> and <span class="webflare-courier-new" style="white-space:pre"><em>expression</em></span> have the same meaning as described for the <strong>cds_evalsig </strong>command. The third parameter <span class="webflare-courier-new" style="white-space:pre"><em>sweep_name</em></span> is the name of a sweep field. You can define a special x-axis with <span class="webflare-courier-new" style="white-space:pre"><em>sweep_name</em></span> when the result has multiple sweeps. The default value for <span class="webflare-courier-new" style="white-space:pre"><em>sweep_name</em></span> is the name of the innermost sweep. The fourth parameter <span class="webflare-courier-new" style="white-space:pre"><em>type_id</em></span> is a string type id that can be any of the following: <code>mag</code>, <code>phase</code>, <code>real</code>, <code>imag</code>, <code>both</code>, <code>db10</code>, <code>db20</code> or <code>dbm</code>. </p>

<h4>
<a id="pgfId-1045447"></a>cds_harmonic</h4>

<p>
<a id="pgfId-1045448"></a>This command is specifically designed for RF results. It helps you to select harmonics and sidebands. In the toolbox data structure created by the <strong>cds_srr</strong> command, all sweep field names are listed in the <code>info</code> field. The harmonic information is not an independent sweep, it always combines frequencies and tones and it is not listed in the <code>info</code> field. The <code>harmonic</code> and <code>harmUnit</code> fields contain the harmonic information. The <strong>cds_harmonic</strong> command can select the interesting harmonics with these pieces of information. The command is </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045449"></a>hsig = cds_harmonic(signal, harms)</pre>

<p>
<a id="pgfId-1045450"></a>For the PSS analysis, <code>harms</code> is a single integer. For the QPSS analysis <code>harms</code> is a vector. For example, use the following command for a QPSS analysis.</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045451"></a>ord3 = cds_harmonic(rfout, [2 -1])</pre>
<h4>
<a id="pgfId-1045452"></a>cds_interpsig</h4>

<p>
<a id="pgfId-1045453"></a>The intervals between time points in Spectre results are not equal. We provide an interpolation command to distribute the time points evenly. The command is </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045454"></a>v = cds_interpsig(signal, sweep_name, num, method)</pre>

<p>
<a id="pgfId-1045455"></a>Where the first parameter <span class="webflare-courier-new" style="white-space:pre"><em>signal</em></span> results from other commands such as <strong>cds_srr</strong>. The second parameter <span class="webflare-courier-new" style="white-space:pre"><em>sweep_name</em></span> is the name of the inner sweep&#8212;normally it is <code>time</code>. The third parameter <span class="webflare-courier-new" style="white-space:pre"><em>num</em></span> is the vector length after interpolation. The fourth parameter <span class="webflare-courier-new" style="white-space:pre"><em>method</em></span> specifies a method for interpolation&#8212;it is a string value which can be <code>linear</code>, <code>cubic</code>, <code>nearest</code> or <code>spline</code>. The default interpolation method is <code>linear</code>.</p>
<p>
<a id="pgfId-1045456"></a>Only the first parameter is required. </p>

<h3>
<a id="pgfId-1045457"></a>The Measurement Commands</h3>
<h4>
<a id="pgfId-1045458"></a>cds_fft</h4>

<p>
<a id="pgfId-1045459"></a>The FFT (Fast Discrete Fourier Transform) is a typical RF measurement. MATLAB provides an internal <code>fft</code> function. The command <strong>cds_fft</strong> calls the internal MATLAB <code>fft</code> function. It prepares the input signal, and calls <code>fft</code> for each outer sweep. The command is </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045460"></a>fsig = cds_fft(tsig)</pre>

<p>
<a id="pgfId-1045461"></a>The input parameter <span class="webflare-courier-new" style="white-space:pre"><em>tsign</em></span> is a time-domain signal. The output parameter <span class="webflare-courier-new" style="white-space:pre"><em>fsig</em></span> contains frequency domain data.</p>

<div class="webflare-information-macro webflare-macro-tip">
<a id="pgfId-1045462"></a>
The <strong>cds_fft</strong> command is a MATLAB script. It is located in the file <code>cds_fft.m</code> in the installation directory. If you want to write your own measurement, this script offers a good example.</div>

<p>
<a id="pgfId-1045463"></a>In <code>cds_fft.m</code>, the script checks the input value at the beginning. The <span class="webflare-courier-new" style="white-space:pre"><em>tsig</em></span> should exist and not be empty. As a time sweep result of <strong>cds_srr</strong>, it must have the fields <code>info</code> and <code>time. </code>Because the intervals between time points in <span class="webflare-courier-new" style="white-space:pre"><em>tsig</em></span> vary, the script calls <strong>cds_interpsig</strong> to distribute the time points evenly. From the vector of field times, the script gets the frequency vector. <span class="webflare-courier-new" style="white-space:pre"><em>tsig</em></span> can also be a multi-level sweep, so it does an fft for each outer sweep. After the fft, it copies additional sweep information from the <span class="webflare-courier-new" style="white-space:pre"><em>tsig</em></span> to <span class="webflare-courier-new" style="white-space:pre"><em>fsig</em></span>, and fills the field <code>time</code> with the field <code>freq</code>.</p>

<h4>
<a id="pgfId-1045464"></a>cds_compression</h4>

<p>
<a id="pgfId-1045465"></a>Returns the n-dB input referred compression point for the wave supplied. The command is </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045466"></a>comp = cds_compression(vport, iport, harm, rport, gcomp, curve)</pre>

<p>
<a id="pgfId-1045467"></a>Where the first parameter <span class="webflare-courier-new" style="white-space:pre"><em>vport</em></span> is the voltage of the port. Normally it is the return value of <strong>cds_srr</strong>. The second parameter <span class="webflare-courier-new" style="white-space:pre"><em>iport</em></span> is the current of the port. It can be calculated from the voltage and impedance. The third parameter <span class="webflare-courier-new" style="white-space:pre"><em>harm</em></span> is the 1st order harmonic, the default value is 1. The parameter <span class="webflare-courier-new" style="white-space:pre"><em>rport</em></span> is the impedance of the port, the default value is 50. The parameter <span class="webflare-courier-new" style="white-space:pre"><em>gcomp</em></span> is gain compression in dB, the default value is 1. The parameter <span class="webflare-courier-new" style="white-space:pre"><em>curve</em></span> is the control flag of curve display. The default value of curve is <code>on</code>. It can be <code>off</code>.</p>

<h4>
<a id="pgfId-1045468"></a>cds_ipn</h4>

<p>
<a id="pgfId-1045469"></a>Returns the Intercept Point for the wave supplied. The command is: </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045470"></a>[ipn_in, ipn_out] = cds_ipn(vport, harmspur, harmref, epoint, rport, ordspur, iport, epref, ordref, curve)</pre>

<p>
<a id="pgfId-1045471"></a>The parameters of <strong>cds_ipn</strong> are similar to the parameters of <strong>cds_compression</strong>. The first parameter <span class="webflare-courier-new" style="white-space:pre"><em>vport</em></span> is the voltage of the port. The second parameter <span class="webflare-courier-new" style="white-space:pre"><em>harmspur</em></span> is the order harmonic value. The third parameter <span class="webflare-courier-new" style="white-space:pre"><em>harmref</em></span> is the reference order (1st order) harmonic value. The parameter <span class="webflare-courier-new" style="white-space:pre"><em>epoint</em></span> is the input power extrapolation point. The parameter <span class="webflare-courier-new" style="white-space:pre"><em>rport</em></span> is impedance of the port. The default value is 50.0. The parameter <span class="webflare-courier-new" style="white-space:pre"><em>ordspur</em></span> is order number. The default value is 3. The parameter <span class="webflare-courier-new" style="white-space:pre"><em>iport</em></span> is the port current. The default value is <span class="webflare-courier-new" style="white-space:pre"><em>vport</em></span>/<span class="webflare-courier-new" style="white-space:pre"><em>rport</em></span>. The parameter <span class="webflare-courier-new" style="white-space:pre"><em>epref</em></span> is the input power reference point. It will use <span class="webflare-courier-new" style="white-space:pre"><em>epoint</em></span> when this parameter is not specified. The parameter <span class="webflare-courier-new" style="white-space:pre"><em>ordref</em></span> is the reference order number. The default value is 1. The parameter <span class="webflare-courier-new" style="white-space:pre"><em>curve</em></span> is the control flag of curve display. The default value is <code>on</code>. It can be <code>on</code> or <code>off</code>. </p>
<p>
<a id="pgfId-1045472"></a>The return parameter <span class="webflare-courier-new" style="white-space:pre"><em>ipn_in</em></span> is the input reference IPn value and <span class="webflare-courier-new" style="white-space:pre"><em>ipn_out</em></span> is the output reference IPn value.</p>

<h3>
<a id="pgfId-1045473"></a>Example </h3>

<p>
<a id="pgfId-1045474"></a>This section shows how to use the toolbox to make RF measurements in MATLAB. The example circuit is an LNA design from the RF workshop which is available at </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045475"></a>&lt;instdir&gt;/tools/spectre/examples/SpectreRFworkshop </pre>

<p>
<a id="pgfId-1045476"></a>Please refer to <em>Lab3: Gain Compression and Total harmonic Distortion (Swept PSS)</em> in the workshop <em>LNA Design Using SpectreRF</em>. </p>
<p>
<a id="pgfId-1045477"></a>After finishing the LNA Lab3, you get the results in </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045478"></a>simulation/Diff_LNA_test/spectre/schematic/psf</pre>

<p>
<a id="pgfId-1045479"></a>To start MATLAB from the system prompt, type the following command </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045480"></a>matlab</pre>

<p>
<a id="pgfId-1045481"></a>In MATLAB, get time domain data with the command </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045482"></a>&gt;&gt; rdir = &#39;simulation/Diff_LNA_test/spectre/schematic/psf&#39;;</pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045483"></a>&gt;&gt; tdout = cds_srr(rdir, &#39;sweeppss_pss_td-sweep&#39;, &#39;RFout&#39;);</pre>
<p><strong>Figure 1-20
<a id="pgfId-1045485"></a><a id="99852"></a>Gain Compression (1dB Compression) </strong></p>
<p>
<a id="pgfId-1045489"></a> </p>
<div class="webflare-div-image">
<img width="522" height="406" src="images/chap1-55.gif" /></div>

<p>
<a id="pgfId-1045490"></a>To get 1 dB compression point, use the following command </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045491"></a>&gt;&gt; cds_compression(fdout)</pre>

<p>
<a id="pgfId-1045495"></a>A window with the result will pop up, as Figure <a href="chap1.html#99852">1-20</a> shows.</p>
<p>
<a id="pgfId-1045496"></a><span class="webflare-courier-new" style="white-space:pre"><em>tdout</em></span> is a power sweep result. For different <code>prf</code>, the time point numbers are different, and for each <code>prf</code>, the intervals between time points vary. The field <span class="webflare-courier-new" style="white-space:pre"><em>time</em></span> is a 161x11 matrix as the field <code>V</code>. </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045497"></a>Execute command:</pre>

<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045498"></a>&gt;&gt; td161=cds_interpsig(tdout); </pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045499"></a>&gt;&gt; td100=cds_interpsig(tdout, &#39;time&#39;, 100);</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045500"></a>&gt;&gt; hold on</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045501"></a>&gt;&gt; cds_plotsig(tdout)</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045502"></a>&gt;&gt; cds_plotsig(td161)</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045503"></a>&gt;&gt; cds_plotsig(td100)</pre>
<p>
<a id="pgfId-1045504"></a>The waveforms shape of td161 and td100 are the same as <span class="webflare-courier-new" style="white-space:pre"><em>tdout</em></span>. But in td161 and td100, the time points are the same for each different <code>prf</code> and the intervals of time points are the same for each <code>prf</code>. So, the field time is stored and handled as a vector.</p>
<p>
<a id="pgfId-1045505"></a>To get the frequency domain data, execute command:</p>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045506"></a>&gt;&gt; fdout = cds_srr(rdir, &#39;sweeppss_pss_fd-sweep&#39;, &#39;RFout&#39;);</pre>
<p>
<a id="pgfId-1045507"></a><span class="webflare-courier-new" style="white-space:pre"><em>fdout</em></span> contains 11 harmonics, the field <code>harmonic</code> lists the harmonic number. To get the 1st order harmonic signal, use the following command </p>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045508"></a>&gt;&gt; fd1 = cds_harmonic(fdout, 1)</pre>

<p><strong>Figure 1-21
<a id="pgfId-1045510"></a><a id="46180"></a>Total Harmonic Distortion</strong></p>
<p>
<a id="pgfId-1045514"></a></p>
<div class="webflare-div-image">
<img width="590" height="465" src="images/chap1-56.gif" /></div>

<p>
<a id="pgfId-1045515"></a>To get total harmonic distortion in percent, use the following command </p>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045516"></a>&gt;&gt; thd = cds_thd(fdout); </pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045517"></a>&gt;&gt; cds_plotsig(thd);</pre>
<p>
<a id="pgfId-1045521"></a>The result is shown in Figure <a href="chap1.html#46180">1-21</a>.</p>
<p>
<a id="pgfId-1045522"></a>To compare the frequency data with time domain data.</p>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045523"></a>&gt;&gt; fd1 = cds_evalsig(fdout, &#39;prf = -30&#39;);</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045524"></a>&gt;&gt; td2fd = cds_fft(tdout);</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045525"></a>&gt;&gt; fd2 = cds_evalsig(td2fd, &#39;prf = -30 &amp; freq&lt;=2.5e10&#39;)</pre>
<p>
<a id="pgfId-1045529"></a>The result is shown in Figure <a href="chap1.html#86886">1-22</a>.</p>

<p><strong>Figure 1-22
<a id="pgfId-1045531"></a><a id="86886"></a>Compare FD data before FFT and after</strong></p>
<p>
<a id="pgfId-1045535"></a></p>
<div class="webflare-div-image">
<img width="553" height="413" src="images/chap1-57.gif" /></div>
<h3>
<a id="pgfId-1045536"></a>Compatibility with Aptivia MATLAB Functions</h3>

<p>
<a id="pgfId-1045537"></a>This topic is of interest to those users who are using acv measures in MATLAB. The document for these measures is in <code>&lt;cdsinst&gt;/doc/matlabmeasug/</code> Chapters 3 and 4. </p>
<p>
<a id="pgfId-1045538"></a>The Spectre/RF MATLAB Toolbox is better able to handle both swept analyses and RF-related analyses such as Monte Carlo and PSS/PAC than acv measures. While acv measures provide more measurements for the transient and ac analyses, the MATLAB Toolbox can reuse acv measure functions with the command <strong>cds2vsde</strong> and the global variable <code>CDS2ACV</code>.</p>
<p>
<a id="pgfId-1045539"></a>Set the global variable <code>CDS2ACV</code> to 1 in MATLAB with the following command. </p>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045540"></a>&gt;&gt; global CDS2ACV; CDS2ACV = 1</pre>
<p>
<a id="pgfId-1045541"></a>When <code>CDS2ACV=1</code>, <strong>cds_srr</strong> prints <code>vsde compatibility information</code> after loading in the dataset. <strong>cds_srr</strong> will translate the signal to acv data structure for acv measures automatically.</p>
<p>
<a id="pgfId-1045542"></a>The <strong>cds2vsde</strong> command is designed for translating signals to acv data structure. The command is </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045543"></a>cds2vsde(sig, raw_file, variable, option)</pre>

<p>
<a id="pgfId-1045544"></a>The parameters <span class="webflare-courier-new" style="white-space:pre"><em>raw_file</em></span> and <span class="webflare-courier-new" style="white-space:pre"><em>variable</em></span> are string values to identify the signal. The parameter <span class="webflare-courier-new" style="white-space:pre"><em>option</em></span> can be <code>add</code> or <code>replace</code> as other acv functions.</p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1045545"></a>The acv data structure cannot handle multi-level sweeps, and for each <span class="webflare-courier-new" style="white-space:pre"><em>raw_file</em></span> the sweep value should be the same. So <strong>cds2vsde</strong> will use different variables or different <span class="webflare-courier-new" style="white-space:pre"><em>raw_files</em></span> for multi-level sweep signals.</div>
<p>
<a id="pgfId-1045546"></a>If you want to convert variable <span class="webflare-courier-new" style="white-space:pre"><em>td2fd</em></span> to acv format, use the following command </p>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045547"></a>&gt;&gt; cds2vsde(td2fd, &#39;sweeppss_pss_fd-sweep&#39;, &#39;td2fd&#39;);</pre>
<p>
<a id="pgfId-1045548"></a>It will print out:</p>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045549"></a>vsde compatibility information</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045550"></a>raw_file: sweeppss_pss_fd-sweep</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045551"></a>variable: td2fd(prf=-30)</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045552"></a>variable: td2fd(prf=-27.5)</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045553"></a>variable: td2fd(prf=-25)</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045554"></a>variable: td2fd(prf=-22.5)</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045555"></a>variable: td2fd(prf=-20)</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045556"></a>variable: td2fd(prf=-17.5)</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045557"></a>variable: td2fd(prf=-15)</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045558"></a>variable: td2fd(prf=-12.5)</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045559"></a>variable: td2fd(prf=-10)</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045560"></a>variable: td2fd(prf=-7.5)</pre>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045561"></a>variable: td2fd(prf=-5)</pre>
<p>
<a id="pgfId-1045562"></a>Then use command <strong>meas_plot</strong> for plotting:</p>
<pre class="webflare-courier-new webflare-indent1 codeContent">
<a id="pgfId-1045563"></a>&gt;&gt; meas_plot(&#39;sweeppss_pss_fd-sweep&#39;, &#39;td2fd(prf=-20)&#39;, &#39;stem&#39;);</pre>

<h3>
<a id="pgfId-1045564"></a>Reference</h3>
<p>
<a id="pgfId-1045579"></a></p>
<table class="webflareTable" id="#id1045565">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045567"></a>[1]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045569"></a><em>Simulation Results Reader User Guide</em>, Product Version 5.0</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045571"></a>[2]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">

<p>
<a id="pgfId-1045573"></a><em>MATLAB External Interfaces Reference </em>available at </p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045574"></a><code>http://www.mathworks.com/access/helpdesk/help/techdoc/matlab.html</code></pre>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045576"></a>[3]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045578"></a>SpectreRF Workshop--LNA Design Using SpectreRF, MMSIM6.0USR2</p>
</td>
</tr>
</tbody></table>
<h3>
<a id="pgfId-1052991"></a>MATLAB Support Matrix</h3>
<h4>Table 1-1
<a id="pgfId-1053425"></a>MATLAB Toolbox</h4>
<table class="webflareTable" id="#id1053245">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1053247">
<a id="pgfId-1053247"></a>MMSIM</span>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1053249">
<a id="pgfId-1053249"></a>MATLAB Release</span>
</td>
<td class="webflareTd" colspan="3" rowspan="1">
<span class="tbl-head" id="#id1053251">
<a id="pgfId-1053251"></a>Supported Platform</span>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053257"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053259"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053261"></a><strong><em>Linux 32 </em></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053263"></a><em>Linux 64</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053265"></a><strong><em>Solaris 64</em></strong></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053267"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053269"></a>R2007a</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053271"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053273"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053275"></a>Supported</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053277"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053279"></a>R2007b</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053281"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053283"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053285"></a>Supported</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053287"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053289"></a>R2008a</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053291"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053293"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053295"></a>Supported</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053297"></a>MMSIM13.1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053299"></a>R2008b</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053301"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053303"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053305"></a>Supported</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053307"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053309"></a>R2009a</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053311"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053313"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053315"></a>Supported</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053317"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053319"></a>R2009b</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053321"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053323"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053325"></a>Supported</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053327"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053329"></a>R2010a</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053331"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053333"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053338"></a>Not Supported <a href="#pgfId-1053337">1</a></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053340"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053342"></a>R2010b</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053344"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053346"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053348"></a>Not Supported 1 </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053350"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053352"></a>R2011a</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053354"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053356"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053358"></a>Not Supported 1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053360"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053362"></a>R2011b</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053364"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053366"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053368"></a>Not Supported 1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053370"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053372"></a>R2012a</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053374"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053376"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053378"></a>Not Supported 1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053380"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053382"></a>R2012b</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053387"></a>Not Supported<a href="#pgfId-1053386">2</a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053389"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053391"></a>Not Supported 1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053393"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053395"></a>R2013a</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053397"></a>Not Supported2</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053399"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053401"></a>Not Supported 1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053403"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053405"></a>R2013b</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053407"></a>Not Supported2</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053412"></a>Supported<a href="#pgfId-1053411">3</a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053414"></a>Not Supported 1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053416"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053418"></a>R2014a</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053420"></a>Not Supported2</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053422"></a>Supported3</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053424"></a>Not Supported 1</p>
</td>
</tr>
</tbody></table>
<h4>Table 1-2
<a id="pgfId-1053606"></a>MATLAB Cosimulation</h4>
<table class="webflareTable" id="#id1053426">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1053428">
<a id="pgfId-1053428"></a>MMSIM</span>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1053430">
<a id="pgfId-1053430"></a>MATLAB Release</span>
</td>
<td class="webflareTd" colspan="3" rowspan="1">
<span class="tbl-head" id="#id1053432">
<a id="pgfId-1053432"></a>Supported Platform</span>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053438"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053440"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053442"></a><strong><em>Linux 32 </em></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053444"></a><em>Linux 64</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053446"></a><strong><em>Solaris 64</em></strong></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053448"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053450"></a>R2007a</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053452"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053454"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053456"></a>Supported</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053458"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053460"></a>R2007b</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053462"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053464"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053466"></a>Supported</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053468"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053470"></a>R2008a</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053472"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053474"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053476"></a>Supported</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053478"></a>MMSIM13.1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053480"></a>R2008b</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053482"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053484"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053486"></a>Supported</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053488"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053490"></a>R2009a</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053492"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053494"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053496"></a>Supported</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053498"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053500"></a>R2009b</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053502"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053504"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053506"></a>Supported</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053508"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053510"></a>R2010a</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053512"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053514"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053519"></a>Not Supported <a href="#pgfId-1053518">4</a></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053521"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053523"></a>R2010b</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053525"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053527"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053529"></a>Not Supported 1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053531"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053533"></a>R2011a</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053535"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053537"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053539"></a>Not Supported 1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053541"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053543"></a>R2011b</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053545"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053547"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053549"></a>Not Supported 1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053551"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053553"></a>R2012a</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053555"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053557"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053559"></a>Not Supported 1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053561"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053563"></a>R2012b</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053568"></a>Not Supported<a href="#pgfId-1053567">5</a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053570"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053572"></a>Not Supported 1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053574"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053576"></a>R2013a</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053578"></a>Not Supported2</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053580"></a>Supported</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053582"></a>Not Supported 1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053584"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053586"></a>R2013b</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053588"></a>Not Supported2</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053593"></a>Supported<a href="#pgfId-1053592">6</a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053595"></a>Not Supported 1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053597"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053599"></a>R2014a</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053601"></a>Not Supported2</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053603"></a>Supported3</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1053605"></a>Not Supported 1</p>
</td>
</tr>
</tbody></table>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1053218"></a>Starting with the MMSIM 14.1release, the MATLAB toolbox supports only the R2012a and above versions.</div>

<h2>
<a id="pgfId-1045735"></a>Noise Separation in Pnoise and Qpnoise Analysis </h2>

<p>
<a id="pgfId-1045736"></a>This section describes how to analyze RF circuits using the noise separation features in the Pnoise and Qpnoise analyses. SpectreRF users in the Analog Design Environment (ADE) will find noise separation information to be useful. </p>

<h3>
<a id="pgfId-1045748"></a>Principles of Noise Separation in RF Circuits </h3>

<p>
<a id="pgfId-1045749"></a>For the Pnoise and Qpnoise analyses, input noise can be either <em>stationary</em> or <em>cyclostationary</em>. A simple instance of stationary noise is the white noise in a resistor with constant resistance. Cyclostationary noise is generally due to the fact that in most RF circuits the operating point of the nonlinear devices, primarily transistors, is periodic and time-varying. </p>
<p>
<a id="pgfId-1045750"></a>To better illustrate the difference between stationary noise and cyclostationary noise, consider the white thermal noise generated by either the nonlinear drain-to-source or channel resistor in a MOS transistor. The formula for <em>white thermal noise</em> is given as </p>

<p>
<a id="pgfId-1045760"></a></p>
<table class="webflareTable" id="#id1045751">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-34)
<a id="pgfId-1045754"></a><a id="43562"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045759"></a><img width="100" height="43" src="images/chap1-58.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1045764"></a>In Equation <em>
<a href="chap1.html#43562"></a><h-hot>1-34</h-hot><em></em>
</em>
, <em>
R</em>
(<em>
V</em>
) is the bias-dependent small signal drain-to-source resistance. Assuming the transistor is driven by a periodic large signal excitation, for example the clock in a switched capacitor filter, <em>
R</em>
<t-times>
(</t-times>
<em>
V</em>
<t-times>
)</t-times>
 will be time-varying and you can no longer model its associated thermal noise as a simple stationary noise source. You must treat the noise source as a cyclostationary random process.</p>
<p>
<a id="pgfId-1045765"></a>When input noise passes through an RF circuit, the <em>aliasing</em> or <em>noise folding</em> effect is introduced by the frequency translation intentionally performed by the linear periodic time-varying (LPTV) characteristics of the RF circuit. You can summarize the noise transfer process as follows. </p>
<ul><li>
<a id="pgfId-1045766"></a>First, for noise that is bias dependent, the time-varying operating point modulates the noise sources </li><li>
<a id="pgfId-1045767"></a>Second, the transfer function from the noise source to output modulates the noise source contribution to the output </li><li>
<a id="pgfId-1045768"></a>The final result is the sum of the noise contributions both up-converted and down-converted to the desired output frequency. The noise transfer process is shown in Figure <a href="chap1.html#77723">1-23</a>, where a mixer is used to demonstrate.<br /><strong class="webflare-fig-line-height">Figure 1-23
<a id="pgfId-1045773"></a><a id="77723"></a>How a Mixer Moves Noise Around </strong>
<a id="pgfId-1045777"></a><div class="webflare-div-image">
<img src="images/Mixer.gif" /></div></li></ul>







<p>
<a id="pgfId-1045778"></a>The Pnoise and Qpnoise analyses calculate the output noise transferred from the noise sources by transfer functions. Using the Direct Plot form, you can plot <em>output noise</em>, <em>input noise</em>, <em>noise figure</em>, <em>transfer function</em>, and so on. By using the Noise Summary Print form and selecting sort and truncation methods, you can print <em>spot noise </em>or <em>integrated noise</em>. </p>
<p>
<a id="pgfId-1045779"></a>The noise separation feature provides more information about how much of the noise is due to the noise sources and how much of the noise is due to the corresponding transfer function. The main purpose of giving the extra information is to provide useful information about how noise sources contribute noise to the output. </p>
<p>
<a id="pgfId-1045780"></a>You can select which one of the two approaches to use to decrease the output noise </p>
<ul><li>
<a id="pgfId-1045781"></a>By decreasing the noise sources using different device dimensions</li><li>
<a id="pgfId-1045782"></a>By decreasing the transfer functions with other circuit architectures</li></ul>

<p>
<a id="pgfId-1045783"></a>For some projects, you might want to separate the noise due to sources from the noise due to transfer functions in order to satisfy noise specifications. When you include the noise separation specifications in the design process you are using global optimization to help produce better designs. </p>
<p>
<a id="pgfId-1045787"></a>When you take <em>K</em> sidebands and one noise source into account, Equation <a href="chap1.html#88289">1-35</a> illustrates the power spectrum density (PSD) of the output noise due to this single noise source. </p>

<p>
<a id="pgfId-1045797"></a></p>
<table class="webflareTable" id="#id1045788">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-35)
<a id="pgfId-1045791"></a><a id="88289"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045796"></a><img width="509" height="62" src="images/chap1-60.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1045798"></a>Where <em>NoiseSource</em><sub><em>i </em></sub>represents the PSD of <em>Source</em><sub><em>i</em></sub> sampled at the frequency shift <br />of <em>i </em>∗ <em>fundamental</em>. </p>
<p>
<a id="pgfId-1045802"></a>When the noise is cyclostationary, Equation <a href="chap1.html#38513">1-36</a> represents the output PSD due to this source. </p>

<p>
<a id="pgfId-1045812"></a></p>
<table class="webflareTable" id="#id1045803">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-36)
<a id="pgfId-1045806"></a><a id="38513"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045811"></a><img width="606" height="153" src="images/chap1-61.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1045819"></a>By introducing the noise gain as a parameter, the formulas in Equations <a href="chap1.html#88289">1-35</a> and <a href="chap1.html#38513">1-36</a> can be unified as they are in Equation <a href="chap1.html#24738">1-37</a>. </p>

<p>
<a id="pgfId-1045832"></a></p>
<table class="webflareTable" id="#id1045823">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-37)
<a id="pgfId-1045826"></a><a id="24738"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045831"></a><img width="447" height="62" src="images/chap1-62.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1045833"></a>Therefore, you know that </p>
<ul><li>
<a id="pgfId-1045834"></a>When the noise source is stationary, the noise gain equals the transfer function </li><li>
<a id="pgfId-1045835"></a>When the noise source is cyclostationary, the noise gain is a normalized combination of frequency conversion due to bias modulation and transfer functions.</li></ul>


<h3>
<a id="pgfId-1045836"></a>The Noise Separation GUI</h3>

<p>
<a id="pgfId-1045837"></a>This section describes how to use noise separation in the analog design environment (ADE). </p>

<h4>
<a id="pgfId-1045838"></a>Setting Up a Pnoise Analysis for Noise Separation </h4>

<p>
<a id="pgfId-1045839"></a>After you use the ADE GUI to set up both a PSS analysis and a Pnoise analyses, use the <em>Noise Type</em> section at the bottom of the Pnoise Choosing Analysis form to set up the noise separation analysis. When you set <em>Noise Type</em> as <em>sources</em>, the <em>Noise Separation </em>field is visible and you can select <em>yes</em> or <em>no</em>, as shown in Figure <a href="chap1.html#88289">1-35</a>. </p>
<p>
<a id="pgfId-1045843"></a>Notice the message below Noise Separation,</p>

<pre class="webflare-courier-new codeContent">
<a id="pgfId-1045844"></a>separate noise into source and gain</pre>

<p>
<a id="pgfId-1045845"></a>This message further describes noise separation in the current context.</p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1045846"></a>Please notice the following information as it applies to this context.</div>
<ul><li style="list-style-type: none;background-image: none;"><ul><li>
<a id="pgfId-1045847"></a>There are two simulation engines: Shooting (TD) and Flexible Balance (FB). Both simulation engines support noise separation. You select the simulation engine in the PSS analysis you set up to run before this Pnoise analysis. </li><li>
<a id="pgfId-1045848"></a>The <em>Noise Separation</em> field is visible and usable only after you set <em>Noise Type</em> to <em>sources</em>. </li><li>
<a id="pgfId-1045849"></a>After you set <em>Noise Separation</em> to <em>yes</em>, the <em>saveallsidebands</em> parameter in the Pnoise Options form is not required. The noise separation results include all the expected sidebands.<br /><strong class="webflare-fig-line-height">Figure 1-24
<a id="pgfId-1045850"></a>Setting up for Noise Separation in the Pnoise Choosing Analysis Form</strong>
<a id="pgfId-1045854"></a><div class="webflare-div-image">
<img width="483" height="132" src="images/chap1-63.gif" /></div></li></ul></li></ul>







<p>
<a id="pgfId-1045855"></a>When you run the PSS and Pnoise analyses, noise separation is measured during the simulation and the corresponding results are saved.</p>

<h4>
<a id="pgfId-1045856"></a>Setting Up A QPnoise Analysis for Noise Separation </h4>

<p>
<a id="pgfId-1045857"></a>After you use the ADE GUI to set up both a QPSS analysis and a QPnoise analysis, set up the noise separation analysis by selecting <em>yes</em> for <em>Noise Separation </em>as shown in Figure <a href="chap1.html#38513">1-36</a>. </p>
<p>
<a id="pgfId-1045861"></a>Notice the message below <em>Noise Separation, </em></p>
<p>
<a id="pgfId-1045862"></a><em>separate noise into source and gain </em></p>
<p>
<a id="pgfId-1045863"></a>This message further describes noise separation in the current context. </p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1045864"></a>Please notice the following information as it applies to this context. </div>
<ul><li>
<a id="pgfId-1045865"></a>There are two simulation engines: Shooting (TD) and Flexible Balance (FB). Both simulation engines support noise separation. (You select the simulation engine in the QPSS analysis you set up to run before this QPnoise analysis.) </li><li>
<a id="pgfId-1045866"></a>After you set <em>Noise Separation</em> to <em>yes</em>, the <em>saveallsidebands</em> parameter in the QPnoise Options form is not required. The noise separation results include all the expected sidebands.<br /><strong class="webflare-fig-line-height">Figure 1-25
<a id="pgfId-1045867"></a>Setting up for Noise Separation in the QPnoise Choosing Analysis Form </strong>
<a id="pgfId-1045871"></a><div class="webflare-div-image">
<img src="images/NoiseSepQPnoise.gif" /></div></li></ul>






<p>
<a id="pgfId-1045872"></a>When you run the QPSS and QPnoise analyses, noise separation is measured during the simulation and the corresponding results are saved.</p>

<h4>
<a id="pgfId-1045873"></a>Plotting Noise Sources, Gains, and Outputs</h4>

<ol><li>
<a id="pgfId-1045874"></a>After running the noise separation analyses from ADE, select <em>Results &#8212; Direct Plot &#8212; Main Form</em> in the ADE Simulation window.<br />
<a id="pgfId-1045875"></a>Aside from <em>pss</em> and <em>pnoise</em> (or <em>qpss</em> and <em>qpnoise</em>), another choice for Analysis, <em>pnoise separation</em> (or <em>qpnoise separation</em>), displays in the Direct Plot form.</li><li>
<a id="pgfId-1045876"></a>Select <em>pnoise separation</em> (or <em>qpnoise separation</em>) to create a noise separation plot. <br />
<a id="pgfId-1045877"></a>Six <em>Function</em> items are displayed. <em>Sideband Output</em>, <em>Instance Output</em>, <em>Source Output</em>, <em>Instance Source</em>, <em>Primary Source</em> and <em>Src. Noise Gain</em>. </li><li>
<a id="pgfId-1045878"></a>Select one of the Functions. <br />
<a id="pgfId-1045904"></a><table class="webflareTable" id="#id1045879">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045881"></a><em>Sideband Output </em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045883"></a>Plots the noise contribution made by multiple selected sidebands to the output noise </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045885"></a><em>Instance Output </em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045887"></a>Plots the noise contribution of some instances (for example, MOS, or BJT) to the output at one selected sideband </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045889"></a><em>Source Output </em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">

<p>
<a id="pgfId-1045891"></a>Plots the noise contribution made by one selected sideband to the output noise </p>

</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045893"></a><em>Instance Source </em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">

<p>
<a id="pgfId-1045895"></a>Plots the noise sources of some instances at one selected sideband </p>

</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045897"></a><em>Primary Source </em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">

<p>
<a id="pgfId-1045899"></a>Plots the primary noise sources (for example, re or rb in a BJT) at one selected sideband </p>

</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045901"></a><em>Src. Noise Gain </em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">

<p>
<a id="pgfId-1045903"></a>Plots the noise gains of primary noise sources (for example, re or rb in a BJT) from source to output at one selected sideband. </p>

</td>
</tr>
</tbody></table><br />
<a id="pgfId-1045905"></a>Notice the message below the <em>Function</em> area in the Direct Plot Form. For example, after selecting the function, <em>Sideband Output</em>, you see the following message.<pre class="webflare-pre-block webflare-courier-new" id="#id1045906">
<a id="pgfId-1045906"></a>Noise contribution of sideband to output</pre>
<a id="pgfId-1045907"></a>This message further describes the noise separation plot in the current context.</li></ol>












<h4><em>
<a id="pgfId-1045908"></a>Selecting Other Information in the Direct Plot Form </em></h4>

<p>
<a id="pgfId-1045909"></a>You further define what RF simulation measurements to plot by entering and selecting items in the Direct Plot form; for example, functions, signal levels, modifiers, plots and so on. </p>
<ol><li>
<a id="pgfId-1045910"></a>While making selections in the Direct Plot form, follow new messages as they display. <br />
<a id="pgfId-1045911"></a>Additional instructions and prompts might appear within the body of the Direct Plot form or at the bottom of the form. For example, after selecting <em>Sideband Output</em> for <em>Function </em>and <em>V**2 / Hz</em> for <em>Signal Level</em>, you can then select either <em>Power</em> or <em>dB20</em> for <em>Modifier</em>. You might also see a message such as the following. <pre class="webflare-pre-block webflare-courier-new" id="#id1045912">
<a id="pgfId-1045912"></a><em>Currently, only sideband data is available</em></pre>
<a id="pgfId-1045913"></a>This message accompanies the <em>Output Sidebands</em> list box. </li><li>
<a id="pgfId-1045914"></a>After selecting <em>Power</em> for <em>Modifier</em> and all of the sidebands in the list box, you would be left with the following message. <br /><pre class="webflare-pre-block webflare-courier-new" id="#id1045915">
<a id="pgfId-1045915"></a><em>Press plot button on this form...</em></pre>
<a id="pgfId-1045916"></a>The completed Direct Plot form displays. </li><li>
<a id="pgfId-1045917"></a>As the last step in the Direct Plot form, click <em>Plot</em> to plot the noise contributed by each individual sideband. <br />
<a id="pgfId-1045920"></a>The Plot displays as shown in Figure <a href="chap1.html#26792">1-26</a>. <br /><strong class="webflare-fig-line-height">Figure 1-26
<a id="pgfId-1045923"></a><a id="26792"></a>Output Sidebands Plot</strong>
<a id="pgfId-1045927"></a><div class="webflare-div-image">
<img src="images/SourceOutputPLOT.gif" /></div></li></ol>













<p>
<a id="pgfId-1045928"></a>When you press the plot button (or perform another specified action, such as <em>Select Net in schematic</em>), a simulation plot appears, by default, in the current Waveform Window. If the Waveform window or Schematic window is not open, selecting a direct plot function automatically opens both windows. </p>
<p>
<a id="pgfId-1045929"></a>Brief instructions for all six noise separation plots follows. </p>

<h4><em>
<a id="pgfId-1045930"></a>Sideband Output</em></h4>

<p>
<a id="pgfId-1045931"></a>Plots the noise contribution of selected sidebands to the output.</p>

<p>
<a id="pgfId-1045945"></a></p>
<table class="webflareTable" id="#id1045932">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045934"></a><em>Signal Level </em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045936"></a>Possible choices of measure units</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045938"></a><em>Modifier</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045940"></a>Possible measure scale according to the <em>Signal Leve</em>l</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045942"></a><em>Output Sideband</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045944"></a>A list box of all possible sidebands. It is multi-selection. </p>
</td>
</tr>
</tbody></table>
<h4><em>
<a id="pgfId-1045946"></a>Instance Output</em></h4>

<p>
<a id="pgfId-1045947"></a>Plots the noise contribution of some instances; for example, MOS, BJT, and so on, to the output at one selected sideband.</p>

<p>
<a id="pgfId-1045985"></a></p>
<table class="webflareTable" id="#id1045948">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045950"></a><em>Signal Level </em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045952"></a>Same as above </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045954"></a><em>Modifier</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045956"></a>Same as above </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045958"></a><em>Output Sideband</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045960"></a>Same as above, except single-selection </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045962"></a>Filter</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045964"></a>Frame</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045966"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045968"></a><em>Include All Types</em> &#8212;All device types in right box selected </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045970"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045972"></a><em>Include None</em> &#8212; Clear all selections in right box</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045974"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045976"></a><em>Include Inst</em> &#8212; Only include these instances. Note the device types of these instances must be selected. </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045978"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045980"></a><em>Exclude Inst</em> &#8212; Exclude these instances from the selected device types.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045982"></a>Truncate </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045984"></a>Frame &#8212; Truncate the top number of <em>Instance Output</em>. The default is 3. </p>
</td>
</tr>
</tbody></table>
<h4><em>
<a id="pgfId-1045986"></a>Instance Source</em></h4>

<p>
<a id="pgfId-1045987"></a>Plots the noise sources of some instances at one selected sideband.</p>

<p>
<a id="pgfId-1046009"></a></p>
<table class="webflareTable" id="#id1045988">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045990"></a><em>Signal Level </em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045992"></a>Same as above </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045994"></a><em>Modifier</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045996"></a>Same as above </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1045998"></a><em>Output Sideband</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046000"></a>Same as above</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046002"></a>Filter </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046004"></a>Same as above</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046006"></a>Truncate </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046008"></a>Same as above</p>
</td>
</tr>
</tbody></table>
<h4><em>
<a id="pgfId-1046010"></a>Source Output</em></h4>

<p>
<a id="pgfId-1046011"></a>Plots the noise contribution of the primary noise source (for example, re and rb in a BJT) to the output at one selected sideband. </p>

<p>
<a id="pgfId-1046033"></a></p>
<table class="webflareTable" id="#id1046012">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046014"></a><em>Signal Level </em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046016"></a>Same as above </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046018"></a><em>Modifier</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046020"></a>Same as above </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046022"></a><em>Output Sideband</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046024"></a>Same as above</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046026"></a>Filter </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046028"></a>Same as above</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046030"></a>Truncate </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046032"></a>Frame &#8212; Truncate the top number of <em>Source Output</em>. The default is 3. </p>
</td>
</tr>
</tbody></table>
<h4><em>
<a id="pgfId-1046034"></a>Primary Source</em></h4>

<p>
<a id="pgfId-1046035"></a>Plots the primary noise sources (for example, re and rb in a BJT) at one selected sideband.</p>

<p>
<a id="pgfId-1046057"></a></p>
<table class="webflareTable" id="#id1046036">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046038"></a><em>Signal Level </em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046040"></a>Same as above </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046042"></a><em>Modifier</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046044"></a>Same as above </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046046"></a><em>Output Sideband</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046048"></a>Same as above</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046050"></a>Filter </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046052"></a>Frame &#8212; Same as above </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046054"></a>Truncate </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046056"></a>Frame &#8212; Same as above </p>
</td>
</tr>
</tbody></table>
<h4><em>
<a id="pgfId-1046058"></a>Source Noise Gain (Src. Noise Gain)</em></h4>

<p>
<a id="pgfId-1046059"></a>Plots the noise gains of primary noise sources (for example, re and rb in a BJT) from source to output at one selected sideband.</p>

<p>
<a id="pgfId-1046081"></a></p>
<table class="webflareTable" id="#id1046060">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046062"></a><em>Signal Level </em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046064"></a>Same as above </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046066"></a><em>Modifier</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046068"></a>Same as above </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046070"></a><em>Output Sideband</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046072"></a>Same as above</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046074"></a>Filter </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046076"></a>Frame &#8212; Same as above</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046078"></a>Truncate </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1046080"></a>Frame &#8212; Same as above </p>
</td>
</tr>
</tbody></table>
<h4>
<a id="pgfId-1046082"></a>Printing the Noise Source Summary Results </h4>

<p>
<a id="pgfId-1046083"></a>You can also view all noise source information in the Noise Summary Print form. </p>

<ul><li>
<a id="pgfId-1046084"></a>Select <em>Results &#8212; Print &#8212; Noise Summary</em> in the ADE Simulation window. </li></ul>

<p>
<a id="pgfId-1046085"></a>In the Noise Summary form, aside from the <code>pnoise</code> and <code>qpnoise</code> items, another item, <code>pnoise_src</code> (or <code>qpnoise_src</code>) is displayed. The field structure of the form, as well as the <code>fill</code>, <code>filter</code> and <code>truncate</code> methods, are the same as those in the <code>pnoise summary</code> (or <code>qpnoise summary</code>) Plot form. </p>
<p>
<a id="pgfId-1046344"></a>In print form, the Noise Source Summary provides an overview of noise source distribution in the circuit under analysis. The organizational structure of the Noise Source Summary is similar to the Output Noise Summary, but the latter provides the contributions to the output of these noise sources. </p>
<p>
<a id="pgfId-1046345"></a>Beyond providing an overview of the source distribution, the Noise Source Summary is also useful in the following cases. The Noise Source Summary helps you to </p>
<ul><li>
<a id="pgfId-1046346"></a>Easily locate obviously abnormal sources. For example, such as a particular noise source with unreasonable PSD according to your experience or knowledge.</li><li>
<a id="pgfId-1046347"></a>Quickly verify some circuit design specifications. For example, in a low noise amplifier (LNA) design, you need the noise figure (NF) in order to evaluate input matching. <br />
<a id="pgfId-1046348"></a>Suppose the inner resistance of a signal is <em>
Rs</em>
, and the equivalent input resistance of the LNA is <em>
Rp</em>
, then NF simply equals </li></ul>



<p class="webflare-indent1">
<a id="pgfId-1046352"></a><img width="91" height="41" src="images/chap1-66.gif" /></p>

<p class="webflare-indent1">
<a id="pgfId-1046353"></a>Since you can express <em>
Rp</em>
 as a simple function of <em>rb</em>, Rs for a Bipolar LNA, with the Noise Source Summary at hand, you can easily estimate the NF by hand.</p>

<h4>
<a id="pgfId-1046086"></a>Displaying the Noise Ssource Information in WaveScan</h4>

<p>
<a id="pgfId-1046087"></a>You can also view all noise source information in WaveScan. </p>

<ul><li>
<a id="pgfId-1046088"></a>Select <em>Tools &#8212; Results Browser</em> in the ADE Simulation window. <br />
<a id="pgfId-1046089"></a>Several data results are listed in In the Results Browser. Among them <ul><li>
<a id="pgfId-1046090"></a>pnoise-sources pnoise or qpnoise-sources qpnoise &#8212; includes noise source information, </li><li>
<a id="pgfId-1046091"></a>pnoise-xfersrcs.pnoise or qpnoise-xfersrcs.qpnois&#8212; includes noise source, gain and output noise information. </li></ul><br />
<a id="pgfId-1046092"></a>You can plot the selected results in the waveform window, post processed in calculator and displayed in table.</li></ul>






<h3>
<a id="pgfId-1046093"></a>The Noise Separation Flow </h3>

<p>
<a id="pgfId-1046094"></a>The hierarchical function layout, filter and truncation algorithms in the Direct Plot form, provide a good way to quickly locate the noise sources which cause the most noise in the output noise. The hierarchical layout is based on the hierarchy collection of output noise, which is simply described as follows. </p>
<ul><li>
<a id="pgfId-1046095"></a>The total output noise equals to the sum of output noise at each sideband</li><li>
<a id="pgfId-1046096"></a>The output noise at one sideband equals to the sum of instance output noise at this sideband. An instance can be a MOS, a BJT or a resistor etc.</li><li>
<a id="pgfId-1046097"></a>The output of one instance at one sideband equals to the sum of primary source output in this instance at this sideband. That is, a BJT includes re, rb, ic et al primary sources.</li></ul>



<h4>
<a id="pgfId-1046098"></a>The Basic Noise Separation Flow </h4>

<p class="webflare-indent1">
<a id="pgfId-1046099"></a><strong>Direct Plot Form -&gt; Pnoise Separation (or Qpnoise Separation) -&gt;</strong> </p>
<p class="webflare-indent1">
<a id="pgfId-1046100"></a><strong>Sideband Output[1] -&gt; Instance Output[2] -&gt;</strong> </p>
<p class="webflare-indent1">
<a id="pgfId-1046101"></a><strong>Source Output[3] -&gt; Instance Source/Primary Source/Src. Noise gain[4]</strong></p>
<b>Note:</b><br />
<a id="pgfId-1046102"></a><strong></strong>
<p class="webflare-indent1">
<a id="pgfId-1046103"></a><strong>[1]</strong> Decide which sidebands contribute the most output noise </p>
<p class="webflare-indent1">
<a id="pgfId-1046104"></a><strong>[2]</strong> Decide which instances contribute the most output noise to the selected sideband </p>
<p class="webflare-indent1">
<a id="pgfId-1046105"></a><strong>[3]</strong> Decide which primary noise sources contribute the most output noise to the filtered and truncated instances </p>
<p class="webflare-indent1">
<a id="pgfId-1046106"></a><strong>[4]</strong> Locate which primary noise sources or gains have the greatest effect on output noise </p>

<h3>
<a id="pgfId-1046107"></a>Noise Separation Example </h3>

<p>
<a id="pgfId-1046108"></a>This example shows how to locate the noise sources that contribute the most Output Noise. It uses the <code>NE600</code> mixer is in the <em>rfExamples</em> library. The schematic is shown in Figure <a href="chap1.html#75450">1-27</a>. Suppose the RF input signal is <code>frf=900 MHz</code>, LO signal <code>flo=1 GHz</code>, the expected IF should be <code>100 MHz</code>.</p>

<p><strong>Figure 1-27
<a id="pgfId-1046113"></a><a id="75450"></a>NE600 Mixer Schematic</strong></p>
<p>
<a id="pgfId-1046117"></a></p>
<div class="webflare-div-image">
<img src="images/NE600FromPS.gif" /></div>
<h4>
<a id="pgfId-1046118"></a>Setting Up and Running a Pnoise Separation Analysis</h4>

<p>
<a id="pgfId-1046119"></a>Using the ADE GUI</p>

<h4><em>
<a id="pgfId-1046120"></a>Stimulus </em></h4>

<p>
<a id="pgfId-1046121"></a>Set up the following stimuli: </p>
<p class="webflare-indent1">
<a id="pgfId-1046122"></a>A large sinusoidal signal at the LO port (PORT2) </p>
<p class="webflare-indent1">
<a id="pgfId-1046123"></a>Set the RF port (PORT1) source <code>type=dc </code></p>

<h4><em>
<a id="pgfId-1046124"></a>Parameters </em></h4>

<p>
<a id="pgfId-1046125"></a>Set up the following parameters: </p>
<p class="webflare-indent1">
<a id="pgfId-1046126"></a><code>flo=1G </code></p>
<p class="webflare-indent1">
<a id="pgfId-1046127"></a><code>prf=-30dBm</code></p>

<h4><em>
<a id="pgfId-1046128"></a>Simulation/Analyses </em></h4>

<ol><li>
<a id="pgfId-1046129"></a>Set up the following PSS analysis.<br />
<a id="pgfId-1046130"></a>Beat frequency: <em>flo</em><br />
<a id="pgfId-1046131"></a>Output harmonics: Number of harmonics 10. </li><li>
<a id="pgfId-1046132"></a>Set up the following Pnoise analysis.<br />
<a id="pgfId-1046133"></a>Sweeptype: default<br />
<a id="pgfId-1046134"></a>Output Frequency Sweep Range (Hz): <br /><span class="indent-as-level2">
<a id="pgfId-1046135"></a>Start 50M </span><br /><span class="indent-as-level2">
<a id="pgfId-1046136"></a>Stop 150M</span><br />
<a id="pgfId-1046137"></a>Sweep Type: Logarithmic <br />
<a id="pgfId-1046138"></a>Points Per Decade: 100 <br />
<a id="pgfId-1046139"></a>Sidebands: <em>Maximum Sideband</em> 5<br />
<a id="pgfId-1046140"></a>Output: probe <br /><span class="indent-as-level2">
<a id="pgfId-1046141"></a>Set up as the Output Probe Instance: /rif </span><br />
<a id="pgfId-1046142"></a>Input Source: port <br /><span class="indent-as-level2">
<a id="pgfId-1046143"></a>Set up as the Input Source Port /rf </span><br />
<a id="pgfId-1046144"></a>Reference side-band: Enter in field -1<br />
<a id="pgfId-1046145"></a>Noise Type: sources <br />
<a id="pgfId-1046146"></a>Noise Separation: yes </li><li>
<a id="pgfId-1046147"></a>Run the PSS and Pnoise simulations.</li></ol>

























<h4>
<a id="pgfId-1046148"></a>Using the Flow to Locate Noise Sources </h4>

<ol><li>
<a id="pgfId-1046149"></a>Plot the Sideband Output.<br />
<a id="pgfId-1046150"></a>Drag the mouse to select all sidebands (from -5 to 5). In this case, the result is shown in Figure <a href="chap1.html#26345">1-28</a>.<br /><strong>Figure 1-28
<a id="pgfId-1046155"></a><a id="26345"></a>Sideband Output of the ne600 with Pnoise Separation</strong>
<a id="pgfId-1046159"></a><div class="webflare-div-image">
<img src="images/SidebandOutPLOT.gif" /></div>
<a id="pgfId-1046162"></a>From Figure <a href="chap1.html#26345">1-28</a>, you can see that Sideband 0 contributes more output noise than any other sideband. Therefore, the next step is to check the instances in sideband 0.</li><li>
<a id="pgfId-1046164"></a>Plot the <em>Instance Output.</em> <ul><li>
<a id="pgfId-1046165"></a>Set output sideband to 0 </li><li>
<a id="pgfId-1046166"></a>Include all types </li><li>
<a id="pgfId-1046167"></a>Top number is 5</li></ul><br />
<a id="pgfId-1046170"></a>The result is shown in Figure <a href="chap1.html#47283">1-29</a>.<br /><strong class="webflare-fig-line-height">Figure 1-29
<a id="pgfId-1046173"></a><a id="47283"></a>Instance Output of ne600 with Pnoise Separation</strong>
<a id="pgfId-1046177"></a><div class="webflare-div-image">
<img src="images/InstanceOutputPLOT.gif" /></div>
<a id="pgfId-1046180"></a>From Figure <a href="chap1.html#47283">1-29</a> you can see that rif, rf, q56, q57 and rl1 (especially the rif) contribute more output noise than other instances.</li><li>
<a id="pgfId-1046182"></a>Plot the <em>Source Output.</em> <ul><li>
<a id="pgfId-1046183"></a>Set output sideband: 0, include all types, top number: 5, </li></ul><br />
<a id="pgfId-1046186"></a>The result is shown in Figure <a href="chap1.html#95961">1-30</a>.<br /><strong class="webflare-fig-line-height">Figure 1-30
<a id="pgfId-1046189"></a><a id="95961"></a>Source Output of ne600 with Pnoise Separation</strong>
<a id="pgfId-1046193"></a><div class="webflare-div-image">
<img src="images/SourceOutputPLOT.gif" /></div>
<a id="pgfId-1046196"></a>In Figure <a href="chap1.html#95961">1-30</a>, you can see that rif.rn, rf.rn, rl1.rn, r45.rn and q57.rb (especially rif.rn) contribute more output noise than other noise sources. <br /><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1046200"></a>The list order of instances in this plot <em>Source Output</em> (in Figure <a href="chap1.html#95961">1-30</a>) is different from the list order of <em>Instance Output</em> in Figure <a href="chap1.html#47283">1-29</a>.</div>
<a id="pgfId-1046205"></a>Up to now it is obvious that rif.rn is the main contributor to the output noise in this circuit. Since rif only includes one noise source rif.rn, The <em>Instance Source</em> and the <em>Primary Source</em> in Figure <a href="chap1.html#61582">1-31</a> should give the same plot. You can further check the <em>Primary Source</em> and <em>Src. Noise Gain</em> of rif.rn.</li><li>
<a id="pgfId-1046209"></a>Plot Primary Source and Src.Noise Gain<br />
<a id="pgfId-1046210"></a>set output sideband: 0, include all types, top number: 1, the result is shown in Figures <a href="chap1.html#61582">1-31</a> and <a href="chap1.html#42459">1-32</a>.<br /><strong>Figure 1-31
<a id="pgfId-1046218"></a><a id="61582"></a>Primary Source of ne600 with Pnoise Separation</strong>
<a id="pgfId-1046222"></a><div class="webflare-div-image">
<img src="images/PrimarySourcePLOT.gif" /></div><strong>Figure 1-32
<a id="pgfId-1046224"></a><a id="42459"></a>Source Noise Gain of ne600 with Pnoise Separation</strong>
<a id="pgfId-1046228"></a><div class="webflare-div-image">
<img src="images/SourceNoiseGainPLOT.gif" /></div>
<a id="pgfId-1046229"></a>To improve the noise performance of this circuit, decreasing the output noise of rif.rn is an effective solution. <br />
<a id="pgfId-1046230"></a>There are two approaches <ul><li>
<a id="pgfId-1046231"></a>One is decreasing the magnitude of noise source rif.rn by adjusting the device geometric size</li><li>
<a id="pgfId-1046232"></a>The other is decreasing the transfer function of rif.rn by adjusting the circuit architecture.</li></ul></li></ol>












































<h4><em>
<a id="pgfId-1046233"></a>Other Notes</em></h4>

<ul><li>
<a id="pgfId-1046234"></a>The Instance Output and Instance Source use the same truncation methods &#8212;truncation is by the top values of instance output noise. The Source Output, Primary Source and Src. Noise Gain use another truncating method &#8212; truncation is by the top number of the primary noise source output. Hence the list order of the former two plots may be different from the later three. If you want to check one instance in Instance Output/Instance Source and its primary sources in Source Output/Primary Source/Src. Noise Gain at the same time, you may be required to set different truncation values.</li><li>
<a id="pgfId-1046235"></a>An instance of an active device such as MOS, BJT includes several primary sources, the orders of magnitude. Some instances such as a thermal resistor generally include one primary source, whose PSD is <em>
4KTG</em>
 where <em>
G</em>
 is the conductance.</li><li>
<a id="pgfId-1046236"></a>When adjusting the circuit architecture by decreasing noise gain or the a transfer function of one noise source, might enlarge the transfer functions of other noise sources. Thus, you should consider using more global optimization. </li><li>
<a id="pgfId-1046237"></a>The Noise summary print form gives an overview of noise source distribution. It is useful for finding out which noise sources are abnormal. You can use WaveScan to check the result noise data. WaveScan is also useful for locating the faults in binomial <code>pnoise</code> (or <code>qpnoise)</code> analysis results.</li></ul>




<h2>
<a id="pgfId-1049369"></a>Simulating Noise and Jitter</h2>
<h3>
<a id="pgfId-1049383"></a>Analyzing Time-varying Noise</h3>

<p>
<a id="pgfId-1049405"></a>RF circuits are usually driven by periodic inputs. The noise in RF circuits is generated by sources that can therefore typically be modeled as periodically time-varying. Noise that has periodically time-varying properties is said to be cyclostationary.</p>

<h3>
<a id="pgfId-1049432"></a>Characterizing Time-Domain Noise</h3>

<p>
<a id="pgfId-1049433"></a>Noise in a circuit that is periodically driven, say with period <em>
T</em>
, exhibits statistical properties that also vary periodically.To understand time-domain characterization of noise, consider the simple circuit shown in Figure <a href="chap1.html#59397">1-33</a>.</p>

<p><strong>Figure 1-33
<a id="pgfId-1049438"></a><a id="59397"></a>Very Simple Mixer Schematic</strong></p>
<p>
<a id="pgfId-1049442"></a></p>
<div class="webflare-div-image">
<img src="images/ReallySimpleMixer.gif" /></div>

<p>
<a id="pgfId-1049446"></a>The amplitude of the noise measured at the RF output shown in Figure <a href="chap1.html#59397">1-33</a> periodically varies depending on the magnitude of the<em>
 
modulating signal <em>
p(t)</em>
, as shown by the sample points in Figure <a href="chap1.html#91167">1-34</a>.</em></p>

<p><strong>Figure 1-34
<a id="pgfId-1049451"></a><a id="91167"></a>Time-Varying Noise Process Analyzed at ξ<strong>1</strong> and ξ<sub>2</sub></strong></p>
<p>
<a id="pgfId-1049455"></a></p>
<div class="webflare-div-image">
<img src="images/NoiseSall.gif" /></div>

<p>
<a id="pgfId-1049459"></a>In Figure <a href="chap1.html#91167">1-34</a></p>
<ul><li>
<a id="pgfId-1049460"></a>The solid line shows the envelope <em>
p(t)</em>
 that modulates the noise process.</li><li>
<a id="pgfId-1049461"></a>The circles show possible phase points on the envelope where you might calculate the time-varying noise power.</li><li>
<a id="pgfId-1049462"></a>The circles marked ξ<sub><em>1</em></sub> and ξ<sub><em>2</em></sub> indicate the two phase points on the envelope where time-varying noise power is calculated.</li><li>
<a id="pgfId-1049463"></a>Noise in circuits that are periodically driven, say with period <em>
T</em>
, exhibits statistical properties that also vary periodically. To understand time-domain characterization of noise, consider the simple circuit shown in <a href="chap1.html#59397">Figure&#160;1-33</a>. The amplitude of the noise measured at the RF output periodically varies depending on the magnitude of the<em>
 
modulating signal <em>
p(t)</em>
, as shown by the sample points (or circles on the signal envelope) in <a href="chap1.html#91167">Figure&#160;1-34</a>.</em></li><li>
<a id="pgfId-1049473"></a>Figure <a href="chap1.html#91167">1-34</a> is a representation of periodically-modulated noise. It shows noise processes for two different phases in the periodic interval. Each process is stationary.</li></ul>




<p>
<a id="pgfId-1049474"></a>Spectre<sup>&#174;</sup> circuit simulator RF analysis (SpectreRF) can calculate the time-varying noise power at any point in the fundamental period. In fact, SpectreRF can calculate the full auto correlation function</p>
<p>
<a id="pgfId-1049475"></a><em>
R</em>
<sup>ξ</sup><em>
(p,q) = &lt; x</em>
<sup>ξ</sup><em>
(p)x</em>
<sup>ξ</sup><em>
(p+q) &gt; = R</em>
<sup>ξ</sup><em>
(q)</em>
</p>
<p>
<a id="pgfId-1049476"></a>and its spectrum for the discrete-time processes <em>
x</em>
<sup>ξ</sup> obtained by periodically sampling the time-domain noise process at the same point in phase.</p>
<p>
<a id="pgfId-1049483"></a>Figures <a href="chap1.html#79428">1-35</a> and <a href="chap1.html#31310">1-36</a> show two such noise processes for two different phases in the periodic interval. Each process is stationary. Figure <a href="chap1.html#79428">1-35</a> shows the noise process for the phase marked ξ<sub><em>1</em></sub> in <a href="chap1.html#91167">Figure&#160;1-34</a>.</p>

<p><strong>Figure 1-35
<a id="pgfId-1049491"></a><a id="79428"></a>Noise Process for Phase ξ<sub><em>1</em></sub></strong></p>
<p>
<a id="pgfId-1049495"></a></p>
<div class="webflare-div-image">
<img src="images/NoiseS1.gif" /></div>

<p>
<a id="pgfId-1049502"></a>Figure <a href="chap1.html#31310">1-36</a> shows the noise process for the phase marked ξ<sub><em>2</em></sub> in <a href="chap1.html#91167">Figure&#160;1-34</a>.</p>

<p><strong>Figure 1-36
<a id="pgfId-1049504"></a><a id="31310"></a>Noise Process for Phase ξ<sub><em>2</em></sub></strong></p>
<p>
<a id="pgfId-1049508"></a></p>
<div class="webflare-div-image">
<img src="images/NoiseS2.gif" /></div>

<p>
<a id="pgfId-1049512"></a>See the <a href="chap1.html#29707">&#8220;Reference Information on Time-Varying Noise&#8221;</a> for a more detailed introduction to noise in periodically time-varying systems.</p>

<h3>
<a id="pgfId-1049513"></a>Calculating Time Domain Noise</h3>

<p>
<a id="pgfId-1049514"></a>The following steps tell you how to calculate time-domain noise using SpectreRF.</p>
<ol><li>
<a id="pgfId-1049515"></a>In a terminal window, type <code>icms</code> (in IC5141) and virtuoso (in IC 6.1.4) to start the environment.</li><li>
<a id="pgfId-1049516"></a>In the ADE window, select <em>Analyses &#8211; Choose.</em><br />
<a id="pgfId-1049517"></a>The Choosing Analyses form appears.</li><li>
<a id="pgfId-1049518"></a>In the Choosing Analyses form, highlight pss and perform the PSS analysis setup.</li><li>
<a id="pgfId-1049519"></a>In the Choosing Analyses form, highlight <em>pnoise.</em></li><li>
<a id="pgfId-1049520"></a>The Choosing Analyses form changes to let you specify information for a Pnoise analysis.</li><li>
<a id="pgfId-1049521"></a>In the Choosing Analyses form, perform the following:<ol><li>
<a id="pgfId-1049522"></a>Choose Noise Type <em>timedomain</em>.</li><li>
<a id="pgfId-1049523"></a>Specify an appropriate frequency range and sweep for the analysis.<br />
<a id="pgfId-1049524"></a>You might, for example, perform a linear sweep up to the fundamental frequency. Because each time point in the calculation is a separate frequency sweep, use the minimum number of frequency points possible to resolve the spectrum. This step minimizes computation time.</li><li>
<a id="pgfId-1049525"></a>Specify a <em>noiseskipcount</em> value or specify additional explicit time points with <em>noisetimepoints.</em></li><li>
<a id="pgfId-1049526"></a>Specify an appropriate set of time points for the time-domain noise analysis.</li><li>
<a id="pgfId-1049527"></a>Use <em>noiseskipcount</em> to calculate time-domain noise for one of every <em>noiseskipcount</em> time points.<br />
<a id="pgfId-1049528"></a>If you set <em>noiseskipcount</em> to a value greater than or equal to zero, the simulator uses the <em>noiseskipcount</em> parameter value and ignores any <em>numberofpoints</em> parameter value. When <em>noiseskipcount </em>is less than zero, the simulator ignores the <em>noiseskipcount</em> parameter. The default is <em>noiseskipcount = -1.</em><br />
<a id="pgfId-1049529"></a>You can add specific points by specifying a time relative to the start of the PSS simulation interval. <em>noiseskipcount = 5</em> performs noise calculations for about 30 time points in the PSS interval.<br />
<a id="pgfId-1049530"></a>If you only need a few time points, add them explicitly with the <em>noisetimepoints</em> parameter and set <em>noiseskipcount</em> to a large value like 1000.</li></ol></li><li>
<a id="pgfId-1049531"></a>In the ADE window, choose <em>Simulation &#8211; Netlist and Run</em><em>.</em></li><li>
<a id="pgfId-1049532"></a>The simulation runs.</li><li>
<a id="pgfId-1049533"></a>In the ADE window, choose <em>Results &#8211; Direct Plot &#8211; PSS</em>.<br />
<a id="pgfId-1049534"></a>The PSS Results form appears.</li><li>
<a id="pgfId-1049535"></a>To calculate time-varying noise power, perform the following steps in the PSS Results form:<ol><li>
<a id="pgfId-1049536"></a>Click <em>tdnoise</em> and then select <em>Integrated noise power</em>.</li><li>
<a id="pgfId-1049537"></a>Type <code>0</code> as the start frequency and the PSS fundamental frequency as the stop period.<br />
<a id="pgfId-1049538"></a>For example, type <code>1G</code> if the PSS period is 1ns.</li></ol><br />
<a id="pgfId-1049539"></a>A periodic waveform appears that represents the expected noise power at each point in the fundamental period.</li><li>
<a id="pgfId-1049541"></a><a id="47367"></a>To display the spectrum of the sampled processes, perform the following steps in the PSS Results form:<ol><li>
<a id="pgfId-1049542"></a>Highlight <em>Output Noise</em>.</li><li>
<a id="pgfId-1049543"></a>Highlight <em>Spectrum</em> for the type of sweep.</li><li>
<a id="pgfId-1049544"></a>Clicking on <em>Plot</em>.</li></ol><br />
<a id="pgfId-1049545"></a>A set of curves appears, one for each sample phase in the fundamental period.</li><li>
<a id="pgfId-1049546"></a>To calculate the autocorrelation function for one of the sampled processes, perform the following steps:<ol><li>
<a id="pgfId-1049550"></a>Display the spectrum using instructions from <a href="chap1.html#47367">step 11</a>.</li><li>
<a id="pgfId-1049551"></a>In the ADE window, choose <em>Tools &#8211; Calculator</em>.</li><li>
<a id="pgfId-1049552"></a>The calculator appears.</li><li>
<a id="pgfId-1049553"></a>Click <em>wave</em> in the calculator and the select the appropriate frequency-domain spectrum.<br />
<a id="pgfId-1049554"></a>One of the sample waveforms is brought into the calculator</li><li>
<a id="pgfId-1049555"></a>Choose <em>DFT</em> from the list of special functions in the calculator. Then set 0 as the <em>From</em> and the PSS fundamental as the <em>To </em>value.</li><li>
<a id="pgfId-1049556"></a>Choose an appropriate window (e.g., Cosine2) and number of samples (around the number of frequency points in the interval [0,1/T]),</li><li>
<a id="pgfId-1049557"></a>Apply the <em>DFT</em> and plot the results.</li></ol><br />
<a id="pgfId-1049558"></a>Harmonic <em>q</em> of the DFT results gives the value of the discrete autocorrelation for this sample phase, <em>R(q)</em>.<br />
<a id="pgfId-1049559"></a>Be sure the noise is in the correct units of power (e.g., V2/Hz), not V/square root of Hz) before performing the DFT to obtain the autocorrelation.</li></ol>

















































<h3>
<a id="pgfId-1049560"></a>Calculating Noise Correlation Coefficients</h3>

<p>
<a id="pgfId-1049561"></a>To characterize the noise in multi-input/multi-output systems, it is necessary to calculate both the noise power at each port and the correlation between the noise at various ports. The situation is complicated in RF systems because the ports may be at different frequencies. For example, in a mixer, the input port may be at the RF frequency and the output port at the IF frequency.</p>
<p>
<a id="pgfId-1049562"></a>Denote the power spectrum of a signal <em>
x</em>
 by <em>
S</em>
<sub><em>XX</em></sub><em>
(</em>
ω<em>
)</em>
, that is</p>
<p>
<a id="pgfId-1049563"></a><em>
S</em>
<sub><em>XX</em></sub><em>
(</em>
ω<em>
) = X*(</em>
ω<em>
) X(</em>
ω<em>
)</em>
</p>
<p>
<a id="pgfId-1049564"></a>where <em>
X(</em>
ω<em>
)</em>
 is the Fourier transform of the signal <em>
x(t)</em>
. For random signals like noise, calculate the expected value of the power spectrum <em>
S</em>
<sub><em>XX</em></sub><em>
(</em>
ω<em>
)</em>
. To characterize the relationship between two separate signals <em>
x(t)</em>
 and <em>
y(t)</em>
, you also need the cross-power spectrum</p>
<p>
<a id="pgfId-1049565"></a><em>
S</em>
<sub><em>XY</em></sub><em>
(</em>
ω<em>
) = X*(</em>
ω<em>
) Y(</em>
ω<em>
)</em>
</p>
<p>
<a id="pgfId-1049566"></a>For random signals, the degree to which <em>
x</em>
 and <em>
y</em>
 are related is given by the cross-power spectrum. You can define a correlation coefficient ρ<em>
xy</em>
(ω) by</p>

<p>
<a id="pgfId-1049570"></a></p>
<div class="webflare-div-image">
<img width="231" height="75" src="images/chap1-77.gif" /></div>

<ul><li>
<a id="pgfId-1049571"></a>A correlation coefficient (ρ<em>
xy</em>
(ω)) of <code>0</code> indicates the signals are completely uncorrelated.</li><li>
<a id="pgfId-1049572"></a>A correlation coefficient of <code>1</code> indicates the signals are perfectly correlated. For example, a signal is always perfectly correlated with itself.</li><li>
<a id="pgfId-1049573"></a>You might also want to consider correlations between noise at different frequencies. The following quantity<br />
<a id="pgfId-1049577"></a><div class="webflare-div-image">
<img width="84" height="55" src="images/chap1-78.gif" /></div></li></ul>






<p>
<a id="pgfId-1049578"></a>expresses the correlation of a signal <em>
x </em>
at frequency ω with the signal <em>
y</em>
 at frequency ω <em>
+ </em>
α<code>.</code> For example, white Gaussian noise is completely uncorrelated with itself for <em>
a </em>
≠&#160;&#160;0. Noise in an RF system generally has <em>
S</em>
<sup>α</sup><em>
(</em>
ω<em>
)</em>
 non-zero when α is the fundamental frequency, for example, the LO frequency in a mixer.</p>
<p>
<a id="pgfId-1049579"></a>After you have measured the noise properties of a circuit, you can represent the circuit as a noiseless multiport with equivalent noise sources. For example, in Figure <a href="chap1.html#92023">1-37</a>, first you measure the noise voltage appearing at the excitation ports of the circuit on the left in Figure <a href="chap1.html#92023">1-37</a>. Then, you can express the noise properties of the circuit as two equivalent frequency-dependent noise voltages <em>
V</em>
<sub><em>N1</em></sub> and <em>
V</em>
<sub><em>N2</em></sub>, and a complex correlation coefficient ρ<em>
12</em>
.</p>

<p><strong>Figure 1-37
<a id="pgfId-1049587"></a><a id="92023"></a>Calculating Noise Correlations and Equivalent Noise Parameters</strong></p>
<p>
<a id="pgfId-1049591"></a></p>
<div class="webflare-div-image">
<img src="images/NoisePorts.gif" /></div>

<p>
<a id="pgfId-1049592"></a>When you know the noise at each port and its correlation, you can obtain any of various sets of equivalent noise parameters. For example, you can express noise in an impedance representation as the equivalent correlated noise voltage sources shown in Figure <a href="chap1.html#92023">1-37</a>, as equivalent noise resistances and the correlation parameters, and as <em>
F</em>
<sub><em>min</em></sub>, <em>
R</em>
<sub><em>N</em></sub>, <em>
G</em>
<sub><em>opt</em></sub>, and <em>
B</em>
<sub><em>opt</em></sub>.</p>

<h3>
<a id="pgfId-1049596"></a>Cyclostationary Noise Example</h3>

<p>
<a id="pgfId-1049597"></a>As an example which illustrates the various aspects of cyclostationary noise, consider the simple mixer circuit shown in Figure <a href="chap1.html#91945">1-38</a>.</p>

<p><strong>Figure 1-38
<a id="pgfId-1049602"></a><a id="91945"></a>Simple Mixer Circuit</strong></p>
<p>
<a id="pgfId-1049606"></a></p>
<div class="webflare-div-image">
<img src="images/SimpleMixer.gif" /></div>

<p>
<a id="pgfId-1049607"></a>In this simple mixer circuit, white Gaussian noise passes through a high-order band-pass filter with center frequency ω<sub><em>0</em></sub>. Then it is multiplied by two square-waves which have a phase shift <em>
a</em>
 with respect to each other. Finally the output of the ideal multipliers is put through a one-pole low-pass filter to produce <em>
I</em>
 and <em>
Q</em>
 outputs.</p>
<p>
<a id="pgfId-1049608"></a>The time-domain behavior of the noise is examined first. The most dramatic effect can be seen by looking directly at the mixer outputs in <a href="chap1.html#91185">Figure&#160;1-39</a>. This figure shows the contributions to the time-varying noise power made by three separate source frequencies. Two of the source frequencies were selected around ω<sub><em>0</em></sub>, the third source frequency was selected away from ω<sub><em>0</em></sub>, slightly into the stop band of the band-pass filter. The sharp change in noise power over the simulation interval occurs because the mixers were driven with square-wave LO signals.</p>

<p><strong>Figure 1-39
<a id="pgfId-1049613"></a><a id="91185"></a>Time-Varying Noise Power Before Low-Pass Filter</strong></p>
<p>
<a id="pgfId-1049617"></a></p>
<div class="webflare-div-image">
<img src="images/Nvst.gif" /></div>

<p>
<a id="pgfId-1049621"></a>Figure <a href="chap1.html#51731">1-40</a> shows the spectrum of a sampled noise process. Note the periodically replicated spectrum.</p>

<p><strong>Figure 1-40
<a id="pgfId-1049623"></a><a id="51731"></a>Spectrum of a Sampled Noise Process</strong></p>
<p>
<a id="pgfId-1049627"></a></p>
<div class="webflare-div-image">
<img src="images/Nif2Freq.gif" /></div>

<p>
<a id="pgfId-1049628"></a>The noise behavior at the output ports is examined next. The output spectra at the <em>
I</em>
 and <em>
Q</em>
 outputs are shown in Figures <a href="chap1.html#85472">1-41</a> and <a href="chap1.html#76860">1-42</a>. The noise density at <em>
I</em>
 is concentrated around zero because the noise at the RF input to the mixers (band-limited around ω<sub><em>0</em></sub>) is shifted down to zero and up to 2ω<sub><em>0</em></sub>, but components not around zero are eliminated by the low-pass filter.</p>

<p><strong>Figure 1-41
<a id="pgfId-1049636"></a><a id="85472"></a>Power Spectra With LO Tones 90<strong><sup>deg</sup></strong>
 Out of Phase</strong></p>
<p>
<a id="pgfId-1049640"></a></p>
<div class="webflare-div-image">
<img src="images/S0Out.gif" /></div>

<p>
<a id="pgfId-1049641"></a>More interesting is the cross-correlation spectrum of the <em>
I</em>
 and <em>
Q</em>
 outputs, shown as the dashed line in Figures <a href="chap1.html#85472">1-41</a> and <a href="chap1.html#76860">1-42</a>. When the signals applied to the mixers are 90 degrees out of phase (as in Figures <a href="chap1.html#85472">1-41</a>), the cross-power spectral density of the noise at the separate <em>
I</em>
 and <em>
Q</em>
 outputs is small, indicating little noise correlation. If the tones are not quite out of phase (as in Figures <a href="chap1.html#76860">1-42</a>), the correlation is much more pronounced, though in neither case is it completely zero.</p>
<p>
<a id="pgfId-1049660"></a>In Figures <a href="chap1.html#85472">1-41</a> and <a href="chap1.html#76860">1-42</a>, the solid and dashed lines represent the following</p>
<ul><li>
<a id="pgfId-1049661"></a>The solid line represents the power spectrum for the <em>
I</em>
 output with the function</li></ul>

<p>
<a id="pgfId-1049665"></a><img width="87" height="52" src="images/chap1-84.gif" /></p>

<ul><li>
<a id="pgfId-1049666"></a>The dashed line represents the cross-spectral density for <em>
I</em>
 and <em>
Q </em>
with the function</li></ul>

<p>
<a id="pgfId-1049670"></a><img width="92" height="56" src="images/chap1-85.gif" /></p>
<p><strong>Figure 1-42
<a id="pgfId-1049672"></a><a id="76860"></a>Power Spectra With LO Tones 72<strong><sup>deg</sup></strong>
 Out of Phase</strong></p>
<p>
<a id="pgfId-1049676"></a></p>
<div class="webflare-div-image">
<img src="images/S0OutSft.gif" /></div>
<p>
<a id="pgfId-1049677"></a>A more interesting example comes from examining the correlation between the noise at the <em>
I</em>
 output and the noise at the RF input. The density function as given by</p>
<p>
<a id="pgfId-1049681"></a><img width="82" height="56" src="images/chap1-87.gif" /></p>

<p>
<a id="pgfId-1049682"></a>is significant because it represents the correlation between the noise at the <em>
I</em>
 output around the baseband frequency with the noise at the RF input, ω<sub><em>0</em></sub> higher in frequency. The correlation is high because the noise at the RF input is centered around ω<sub><em>0</em></sub> and converted to zero-centered noise by the mixer.</p>

<p><strong>Figure 1-43
<a id="pgfId-1049684"></a><a id="82620"></a>Noise Spectrum at the RF Input</strong></p>
<p>
<a id="pgfId-1049688"></a></p>
<div class="webflare-div-image">
<img src="images/SrfIn.gif" /></div>

<p>
<a id="pgfId-1049692"></a>In Figure <a href="chap1.html#82620">1-43</a>, the noise spectrum at the RF input is given by the following function</p>

<p>
<a id="pgfId-1049696"></a><img width="79" height="62" src="images/chap1-89.gif" /></p>
<p><strong>Figure 1-44
<a id="pgfId-1049698"></a><a id="48178"></a>Noise Spectrum at Various Power Densities</strong></p>
<p>
<a id="pgfId-1049702"></a></p>
<div class="webflare-div-image">
<img src="images/S1IR.gif" /></div>

<p>
<a id="pgfId-1049706"></a>In Figure <a href="chap1.html#48178">1-44</a>, the solid, dashed, and dashed-dot lines represent the following</p>
<ul><li>
<a id="pgfId-1049707"></a>The solid line represents the cross power spectrum which indicates correlation between output noise power at the <em>
I</em>
 output versus noise at the RF input that is one harmonic higher in frequency. This is represented by the following function</li></ul>

<p>
<a id="pgfId-1049711"></a><img width="86" height="59" src="images/chap1-91.gif" /></p>

<ul><li>
<a id="pgfId-1049712"></a>The dashed line represents the noise spectrum at the <em>
I</em>
 output with the following function</li></ul>

<p>
<a id="pgfId-1049716"></a><img width="83" height="56" src="images/chap1-92.gif" /></p>

<ul><li>
<a id="pgfId-1049717"></a>The dashed-dot line represents the noise spectrum at the RF input with the following function</li></ul>

<p>
<a id="pgfId-1049721"></a><img width="69" height="55" src="images/chap1-93.gif" /></p>

<p>
<a id="pgfId-1049722"></a>Finally a detailed circuit example was considered. A transistor-level image-reject receiver with <em>
I</em>
 and <em>
Q</em>
 outputs was analyzed. The noise spectra at the <em>
I</em>
 and <em>
Q</em>
 outputs were found to be very similar, as shown in Figure <a href="chap1.html#54742">1-45</a>.</p>

<p><strong>Figure 1-45
<a id="pgfId-1049727"></a><a id="54742"></a>Power Spectral Densities of an Image-Reject Receiver</strong></p>
<p>
<a id="pgfId-1049731"></a></p>
<div class="webflare-div-image">
<img src="images/IQpwr.gif" /></div>

<p>
<a id="pgfId-1049735"></a>In the image-reject receiver example shown in Figure <a href="chap1.html#54742">1-45</a>, the power spectral densities are represented as follows</p>
<ul><li>
<a id="pgfId-1049736"></a><em>
I</em>
 output is a solid line</li><li>
<a id="pgfId-1049737"></a><em>
Q</em>
 output is a dashed line</li><li>
<a id="pgfId-1049738"></a><em>
IQ</em>
 cross-power density is a dash-dot line</li></ul>


<p>
<a id="pgfId-1049739"></a>The <em>
IQ</em>
 cross-power density was smaller, but not negligible, indicating that the noise at the two outputs is partially correlated. The correlation coefficient between noise at the <em>
I</em>
 and <em>
Q</em>
 outputs of the image-reject receiver is shown in Figure <strong><a href="chap1.html#87041"></a><h-hot>1-46</h-hot><strong></strong></strong>.</p>

<p><strong>Figure 1-46
<a id="pgfId-1049744"></a><a id="87041"></a>Correlation Coefficient for Output Noise of Image-Reject Receiver</strong></p>
<p>
<a id="pgfId-1049748"></a></p>
<div class="webflare-div-image">
<img src="images/IQCorrCoef.gif" /></div>
<h3>
<a id="pgfId-1049750"></a><a id="29707"></a>Reference Information on Time-Varying Noise</h3>

<p>
<a id="pgfId-1049751"></a>The following sections provide background and reference information on the following noise-related topics:</p>
<ul><li>
<a id="pgfId-1049755"></a><a href="chap1.html#75167">Thermal Noise</a></li><li>
<a id="pgfId-1049759"></a><a href="chap1.html#84300">Linear Systems and Noise</a></li><li>
<a id="pgfId-1049763"></a><a href="chap1.html#69142">Time-Varying Systems and the Autocorrelation Function</a></li><li>
<a id="pgfId-1049767"></a><a href="chap1.html#10695">Time-Varying Systems and Frequency Correlations</a></li><li>
<a id="pgfId-1049771"></a><a href="chap1.html#46178">Time-Varying Noise Power and Sampled Systems</a></li></ul>





<h4>
<a id="pgfId-1049773"></a><a id="75167"></a>Thermal Noise</h4>

<p>
<a id="pgfId-1049774"></a>The term <em>noise</em> is commonly used to refer to any unwanted signal. In the context of analog circuit simulation, noise is distinguished from such phenomena as distortion in the sense that it is non-deterministic, being generated from <em>random</em> events at a microscopic scale. For example, suppose a time-dependent current <em>
i(t)</em>
 is driven through a linear resistor, as shown in Figure <a href="chap1.html#44971">1-47</a>.</p>

<p><strong>Figure 1-47
<a id="pgfId-1049779"></a><a id="44971"></a>Deterministic Current Source Driving a Noisy Linear Resistor</strong></p>
<p>
<a id="pgfId-1049783"></a></p>
<div class="webflare-div-image">
<img src="images/irpict.gif" /></div>

<p>
<a id="pgfId-1049784"></a>The voltage that appears across the resistor is</p>

<p>
<a id="pgfId-1049788"></a><img width="151" height="45" src="images/chap1-97.gif" /></p>

<p>
<a id="pgfId-1049792"></a>The desired signal <em>
i(t)R</em>
, shown in Figure<a href="chap1.html#97629">1-48</a>, is corrupted by an added noise voltage <em>
n(t)</em>
 that is due to resistive thermal noise. The thermal noise of the resistor is modelled by a current source in parallel with the resistor.</p>

<p><strong>Figure 1-48
<a id="pgfId-1049794"></a><a id="97629"></a>The Desired Signal i(t)R</strong></p>
<p>
<a id="pgfId-1049798"></a></p>
<div class="webflare-div-image">
<img src="images/irpictnoiseonlynoise1.gif" /></div>

<p>
<a id="pgfId-1049802"></a>The total measured voltage is shown in Figure <a href="chap1.html#24321">1-49</a>.</p>

<p><strong>Figure 1-49
<a id="pgfId-1049804"></a><a id="24321"></a>The Total Measured Voltage</strong></p>
<p>
<a id="pgfId-1049808"></a></p>
<div class="webflare-div-image">
<img src="images/irpictnoiseonlynoise2.gif" /></div>

<p>
<a id="pgfId-1049809"></a>The added noise process alone, <em>
n(t)</em>
, is a random process and so it must be characterized in ways that are different than for deterministic signals. That is, at a time <em>
t</em>
<sub><em>0</em></sub> the voltage produced by the driven current can be exactly specified&#8212;it is <em>
i</em>
<sub><em>0</em></sub><em>
sint</em>
<sub><em>0</em></sub><em>
R</em>
. Just by inspecting Figure <a href="chap1.html#97629">1-48</a> we can predict this part of the measured signal.</p>
<p>
<a id="pgfId-1049813"></a>On the other hand, the exact value of the noise signal cannot be predicted in advance, although it can be measured to be a particular value <em>
n(t</em>
<sub><em>0</em></sub><em>
)</em>
. However, if another measurement is performed, the noise signal <em>
n(t)</em>
 we obtain is different and Figure <a href="chap1.html#24321">1-49</a> changes. Due to its innate randomness, we must use a statistical means to characterize <em>
n(t)</em>
.</p>
<p>
<a id="pgfId-1049820"></a>Now consider the circuit in Figure <a href="chap1.html#33927">1-50</a>, where we restrict attention to the noise source/resistor pair alone.</p>

<p><strong>Figure 1-50
<a id="pgfId-1049822"></a><a id="33927"></a>Resistor Modeled as a Noiseless Resistance with an Equivalent Noise Current Source</strong></p>
<p>
<a id="pgfId-1049826"></a></p>
<div class="webflare-div-image">
<img src="images/noiseronly.gif" /></div>

<p>
<a id="pgfId-1049830"></a>A typical measured noise current/voltage is shown in Figure <a href="chap1.html#73353">1-51</a>.</p>

<p><strong>Figure 1-51
<a id="pgfId-1049832"></a><a id="73353"></a>Typical Measured Noise Current/Voltage</strong></p>
<p>
<a id="pgfId-1049836"></a></p>
<div class="webflare-div-image">
<img src="images/whitenoisevar1.gif" /></div>

<p>
<a id="pgfId-1049837"></a>Because we cannot predict the specific value of <em>
n(t)</em>
 at any point, we might instead try to predict what its value would be on average, or what we might <em>expect</em> the noise to be. For example, if we measure many noise voltage curves in the time domain, <em>
n(t)</em>
, and average over many different curves, we obtain an approximation to the expected value of <em>
n(t)</em>
 which we denote by <em>
E</em>
{<em>
n(t)</em>
}. For thermal noise, we find that <em>
E</em>
{<em>
n(t)</em>
} <em>
= 0</em>
. Therefore, instead of computing <em>
E</em>
{<em>
n(t)</em>
}, let us instead compute <em>
E</em>
{<em>
n(t)</em>
<spti-sups-times-italic>
2</spti-sups-times-italic>
}, the expected noise power. An example of this sort of measurement is shown in Figure <a href="chap1.html#12224">1-52</a>. 250 measurements were needed to compute this curve.</p>

<p><strong>Figure 1-52
<a id="pgfId-1049842"></a><a id="12224"></a>Expected Noise Power</strong></p>
<p>
<a id="pgfId-1049846"></a></p>
<div class="webflare-div-image">
<img src="images/whitenoisevar2.gif" /></div>

<p>
<a id="pgfId-1049847"></a>Now suppose that we wish to tap the circuit at multiple points. Each point has its own noise characteristics, but they are not necessarily independent. Consider the circuit shown in Figure <a href="chap1.html#72301">1-53</a>.</p>

<p><strong>Figure 1-53
<a id="pgfId-1049852"></a><a id="72301"></a>Circuit Illustrating Correlated Noise</strong></p>
<p>
<a id="pgfId-1049856"></a></p>
<div class="webflare-div-image">
<img src="images/noisetwor.gif" /></div>

<p>
<a id="pgfId-1049857"></a>The signals <em>
n</em>
<sub><em>1</em></sub><em>
(t)</em>
 and <em>
n</em>
<sub><em>2</em></sub><em>
(t)</em>
 are obtained by measuring the voltage across a single resistor (<em>
n</em>
<sub><em>1</em></sub><em>
(t)</em>
), and across both resistors (<em>
n</em>
<sub><em>2</em></sub><em>
(t)</em>
), respectively. Just measuring <em>
E</em>
{<em>
n</em>
<sub><em>1</em></sub><em>
(t)</em>
<spti-sups-times-italic>
2</spti-sups-times-italic>
} and <em>
E</em>
{<em>
n</em>
<sub><em>2</em></sub><em>
(t)</em>
<spti-sups-times-italic>
2</spti-sups-times-italic>
} is not enough to predict the behavior of this system, because <em>
n</em>
<sub><em>1</em></sub><em>
(t) </em>
and <em>
n</em>
<sub><em>2</em></sub><em>
(t)</em>
 are not independent.</p>
<p>
<a id="pgfId-1049864"></a>To see <em>
n</em>
<sub><em>1</em></sub><em>
(t) </em>
and <em>
n</em>
<sub><em>2</em></sub><em>
(t)</em>
 are not independent, consider Figures <a href="chap1.html#29629">1-54</a> and <a href="chap1.html#23822">1-55</a>. Samples of each of the processes are taken and plotted on an X-Y graph.</p>

<p><strong>Figure 1-54
<a id="pgfId-1049866"></a><a id="29629"></a>Samples of n<sub><strong>1</strong></sub>(t) Plotted Versus n<sub><strong>2</strong></sub>(t)</strong></p>
<p>
<a id="pgfId-1049870"></a></p>
<div class="webflare-div-image">
<img src="images/twonoisecorrB.gif" /></div>

<p>
<a id="pgfId-1049874"></a>Because <em>
n</em>
<sub><em>1</em></sub><em>
(t)</em>
 composes part of <em>
n</em>
<sub><em>2</em></sub><em>
(t)</em>
, <em>
n</em>
<sub><em>1</em></sub><em>
(t)</em>
 and <em>
n</em>
<sub><em>2</em></sub><em>
(t) </em>
are correlated so in Figure <a href="chap1.html#29629">1-54</a>, the X-Y plot has a characteristic skew along the <em>
X=Y</em>
 line, relative to the <em>
n</em>
<sub><em>1</em></sub><em>
(t)</em>
, <em>
n</em>
<sub><em>3</em></sub><em>
(t)</em>
 plot in Figure <a href="chap1.html#23822">1-55</a>,</p>

<p><strong>Figure 1-55
<a id="pgfId-1049879"></a><a id="23822"></a>Samples of n<sub><strong>1</strong></sub>(t) Plotted Versus n<sub><strong>3</strong></sub>(t)</strong></p>
<p>
<a id="pgfId-1049883"></a></p>
<div class="webflare-div-image">
<img src="images/twonoisecorrA.gif" /></div>

<p>
<a id="pgfId-1049884"></a>The signals <em>
n</em>
<sub><em>1</em></sub><em>
(t)</em>
 and <em>
n</em>
<sub><em>3</em></sub><em>
(t)</em>
 are uncorrelated because they represent thermal noise from different sources. The additional measurement needed to describe the random processes is the measurement of the correlation between the two processes, <em>
E</em>
{<em>
n</em>
<sub><em>1</em></sub><em>
(t)n</em>
<sub><em>2</em></sub><em>
(t)</em>
}. We can also define a time-varying correlation coefficient ρ, with ρ∈ [<em>
0,1</em>
], as</p>

<p>
<a id="pgfId-1049888"></a><img width="246" height="105" src="images/chap1-106.gif" /></p>

<p>
<a id="pgfId-1049889"></a>A value of ρ<em>
=0</em>
 indicated completely uncorrelated signals, and a value near one indicates a high degree of correlation. In this example we would find that ρ<em>
(t) =1/2</em>
, representing the fact that each of the two noise sources contributes half of the process <em>
n</em>
<sub><em>2</em></sub><em>
(t)</em>
.</p>
<p>
<a id="pgfId-1049890"></a>When there are multiple variables of interest in the system, it is convenient to use matrix notation. We write all the random processes of interest in a vector, for example</p>

<p>
<a id="pgfId-1049894"></a><img width="120" height="89" src="images/chap1-107.gif" /></p>

<p>
<a id="pgfId-1049895"></a>and then we can write the correlations as the expected value of a vector outer product, <em>
E</em>
{<em>
x(t)x</em>
<spti-sups-times-italic>
H</spti-sups-times-italic>
<em>
(t)</em>
}, where the <em>
H</em>
 superscript indicates Hermitian transpose.</p>
<p>
<a id="pgfId-1049896"></a>For example, we might write a time-varying correlation matrix as</p>

<p>
<a id="pgfId-1049900"></a><img width="447" height="94" src="images/chap1-108.gif" /></p>
<h4>
<a id="pgfId-1049902"></a><a id="84300"></a>Linear Systems and Noise</h4>

<p>
<a id="pgfId-1049903"></a>The examples in the preceding sections describe how to characterize purely static systems. Now we need to add some elements with memory, such as inductors and capacitors.</p>
<p>
<a id="pgfId-1049904"></a>As a first example, consider adding a capacitor in parallel to the simple resistor, as shown in Figure <a href="chap1.html#49257">1-56</a>.</p>

<p><strong>Figure 1-56
<a id="pgfId-1049909"></a><a id="49257"></a>A Simple RC Circuit</strong></p>
<p>
<a id="pgfId-1049913"></a></p>
<div class="webflare-div-image">
<img src="images/ircap.gif" /></div>

<p>
<a id="pgfId-1049917"></a>A sample of the noise process in shown in Figure <a href="chap1.html#11348">1-57</a>.</p>

<p><strong>Figure 1-57
<a id="pgfId-1049919"></a><a id="11348"></a>Noise Process for a Simple RC Circuit</strong></p>
<p>
<a id="pgfId-1049923"></a></p>
<div class="webflare-div-image">
<img src="images/rcnoiseProcess.gif" /></div>

<p>
<a id="pgfId-1049924"></a>The noise looks different than the noise of the resistor alone, because the low-pass filter action of the RC circuit eliminates very high frequencies in the noise. However, we cannot see this effect simply by measuring <em>
E</em>
{<em>
n(t)</em>
<spti-sups-times-italic>
2</spti-sups-times-italic>
} as shown in Figure <a href="chap1.html#20159">1-58</a>.</p>

<p><strong>Figure 1-58
<a id="pgfId-1049929"></a><a id="20159"></a>Expected Noise Power for an RC Circuit</strong></p>
<p>
<a id="pgfId-1049933"></a></p>
<div class="webflare-div-image">
<img src="images/rcnoiseExPower.gif" /></div>

<p>
<a id="pgfId-1049934"></a>The measurement of <em>
E</em>
{<em>
n(t)</em>
<spti-sups-times-italic>
2</spti-sups-times-italic>
} is independent of time for an RC circuit, just as it was for the for the resistor circuit.</p>

<h4>
<a id="pgfId-1049935"></a>Spectral Densities in Two Simple Circuits</h4>

<p>
<a id="pgfId-1049936"></a>Instead of expected noise power, let us look at the expected power density in the frequency domain. Let <em>
n(</em>
ω<em>
)</em>
 denote the Fourier transform of one sample of <em>
n(t)</em>
. Then, <em>
E</em>
{<em>
n(</em>
ω<em>
)n(</em>
ω<em>
)*</em>
} is the expected power spectral density, which we denote by <em>
S</em>
<sub><em>n</em></sub><em>
(</em>
ω<em>
)</em>
.</p>
<p>
<a id="pgfId-1049939"></a>In the present case, the capacitor has a pronounced effect on the spectral density. Figure <a href="chap1.html#40825">1-58</a> shows a computed power spectral density for the resistor thermal noise previously considered. The spectrum is essentially flat (some deviations occur because a finite number of samples was taken to perform the calculation). The flat spectrum represents the fact that in the resistor&#39;s noise, all frequencies are, in some statistical sense, equally present. We call such a process <em>white noise</em>.</p>
<p>
<a id="pgfId-1049942"></a><strong>Power Spectral Density for Resistor Thermal Noise</strong><a id="40825"></a></p>

<p>
<a id="pgfId-1049946"></a></p>
<div class="webflare-div-image">
<img src="images/PowSpecDenResCap.gif" /></div>

<p>
<a id="pgfId-1049950"></a>Figure <a href="chap1.html#85257">1-59</a> shows the spectrum of the noise process after filtering by the resistor-capacitor system.</p>

<p><strong>Figure 1-59
<a id="pgfId-1049952"></a><a id="85257"></a>Resistor-Capacitor Filtered Spectral Noise Process</strong></p>
<p>
<a id="pgfId-1049956"></a></p>
<div class="webflare-div-image">
<img src="images/PowSpecDenResCap.gif" /></div>

<p>
<a id="pgfId-1049957"></a>It is easy to rigorously account for the effect of the RC-filter on the power spectrum of the noise signal. Suppose a random signal <em>
x</em>
 is passed through a time-invariant linear filter with frequency-domain transfer function <em>
h(</em>
ω<em>
)</em>
. Then the output is <em>
y(</em>
ω<em>
)=h(</em>
ω<em>
)x(</em>
ω<em>
)</em>
.</p>
<p>
<a id="pgfId-1049958"></a>Because expectation is a linear operator, we can easily relate the power spectral density of <em>
y</em>
, <em>
S</em>
<sub><em>y</em></sub><em>
(</em>
ω<em>
)</em>
 to <em>
S</em>
<sub><em>x</em></sub><em>
(</em>
ω<em>
)</em>
, the power spectral density of <em>
x</em>
, by using the definitions of <em>
y</em>
 and power density. Specifically,</p>

<p>
<a id="pgfId-1049962"></a><img width="530" height="52" src="images/chap1-114.gif" /></p>

<p>
<a id="pgfId-1049963"></a>The noise from the resistor can be considered to be generated by a noise current source <em>
i</em>
, with power density</p>

<p>
<a id="pgfId-1049967"></a><img width="132" height="63" src="images/chap1-115.gif" /></p>

<p>
<a id="pgfId-1049968"></a>placed in parallel with the resistor. With the capacitor in parallel, the transfer function from the current source to the resistor voltage is just the impedance <em>
Z(</em>
ω<em>
)</em>
,</p>

<p>
<a id="pgfId-1049972"></a><img width="204" height="72" src="images/chap1-116.gif" /></p>

<p>
<a id="pgfId-1049973"></a>and so the noise voltage power density is</p>

<p>
<a id="pgfId-1049977"></a><img width="183" height="112" src="images/chap1-117.gif" /></p>

<p>
<a id="pgfId-1049978"></a>Clearly the spectrum is attenuated at high frequencies and reaches a maximum near zero.</p>
<p>
<a id="pgfId-1049979"></a>For a vector process, we may define a matrix of power-spectral densities,</p>

<p>
<a id="pgfId-1049983"></a><img width="196" height="72" src="images/chap1-118.gif" /></p>

<p>
<a id="pgfId-1049984"></a>The diagonal terms are simple real-valued power densities, and the off-diagonal terms are generally complex-valued cross-power densities between two variables. The cross-power density gives a measure of the correlation between the noise in two separate signals at a specific frequency. We may define a correlation coefficient as</p>

<p>
<a id="pgfId-1049988"></a><img width="222" height="82" src="images/chap1-119.gif" /></p>

<p>
<a id="pgfId-1049989"></a>It is often more useful to examine the correlation coefficient because the cross-power density may be small. As an example, consider a noiseless amplifier. The noise at the input is simply a scaled version of the noise at the output leading to a ρ<em>
=1</em>
, but the cross-power density is much smaller than the output total noise power density if the amplifier has small gain.</p>
<p>
<a id="pgfId-1049990"></a>In a numerical simulation it is important to compute <em>only</em> the correlation coefficient when the diagonal spectral densities are sufficiently large. If one of the power densities in the denominator of the correlation-coefficient definition is very small, then a small numerical error could lead to large errors in the computed coefficient, because of division by a number close to zero.</p>
<p>
<a id="pgfId-1049991"></a>In the vector case, the transfer function is also a matrix <em>
H(</em>
ω<em>
)</em>
, such that <em>
y(</em>
ω<em>
)=H(</em>
ω<em>
)x(</em>
ω<em>
)</em>
 and so the spectral densities at the input and output are related by</p>

<p>
<a id="pgfId-1049995"></a><img width="474" height="71" src="images/chap1-120.gif" /></p>
<h4>
<a id="pgfId-1049997"></a><a id="69142"></a>Time-Varying Systems and the Autocorrelation Function</h4>

<p>
<a id="pgfId-1049998"></a>If all the sources of noise in a system are resistors, and the circuit consists strictly of linear time-invariant elements, then the matrix of spectral densities <em>
S</em>
<sub><em>xx</em></sub><em>
(</em>
ω<em>
)</em>
 is sufficient to describe the noise. However, most interesting RF circuits contain nonlinear elements driven by time-varying signals. This introduces time-varying noise sources as well as time-varying filtering. Because most noise sources are small, and generate small perturbations to the circuit behavior, for purposed of noise analysis, most RF circuits can be effectively modeled as linear time-varying systems. The simple matrix of power spectra is not sufficient to describe these systems.</p>
<p>
<a id="pgfId-1049999"></a>To see this, return to the simple resistor example. Suppose that a switch is connected between the resistor and the voltage measuring device, as shown in Figure <a href="chap1.html#46316">1-60</a>.</p>

<p><strong>Figure 1-60
<a id="pgfId-1050004"></a><a id="46316"></a>SimpleTime-Varying Circuit with Switch</strong></p>
<p>
<a id="pgfId-1050008"></a></p>
<div class="webflare-div-image">
<img src="images/rSwitch.gif" /></div>

<p>
<a id="pgfId-1050009"></a>Further suppose that the switch is periodically opened and closed. When the switch is open, there is no noise measured. When the switch is closed, the thermal noise is seen at the voltage output. A typical noise waveform is shown on the bottom left in Figure <a href="chap1.html#72749">1-61</a>.</p>

<p><strong>Figure 1-61
<a id="pgfId-1050014"></a><a id="72749"></a>Typical Waveforms for Noise, Noise Power and White Noise</strong></p>
<p>
<a id="pgfId-1050018"></a></p>
<div class="webflare-div-image">
<img src="images/SwitchSpec.gif" /></div>

<p>
<a id="pgfId-1050022"></a>The time-varying noise power <em>
E</em>
{<em>
n(t)</em>
<spti-sups-times-italic>
2</spti-sups-times-italic>
} can be computed and is shown in Figure <a href="chap1.html#72749">1-61</a> on the top left, above the time-varying noise waveform. The expected power periodically switches between zero and the value expected from the resistor noise. This is different than the resistor-only and resistor-capacitor systems considered previously. Indeed, no linear time-invariant system could create this behavior. However, if we examine the power spectrum on the right in Figure <a href="chap1.html#72749">1-61</a>, we again find that it is flat, corresponding to <em>white</em> noise.</p>

<h4><em>
<a id="pgfId-1050026"></a>The Autocorrelation Function</em></h4>

<p>
<a id="pgfId-1050027"></a>At this point it is clear that <em>
E</em>
{<em>
n(t)</em>
} and <em>
E</em>
{<em>
n(t)</em>
<spti-sups-times-italic>
2</spti-sups-times-italic>
}<em></em>
do not completely specify the random process <em>
n(t)</em>
, nor does the power spectral density. To obtain a complete characterization, consider measuring <em>
n(t)</em>
 at two different timepoints, <em>
t</em>
<sub><em>1</em></sub> and <em>
t</em>
<sub><em>2</em></sub>. <em>
n(t</em>
<sub><em>1</em></sub><em>
)</em>
 and <em>
n(t</em>
<sub><em>2</em></sub><em>
)</em>
 are two separate random variables. They may be independent of each other, but in general they have some correlation. Therefore, to completely specify the statistical characteristics of <em>
n(t</em>
<sub><em>1</em></sub><em>
)</em>
 and <em>
n(t</em>
<sub><em>2</em></sub><em>
)</em>
 together, we must specify not only the variances <em>
E</em>
{<em>
n(t</em>
<sub><em>1</em></sub><em>
)</em>
<spti-sups-times-italic>
2</spti-sups-times-italic>
} and <em>
E</em>
{<em>
n(t</em>
<sub><em>2</em></sub><em>
)</em>
<spti-sups-times-italic>
2</spti-sups-times-italic>
}, but also the covariance <em>
E</em>
{<em>
n(t</em>
<sub><em>1</em></sub><em>
)n(t</em>
<sub><em>2</em></sub><em>
)</em>
}. In fact because <em>
n(t)</em>
 has infinite dimension, an infinite number of these correlations must be specified to characterize the entire random process. The usual way of doing this is by defining the autocorrelation function <em>
R</em>
<sub><em>n</em></sub><em>
(t,t+</em>
τ<em>
) = E</em>
{<em>
n(t)n(t+</em>
τ<em>
)</em>
}.</p>
<p>
<a id="pgfId-1050028"></a>If <em>
x(t)</em>
 is a vector process,</p>

<p>
<a id="pgfId-1050032"></a><img width="125" height="83" src="images/chap1-123.gif" /></p>

<p>
<a id="pgfId-1050033"></a>then we define the autocorrelation matrix as</p>

<p>
<a id="pgfId-1050037"></a><img width="549" height="84" src="images/chap1-124.gif" /></p>

<p>
<a id="pgfId-1050038"></a>where superscript <em>
H</em>
 indicates Hermitian transpose.</p>
<p>
<a id="pgfId-1050039"></a>The diagonal term gives the autocorrelation function for a single entry of the vector, e.g, <em>
E</em>
{<em>
x</em>
<sub><em>1</em></sub><em>
(t)x</em>
<sub><em>t</em></sub><em>
(t+</em>
τ<em>
)</em>
}. For τ<em>
=0</em>
, this is the time-varying power in the single process, e.g. <em>
E</em>
{<em>
x</em>
<sub><em>1</em></sub><em>
(t)</em>
<spti-sups-times-italic>
2</spti-sups-times-italic>
}. If the process <em>
x(t)</em>
 is Gaussian, it is completely characterized by its autocorrelation function <em>
R</em>
<sub><em>x</em></sub><em>
(t, t+</em>
τ<em>
)</em>
 because all the variances and co-variances are now specified.</p>
<p>
<a id="pgfId-1050040"></a>We can also precisely define what it means for a process to be <em>time-independent</em>, or <em>stationary</em>&#8212;A stationary process is one whose autocorrelation function is a function of τ only, not of <em>
t</em>
. This means that not only is the <em>
noise power</em>
 <em>
E</em>
{<em>
n(t)</em>
<spti-sups-times-italic>
2</spti-sups-times-italic>
} independent of <em>
t</em>
, but the correlation of the signal at a time point with the signal at another timepoint is only dependent on the difference between the timepoints, τ. The white noise generated by the resistor, and the RC-filtered noise, are both stationary processes.</p>

<h4><em>
<a id="pgfId-1050041"></a>Connecting Autocorrelation and Spectral Densities</em></h4>

<p>
<a id="pgfId-1050042"></a>At different points in the discussion above it was claimed that the expected time-varying power <em>
E</em>
{<em>
n(t)</em>
<spti-sups-times-italic>
2</spti-sups-times-italic>
} of the resistor voltage is constant in time, and also the power density <em>
S</em>
<sub><em>n</em></sub><em>
(</em>
ω<em>
)</em>
 is constant in frequency. At first this seems odd because a quantity that is <em>broad</em> in time should be <em>concentrated</em> in frequency, and vice versa.</p>
<p>
<a id="pgfId-1050043"></a>The answer comes in the precise relation of the spectral density to the autocorrelation function. Indeed, it turns out that the spectral density is the Fourier transform of the autocorrelation function, but with respect to the variable τ, not with respect to <em>
t</em>
. In other words, the measured spectral density is related to the correlation of a random process with time-shifted versions of itself. Formally, for a stationary process <em>
R</em>
<sub><em>n</em></sub><em>
(t,t+</em>
τ<em>
) = R</em>
<sub><em>n</em></sub><em>
(t)) </em>
we write</p>

<p>
<a id="pgfId-1050047"></a><img width="202" height="77" src="images/chap1-125.gif" /></p>

<p>
<a id="pgfId-1050048"></a>For example, in the resistor-capacitor system considered above, we can calculate the autocorrelation function <em>
R</em>
<sub><em>n</em></sub><em>
(</em>
τ<em>
)</em>
 by an inverse Fourier transform of the power spectral density, with the result</p>

<p>
<a id="pgfId-1050052"></a><img width="220" height="64" src="images/chap1-126.gif" /></p>

<p>
<a id="pgfId-1050053"></a>From inspecting this expression we can see that what is happening is that adding a capacitor to the system creates memory. The random current process generated by the thermal noise of the resistor has no memory of itself so the currents at separate time-instants are not correlated. However, if the current source adds a small amount of charge to the capacitor, the charge takes a finite amount of time to discharge through the resistor creating voltage. Thus voltage at a time-instant is correlated with the voltage at some time later, because part of the voltage at the two separated time instants is due to the same bit of added charge. From inspecting the autocorrelation function it is clear that the correlation effects last only as long as the time it takes any particular bit of charge to decay, in other words, a few times the <em>
RC</em>
 time constant of the resistor-capacitor system.</p>
<p>
<a id="pgfId-1050054"></a>Note that the process is still stationary because this memory effect depends only on how long has elapsed since the bit of charge has been added, or rather how much time the bit of charge has had to dissipate, not the absolute time at which the charge is added. Charge added at separate times is not correlated because arbitrary independent amounts can be added at a given instant. In particular, the time-varying noise power,</p>

<p>
<a id="pgfId-1050058"></a><img width="207" height="80" src="images/chap1-127.gif" /></p>
<h4>
<a id="pgfId-1050060"></a><a id="10695"></a>Time-Varying Systems and Frequency Correlations</h4>

<p>
<a id="pgfId-1050061"></a>Now we have seen that the variation of the spectrum in frequency is related to the correlations of the process, in time. We might logically expect that, conversely, variation of the process in time (that is, non-stationarity) might have something to due with correlations of the process in frequency. To see why this might be the case, suppose we could write a random process <em>
x</em>
 as a sum of complex exponentials with random coefficients,</p>

<p>
<a id="pgfId-1050065"></a><img width="152" height="74" src="images/chap1-128.gif" /></p>

<p>
<a id="pgfId-1050066"></a>Noting that <em>
c</em>
<sub><em>-k</em></sub><em>
=c</em>
<sub><em>k</em></sub><em>
*, </em>
the time-varying power in the process is</p>

<p>
<a id="pgfId-1050070"></a><img width="360" height="80" src="images/chap1-129.gif" /></p>

<p>
<a id="pgfId-1050071"></a>and it is clear that <em>
E</em>
{<em>
x(t)</em>
<spti-sups-times-italic>
2</spti-sups-times-italic>
} is constant in time if and only if</p>

<p>
<a id="pgfId-1050075"></a><img width="169" height="53" src="images/chap1-130.gif" /></p>

<p>
<a id="pgfId-1050076"></a>In other words, the coefficients of expansion of sinusoids of different frequencies must be uncorrelated. In general, a stationary process is one whose frequency-domain representation contains no correlations across different frequencies.</p>
<p>
<a id="pgfId-1050077"></a>To see how frequency correlations might come about, let us return to the resistor-switch example. Let <em>
n(t)</em>
 denote the voltage noise on the resistor, and <em>
h(t)</em>
 the action of the switch, so that the measure voltage is given by <em>
v(t) = h(t)n(t)</em>
, where <em>
h(t)</em>
 is periodic with period <em>
T</em>
 and frequency</p>

<p>
<a id="pgfId-1050081"></a><img width="88" height="56" src="images/chap1-131.gif" />
</p>

<p>
<a id="pgfId-1050082"></a>The time-domain multiplication of the switch becomes a convolution in the frequency domain,</p>

<p>
<a id="pgfId-1050086"></a><img width="171" height="43" src="images/chap1-132.gif" /></p>

<p>
<a id="pgfId-1050087"></a>where ⊗ denotes convolution.</p>
<p>
<a id="pgfId-1050088"></a>Because <em>
h(t)</em>
 is periodic, its frequency-domain representation is a series of Dirac deltas,</p>

<p>
<a id="pgfId-1050092"></a><img width="191" height="57" src="images/chap1-133.gif" /></p>

<p>
<a id="pgfId-1050093"></a>and so</p>

<p>
<a id="pgfId-1050097"></a><img width="190" height="55" src="images/chap1-134.gif" /></p>

<p>
<a id="pgfId-1050098"></a>and the spectral power density is simply</p>

<p>
<a id="pgfId-1050102"></a><img width="507" height="55" src="images/chap1-135.gif" /></p>

<p>
<a id="pgfId-1050103"></a>Because the process <em>
n</em>
 is stationary, this reduces to</p>

<p>
<a id="pgfId-1050107"></a><img width="235" height="65" src="images/chap1-136.gif" /></p>

<p>
<a id="pgfId-1050108"></a>Because <em>
S</em>
<sub><em>n</em></sub><em>
(</em>
ω<em>
)</em>
 is constant in frequency, <em>
S</em>
<sub><em>v</em></sub><em>
(</em>
ω<em>
)</em>
 is also.</p>
<p>
<a id="pgfId-1050109"></a>However, the process <em>
v</em>
 is no longer stationary because frequencies separated by multiples of ω<sub><em>0</em></sub> have been correlated by the action of the time-varying switch. We may see this effect in the time-variation of the noise power, as in <a href="chap1.html#72749">Figure&#160;1-61</a>, or we may examine the correlations directly in the frequency domain.</p>
<p>
<a id="pgfId-1050113"></a>To do this, we introduce the <em>cycle spectra</em></p>

<p>
<a id="pgfId-1050117"></a><img width="79" height="59" src="images/chap1-137.gif" /></p>

<p>
<a id="pgfId-1050118"></a>that are defined by</p>

<p>
<a id="pgfId-1050122"></a><img width="240" height="71" src="images/chap1-138.gif" /></p>

<p>
<a id="pgfId-1050123"></a>and are a sort of cross-spectral density, taken between two separate frequencies. <em>
S</em>
<sub><em>0</em></sub><em>
(</em>
ω<em>
)</em>
 is just the power spectral density we have previously discussed. In fact we can define a frequency-correlation coefficient as</p>

<p>
<a id="pgfId-1050127"></a><img width="216" height="89" src="images/chap1-139.gif" /></p>

<p>
<a id="pgfId-1050128"></a>and if</p>

<p>
<a id="pgfId-1050132"></a><img width="106" height="63" src="images/chap1-140.gif" /></p>

<p>
<a id="pgfId-1050133"></a>then the process <em>
n</em>
 has frequency content at ω and ω + α that is perfectly correlated.</p>
<p>
<a id="pgfId-1050134"></a>Consider separating out a single frequency component of a random process and multiplying by a sinusoidal waveform of frequency α, as shown in Figure <a href="chap1.html#85037">1-62</a>. The component at ω is shifted to re-appear at ω + α and ω − α. The new process&#39; frequency components at ω − α and ω + α are deterministically related to the components of the old process located at ω. Therefore, they are correlated, and <em>
S</em>
<spti-sups-times-italic>
2a</spti-sups-times-italic>
<em>
(</em>
ω<em>
)</em>
 is non-zero.</p>

<p><strong>Figure 1-62
<a id="pgfId-1050139"></a><a id="85037"></a>Time-Variation Introduces Frequency Correlation</strong></p>
<p>
<a id="pgfId-1050143"></a></p>
<div class="webflare-div-image">
<img src="images/FreqCorr.gif" /></div>

<p>
<a id="pgfId-1050144"></a>Physically, what happens is that to form a waveform with a defined <em>shape </em>in time, the different frequency components of the signal must add in a coherent, or correlated fashion. In a process like thermal noise, the Fourier coefficients at different frequencies have phase that is randomly distributed with respect to each other, and the Fourier components can only add incoherently. Their powers add, rather than their amplitudes. Frequency correlation and time-variation of statistics are thus seen to be equivalent concepts.</p>
<p>
<a id="pgfId-1050145"></a>Another way of viewing the cycle spectra is that they represent, in a sense, the two-dimensional Fourier transform of the autocorrelation function, and are therefore just another way of expressing the statistics of the process.</p>

<h4><em>
<a id="pgfId-1050147"></a><a id="46178"></a>Time-Varying Noise Power and Sampled Systems</em></h4>

<p>
<a id="pgfId-1050148"></a>Again supposing the signal <em>
n</em>
 to be cyclostationary with period <em>
T</em>
, for each sample phase ξ ∈ <em>
[0,T)</em>
, we may define the discrete-time autocorrelation function</p>

<p>
<a id="pgfId-1050152"></a><img width="79" height="58" src="images/chap1-142.gif" /></p>

<p>
<a id="pgfId-1050153"></a>to be</p>

<p>
<a id="pgfId-1050157"></a><img width="306" height="62" src="images/chap1-143.gif" /></p>

<p>
<a id="pgfId-1050158"></a>Because the cyclostationary process <em>
R</em>
<sub><em>n</em></sub> is periodic, by inspection</p>

<p>
<a id="pgfId-1050162"></a><img width="113" height="59" src="images/chap1-144.gif" /></p>

<p>
<a id="pgfId-1050163"></a>is independent of <em>
p</em>
 and thus stationary, that is</p>

<p>
<a id="pgfId-1050167"></a><img width="171" height="65" src="images/chap1-145.gif" /></p>

<p>
<a id="pgfId-1050168"></a>Note that</p>

<p>
<a id="pgfId-1050172"></a><img width="154" height="62" src="images/chap1-146.gif" /></p>

<p>
<a id="pgfId-1050173"></a>gives the expected noise power, <em>
R</em>
<sub><em>n</em></sub><em>
(</em>
ξ<em>
,</em>
ξ<em>
)</em>
, for the signal at phase ξ. Plotting <em>
R</em>
<sup>ξ</sup><em>
(0)</em>
 versus ξ shows how the noise power varies periodically with time.</p>
<p>
<a id="pgfId-1050174"></a>The discrete-time process</p>

<p>
<a id="pgfId-1050178"></a><img width="181" height="61" src="images/chap1-147.gif" /></p>

<p>
<a id="pgfId-1050179"></a>can be described in the frequency-domain by its discrete Fourier transform,</p>

<p>
<a id="pgfId-1050183"></a><img width="246" height="75" src="images/chap1-148.gif" /></p>

<p>
<a id="pgfId-1050184"></a>Note that the spectrum of the discrete (sampled) process</p>

<p>
<a id="pgfId-1050188"></a><img width="68" height="61" src="images/chap1-149.gif" /></p>

<p>
<a id="pgfId-1050189"></a>is periodic in frequency with period <em>
1/ T</em>
.</p>
<p>
<a id="pgfId-1050190"></a>All noise power is aliased into the Nyquist interval <em>
[</em>
−<em>
1/ 2T, 1/ 2T]</em>
 (or, equivalently, the interval <em>
[0,1/ T]</em>
). Generally it is the noise spectrum which is available from the circuit simulator. To obtain the autocorrelation function or time-varying noise power, an inverse Fourier integral must be calculated by</p>

<p>
<a id="pgfId-1050194"></a><img width="232" height="61" src="images/chap1-150.gif" /></p>
<h3>
<a id="pgfId-1050195"></a>Summary</h3>

<ul><li>
<a id="pgfId-1050196"></a>All useful noise metrics can be interpreted in terms of correlations. Physically these can be interpreted as the expected value of two-term products. In the case of random vectors these are expected values of vector outer products.</li><li>
<a id="pgfId-1050197"></a>The power spectral density of a variable indexed <em>
i</em>
 is</li></ul>


<p class="webflare-indent1">
<a id="pgfId-1050201"></a><img width="224" height="52" src="images/chap1-151.gif" /></p>

<p class="webflare-indent1">
<a id="pgfId-1050202"></a>This is what the current SpectreRF pnoise analysis computes.</p>
<p class="webflare-indent1">
<a id="pgfId-1050203"></a><em>
S</em>
<sub><em>xx</em></sub><em>
(</em>
ω<em>
)</em>
 is constant if and only if <em>
x</em>
 is a white noise process. In that case <em>
R</em>
<sub><em>xx</em></sub><em>
(</em>
τ<em>
) = R</em>
δ<em>
(</em>
τ<em>
)</em>
 if there are no correlations in time for the process.</p>
<p class="webflare-indent1">
<a id="pgfId-1050204"></a>The cross-power densities of two variables <em>
x</em>
<sub><em>i</em></sub> and <em>
x</em>
<sub><em>j</em></sub> are</p>

<p class="webflare-indent1">
<a id="pgfId-1050208"></a><img width="233" height="79" src="images/chap1-152.gif" /></p>

<p class="webflare-indent1">
<a id="pgfId-1050209"></a>If and only if the two variables have zero correlation at that frequency, then</p>

<p class="webflare-indent1">
<a id="pgfId-1050213"></a><img width="91" height="55" src="images/chap1-153.gif" /></p>

<p class="webflare-indent1">
<a id="pgfId-1050214"></a>A correlation coefficient may be defined as</p>

<p class="webflare-indent1">
<a id="pgfId-1050218"></a><img width="190" height="83" src="images/chap1-154.gif" /></p>

<p class="webflare-indent1">
<a id="pgfId-1050219"></a>and ρ<sub><em>ij</em></sub><em>
(f)</em>
 ∈ <em>
[0,1]</em>
.</p>
<p class="webflare-indent1">
<a id="pgfId-1050220"></a>The cycle-spectra</p>

<p class="webflare-indent1">
<a id="pgfId-1050224"></a><img width="72" height="58" src="images/chap1-155.gif" /></p>

<p class="webflare-indent1">
<a id="pgfId-1050225"></a>represent correlations between frequencies separated by the cycle-frequency α</p>

<p class="webflare-indent1">
<a id="pgfId-1050229"></a><img width="242" height="75" src="images/chap1-156.gif" /></p>

<p class="webflare-indent1">
<a id="pgfId-1050230"></a>For a single process <em>
x</em>
<sub><em>i</em></sub>, a correlation coefficient may be defined as</p>

<p class="webflare-indent1">
<a id="pgfId-1050234"></a><img width="219" height="93" src="images/chap1-157.gif" /></p>

<p class="webflare-indent1">
<a id="pgfId-1050235"></a>and</p>

<p class="webflare-indent1">
<a id="pgfId-1050239"></a><img width="127" height="65" src="images/chap1-158.gif" /></p>

<ul><li>
<a id="pgfId-1050240"></a>A process is stationary if and only if</li></ul>

<p class="webflare-indent1">
<a id="pgfId-1050244"></a><img width="105" height="63" src="images/chap1-159.gif" /></p>

<p class="webflare-indent1">
<a id="pgfId-1050245"></a>for all ω and all α ≠ <em>
0</em>
, that is, if there are no correlations in frequency for the process.</p>
<p class="webflare-indent1">
<a id="pgfId-1050246"></a>In other words,</p>

<p class="webflare-indent1">
<a id="pgfId-1050250"></a><img width="181" height="59" src="images/chap1-160.gif" /></p>

<ul><li>
<a id="pgfId-1050251"></a>A process is cyclostationary if</li></ul>

<p class="webflare-indent1">
<a id="pgfId-1050255"></a><img width="85" height="55" src="images/chap1-161.gif" /></p>

<p class="webflare-indent1">
<a id="pgfId-1050256"></a>for all α ≠ <em>
m</em>
ω<sub><em>0</em></sub> for some ω<sub><em>0</em></sub> and integer <em>
m</em>
. Frequencies separated by <em>
m</em>
ω<sub><em>0</em></sub> are correlated. A stationary process passed through a periodically linear-time varying filter in general is cyclostationary with ω<sub><em>0</em></sub> the fundamental harmonic of the filter.</p>
<p class="webflare-indent1">
<a id="pgfId-1050257"></a>We might also compute correlations between different nodes at different frequencies, with the obvious interpretation and generalization of the correlation coefficients.</p>

<h3>
<a id="pgfId-1050258"></a>Oscillator Noise Analysis</h3>

<p>
<a id="pgfId-1050259"></a>In RF systems, local oscillator phase noise can limit the final system performance. Spectre<sup>&#174;</sup> circuit simulator RF analysis (SpectreRF) lets you rigorously characterize the noise performance of oscillator elements. This appendix explains phase noise, tells how it occurs, and shows how to calculate phase noise using the SpectreRF simulator.</p>
<p>
<a id="pgfId-1050263"></a><a href="chap1.html#39558">&#8220;Phase Noise Primer&#8221;</a> discusses how phase noise occurs and provides a simple illustrative example.</p>
<p>
<a id="pgfId-1050267"></a><a href="chap1.html#35587">&#8220;Models for Phase Noise&#8221;</a> contains mathematical details about how the SpectreRF simulator calculates noise and how these calculations are related to other possible phase noise models. You can skip this section without any loss of continuity, but this section can help you better understand how SpectreRF calculates phase noise and better appreciate the drawbacks and pitfalls of other simple phase noise models. This section can also help in debugging difficult circuit simulations.</p>
<p>
<a id="pgfId-1050271"></a><a href="chap1.html#14317">&#8220;Calculating Phase Noise&#8221;</a> provides some suggestions for successful and efficient analysis of oscillators and discusses the limitations of the simulator.</p>
<p>
<a id="pgfId-1050275"></a><a href="chap1.html#14394">&#8220;Troubleshooting Phase Noise Calculations&#8221;</a> explains troubleshooting methods for difficult simulations.</p>
<p>
<a id="pgfId-1050279"></a><a href="chap1.html#20382">&#8220;Frequently Asked Questions&#8221;</a> answers some commonly asked questions about phase noise and the SpectreRF simulator.</p>
<p>
<a id="pgfId-1050286"></a><a href="chap1.html#45073">&#8220;Further Reading&#8221;</a> and <a href="chap1.html#92748">&#8220;References&#8221;</a> list additional sources of information on oscillator noise analysis.</p>
<p>
<a id="pgfId-1050287"></a>The procedures included in this appendix are intended for SpectreRF users who analyze oscillator noise. You must have a working familiarity with SpectreRF simulation and its operating principles. In particular, you must understand the SpectreRF PSS and Pnoise analyses. For information, see <em><a actuate="user" class="URL" href="../spectreRFTheory/spectreRFTheoryTOC.html#firstpage" show="replace" xml:link="simple">Spectre Circuit Simulator RF Analysis Theory.</a></em></p>

<h3>
<a id="pgfId-1050291"></a><a id="39558"></a>Phase Noise Primer<a id="marker-1050290"></a></h3>

<p>
<a id="pgfId-1050295"></a>Consider the simple resonant circuit with a feedback amplifier shown in Figure <a href="chap1.html#34830">1-63</a>, a parallel LC circuit with nonlinear transconductance. At small capacitor voltages, the transconductance is negative, and the amplifier is an active device that creates positive feedback to increase the voltage on the capacitor. At larger voltages, where the transconductance term goes into compression, the amplifier effectively acts as a positive resistor (with negative feedback) and limits the capacitor voltage.</p>

<p><strong>Figure 1-63
<a id="pgfId-1050297"></a><a id="34830"></a>A Simple Resonant Oscillator</strong></p>
<p>
<a id="pgfId-1050306"></a></p>
<div class="webflare-div-image">
<img width="408" height="112" src="images/chap1-162.gif" /></div>

<p>
<a id="pgfId-1050307"></a>A simple model for the nonlinear transconductance is a cubic polynomial. We hypothesize a nonlinear resistor with a current-voltage relation given by</p>

<p>
<a id="pgfId-1050311"></a><img width="180" height="65" src="images/chap1-163.gif" /></p>

<p>
<a id="pgfId-1050312"></a>The effect of the resistor in parallel with the inductor and the capacitor can be lumped into this transconductance term. The parameter is a measure of the strength of the nonlinearity in the transconductance relative to the linear part of the total transconductance. Because the signal amplitude grows until the nonlinearity becomes significant, the value of this parameter does not affect the qualitative operation of the circuit.</p>
<p>
<a id="pgfId-1050313"></a>For simplicity, for the remainder of this appendix</p>

<p>
<a id="pgfId-1050317"></a><img width="85" height="53" src="images/chap1-164.gif" /></p>

<p>
<a id="pgfId-1050318"></a>After some renormalization of variables, where time is scaled by</p>

<p>
<a id="pgfId-1050322"></a><img width="74" height="50" src="images/chap1-165.gif" /></p>

<p>
<a id="pgfId-1050323"></a>with</p>

<p>
<a id="pgfId-1050327"></a><img width="112" height="59" src="images/chap1-166.gif" /></p>

<p>
<a id="pgfId-1050328"></a>and current is scaled by</p>

<p>
<a id="pgfId-1050332"></a><img width="82" height="48" src="images/chap1-167.gif" /></p>

<p>
<a id="pgfId-1050333"></a>You can write the differential equations describing the oscillator in the following form</p>

<p>
<a id="pgfId-1050337"></a><img width="237" height="58" src="images/chap1-168.gif" /></p>

<p>
<a id="pgfId-1050338"></a>and</p>

<p>
<a id="pgfId-1050342"></a><img width="93" height="58" src="images/chap1-169.gif" /></p>

<p>
<a id="pgfId-1050343"></a>In these equations, <em>
v</em>
 and <em>
i</em>
 represent the normalized capacitor voltage and inductor current, respectively, and ξ<t-times>
(</t-times>
<em>
t</em>
<t-times>
)</t-times>
 is a small-signal excitation such as white Gaussian noise, <em>
Q</em>
 = <em>
R</em>
/ω<sub><em>0</em></sub><em>
L</em>
 is the quality factor of an RLC circuit made by replacing the nonlinear transconductance by a positive resistance <em>
R</em>
.</p>
<p>
<a id="pgfId-1050344"></a>The equations just discussed describe the familiar Van der Pol oscillator system. This model includes many of the qualitative aspects of oscillator dynamics, yet it is simple enough to analyze in detail. Many more complicated oscillators that operate in a weakly nonlinear mode can be approximated with this model by using the first few terms in the Taylor series expansion of the relevant transconductances.</p>
<p>
<a id="pgfId-1050345"></a>As a brute-force method of calculating the noise properties of this circuit, the nonlinear stochastic differential equations that describe the current and voltage processes were numerically integrated [1], and the noise power was obtained using a standard FFT-periodiagram technique. This technique requires several hundred simulations of the oscillator over many thousands of periods. Consequently, it is not a feasible approach for practical circuits, but it is rigorously correct in its statistical description even though it requires no knowledge of the properties of oscillators, noise, periodicity, or signal amplitudes. Figure <a href="chap1.html#38218">1-64</a> shows the total time-averaged noise in the voltage variable.</p>

<p><strong>Figure 1-64
<a id="pgfId-1050350"></a><a id="38218"></a>Noise in a Simple Van der Pol System</strong></p>
<p>
<a id="pgfId-1050354"></a></p>
<div class="webflare-div-image">
<img src="images/A1VanDerPol.gif" /></div>

<p>
<a id="pgfId-1050355"></a>By plotting <em>Power Spectral Density</em> against <em>Normalized Noise Frequency Offset </em>for a Q = 5 system, Figure <a href="chap1.html#38218">1-64</a> shows noise in a simple Van der Pol system.</p>
<p>
<a id="pgfId-1050362"></a>The left half of Figure <a href="chap1.html#38218">1-64</a> shows noise as a function of absolute frequency.</p>
<p>
<a id="pgfId-1050366"></a>The right half of Figure <a href="chap1.html#38218">1-64</a> shows noise as a function of frequency offset from the oscillator fundamental frequency.</p>
<p>
<a id="pgfId-1050367"></a>The dashed line is LC-filtered white noise, the dash-dot line is RLC-filtered white noise, the solid line is SpectreRF phase noise, and <t-times>
(x)</t-times>
 marks are noise power from a full nonlinear stochastic differential equation solution.</p>
<p>
<a id="pgfId-1050368"></a>The resulting noise power spectral density looks much like the voltage versus current response of a parallel LC circuit. The oscillator in steady-state, however, does not look like an LC circuit. As you see in the following paragraphs, this noise characteristic similarity occurs because both systems have an infinite number of steady-state solutions.</p>
<p>
<a id="pgfId-1050369"></a>The characteristic shape of the small-signal response of an LC circuit results because an excitation at the precise resonant frequency can introduce a drift in the amplitude or phase of the oscillation. The magnitude of this drift grows with time and is potentially unbounded. In the frequency domain, this drift appears as a pole on the imaginary axis at the resonant frequency. The response is unbounded because no restoring force acts to return the amplitude or phase of the oscillation to any previous value, and perturbations can therefore accumulate indefinitely.</p>
<p>
<a id="pgfId-1050370"></a>Similarly, phase noise exists in a nonlinear oscillator because an autonomous oscillator has no time reference. A solution to the oscillator equations that is shifted in time is still a solution. Noise can induce a time shift in the solution, and this time shift looks like a phase change in the signal (hence the term <em>phase noise</em>). Because there is no <em>resistance</em> to change in phase, applying a constant white noise source to the signal causes the phase to become increasingly uncertain relative to the original phase. In the frequency domain, this corresponds to the increase of the noise power around the fundamental frequency.</p>
<p>
<a id="pgfId-1050371"></a>If the noise perturbs the signal in a direction that does not correspond to a time shift, the nonlinear transconductance works to put the oscillator back on the original trajectory. This is similar to AM noise. The signal uncertainty created by the amplitude noise remains bounded and small because of the action of the nonlinear amplifier that created the oscillation. The LC circuit operates differently. It lacks both a time (or phase) reference and an amplitude reference and therefore can exhibit large AM noise.</p>
<p>
<a id="pgfId-1050372"></a>Another explanation of the similarity between the oscillator and the LC circuit is that both are linear systems that have poles on the imaginary axis at the fundamental frequency, ω<sub>0</sub>. That is, at the complex frequencies <em>
s</em>
 = <em>
i</em>
ω<sub>0</sub>. However, the associated transfer functions are not the same. In fact, because of the time-varying nature of the oscillator circuit, multiple transfer functions must be considered in the linear time-varying analysis.</p>
<p>
<a id="pgfId-1050373"></a>Understanding the qualitative behavior of linear and nonlinear oscillators is the first step towards a complete understanding of oscillator noise behavior. Further understanding requires more quantitative comparisons that are presented in <a href="chap1.html#35587">Models for Phase Noise</a>. If you are not interested in these mathematical details, you might skip ahead to <a href="chap1.html#14317">&#8220;Calculating Phase Noise&#8221;</a>.</p>

<h3>
<a id="pgfId-1050382"></a><a id="35587"></a>Models for Phase Noi<a id="marker-1050381"></a>se</h3>

<p>
<a id="pgfId-1050383"></a>This section considers several possible models for noise in oscillators. In the engineering literature, the most widespread model for phase noise is the Leeson model [2]. This heuristic model is based on qualitative arguments about the nature of noise processes in oscillators. It shares some properties with the LC circuit models presented in the previous section. These models fit well with an intuitive understanding of oscillators as resonant RLC circuits with a feedback amplifier. In the simplest treatment, the amplifier is considered to be a negative conductance whose value is chosen to cancel any positive real impedance in the resonant tank circuit. The resulting linear time-invariant noise model is easy to analyze.</p>

<h4>
<a id="pgfId-1050384"></a>Linear Time-Invariant (LTI) Models</h4>

<p>
<a id="pgfId-1050385"></a>To calculate the noise in a parallel RLC configuration, the noise of the resistor is modeled as a parallel current source of power density</p>

<p>
<a id="pgfId-1050389"></a><img width="121" height="66" src="images/chap1-171.gif" /></p>

<p>
<a id="pgfId-1050390"></a>Where <em>k</em><sub>B</sub> is Boltzman&#8217;s constant. In general, if current noise excites a linear time-invariant system, then the noise power density produced in a voltage variable is given by [3] as follows</p>

<p>
<a id="pgfId-1050394"></a><img width="190" height="53" src="images/chap1-172.gif" /></p>

<p>
<a id="pgfId-1050395"></a>where <em>
H</em>
(ω) is the transfer function of the LTI transformation from the noise current source <em>input</em> to the voltage <em>output</em>. The transfer function is defined in the standard way to be</p>

<p>
<a id="pgfId-1050399"></a><img width="131" height="79" src="images/chap1-173.gif" /></p>

<p>
<a id="pgfId-1050400"></a>where <em>
i</em>
<sub><em>s</em></sub> is a (deterministic) current source and <em>
v</em>
<sub>0</sub> is the measured voltage between the nodes of interest.</p>
<p>
<a id="pgfId-1050401"></a>It follows that the noise power spectral density of the capacitor voltage in the RLC circuit is, at noise frequency ω = ω<sub>0</sub> <t-times>
+</t-times>
 ω′ with ω′ &lt;&lt; ω<sub>0</sub>.</p>

<p>
<a id="pgfId-1050405"></a><img width="228" height="82" src="images/chap1-174.gif" /></p>

<p>
<a id="pgfId-1050406"></a>where the quality factor of the circuit is</p>

<p>
<a id="pgfId-1050410"></a><img width="94" height="73" src="images/chap1-175.gif" /></p>

<p>
<a id="pgfId-1050411"></a>The parallel resistance is <em>
R</em>
 (the source of the thermal noise), and ω<sub>0</sub> is the resonant frequency.</p>
<p>
<a id="pgfId-1050412"></a>If a noiseless negative conductance is added to precisely cancel the resistor loss, the noise power for small ω′ / ω<sub>0</sub> becomes</p>

<p>
<a id="pgfId-1050416"></a><img width="186" height="82" src="images/chap1-176.gif" /></p>

<p>
<a id="pgfId-1050417"></a>This linear time-invariant viewpoint explains some qualitative aspects of phase noise, especially the (ω<sub>0</sub> / <em>
Q</em>
ω′)<spti-sups-times-italic>
2</spti-sups-times-italic>
 dependencies. However, even for this simple system, a set of complicating arguments is needed to extract approximately correct noise from the LTI model. In particular, we must explain the 3 dB of excess amplitude noise inside the resonant bandwidth generated by an LC model but not by an oscillator (see <a href="chap1.html#39087">&#8220;Amplitude Noise and Phase Noise in the Linear Model&#8221;</a>). Furthermore, many oscillators, such as relaxation and ring oscillators, do not naturally fit this linear time-invariant model. Most oscillators are better described as time-varying (LTV) circuits because many phenomena, such as upconversion of <t-times>
1</t-times>
<em>
/f </em>
noise, can only be explained by time-varying models.</p>

<h4>
<a id="pgfId-1050422"></a><a id="42198"></a>Linear Time-Varying (LTV) Models</h4>

<p>
<a id="pgfId-1050423"></a>For linear time-invariant systems, the noise at a frequency ω is directly due to noise sources at that frequency. The relative amplitudes of the noise at the system outputs and the source noise are given by the transfer functions from noise sources to the observation point. Time-varying systems exhibit frequency conversion, however, and each harmonic <em>
k</em>
<em>ω</em><sub>0</sub> in the oscillation can transfer noise from a frequency ω ± <em>
k</em>
ω<sub>0</sub> to the observation frequency ω. In general, for a stationary noise source ξ(<em>
t</em>
), the total observed noise voltage is [3]</p>

<p>
<a id="pgfId-1050427"></a><img width="255" height="56" src="images/chap1-177.gif" /></p>

<p>
<a id="pgfId-1050428"></a>Each term in the series represents conversion of current power density at frequency ω + <em>
k</em>
<em>ω</em><sub>0</sub> to voltage power density at frequency ω with gain <t-times>
|</t-times>
<em>
H</em>
<sub>k</sub><t-times>
(</t-times>
ω<t-times>
)|</t-times>
<sup>2</sup>. As an example, return again to the Van der Pol oscillator with α = <t-times>
1/3</t-times>
 and notice how a simple time-varying linear analysis of noise proceeds.</p>
<p>
<a id="pgfId-1050429"></a>The first analysis step for the Van der Pol oscillator is to obtain a large-signal solution, so you set ξ(<em>
t</em>
) = <t-times>
0</t-times>
. In the large-Q limit, the oscillation is nearly sinusoidal and so it is a good approximation to assume the following</p>

<p>
<a id="pgfId-1050433"></a><img width="133" height="53" src="images/chap1-178.gif" /></p>

<p>
<a id="pgfId-1050434"></a>The amplitude, <em>
a,</em>
 and oscillation frequency can be determined from the differential equations that describe the oscillator. Recognizing that</p>

<p>
<a id="pgfId-1050438"></a><img width="174" height="69" src="images/chap1-179.gif" /></p>

<p>
<a id="pgfId-1050439"></a>and substituting into the equation for <em>
dv/dt</em>
<em>,</em> <em>
a</em>
 and ω<sub>0</sub> are determined by the following</p>

<p>
<a id="pgfId-1050443"></a><img width="508" height="71" src="images/chap1-180.gif" /></p>

<p>
<a id="pgfId-1050444"></a>Substituting</p>

<p>
<a id="pgfId-1050448"></a><img width="272" height="66" src="images/chap1-181.gif" /></p>

<p>
<a id="pgfId-1050449"></a>and using the orthogonality of the sine and cosine functions, it follows that</p>

<p>
<a id="pgfId-1050453"></a><img width="107" height="75" src="images/chap1-182.gif" /></p>
<p>
<a id="pgfId-1050454"></a>and</p>
<p>
<a id="pgfId-1050458"></a><img width="125" height="62" src="images/chap1-183.gif" /></p>

<p>
<a id="pgfId-1050459"></a>(The <t-times>
sin(3</t-times>
ω<sub>0</sub><em>
t</em>
<t-times>
) </t-times>
term is relevant only when we consider higher-order harmonics of the oscillation.) Therefore, to the lowest order of approximation, <em>
a </em>
<t-times>
=</t-times>
<em></em>
<t-times>
2</t-times>
 and ω<sub>0</sub> <t-times>
=</t-times>
 <t-times>
1</t-times>
.</p>
<p>
<a id="pgfId-1050460"></a>The only nonlinear term in the Van der Pol equations is the current-voltage term, <em>
v</em>
<sup>3</sup><t-times>
/3</t-times>
. This term differentiates the Van der Pol oscillator from the LC circuit. The small-signal conductance is the derivative with respect to voltage of the nonlinear current</p>

<p>
<a id="pgfId-1050464"></a><img width="93" height="66" src="images/chap1-184.gif" /></p>

<p>
<a id="pgfId-1050465"></a>With</p>

<p>
<a id="pgfId-1050469"></a><img width="113" height="52" src="images/chap1-185.gif" /></p>

<p>
<a id="pgfId-1050470"></a>the small-signal conductance as a function of time is</p>

<p>
<a id="pgfId-1050474"></a><img width="139" height="50" src="images/chap1-186.gif" /></p>

<p>
<a id="pgfId-1050475"></a>Because there is a nonzero, time-varying, small-signal conductance, the Periodic Time Varying Linear (PTVL) model is different from the LTI LC circuit model. In fact, the time-average conductance is not even zero. However, the time-average power dissipated by the nonlinear current source is zero, a necessary condition for stable, sustained oscillation.</p>
<p>
<a id="pgfId-1050476"></a>Oscillators are intrinsically time-varying elements because they trade off excessive gain during the low-amplitude part of the cycle with compressive effects during the remainder of the cycle. This effect is therefore a generic property not unique to this example.</p>
<p>
<a id="pgfId-1050477"></a>To complete the noise analysis, write the differential equations that the small-signal solution<em> </em><em>
i</em>
<sub>s(</sub><sub><em>t</em></sub><sub>)</sub>, <em>
v</em>
<sub>s(</sub><sub><em>t</em></sub><sub>)</sub> must satisfy,</p>

<p>
<a id="pgfId-1050481"></a><img width="282" height="63" src="images/chap1-187.gif" /></p>

<p>
<a id="pgfId-1050482"></a>and</p>

<p>
<a id="pgfId-1050486"></a><img width="78" height="63" src="images/chap1-188.gif" /></p>

<p>
<a id="pgfId-1050487"></a>From the large signal analysis, <em>
v</em>
<t-times>
(</t-times>
<em>
t</em>
<t-times>
) = 2sin</t-times>
<em>
t</em>
, and so</p>

<p>
<a id="pgfId-1050491"></a><img width="270" height="69" src="images/chap1-189.gif" /></p>

<p>
<a id="pgfId-1050492"></a>and</p>

<p>
<a id="pgfId-1050496"></a><img width="90" height="64" src="images/chap1-190.gif" /></p>

<p>
<a id="pgfId-1050497"></a>The time-varying conductance can mix voltages from a frequency ω to ω<t-times>
 - 2</t-times>
. For small ω´, if an excitation is applied at a frequency ω <t-times>
= 1 + </t-times>
ω´, <em>
i</em>
<sub>s</sub> and<em> </em><em>
v</em>
<sub>s</sub> are expected to have components at <t-times>
1 </t-times>
+ ω´ and −<t-times>
1 </t-times>
+ ω´ for the equations to balance. (Higher-order terms are again presumed to be small.) Writing</p>

<p>
<a id="pgfId-1050501"></a><img width="257" height="50" src="images/chap1-191.gif" /></p>

<p>
<a id="pgfId-1050502"></a>and substituting into the small-signal equations with</p>

<p>
<a id="pgfId-1050506"></a><img width="133" height="52" src="images/chap1-192.gif" /></p>

<p>
<a id="pgfId-1050507"></a>leads to the following system of equations for <em>
i</em>
<sub>+</sub> and <em>
i</em>
−</p>

<p>
<a id="pgfId-1050511"></a><img width="557" height="124" src="images/chap1-193.gif" /></p>

<p>
<a id="pgfId-1050512"></a>Solving these equations gives the transfer function from an excitation at frequency <t-times>
1 + </t-times>
ω´ to the small-signal at frequency <t-times>
1 + </t-times>
ω´ that we call <em>
H</em>
<sub>0</sub>(ω´). A similar analysis gives the other significant transfer function, from noise at frequency −<t-times>
1 + </t-times>
ω´ of amplitude<em> </em>C_ to the small-signal response at frequency <t-times>
1 + </t-times>
ω´, that we call <em>
H</em>
<sub>-2</sub>(ω´). In the present case, for small ω´,</p>

<p>
<a id="pgfId-1050516"></a><img width="191" height="97" src="images/chap1-194.gif" /></p>

<p>
<a id="pgfId-1050517"></a>For a general Van der Pol circuit with a parallel resistor <em>
R</em>
 that generates white current noise, ξ<t-times>
(</t-times>
<em>
t</em>
<t-times>
)</t-times>
, with <t-times>
S</t-times>
ξ(ω) = 4 <em>
k</em>
<sub><em>B</em></sub> <em>
T</em>
/<em>
R</em>
,</p>

<p>
<a id="pgfId-1050521"></a><img width="167" height="98" src="images/chap1-195.gif" /></p>

<p>
<a id="pgfId-1050522"></a>Note that this is precisely one-half the noise predicted by the LC model.</p>
<p>
<a id="pgfId-1050523"></a>You can gain additional insight about phase noise by analyzing the time-domain small-signal response. The small-signal current response is.</p>

<p>
<a id="pgfId-1050527"></a><img width="224" height="75" src="images/chap1-196.gif" /></p>

<p>
<a id="pgfId-1050528"></a>Notice that <t-times>
c</t-times>
<sub>+</sub> and <t-times>
c</t-times>
<sub>-</sub> are complex random variables that represent the relative contribution of white noise at separate frequencies. As white noise has no frequency correlations, they have uncorrelated random phase, and thus zero amplitude expectation, and unit variance in amplitude. Because the large-signal current is <em>
i</em>
<t-times>
(</t-times>
<em>
t</em>
<t-times>
) = 2cos</t-times>
<em>
 t</em>
, and the sine and cosine functions are orthogonal, the total noise for small ω´ that we computed is essentially all phase noise.</p>

<h4>
<a id="pgfId-1050530"></a><a id="39087"></a>Amplitude Noise and Phase Noise in the Linear Model</h4>

<p>
<a id="pgfId-1050531"></a>Occasional claims are made that in oscillators, &#8220;Half the noise is phase noise and half the noise is amplitude noise.&#8221; However, as the simple time-varying analysis in the previous section shows, in a physical oscillator the noise process is mostly phase noise for frequencies near the fundamental. It is true that in an LC-circuit half the total noise power corresponds to AM-like modulation and the other half to phase modulation. In the literature, the AM part of the noise is sometimes disregarded when quoting the oscillator noise although this is not always the case. (The SpectreRF simulator computes the total noise generated by the circuit; see <a href="chap1.html#12432">&#8220;Details of the SpectreRF Calculation&#8221;</a>).</p>
<p>
<a id="pgfId-1050535"></a>However, a <em>linear</em> oscillator does not really exist. Physical oscillators operate with a tradeoff of gain that causes growing signal strength and nonlinear compressive effects that act to limit the signal amplitude. For noise calculation, the oscillator cannot be considered a linear time-invariant system because there are intrinsic nonlinear effects that produce large phase noise but limited amplitude noise. Oscillators are time-varying, and they therefore require a time-varying small-signal analysis.</p>
<p>
<a id="pgfId-1050536"></a>Arguments that start with stationary white noise and pass it through a linear model in a forward-analysis fashion produce incorrect answers. This is true because they neglect the time-variation of the conductances (and possibly the capacitances) in the circuit. In the simple cases considered here, the conductances vary in time in a special way so as to produce no amplitude noise, only phase noise.</p>
<p>
<a id="pgfId-1050537"></a>They have that special variation because they result from linearization about an oscillator limit cycle. An oscillator in a limit cycle has a large response to phase perturbations, but not to amplitude perturbations. The amplitude perturbations are limited by the properties of the nonlinear amplifier, but the phase perturbations can persist. The SpectreRF simulator calculates the correct phase noise because it <em>knows</em> about the oscillator properties.</p>
<p>
<a id="pgfId-1050538"></a>Similarly, arguments [13] that start with noise power and derive phase noise in a backwards fashion also usually produce incorrect results because they cannot correctly account for frequency correlations in the noise of the oscillator. These frequency correlations are introduced by the time-varying nature of the circuit.</p>
<p>
<a id="pgfId-1050539"></a>Occasionally, a netlist appears in which a negative resistance precisely cancels a positive resistance to create a pure LC circuit. Because such a circuit has an infinite number of oscillation modes, the SpectreRF simulator cannot correctly calculate the noise because it assumes a unique oscillation. Such a circuit is not physically realizable because adding or subtracting a microscopically small amount of conductance makes the circuit either go into nonlinear operation (amplifier saturation) or become a damped LC circuit that has a unique final equilibrium point. This equilibrium point is the zero-state solution. Trying to create the negative resistance oscillator is like trying to bias a circuit on a metastable point. Any amplitude oscillation can exist, depending on the initial conditions, as long as the amplitude is less than the amplifier saturation point.</p>

<h4>
<a id="pgfId-1050541"></a><a id="12432"></a>Details of the SpectreRF Calculation</h4>

<p>
<a id="pgfId-1050542"></a>This section contains the mathematical details of how the SpectreRF simulator computes noise in oscillators. Understanding the material in this section can help you troubleshoot and understand difficult oscillator problems.</p>
<p>
<a id="pgfId-1050543"></a>The analysis the SpectreRF simulator performs is similar to the simple analysis in the section <a href="chap1.html#42198">&#8220;Linear Time-Varying (LTV) Models&#8221;</a>. During analysis, the SpectreRF simulator</p>
<ol><li>
<a id="pgfId-1050547"></a>First finds the periodic steady state of the oscillator using the PSS analysis.</li><li>
<a id="pgfId-1050548"></a>Then linearizes around this trajectory.</li><li>
<a id="pgfId-1050549"></a>The resulting time-varying linear system is used to calculate the noise power density. The primary difference between the SpectreRF calculation and the previous analysis is that the basis functions used for the SpectreRF calculation are not just a few sinusoids, but rather a collection of many piecewise polynomials. The use of piecewise polynomials allows the SpectreRF simulator to solve circuits with arbitrary waveforms, including circuits with highly nonlinear behavior.</li></ol>


<p>
<a id="pgfId-1050550"></a>Noise computations are usually performed with a small-signal assumption, but a rigorous small-signal characterization of phase noise is complicated because the variance in the phase of the oscillation grows unbounded over time. From a mathematical viewpoint, an oscillator is an autonomous system of differential equations with a stable limit cycle. An oscillator has phase noise because it is neutrally stable with respect to noise perturbations that move the oscillator in the direction of the limit cycle. Such <em>phase</em> perturbations persist with time, whereas transverse fluctuations are damped with a characteristic time inversely proportional to the quality factor of the oscillator.</p>
<p>
<a id="pgfId-1050551"></a>Further care is necessary because, in general, the two types of excitations (those that create phase slippage and those responsible for time-damped fluctuations) are not strictly those that are parallel or perpendicular, respectively, to the oscillator trajectory, as is sometimes claimed (for example, in [4]).</p>
<p>
<a id="pgfId-1050552"></a>However, one must realize that the noise powers at frequencies near the fundamental frequency correspond to correlations between points that are widely separated on the oscillator envelope. In other words, they are long-time signal effects. In fact, asymptotically (at long times), the ratio of the variance of any state variable to its power at the fundamental frequency is unity for any magnitude of the noise excitation. Therefore, in practical cases, you can consider only small deviations in the state variables when describing the phase noise.</p>
<p>
<a id="pgfId-1050553"></a>The first step in the noise analysis is to determine the oscillator steady-state solution. This is done in the time domain using Shooting methods [5]. After the periodic steady-state is obtained, the circuit equations are linearized around that waveform in order to perform the small-signal analysis.</p>
<p>
<a id="pgfId-1050554"></a>The time-varying linear system describing the small-signal response <t-times>
vs(</t-times>
<em>
t</em>
<t-times>
) </t-times>
of the oscillator to a signal <em>
w</em>
<t-times>
(</t-times>
<em>
t</em>
<t-times>
)</t-times>
 can be written in general form as [6, 7]</p>

<p>
<a id="pgfId-1050558"></a><img width="292" height="71" src="images/chap1-197.gif" /></p>

<p>
<a id="pgfId-1050559"></a>where <t-times>
C(</t-times>
<em>
t</em>
<t-times>
)</t-times>
 and <t-times>
G(</t-times>
<em>
t</em>
<t-times>
)</t-times>
 represent the linear, small-signal, time-varying capacitance and conductance matrixes, respectively. These matrixes are obtained by linearization about the periodic steady-state solution (the limit cycle). To understand the nature of time-varying linear analysis, the concept of Floquet multipliers is introduced.</p>
<p>
<a id="pgfId-1050560"></a>Suppose <em>
x</em>
<t-times>
(</t-times>
<em>
t</em>
<t-times>
)</t-times>
 is a solution to the oscillator circuit equations that is periodic with period <em>
T</em>
. If <em>
x</em>
<t-times>
(0)</t-times>
 is a point on the periodic solution <em>
x</em>
<sub><em>L</em></sub><t-times>
(</t-times>
<em>
t</em>
<t-times>
)</t-times>
, then <em>
x</em>
<t-times>
(</t-times>
<em>
T</em>
<t-times>
) = </t-times>
<em>
x</em>
<t-times>
(0)</t-times>
. If <em>
x</em>
<t-times>
(0)</t-times>
 is perturbed slightly off the periodic trajectory, <em>
x</em>
<t-times>
(0) = </t-times>
<em>
x</em>
<sub><em>L</em></sub><t-times>
(0) + </t-times>
δ<t-times />
<em>
x</em>
, then <em>
x</em>
<t-times>
(</t-times>
<em>
T</em>
<t-times>
)</t-times>
 is also perturbed, and in general for small δ<em>
x</em>
<em>,</em></p>

<p>
<a id="pgfId-1050564"></a><img width="197" height="57" src="images/chap1-198.gif" /></p>

<p>
<a id="pgfId-1050565"></a>The Jacobian matrix</p>

<p>
<a id="pgfId-1050569"></a><img width="66" height="58" src="images/chap1-199.gif" /></p>

<p>
<a id="pgfId-1050570"></a>is called the sensitivity matrix. The SpectreRF simulator uses an implicit representation of this matrix both in the Shooting method that calculates the steady-state and in the small-signal analyses. To see how the sensitivity matrix relates to oscillator noise analysis, consider the effect of a perturbation at time <em>
t</em>
<t-times>
 = 0</t-times>
 several periods later, at <em>
t</em>
<t-times>
 = </t-times>
<em>
nT</em>
. From the above equation,</p>

<p>
<a id="pgfId-1050574"></a><img width="240" height="71" src="images/chap1-200.gif" /></p>

<p>
<a id="pgfId-1050575"></a>so</p>

<p>
<a id="pgfId-1050579"></a><img width="220" height="65" src="images/chap1-201.gif" /></p>

<p>
<a id="pgfId-1050580"></a>where φ<sub><em>i</em></sub> is an eigenvector of the sensitivity matrix. The <t-times>
C</t-times>
<sub><em>i </em></sub>are the expansion coefficients of δ<em>
x</em>
 in the basis of φ<sub><em>i</em></sub>. If ψ<sub><em>i</em></sub> is a left eigenvector (an eigenvector of its transpose) of the sensitivity matrix, then</p>

<p>
<a id="pgfId-1050584"></a><img width="101" height="51" src="images/chap1-202.gif" /></p>

<p>
<a id="pgfId-1050585"></a>Let λ be an eigenvalue of the sensitivity matrix. In the context of linear time-varying systems, the eigenvalues λ are called <em>Floquet multipliers</em>. If all the λ have magnitude less than one (corresponding to left-half-plane poles), the perturbation decays with time and the periodic trajectory is stable. If any λ has a magnitude greater than one, the oscillation cannot be linearly stable because small perturbations soon force the system away from the periodic trajectory <t-times>
x</t-times>
<sub><em>L</em></sub><t-times>
(</t-times>
<em>
t</em>
<t-times>
)</t-times>
.</p>
<p>
<a id="pgfId-1050586"></a>A stable nonlinear physical oscillator, however, must be neutrally stable with respect to perturbations that move it in the direction of the orbit. These are not necessarily perturbation <em>in</em> the direction of the orbit because, in general,</p>

<p>
<a id="pgfId-1050590"></a><img width="63" height="52" src="images/chap1-203.gif" /></p>

<p>
<a id="pgfId-1050591"></a>This is true because a time-shifted version of the oscillator periodic trajectory still satisfies the oscillator equations. In other words, one of the Floquet multipliers must be equal to unity. This Floquet multiplier is responsible for phase noise in the oscillator. The associated eigenvector determines the nature of the noise.</p>
<p>
<a id="pgfId-1050592"></a>If λ<t-times>
 = e</t-times>
η is a Floquet multiplier, then η<t-times>
 + </t-times>
<em>
ik</em>
ω<sub>0</sub> is a pole of the time-varying linear system for any integer <em>
k</em>
. Therefore, because of the unity Floquet multiplier, the time-varying linear system has poles on the imaginary axis at <em>
k</em>
ω0. This is very similar to what occurs in a pure LC resonator, and it explains the identical shape of the noise profiles.</p>
<p>
<a id="pgfId-1050593"></a>Because operator <em>
L</em>
<t-times>
(</t-times>
<em>
t</em>
<t-times>
)</t-times>
<em> </em>has poles at the harmonics of the oscillation frequency, numerical calculations of the noise at nearby frequencies become inaccurate if treated in a naive manner [8, 9]. To correctly account for the phase noise, the SpectreRF simulator finds and extracts the eigenvector that corresponds to the unity Floquet multiplier. To correctly extract the phase noise component, both the right and left eigenvectors are required. After these vectors are obtained, the singular (phase noise) contribution to the noise can be extracted. The remaining part of the noise can be obtained using the usual iterative solution techniques [6] in a numerically well-conditioned operation.</p>
<p>
<a id="pgfId-1050597"></a>In <a href="chap1.html#38218">Figure&#160;1-64</a>, you can see that the SpectreRF PTVL analysis correctly predicts the total noise, including the onset of 3 dB amplitude noise outside the bandwidth of the resonator. Note that this simulation was conducted at</p>

<p>
<a id="pgfId-1050601"></a><t-times>
<img width="146" height="78" src="images/chap1-204.gif" /></t-times>
</p>

<p>
<a id="pgfId-1050602"></a>which represents a very high noise level that is several orders of magnitude higher than in actual circuits. The good match of the PTVL models to the full nonlinear simulation shows the validity of the PTVL approximation.</p>

<h3>
<a id="pgfId-1050605"></a><a id="14317"></a><a id="marker-1050604"></a>Calculating Phase Noise</h3>

<p>
<a id="pgfId-1050606"></a>The following sections suggest simulation parameters, give you tips for using these parameters, and advise you about checking for accuracy.</p>

<h4>
<a id="pgfId-1050607"></a>Setting Simulator Options</h4>

<p>
<a id="pgfId-1050608"></a>The SpectreRF time-varying small-signal analyses are more powerful than the standard large-signal analyses (DC, TRAN) but, like any precision instrument, they also have greater sensitivity to numerical errors. For many circuits, particularly oscillators, more simulator precision is needed to get good results from the PAC, PXF, and Pnoise calculations than is needed to get good DC or TRAN results.</p>
<p>
<a id="pgfId-1050609"></a>The small-signal analyses operate by linearizing around the periodic steady state solution. Consequently, the oscillator noise analysis, and the periodic small-signal analyses in general, inherit most of their accuracy properties from the previous PSS simulation. You must be sure the PSS simulation generates a sufficiently accurate linearization. See <a href="chap1.html#34940">&#8220;What Can Go Wrong&#8221;</a> for a discussion.</p>
<p>
<a id="pgfId-1050616"></a>Table <a href="chap1.html#20313">1-3</a> recommends simulator options for various classes of circuits.</p>

<p>
<a id="pgfId-1050679"></a></p>
<table class="webflareTable" id="#id1050617">
<caption style="text-align:left;"><p>
</p><h4>Table 1-3
<a id="pgfId-1050620"></a>Recommended SpectreRF Parameter Values<a id="20313"></a></h4></caption>
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1050630">
<a id="pgfId-1050630"></a>Circuit</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1050632">
<a id="pgfId-1050632"></a>errpreset</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1050634">
<a id="pgfId-1050634"></a>reltol</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1050636">
<a id="pgfId-1050636"></a>vabstol</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1050638">
<a id="pgfId-1050638"></a>iabstol</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050640"></a>Easy</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050642"></a>moderate</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050644"></a> 1.0e<sup>-4</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050646"></a> default</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050648"></a> default</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050650"></a>Hard-I</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050652"></a>conservative</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050654"></a> 1.0e<sup>-5</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050656"></a> 10n</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050658"></a> 1p</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050660"></a>Hard-II</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050662"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050664"></a> 1.0e<sup>-6</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050666"></a> 1n</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050668"></a> 0.1p</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050670"></a>Hard-III</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050672"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050674"></a> 1.0e<sup>-7</sup></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050676"></a> 0.1n</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050678"></a> 0.1p </p>
</td>
</tr>
</tbody></table>

<ul><li>
<a id="pgfId-1050680"></a><em>Easy</em> circuits are low<t-times>
-</t-times>
<em>
Q</em>
 (about <em>
Q</em>
<t-times>
 &lt; 10</t-times>
) resonant oscillators, ring oscillators, and weakly-nonlinear relaxation oscillators. Most textbook circuits are in this category. This is the default setting when you set <code>errpreset=moderate</code>.</li><li>
<a id="pgfId-1050681"></a><em>Hard-I</em> circuits are most high<em>
-Q</em>
 resonant oscillators; circuits with complicated AGC, load, or bias circuitry; and relaxation or ring oscillators that exhibit moderate to strong nonlinear or <em>stiff</em> effects. This is the best general-purpose set of options and it is the default when you set <code>errpreset=conservative</code>.</li><li>
<a id="pgfId-1050682"></a><em>Hard-II</em> and <em>Hard-III </em>circuits include a few particularly difficult circuits.<br />
<a id="pgfId-1050683"></a>Usually these options are used only in a convergence study or for circuits that previously failed a conversion study using less strict options. Circuits in this category often exhibit some form of unusual behavior (see <a href="chap1.html#34940">&#8220;What Can Go Wrong&#8221;</a>). Sometimes this behavior results from circuit properties, for example, some very high<t-times>
-</t-times>
<em>
Q</em>
 crystal oscillators and some very stiff relaxation oscillator circuits. Occasionally, the behavior reflects a design flaw.</li></ul>



<p>
<a id="pgfId-1050689"></a>Usually setting <code>method=gear2only</code> is recommended for the PSS simulation (but see <a href="chap1.html#34940">&#8220;What Can Go Wrong&#8221;</a>).</p>
<p>
<a id="pgfId-1050691"></a>The parameters in Table A-1 are used in error control at two places.</p>
<p>
<a id="pgfId-1050692"></a>At the local truncation error (LTE) at each transients integration. The LTE control formula is</p>

<p class="webflare-indent1">
<a id="pgfId-1050696"></a><img width="492" height="52" src="images/chap1-205.gif" /></p>

<ul><li>
<a id="pgfId-1050697"></a>To control the periodicity error over the period. The periodicity error control formula is</li></ul>

<p class="webflare-indent1">
<a id="pgfId-1050701"></a><img width="599" height="49" src="images/chap1-206.gif" /></p>

<p>
<a id="pgfId-1050702"></a>The default value for <code>vabstol</code> is <code>1.0e</code><sup>-6</sup>, The default value for <code>iabstol</code> is <code>1.0e</code><sup>-12</sup><code> </code>which is accurate enough for most cases. Tighten <code>iabstol</code> when necessary. Refer to section 4.3 in <h-hot><a href="chap1.html#DesignersGuide">[17]</a></h-hot> for detailed discussion about transient integration.</p>
<p>
<a id="pgfId-1050704"></a>To speed up transients integration during the<code> tstab</code> stage, the default values at the <code>tstab</code> stage are <code>reltol=1.0e</code>-3, <code>lteratio=3.5</code>, <code>relref=sigglobal</code>, <code>maxstep=T</code>/25. <code>method=traponly</code>. After the <code>tstab</code> stage, those parameters are set back according to <code>errpreset</code>.</p>
<p>
<a id="pgfId-1050705"></a>For circuits, such as extremely high Q oscillators, that need very high accuracy, you can gain further accuracy by turning on the highorder refinement<code> highorder=yes</code> and <code>errpreset=conservative. </code>This runs multi-interval Chebyshev PSS refinement after the Shooting phase of the PSS analysis.</p>
<p>
<a id="pgfId-1050706"></a>An effective and fast method to start the oscillator is to run the new autonomous envelope analysis and to save the simulation results. Use the results of the autonomous envelope analysis as the initial condition for the PSS analysis.</p>
<p>
<a id="pgfId-1050707"></a>A longer <code>tstab</code> stage helps with PSS convergence. However a longer <code>tstab</code> stage can slow the simulation. Using autonomous envelope analysis to establish <code>tstab</code> is considerably faster than using the transient analysis for <code>tstab. </code>See <em><a actuate="user" class="URL" href="../spectreRFTheory/chap2.html#AutoENVLP" show="replace" xml:link="simple">Spectre Circuit Simulator RF Analysis Theory.</a></em> for information on the autonomous envelope analysis.</p>
<p>
<a id="pgfId-1050709"></a>For releases before MMSIM60 USR1, an effective method to start the oscillation is to add a kicker to the circuit. The kicker can be either a voltage or current source. To effectively start the oscillation, the kicker has to be placed at the most sensitive place which usually is close to the oscillating transistor. The kicker can be either a PWL source or a damped sinusoidal source with frequency set to the oscillation frequency. The kicker must die down and remain stable after oscillation is established to avoid affecting the PSS analysis.</p>

<h3>
<a id="pgfId-1050712"></a><a id="14394"></a>Troubleshooting Phase Noise Calcu<a id="marker-1050711"></a>lations</h3>

<p>
<a id="pgfId-1050713"></a>The SpectreRF simulator calculates noise effectively for most oscillators. However, circuits that are very stiff, very nonlinear, or just poorly designed can occasionally cause problems for the simulator. Stiff circuits exhibit dynamics with two or more very different time scales; for example, a relaxation oscillator with a square-wave-like periodic oscillation. Over most of the cycle, the voltages change very slowly, but occasional rapid transitions are present. This section describes some of the reasons for the problems, what goes wrong, how to identify problems, and how to fix them.</p>
<p>
<a id="pgfId-1050717"></a>See <a href="chap1.html#12432">&#8220;Details of the SpectreRF Calculation&#8221;</a> for help troubleshooting particularly difficult circuits.</p>

<h4>
<a id="pgfId-1050719"></a><a id="25572"></a>Known Limitations of the Simulator</h4>

<p>
<a id="pgfId-1050720"></a>Any circuit that does not have a stable periodic steady-state cannot be analyzed by the SpectreRF simulator because oscillator noise analysis is performed by linearizing around a waveform that is assumed to be strictly periodic.</p>
<p>
<a id="pgfId-1050721"></a>For example, oscillators based on IMPATT diodes generate strong sub-harmonic responses and cannot be properly analyzed with the SpectreRF simulator. As another example, Colpitts oscillators, properly constructed, can be made to exhibit chaotic as well as sub-harmonic behavior.</p>
<p>
<a id="pgfId-1050722"></a>Similarly, any circuit with significant large-signal response at tones other than the fundamental and its harmonics might create problems for the simulator. Some types of varactor-diode circuits might fit this category. In addition, some types of AGC circuitry and bias circuitry can create these effects.</p>
<p>
<a id="pgfId-1050723"></a>The SpectreRF simulator cannot simulate these circuits because simulation of an autonomous circuit with sub-harmonic or other aperiodic components in the large signal response essentially requires foreknowledge of which frequency components are important. Such foreknowledge requires Fourier analysis of very long transient simulations and cannot be easily automated. Such simulations can be very expensive.</p>

<h4>
<a id="pgfId-1050725"></a><a id="34940"></a>What Can Go Wrong</h4>

<p>
<a id="pgfId-1050726"></a>The SpectreRF simulator can have problems in the following situations.</p>

<h4><em>
<a id="pgfId-1050727"></a>Generic PSS Simulation Problems</em></h4>

<p>
<a id="pgfId-1050728"></a>Any difficulties in the underlying PSS analysis affect the phase noise computation. For example, underestimating the oscillator period or failing to start the oscillator properly can cause PSS convergence problems that make running a subsequent Pnoise analysis impossible.</p>

<h4><em>
<a id="pgfId-1050729"></a>Hypersensitive Circuits</em></h4>

<p>
<a id="pgfId-1050730"></a>Occasionally, you might see circuits that are extremely sensitive to small parameter changes. Such a circuit was a varactor-tuned VCO that had the varactor bias current, and therefore the oscillation frequency, set by a <t-times>
1 T</t-times>
&#x2126; resistor. Changing to a <t-times>
2 T</t-times>
&#x2126; resistor, which is a <t-times>
1e</t-times>
<sup>-12</sup> relative perturbation in the circuit matrixes, changed the oscillation frequency from <t-times>
125 </t-times>
MHz to <t-times>
101 </t-times>
Mhz. Such extreme circuit sensitivity results in very imprecise PSS simulations. In particular, the calculated periods have relatively large variations. If precise PSS simulations are impossible, precise noise calculations are also impossible. In such a case, you must fix the circuit.</p>

<h4><em>
<a id="pgfId-1050731"></a>Subharmonics or Parametric Oscillator Modulation</em></h4>

<p>
<a id="pgfId-1050732"></a>Sometimes bias and AGC circuitry might create small-amplitude parasitic oscillations in the large signal waveform. You can identify these oscillations by performing a transient simulation to steady-state and then looking for modulation of the envelope of the oscillation waveform. For high<t-times>
-</t-times>
<em>
Q</em>
 circuits and/or low-frequency parasitics, this transient simulation might be very long.</p>
<p>
<a id="pgfId-1050733"></a>In this case, because the oscillator waveform is not actually periodic, the PSS simulation can only converge to within approximately the amplitude of the parasitic oscillation. If the waveform possesses a parasitic oscillation that changes amplitude, over one period, around 10<sup>-5</sup> relative to the oscillator envelope, then convergence with <code>reltol</code> &lt; 10<sup>-5</sup> is probably not possible (assuming <code>steadyratio</code> is one or less).</p>
<p>
<a id="pgfId-1050734"></a>These effects might also appear as a parametric sideband amplification phenomenon.</p>
<p>
<a id="pgfId-1050738"></a>See <a href="chap1.html#20382">&#8220;Frequently Asked Questions&#8221;</a> for more information.</p>

<h4><em>
<a id="pgfId-1050739"></a>Small-Signal Frequency is Much Higher than the Fundamental Frequency</em></h4>

<p>
<a id="pgfId-1050740"></a>The same timesteps are used for both the small-signal analysis and the PSS analysis. If the small-signal frequency is much higher than the fundamental frequency, much smaller timesteps might be required to accurately resolve the small-signal than are needed for the large signal. To force the SpectreRF simulator to take sufficiently small timesteps in the PSS simulation, be sure the <code>maxacfreq</code> parameter is set correctly.</p>

<h4><em>
<a id="pgfId-1050741"></a>Wide Timestep Variation</em></h4>

<p>
<a id="pgfId-1050742"></a>Occasionally, in simulations that generate PSS waveforms with timesteps that vary over several orders of magnitude, the linear systems of equations that determine the small-signal response become ill-conditioned. As a result, the noise analysis is inaccurate. Usually this occurs because you have requested excessive simulator precision; for example, nine-digit precision. You can sometimes eliminate this problem using <code>method = traponly</code> in the PSS solution. You might also set <code>maxstep</code> to a very small value in the PSS analysis or you might specify a very large <code>maxacfreq</code> value.</p>

<h4><em>
<a id="pgfId-1050743"></a>Problems with Device Models</em></h4>

<p>
<a id="pgfId-1050744"></a>When the device models leave their physically meaningful operating range during the large-signal PSS solution, the noise calculations are usually inaccurate. Similarly, when the models are discontinuous, or have discontinuous derivatives, the small-signal analysis might be inaccurate.</p>

<h4><em>
<a id="pgfId-1050745"></a>Problems Resolving Floquet Multipliers in Stiff Relaxation Oscillators</em></h4>

<p>
<a id="pgfId-1050746"></a>Sometimes in very stiff relaxation oscillators, the PSS solution rapidly and easily converges; but the numerically calculated Floquet multiplier associated with the PSS solution is far from unity. Typically, this multiplier is real and has a magnitude much larger than unity. The SpectreRF simulator prints a warning (see <a href="chap1.html#20261">&#8220;Message III&#8221;</a>). It is interesting that sometimes the phase noise is quite accurate even with low simulation tolerances. If you have this problem, perform a convergence study.</p>

<h4><em>
<a id="pgfId-1050750"></a>Problems Resolving Floquet Multipliers in High-Q Resonant Circuits</em></h4>

<p>
<a id="pgfId-1050751"></a>In a physical oscillator, there is one Floquet multiplier equal to unity. In an infinite<t-times>
-</t-times>
<em>
Q</em>
 linear resonator, however, the multipliers occur in complex conjugate pairs. A very high<t-times>
-</t-times>
<em>
Q</em>
 nonlinear oscillator has another Floquet multiplier on the real axis nearly equal to, but slightly less than, one. In this presence of numerical error, however, these two real Floquet multipliers can appear to the simulator as a complex-conjugate pair. The phase noise is computed using the Floquet vector associated with the unity Floquet multiplier. When the two multipliers appear as a complex pair, the relevant vector is undefined. When the SpectreRF simulator correctly identifies this situation, it prints a warning (see <a href="chap1.html#20261">&#8220;Message III&#8221;</a>). The solution is usually to simulate using the next higher accuracy step (see <a href="chap1.html#20313">Table&#160;1-3</a>). Sometimes varying <code>tstab</code> can also help with this problem.</p>
<p>
<a id="pgfId-1050758"></a>If the circuit is really an infinite<t-times>
-</t-times>
<em>
Q</em>
 resonator (for example, a pure parallel LC circuit), the multipliers always appear as complex conjugate pairs and the noise computations are not accurate close to the fundamental frequency. Such circuits are not physical oscillators, and the SpectreRF simulator is not designed to deal with them; see <a href="chap1.html#39087">&#8220;Amplitude Noise and Phase Noise in the Linear Model&#8221;</a> and <a href="chap1.html#20382">&#8220;Frequently Asked Questions&#8221;</a>.</p>

<h4>
<a id="pgfId-1050765"></a>Phase Noise Error Messages</h4>

<p>
<a id="pgfId-1050766"></a>SpectreRF displays error messages when it encounters several types of known numerical difficulty. To interpret the error messages produced by the phase noise analysis, you must know the material in <a href="chap1.html#12432">&#8220;Details of the SpectreRF Calculation&#8221;</a>.</p>

<h4><em>
<a id="pgfId-1050770"></a>Message I</em></h4>

<p>
<a id="pgfId-1050771"></a><strong>The Floquet eigenspace computed by spectre PSS analysis appears to be inaccurate. PNOISE computations may be inaccurate. Consider re-running the simulation with smaller reltol and method=gear2only.</strong></p>
<p>
<a id="pgfId-1050772"></a>The eigenvector responsible for phase noise was inaccurately computed and the PSS simulation tolerances might be too loose. Try simulating the circuit at the next higher accuracy setting (see <a href="chap1.html#20313">Table&#160;1-3</a>) and then compare the calculated noise in the two simulations.</p>

<h4><em>
<a id="pgfId-1050776"></a>Message II</em></h4>

<p>
<a id="pgfId-1050777"></a><strong>The Floquet eigenspace computed by spectre PSS analysis appears to be ill-defined. PNOISE computations may be inaccurate. Consider re-running the simulation with smaller reltol, different tstab(s), and method=gear2only. Check the circuit for unusual components.</strong></p>
<p>
<a id="pgfId-1050778"></a>This can be an accuracy problem, or it can result from an unusual circuit topology or sensitivity. Tighten the accuracy requirements as much as possible (see <a href="chap1.html#20313">Table&#160;1-3</a>). If this message appears in all simulations, the noise might be incorrect even if the simulations agree.</p>

<h4><em>
<a id="pgfId-1050783"></a><a id="20261"></a>Message III</em></h4>

<p>
<a id="pgfId-1050784"></a><strong>The Floquet eigenspace computed by spectre PSS analysis appears to be inaccurate and/or the oscillator possesses more than one stable mode of oscillation. PNOISE computations may be inaccurate. Consider re-running the simulation with smaller reltol, different tstab(s), and method=gear2only.</strong></p>
<p>
<a id="pgfId-1050785"></a>All the real Floquet multipliers were well-separated from unity, suggesting that the PSS simulation tolerances might be too loose. Simulate the circuit at the next higher accuracy setting (see <a href="chap1.html#20313">Table&#160;1-3</a>) and then compare the calculated noise in the two simulations. If the calculated noise does not change, it is probably correct even if this message appears in both simulations.</p>

<h4>
<a id="pgfId-1050790"></a><a id="13191"></a>The tstab Parameter</h4>

<p>
<a id="pgfId-1050791"></a>Because SpectreRF performs the PSS calculation in the time domain by using a <em>Shooting method</em>, an infinite number of possible PSS solutions exist, depending on where the first timepoint of the PSS solution is placed relative to the oscillator phase.</p>
<p>
<a id="pgfId-1050792"></a>The placement of the first timepoint is determined by the length of the initial transient simulation, which you can control using the <code>tstab</code> parameter. If the <code>tstab</code> value causes the edges of the periodic window to fall on a point where the periodic oscillator waveform is making very rapid transitions, it is very difficult for PSS to converge. Similarly, the results of the small-signal analyses are probably not very accurate. Avoid such situations. If the start of the PSS waveform falls on a very fast signal transition, you usually need to view the results of further small-signal analyses with some skepticism.</p>
<p>
<a id="pgfId-1050793"></a>Although a poor choice of the <code>tstab</code> parameter value can degrade convergence and accuracy, appropriate use of <code>tstab</code> can help to identify problem circuits and to estimate the reliability of their noise computations.</p>
<p>
<a id="pgfId-1050794"></a>If you perform several PSS and Pnoise computations that differ only in their <code>tstab</code> parameter values, the results should be fairly similar, within a relative deviation of the same order of magnitude as the simulator parameter<em> </em><code>reltol</code>. If this is not the case, you might not have set the simulator accuracy parameters sufficiently tight to achieve an accurate solution; and you need to reset one or more of the parameters<em> </em><code>reltol</code>, <code>vabstol</code>, or <code>iabstol</code>. The circuit might also be poorly designed and very sensitive to perturbations in its parameters.</p>
<p>
<a id="pgfId-1050795"></a>If the calculated fundamental period of the oscillator varies with <code>tstab</code> even when you set <code>reltol</code>, <code>iabstol</code>, and <code>vabstol</code> to very small (but not vanishingly small) values, the circuit is probably poorly designed, exhibiting anomalous behavior, or both. (see <a href="chap1.html#25572">&#8220;Known Limitations of the Simulator&#8221;</a>).</p>

<h3>
<a id="pgfId-1050801"></a><a id="20382"></a>Frequently Asked Questions<a id="marker-1050800"></a></h3>

<p>
<a id="pgfId-1050802"></a>The following questions are similar to those commonly asked about oscillator noise analysis with the SpectreRF simulator.</p>
<p>
<a id="pgfId-1050803"></a><strong>Does SpectreRF simulation calculate phase noise, amplitude noise, or both?</strong></p>
<p>
<a id="pgfId-1050804"></a>SpectreRF simulation computes the total noise of the circuit, both amplitude and phase noise. What the analog circuit design environment plots as <em>phase noise</em> is really the total noise scaled by the power in the fundamental oscillation mode. Close enough to the fundamental frequency, the noise is all phase noise, so what the analog circuit design environment plots of <em>phase noise</em> is really the phase noise as long as it is a good ways above the noise floor.</p>
<p>
<a id="pgfId-1050805"></a>Some discussions of oscillator noise based on a simple resonator/amplifier description describe the total noise, at small frequency offsets from the fundamental, as being half amplitude noise and half phase noise. In reality, for physical oscillators, near the fundamental nearly all the noise is phase noise. Therefore, these simple models overestimate the total noise by 3 dB. For a detailed explanation, see the phase noise theory described in <a href="chap1.html#12432">&#8220;Details of the SpectreRF Calculation&#8221;</a> and the detailed discussion of the Van der Pol oscillator <a href="chap1.html#42198">&#8220;Linear Time-Varying (LTV) Models&#8221;</a>.</p>
<p>
<a id="pgfId-1050812"></a><strong>I have a circuit that contains an oscillator. Can I simulate the oscillator separately and use the phase noise SpectreRF calculates as input for a second PSS/PNOISE simulation?</strong></p>
<p>
<a id="pgfId-1050813"></a>No. Oscillators generate noise with correlated spectral sidebands. Currently, SpectreRF simulation output represents only the time-average noise power, not the correlation information, so the noise cannot be input to a simulation that contains time-varying elements that might mix together noise from separate frequencies.</p>
<p>
<a id="pgfId-1050814"></a>If the second circuit is a linear filter (purely lumped linear time-invariant elements, such as resistors, capacitors, inductors, or a linearization of a nonlinear circuit around a DC operating point) that generates no frequency mixing, then you can use the output of the SpectreRF Pnoise analysis as a <em>noisefile</em> for a subsequent NOISE (not Pnoise) analysis.</p>
<p>
<a id="pgfId-1050815"></a><strong>How accurate are the phase noise calculations? What affects the errors?</strong></p>
<p>
<a id="pgfId-1050816"></a>Initially, it is important to distinguish between modeling error and simulation (numerical) error. If the device models are only good to 10% the simulation is only good to 10% (or worse). So, for the rest of this appendix, we discuss numerical error introduced by the approximations in the algorithms.</p>
<p>
<a id="pgfId-1050817"></a>You must also distinguish between absolute and relative signal frequencies in the noise analysis. When the noise frequency is plotted on an absolute scale, the error is primarily a function of the variance in the calculated fundamental period. This is true because of the singular behavior, in these regions, of the phase noise near a harmonic of the fundamental. To see this behavior, note that for the simple oscillator driven by white noise, the noise power is proportional to the offset from the fundamental frequency,</p>

<p>
<a id="pgfId-1050821"></a><img width="160" height="75" src="images/chap1-207.gif" /></p>

<p>
<a id="pgfId-1050822"></a>If you make a small error in the calculation of ω<sub>0</sub>, the error Δ <t-times>
S</t-times>
<sub><em>v</em></sub> in the noise is proportional to ¹<t-times>
S / </t-times>
¹ω<sub>0</sub></p>

<p>
<a id="pgfId-1050826"></a><img width="168" height="81" src="images/chap1-208.gif" /></p>

<p>
<a id="pgfId-1050827"></a>This error can be very large even if Δω<sub>0</sub>, the error in ω<sub>0</sub>, is small. However, because of the way SpectreRF simulation extracts out the phase noise, the calculated phase noise, as a function of offset from the fundamental frequency, can be quite accurate even for very small offsets.</p>
<p>
<a id="pgfId-1050828"></a>Now consider how much error is present in the calculated fundamental frequency. Because the numerical error is related to many simulation variables, it is difficult to quantify, without examination, how much is present. However, as a rough approximation, if we define the quantity</p>

<p>
<a id="pgfId-1050832"></a><img width="269" height="74" src="images/chap1-209.gif" /></p>

<p>
<a id="pgfId-1050833"></a>where <em>
max</em>
<t-times>
(</t-times>
<em>
i</em>
<t-times>
)</t-times>
 and <em>
max</em>
<t-times>
(</t-times>
<em>
v</em>
<t-times>
) </t-times>
are the maximum values of current and voltage over the PSS period, then, under some assumptions, Δ ω<sub>0</sub>, the error in the fundamental ω<sub>0,</sub> probably satisfies</p>

<p>
<a id="pgfId-1050837"></a><img width="162" height="53" src="images/chap1-210.gif" /></p>

<p>
<a id="pgfId-1050838"></a>where <em>
M</em>
 is the number of timesteps taken for the PSS solution. This analysis assumes that <code>steadyratio</code> is sufficiently tight, not much more than one, and also that <code>iabstol</code> and <code>vabstol</code> are sufficiently small.</p>
<p>
<a id="pgfId-1050839"></a>If you require a good estimate of the accuracy in the fundamental, run the PSS simulation with many different accuracy settings, initial conditions and <code>tstab</code><em> </em>values (See <a href="chap1.html#13191">&#8220;The tstab Parameter&#8221;</a>). For example, to estimate how much numerical error remains in the calculated fundamental frequency for a given simulation, run the simulation; reduce <code>reltol</code>, <code>iabstol</code>, and <code>vabstol</code> by a factor of 10 to100; rerun the simulation; and then compare the calculated fundamental frequencies. For the sorts of parameters we recommend for oscillator simulations, four to five digits of precision seems typical. Past that point, round off error and anomalous effects introduced by vastly varying timesteps offset any gains from tightening the various accuracy parameters.</p>
<p>
<a id="pgfId-1050843"></a>For phase noise calculations, again it is unrealistic to expect relative precision of better than the order of <code>reltol</code>. That is, if <code>reltol</code> is 10<sup>-5</sup> and the oscillator fundamental is about <t-times>
1 </t-times>
GHz, the SpectreRF numerical fuzz for the calculated period is probably about <t-times>
10 </t-times>
KHz. Therefore, when plotted on an absolute frequency scale, the phase noise calculation exhibits substantial variance within about <t-times>
10 </t-times>
KHz of the fundamental.</p>
<p>
<a id="pgfId-1050844"></a>However, when plotted on a frequency scale <em>relative</em> to the fundamental, the phase noise calculation might be more precise for many oscillators. If the circuit is strongly dissipative (that is, low<t-times>
-</t-times>
<em>
Q</em>
, such as ring oscillators and relaxation oscillators), the phase noise calculation is probably fairly accurate up to very close to the fundamental frequency even with loose simulation tolerance settings. High<t-times>
-</t-times>
<em>
Q</em>
 circuits are more demanding of the simulator and require more stringent simulation tolerances to produce good results. In particular, circuits that use varactor diodes as tuning elements in a high<t-times>
-</t-times>
<em>
Q</em>
 tank circuit appear to cause occasional problems. Small modifications to the netlist (runs with different <code>tstab</code> values and minor topology changes) can usually tell you whether (and where) the simulator results are reliable.</p>
<p>
<a id="pgfId-1050845"></a>Simulation accuracy is determined by how precisely SpectreRF simulation can solve the augmented nonlinear boundary value problem that determines the periodic steady-state. The accuracy of the BVP solution is controlled primarily by the simulation variables <code>reltol</code>, <code>iabstol</code>, <code>vabstol</code>, <code>steadyratio</code>, and <code>lteratio</code>. Typically, <code>steadyratio</code> and <code>lteratio</code> are fixed, so <code>reltol</code> is usually the variable of interest.</p>
<p>
<a id="pgfId-1050846"></a>Occasionally accuracy might be somewhat affected by other variables such as <code>relref</code>, <code>method</code>, the number of timesteps, and <code>tstab</code>. Again, the physical properties of the circuit might limit the accuracy.</p>
<p>
<a id="pgfId-1050847"></a><strong>I have a circuit with an oscillator and a sinusoidal source. Can I simulate this circuit with SpectreRF simulation?</strong></p>
<p>
<a id="pgfId-1050848"></a>In general, SpectreRF simulation is not intended to analyze circuits that contain autonomous oscillators and independent periodic sources.</p>
<p>
<a id="pgfId-1050849"></a>If the circuit contains components that could potentially oscillate autonomously and also independent large-signal sinusoidal sources, SpectreRF simulation works properly only if two conditions are fulfilled. The system must be treated as a driven system, and the coupling from the sinusoidal sources to the oscillator components must be strong enough to lock the oscillator to the independent source frequency. (In different contexts, this is known as <em>oscillator entrainment</em> or <em>phase-locking</em>) The normal (nonautonomous) PSS and small-signal analyses function normally in these conditions.</p>
<p>
<a id="pgfId-1050850"></a>If the autonomous and driven portions of the circuit are weakly coupled, the circuit waveform might be more complicated; for example, a two-tone (quasi-periodic) signal with incommensurate frequencies. (Incommensurate frequencies are those for which there is no period that is an integer multiple of the period of each frequency.) Even if PSS converges, further small-signal analyses (PAC, PXF, Pnoise) almost certainly give the wrong answers.</p>
<p>
<a id="pgfId-1050851"></a><strong>What is the significance of total noise power?</strong></p>
<p>
<a id="pgfId-1050852"></a>First, you must understand that SpectreRF simulation calculates and measures noise in voltages and currents. The total power in the phase process is unbounded, but the power in the actual state variables is bounded.</p>
<p>
<a id="pgfId-1050853"></a>Oscillator phase noise is usually characterized by the quantity</p>

<p>
<a id="pgfId-1050857"></a><img width="118" height="62" src="images/chap1-211.gif" /></p>

<p>
<a id="pgfId-1050858"></a>where <em>
P</em>
<sub>1</sub> is the power in the fundamental component of the steady state solution and <em>
Sv</em>
<t-times>
(</t-times>
<em>
f</em>
<t-times>
)</t-times>
 is the power spectral density of a state variable <em>
V</em>
.</p>
<p>
<a id="pgfId-1050859"></a>For an oscillator with only white-noise sources, <em>
L</em>
<t-times>
(</t-times>
<em>
f</em>
<t-times>
)</t-times>
 has a Lorentzian line shape,</p>

<p>
<a id="pgfId-1050863"></a><img width="151" height="68" src="images/chap1-212.gif" /></p>

<p>
<a id="pgfId-1050864"></a>where <em>
a</em>
 is dependent on the circuit and noise sources, and thus the total phase noise power</p>

<p>
<a id="pgfId-1050868"></a><em><img width="115" height="50" src="images/chap1-213.gif" />
</em></p>

<p>
<a id="pgfId-1050869"></a>Because</p>

<p>
<a id="pgfId-1050873"></a><img width="258" height="56" src="images/chap1-214.gif" /></p>

<p>
<a id="pgfId-1050874"></a>we are led to the uncomfortable, but correct, conclusion that the variance in any variable is 100 percent of the RMS value of the variable, <em>irrespective of circuit properties or the amplitude of the noise sources</em>.</p>
<p>
<a id="pgfId-1050875"></a>Physically, this means that if a noise source has been active, because <t-times>
t = -</t-times>
∞, then the voltage variable in question is randomly distributed over its whole trajectory. Therefore, the relative variance is one. Clearly, the variance is not a physically useful characterization of the noise, and the total noise power must be interpreted carefully. What is actually needed is the variance as a function of time, given a fixed reference for the signal in question; or, more often, the rate at which the variance increases from a zero point; or, sometimes, the increment in the variance from cycle to cycle. That is, we want to specify the phase of the oscillator signal at a given time point and to find a statistical characterization of the variances relative to that time. But because of the non-causal nature of the Fourier integral, quantities like the total noise power give us information about the statistical properties of the signal over all time.</p>
<p>
<a id="pgfId-1050876"></a><strong>What&#8217;s the story with pure linear oscillators (LC circuits)?</strong></p>
<p>
<a id="pgfId-1050877"></a>Oddly enough, SpectreRF simulation is not set up to do Pnoise analysis on pure LC circuits.</p>
<p>
<a id="pgfId-1050878"></a>Pure LC circuits are not physically realizable oscillators, and the mathematics that describes them is different from the mathematics that describes physical oscillators. A special option must be added to the code in order for Pnoise to handle <em>linear oscillators</em>. See <a href="chap1.html#35587">&#8220;Models for Phase Noise&#8221;</a>, and, in particular, <a href="chap1.html#39087">&#8220;Amplitude Noise and Phase Noise in the Linear Model&#8221;</a>. Because the normal NOISE analysis is satisfactory for these circuits and also much faster, it is unlikely that Pnoise is modified.</p>
<p>
<a id="pgfId-1050886"></a><strong>Why doesn&#39;t the SpectreRF model match my linear model?</strong><a id="32112"></a></p>
<p>
<a id="pgfId-1050890"></a>As is discussed in <a href="chap1.html#39087">&#8220;Amplitude Noise and Phase Noise in the Linear Model&#8221;</a>, the difference between the SpectreRF model (the correct answer) and the linear oscillator model is that in the linear oscillator, both the amplitude and the phase fluctuations can become large. However, in a nonlinear oscillator, the amplitude fluctuations are always bounded, so the noise is half as much, asymptotically.</p>
<p>
<a id="pgfId-1050891"></a>We emphasize that computing the correct total noise power requires using the time-varying small signal analysis. An oscillator is, after all, a time-varying circuit by definition. Time-invariant analyses, like the <em>linear oscillator model</em>, can sometimes be useful, but they can also be misleading and should be avoided.</p>
<p>
<a id="pgfId-1050893"></a><strong>There are funny sidebands/spikes in the oscillator noise analysis. Is this a bug?</strong><a id="30943"></a></p>
<p>
<a id="pgfId-1050894"></a>Very possibly this is parametric small-signal amplification, a real effect. This sometimes occurs when there is an AGC circuit with a very long time constant modulating the parameters of circuit elements in the oscillator loop. Sidebands in the noise power appear at frequencies offset from the oscillator fundamental by the AGC characteristic frequency.</p>
<p>
<a id="pgfId-1050895"></a>Similarly, any elements that can create a low-frequency parasitic oscillation, such as a bias inductor resonating with a capacitor in the oscillator loop, can create these sorts of sidebands.</p>

<h3>
<a id="pgfId-1050898"></a><a id="45073"></a>Further Reading<a id="marker-1050897"></a></h3>

<p>
<a id="pgfId-1050899"></a>The best references on the subject of phase noise are by Alper Demir and Franz Kaertner. Alper Demir&#8217;s thesis [10], now a Kluwer book, is a collection of useful thinking about noise. Kaertner&#8217;s papers [11, 12, 9] contain a reasonably rigorous and fairly mathematical treatment of phase noise calculations.</p>
<p>
<a id="pgfId-1050900"></a>The book by W. P. Robins [13] has a lot of engineering-oriented thinking. However, it makes heavy use of LTI models, and much of the discussion about noise cannot be strictly applied to oscillators. As a consequence, you must interpret the results in this book with care.</p>
<p>
<a id="pgfId-1050901"></a>Hajimiri and Lee&#8217;s paper [4] is worth reading, but their analysis is superseded by Kaertner&#8217;s.</p>
<p>
<a id="pgfId-1050902"></a>Other references include [8, 14, 15, 16].</p>

<h3>
<a id="pgfId-1050904"></a><a id="92748"></a>References</h3>
<p>
<a id="pgfId-1050975"></a></p>
<table class="webflareTable" id="#id1050905">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050907"></a>[1]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050909"></a>P. Kloeden and E. Platen, <em>Numerical Solution of Stochastic Differential Equations</em>. Springer-Verlag, 1995.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050911"></a>[2]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050913"></a>D. Leeson, &#8220;A simple model of feedback oscillator noise spectrum,&#8221; <em>Proc. IEEE</em>, vol. 54, pp. 329&#8211;330, 1966.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050915"></a>[3]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050917"></a>W. A. Gardner, <em>Introduction to random processes</em>. McGraw Hill, 1990.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050919"></a>[4]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050921"></a>A. Hajimiri and T. Lee, &#8220;A general theory of phase noise in electrical oscillators,&#8221; <em>IEEE Journal of Solid. State Circuits</em>, vol. 33, pp. 179&#8211;193, 1998.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050923"></a>[5]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050925"></a>R. Telichevesky, J. White, and K. Kundert, &#8220;Efficient steady-state analysis based on matrix-free krylov-subspace methods,&#8221; in <em>Proceedings of 32rd Design Automation Conference</em>, June 1995.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050927"></a>[6]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050929"></a>R. Telichevesky, J. White, and K. Kundert, &#8220;Efficient AC and noise analysis of two-tone RF circuits,&#8221; in <em>Proceedings of 33rd Design Automation Conference</em>, June 1996.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050931"></a>[7]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050933"></a>M. Okumura, T. Sugaware, and H. Tanimoto, &#8220;An efficient small-signal frequency analysis method of nonlinear circuits with two frequency excitations,&#8221; <em>IEEE Transactions on Computer-Aided Design</em>, vol. 9, pp. 225&#8211;235, 1990.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050935"></a>[8]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050937"></a>W. Anzill and P. Russer, &#8220;A general method to simulate noise in oscillators based on frequency domain techniques,&#8221; <em>IEEE Transactions on Microwave Theory and Techniques</em>, vol. 41, pp. 2256&#8211;2263, 1993.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050939"></a>[9]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050941"></a>F. X. Kärtner, &#8220;Noise in oscillating systems,&#8221; in <em>Proceedings of the Integrated Nonlinear Microwave and Millimeter Wave Circuits Conference</em>, 1992.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050943"></a>[10]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050945"></a>A. Demir, <em>Analysis and simulation of noise in nonlinear electronic circuits and systems</em>. PhD thesis, University of California, Berkeley, 1997.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050947"></a>[11]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050949"></a>F. X. Kaertner, &#8220;Determination of the correlation spectrum of oscillators with low noise,&#8221; I<em>EEE Trans. Microwave Theory and Techniques</em>, vol. 37, pp. 90&#8211;101, 1989.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050951"></a>[12]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050953"></a>F. X. Kaertner, &#8220;Analysis of white and f-a noise in oscillators,&#8221; <em>Int. J. Circuit Theory and Applications</em>, vol. 18, pp. 485&#8211;519, 1990.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050955"></a>[13]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050957"></a>W. P. Robins, <em>Phase Noise in Signal Sources</em>. Institution of Electrical Engineers, 1982.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050959"></a>[14]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050961"></a>A. A. Abidi and R. G. Meyer, &#8220;Noise in relaxation oscillators,&#8221; <em>IEEE J. Sol. State Circuits</em>, vol. 18, pp. 794&#8211;802, 1983.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050963"></a>[15]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050965"></a>B. Razavi, &#8220;A study of phase noise in cmos oscillators,&#8221; <em>IEEE J. Sol. State Circuits</em>, vol. 31, pp. 331&#8211;343, 1996.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050967"></a>[16]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050969"></a>K. Kurokawa, &#8220;Noise in synchronized oscillators,&#8221; <em>IEEE Transactions on Microwave Theory and Techniques</em>, vol. 16, pp. 234&#8211;240, 1968.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050972"></a><a id="DesignersGuide"></a>[17]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050974"></a>K. Kundert, &#8220;The Designer&#8217;s Guide to Spice &amp; Spectre,&#8221; <em>Kluwer Academic Publishers</em>, 1995.</p>
</td>
</tr>
</tbody></table>
<h3>
<a id="pgfId-1050976"></a>Measuring AM, PM and FM Conversion</h3>
<h3>
<a id="pgfId-1050977"></a>Derivation</h3>

<p>
<a id="pgfId-1050978"></a>Consider a sinusoid that is simultaneously both amplitude and phase modulated as in Equation <a href="chap1.html#40806">1-38</a>.</p>

<p>
<a id="pgfId-1050991"></a></p>
<table class="webflareTable" id="#id1050982">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-38)
<a id="pgfId-1050985"></a><a id="40806"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1050990"></a><img width="339" height="48" src="images/chap1-215.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1050995"></a>In Equation <a href="chap1.html#40806">1-38</a>, <em>
A</em>
<sub>c</sub>, φ<sub>c</sub>, ω<sub>c</sub>, are the amplitude, phase and angular frequency of the carrier, while α<t-times>
(t)</t-times>
, and φ<t-times>
(t)</t-times>
 are the amplitude and phase modulation.</p>
<p>
<a id="pgfId-1050996"></a>When you assume that φ<t-times>
(t)</t-times>
 is small for all <t-times>
t</t-times>
, this allows the narrowband angle modulation approximation as in Equation <a href="chap1.html#37001">1-39</a>. See [ziemer76].</p>

<p>
<a id="pgfId-1051009"></a></p>
<table class="webflareTable" id="#id1051000">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-39)
<a id="pgfId-1051003"></a><a id="37001"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051008"></a><img width="459" height="47" src="images/chap1-216.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1051013"></a>Converting to complex exponentials gives Equation <a href="chap1.html#62814">1-40</a>.</p>

<p>
<a id="pgfId-1051023"></a></p>
<table class="webflareTable" id="#id1051014">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-40)
<a id="pgfId-1051017"></a><a id="62814"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051022"></a><img width="577" height="103" src="images/chap1-217.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1051024"></a>Letting both the amplitude and phase modulation be complex exponentials with the same frequency, ω<sub>m</sub>, gives Equations <a href="chap1.html#23366">1-41</a>, <a href="chap1.html#94670">1-42</a>, <a href="chap1.html#73965">1-43</a>, <a href="chap1.html#84605">1-44</a> and <a href="chap1.html#37395">1-45</a>.</p>
<p>
<a id="pgfId-1051057"></a></p>
<table class="webflareTable" id="#id1051040">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-41)
<a id="pgfId-1051043"></a><a id="23366"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051048"></a><img width="131" height="52" src="images/chap1-218.gif" /></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-42)
<a id="pgfId-1051051"></a><a id="94670"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051056"></a><img width="208" height="67" src="images/chap1-219.gif" /></p>
</td>
</tr>
</tbody></table>
<p>
<a id="pgfId-1051058"></a>Where</p>

<p>
<a id="pgfId-1051084"></a></p>
<table class="webflareTable" id="#id1051059">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-43)
<a id="pgfId-1051062"></a><a id="73965"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051067"></a><img width="110" height="46" src="images/chap1-220.gif" /></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-44)
<a id="pgfId-1051070"></a><a id="84605"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051075"></a><img width="115" height="46" src="images/chap1-221.gif" /></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-45)
<a id="pgfId-1051078"></a><a id="37395"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051083"></a><img width="471" height="150" src="images/chap1-222.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1051085"></a>Assuming that both A and Φ are small and neglecting cross modulation terms gives Equation <a href="chap1.html#49115">1-46</a>.</p>

<p>
<a id="pgfId-1051098"></a></p>
<table class="webflareTable" id="#id1051089">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-46)
<a id="pgfId-1051092"></a><a id="49115"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051097"></a><img width="353" height="200" src="images/chap1-223.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1051102"></a>Simplifying gives Equation <a href="chap1.html#14183">1-47</a>.</p>
<p>
<a id="pgfId-1051112"></a></p>
<table class="webflareTable" id="#id1051103">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-47)
<a id="pgfId-1051106"></a><a id="14183"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051111"></a><img width="389" height="200" src="images/chap1-224.gif" /></p>
</td>
</tr>
</tbody></table>
<p>
<a id="pgfId-1051116"></a>In Equation <a href="chap1.html#14183">1-47</a>,</p>
<ul><li>
<a id="pgfId-1051117"></a>The AM terms are</li></ul>

<p class="webflare-indent1">
<a id="pgfId-1051121"></a><img width="340" height="45" src="images/chap1-225.gif" /></p>

<ul><li>
<a id="pgfId-1051122"></a>The PM terms are</li></ul>

<p class="webflare-indent1">
<a id="pgfId-1051126"></a><img width="407" height="104" src="images/chap1-226.gif" /></p>

<p>
<a id="pgfId-1051127"></a>Because the left-side term <span class="webflare-courier-new" style="white-space:pre"><em>v</em></span><code><sub><em>m</em></sub></code>(<span class="webflare-courier-new" style="white-space:pre"><em>t</em></span>) represents a real-time signal, only the real parts of the complex terms are of interest. Dropping the imaginary parts and rearranging Equation <a href="chap1.html#14183">1-47</a> produces Equation <a href="chap1.html#13045">1-48</a>,</p>

<p>
<a id="pgfId-1051143"></a></p>
<table class="webflareTable" id="#id1051134">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-48)
<a id="pgfId-1051137"></a><a id="13045"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051142"></a><img width="430" height="149" src="images/chap1-227.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1051147"></a>When you ignore the negative ω<sub>m</sub> term in Equation <a href="chap1.html#13045">1-48</a>, you get</p>
<ul><li>
<a id="pgfId-1051148"></a>The LSB (lower sidebands) terms are</li></ul>

<p class="webflare-indent1">
<a id="pgfId-1051152"></a><img width="362" height="45" src="images/chap1-228.gif" /></p>

<ul><li>
<a id="pgfId-1051153"></a>The USB (upper sidebands) terms are</li></ul>

<p class="webflare-indent1">
<a id="pgfId-1051157"></a><img width="350" height="48" src="images/chap1-229.gif" /></p>

<p>
<a id="pgfId-1051158"></a>Assume that you perform a <code>PAC</code> analysis, which applies a single complex exponential signal that generates responses at the upper and lower sidebands of the ω<sub>c</sub> signal. Assume the transfer functions are <t-times>
L</t-times>
 and <t-times>
U</t-times>
, so the lower and upper sideband signals are given by Equations <a href="chap1.html#66028">1-49</a> and <a href="chap1.html#65176">1-50</a>.</p>
<p>
<a id="pgfId-1051182"></a></p>
<table class="webflareTable" id="#id1051165">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-49)
<a id="pgfId-1051168"></a><a id="66028"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051173"></a><img width="180" height="46" src="images/chap1-230.gif" /></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-50)
<a id="pgfId-1051176"></a><a id="65176"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051181"></a><img width="193" height="46" src="images/chap1-231.gif" /></p>
</td>
</tr>
</tbody></table>
<p>
<a id="pgfId-1051183"></a>Where</p>

<p class="webflare-indent1">
<a id="pgfId-1051188"></a><img width="119" height="102" src="images/chap1-232.gif" /></p>

<p>
<a id="pgfId-1051198"></a>Matching common frequency terms between Equations <a href="chap1.html#13045">1-48</a>, <a href="chap1.html#66028">1-49</a>, and <a href="chap1.html#65176">1-50</a> gives Equations <a href="chap1.html#57030">1-51</a>, <a href="chap1.html#57582">1-52</a>, <a href="chap1.html#36839">1-53</a> and <a href="chap1.html#76166">1-54</a>.</p>
<p>
<a id="pgfId-1051244"></a></p>
<table class="webflareTable" id="#id1051211">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-51)
<a id="pgfId-1051214"></a><a id="57030"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051219"></a><img width="241" height="56" src="images/chap1-233.gif" /></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-52)
<a id="pgfId-1051222"></a><a id="57582"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051227"></a><img width="231" height="59" src="images/chap1-234.gif" /></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-53)
<a id="pgfId-1051230"></a><a id="36839"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051235"></a><img width="173" height="61" src="images/chap1-235.gif" /></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-54)
<a id="pgfId-1051238"></a><a id="76166"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051243"></a><img width="184" height="61" src="images/chap1-236.gif" /></p>
</td>
</tr>
</tbody></table>
<p>
<a id="pgfId-1051251"></a>Solving for the modulation coefficients gives Equations <a href="chap1.html#71284">1-55</a> and <a href="chap1.html#96929">1-56</a>.</p>
<p>
<a id="pgfId-1051269"></a></p>
<table class="webflareTable" id="#id1051252">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-55)
<a id="pgfId-1051255"></a><a id="71284"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051260"></a><img width="211" height="66" src="images/chap1-237.gif" /></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-56)
<a id="pgfId-1051263"></a><a id="96929"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051268"></a><img width="210" height="69" src="images/chap1-238.gif" /></p>
</td>
</tr>
</tbody></table>
<p>
<a id="pgfId-1051276"></a>Thus, Equation <a href="chap1.html#71284">1-55</a> gives the transfer function for amplitude modulation and Equation <a href="chap1.html#96929">1-56</a> gives the transfer function for phase modulation.</p>

<h4>
<a id="pgfId-1051277"></a>Positive Frequencies</h4>

<p>
<a id="pgfId-1051281"></a>Notice that <code>L</code> is defined in <a href="chap1.html#66028">Equation&#160;1-49</a> to be the transfer function from the input to the sideband at ω<sub>m</sub> − ω<sub>c</sub>, which is a negative frequency. This is usually a natural definition for use with the Spectre<sup>&#174;</sup> circuit simulator RF analysis (SpectreRF) small signal analyses (depending on the setting of the <code>freqaxis</code> parameter). It can be cumbersome though when the only data available is at positive frequencies. Thus, the transfer function to ω<sub>c</sub> − ω<sub>m </sub>is defined as</p>

<p>
<a id="pgfId-1051285"></a><img width="41" height="34" src="images/chap1-239.gif" /></p>

<p>
<a id="pgfId-1051289"></a>Then, as in Equation <a href="chap1.html#59047">1-57</a>,</p>

<p>
<a id="pgfId-1051299"></a></p>
<table class="webflareTable" id="#id1051290">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-57)
<a id="pgfId-1051293"></a><a id="59047"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051298"></a><img width="186" height="45" src="images/chap1-240.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1051300"></a>Because the signals are real, <t-times>
L</t-times>
 is a complex conjugate of</p>

<p>
<a id="pgfId-1051304"></a><img width="37" height="39" src="images/chap1-241.gif" /></p>

<p>
<a id="pgfId-1051308"></a>And the reverse is also true, as in Equation <a href="chap1.html#43756">1-58</a>,</p>

<p>
<a id="pgfId-1051318"></a></p>
<table class="webflareTable" id="#id1051309">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-58)
<a id="pgfId-1051312"></a><a id="43756"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051317"></a><img width="68" height="37" src="images/chap1-242.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1051328"></a>Equations <a href="chap1.html#94072">1-59</a> and <a href="chap1.html#44406">1-60</a> are produced by rewriting <a href="chap1.html#71284">Equation&#160;1-55</a> and <a href="chap1.html#96929">Equation&#160;1-56</a> in terms of</p>

<p>
<a id="pgfId-1051335"></a><img width="57" height="37" src="images/chap1-243.gif" /></p>
<p>
<a id="pgfId-1051353"></a></p>
<table class="webflareTable" id="#id1051336">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-59)
<a id="pgfId-1051339"></a><a id="94072"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051344"></a><img width="217" height="66" src="images/chap1-244.gif" /></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-60)
<a id="pgfId-1051347"></a><a id="44406"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051352"></a><img width="221" height="64" src="images/chap1-245.gif" /></p>
</td>
</tr>
</tbody></table>
<h4>
<a id="pgfId-1051354"></a>FM Modulation</h4>

<p>
<a id="pgfId-1051355"></a>For FM modulation, the phase modulation φ<t-times>
(t)</t-times>
 becomes the integral of the FM modulation signal, ω<t-times>
(t)</t-times>
 as shown in Equation <a href="chap1.html#49626">1-61</a>.</p>

<p>
<a id="pgfId-1051368"></a></p>
<table class="webflareTable" id="#id1051359">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-61)
<a id="pgfId-1051362"></a><a id="49626"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051367"></a><img width="224" height="42" src="images/chap1-246.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1051369"></a>Where</p>

<p>
<a id="pgfId-1051379"></a></p>
<table class="webflareTable" id="#id1051370">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-62)
<a id="pgfId-1051373"></a><a id="43113"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051378"></a><img width="131" height="38" src="images/chap1-247.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1051386"></a>Recall from <a href="chap1.html#94670">Equation&#160;1-42</a> and <a href="chap1.html#96929">Equation&#160;1-56</a> that</p>

<p>
<a id="pgfId-1051396"></a></p>
<table class="webflareTable" id="#id1051387">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-63)
<a id="pgfId-1051390"></a><a id="89867"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051395"></a><img width="271" height="66" src="images/chap1-248.gif" /></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1051403"></a>Combining Equation <a href="chap1.html#43113">1-62</a> and Equation <a href="chap1.html#89867">1-63</a> and the differentiating both sides results in Equations <a href="chap1.html#96080">1-64</a>, <a href="chap1.html#45500">1-65</a>, and <a href="chap1.html#37924">1-66</a>.</p>
<p>
<a id="pgfId-1051430"></a></p>
<table class="webflareTable" id="#id1051413">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-64)
<a id="pgfId-1051416"></a><a id="96080"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051421"></a><img width="286" height="69" src="images/chap1-249.gif" /></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-65)
<a id="pgfId-1051424"></a><a id="45500"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051429"></a><img width="310" height="65" src="images/chap1-250.gif" /></p>
</td>
</tr>
</tbody></table>
<p>
<a id="pgfId-1051431"></a>Or</p>

<p>
<a id="pgfId-1051441"></a></p>
<table class="webflareTable" id="#id1051432">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p><strong>(1-66)
<a id="pgfId-1051435"></a><a id="37924"></a></strong></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051440"></a><img width="109" height="45" src="images/chap1-251.gif" /></p>
</td>
</tr>
</tbody></table>
<h3>
<a id="pgfId-1051442"></a>Simulation</h3>

<p>
<a id="pgfId-1051446"></a>The test circuit, represented by the two netlists shown in <a href="chap1.html#25550">Example&#160;</a> and <a href="chap1.html#68677">Example&#160;</a>, was run with SpectreRF. The test circuit consists of three, linear, periodically-varying modulators that are driven with the same input. The input is constant valued in the large signal <code>PSS</code> analysis, and generates a single complex exponential analysis during the <code>PAC</code> analysis. The idea is to compute the transfer functions from this input to the upper and lower sidebands at the output of the modulators and then use the derivation just described to convert these transfer functions into transfer functions to the AM, PM, and FM modulations and then check the simulation results against the expected results.</p>
<p>
<a id="pgfId-1051450"></a>Notice that <code>freqaxis=out</code>. This is necessary to match the derivation. If you would rather use <code>freqaxis=absout</code>, you would have to use the complex conjugate of <t-times>
L</t-times>
 as in <a href="chap1.html#94072">Equation&#160;1-59</a> and <a href="chap1.html#44406">Equation&#160;1-60</a>.</p>

<ft-figtabl-title id="#id1051458">
<a id="pgfId-1051458"></a><a id="25550"></a>Netlist for the AM, PM, and FM Conversion Test Circuit</ft-figtabl-title>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1051459"></a>// AM, PM, and FM modulation test circuit<br /></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1051460"></a>simulator lang=spectre<br />ahdl_include &quot;modulators.va&quot;<br /></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1051461"></a>parameters MOD_FREQ=10MHz<br />parameters CARRIER_FREQ=1GHz<br /></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1051462"></a>Vin (in 0) vsource pacmag=1 pacphase=0<br />Mod0 (unmod in) AMmodulator freq=CARRIER_FREQ mod_index=0<br />Mod1 (am in) AMmodulator freq=CARRIER_FREQ mod_index=1<br />Mod2 (pm in) PMmodulator freq=CARRIER_FREQ kp=1<br />Mod3 (fm in) FMmodulator freq=CARRIER_FREQ fd=MOD_FREQ<br /></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1051463"></a>waves pss fund=CARRIER_FREQ outputtype=all tstab=2ns harms=1<br />xfer pac start=MOD_FREQ maxsideband=4 freqaxis=out</pre>

<p>
<a id="pgfId-1051467"></a>The netlist for the modulator models shown in Example <a href="chap1.html#68677">1-66</a>, has the filename <code>modulators.va</code>.</p>

<ft-figtabl-title id="#id1051469">
<a id="pgfId-1051469"></a><a id="68677"></a>Netlist for the Modulator Models Written in Verilog-A</ft-figtabl-title>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1051470"></a>`include &quot;discipline.h&quot;<br />`include &quot;constants.h&quot;<br /></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1051471"></a>module AMmodulator (out, in);<br />    input in;<br />    output out;<br />    electrical out, in;<br />    parameter real freq = 1 from (0:inf);<br />    parameter real mod_index = 1;<br /></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1051472"></a>    analog begin<br />        V(out) &lt;+ (1+mod_index*V(in)) * cos(2*`M_PI*freq*$abstime);<br />        $bound_step( 0.05 / freq );<br />    end<br />endmodule<br /></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1051473"></a>module PMmodulator (out, in);<br />    input in;<br />    output out;<br />    electrical out, in;<br />    parameter real freq = 1 from (0:inf);<br />    parameter real kp = 1 from (0:inf);<br /></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1051474"></a>    analog begin<br />        V(out) &lt;+ cos(2*`M_PI*freq*$abstime + kp*V(in));<br />        $bound_step( 0.05 / freq );<br />    end<br />endmodule<br /></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1051475"></a>module FMmodulator (out, in);<br />    input in;<br />    output out;<br />    electrical out, in;<br />    parameter real freq = 1 from (0:inf);<br />    parameter real fd = 1 from (0:inf);<br />    real phi;<br /></pre>
<pre class="webflare-courier-new codeContent">
<a id="pgfId-1051476"></a>    analog begin<br />        V(out) &lt;+ cos(2*`M_PI*(freq*$abstime + idtmod(fd*V(in),0,1, -0.5)));<br />        $bound_step( 0.05 / freq );<br />    end<br />endmodule</pre>
<h3>
<a id="pgfId-1051477"></a>Results</h3>

<p>
<a id="pgfId-1051478"></a>The simulations were run with various values for <code>pacphase</code> on <code>Vin</code>.</p>
<p>
<a id="pgfId-1051482"></a>Table <a href="chap1.html#15882">1-4</a> shows results for the output of the AM modulator with <em>
v</em>
<sub><em>LO</em></sub><t-times>
 = </t-times>
<em>
cos</em>
<t-times>
(</t-times>
ω<sub><em>c</em></sub><em>
t</em>
<t-times>
)</t-times>
.</p>
<p>
<a id="pgfId-1051486"></a>Table <a href="chap1.html#74629">1-5</a> shows results for the output of the PM modulator with <em>
v</em>
<sub><em>LO</em></sub><t-times>
 = </t-times>
<em>
cos</em>
<t-times>
(</t-times>
ω<sub><em>c</em></sub><em>
t</em>
<t-times>
)</t-times>
.</p>

<p>
<a id="pgfId-1051558"></a></p>
<table class="webflareTable" id="#id1051487">
<caption style="text-align:left;"><p>
</p><h4>Table 1-4
<a id="pgfId-1051490"></a><a id="15882"></a>Results for the AM Modulator Output </h4></caption>
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051500">
<a id="pgfId-1051500"></a>pacphase</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051502">
<a id="pgfId-1051502"></a>L</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051504">
<a id="pgfId-1051504"></a>U</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051506">
<a id="pgfId-1051506"></a>A</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051508">
<a id="pgfId-1051508"></a>Φ</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051510"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051512"></a>1/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051514"></a>1/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051516"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051518"></a>0</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051520"></a>45</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051525"></a><img width="44" height="47" src="images/chap1-252.gif" /></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051530"></a><img width="46" height="46" src="images/chap1-253.gif" /></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051535"></a><img width="49" height="48" src="images/chap1-254.gif" />
</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051537"></a>0</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051539"></a>90</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051541"></a><em>
 j</em>
/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051543"></a><em>
 j</em>
/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051545"></a><em>
 j</em>
 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051547"></a>0 </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051549"></a>180</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051551"></a>−1/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051553"></a>−1/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051555"></a>−1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051557"></a>0 </p>
</td>
</tr>
</tbody></table>
<p>
<a id="pgfId-1051630"></a></p>
<table class="webflareTable" id="#id1051559">
<caption style="text-align:left;"><p>
</p><h4>Table 1-5
<a id="pgfId-1051562"></a><a id="74629"></a>Results for the PM Modulator Output</h4></caption>
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051572">
<a id="pgfId-1051572"></a>pacphase</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051574">
<a id="pgfId-1051574"></a>L</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051576">
<a id="pgfId-1051576"></a>U</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051578">
<a id="pgfId-1051578"></a>A</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051580">
<a id="pgfId-1051580"></a>Φ</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051582"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051584"></a>−1/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051586"></a>1/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051588"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051590"></a>1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051592"></a>45</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051597"></a><img width="44" height="47" src="images/chap1-255.gif" /></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051602"></a><img width="43" height="47" src="images/chap1-256.gif" /></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051604"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051609"></a><img width="46" height="49" src="images/chap1-257.gif" /></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051611"></a>90</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051613"></a>1/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051615"></a>−1/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051617"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051619"></a><em>
 j</em>
</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051621"></a>180</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051623"></a><em>
 j</em>
/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051625"></a>−<em>
j</em>
/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051627"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051629"></a>−1 </p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1051631"></a>If you repeat the simulations but replace the <em>
cos</em>
 function in the modulators with the <em>
sin</em>
 function, which is equivalent to changing the <code>LO</code> to <em>
v</em>
<sub><em>LO</em></sub> = <em>
sin</em>
(ω<sub><em>c</em></sub><em>
t</em>
) or setting φ<sub><em>c</em></sub> = −<em>
90</em>
, you achieve the following results.</p>
<ul><li>
<a id="pgfId-1051635"></a>Table <a href="chap1.html#85460">1-6</a> shows results for the output of the AM modulator with <em>
v</em>
<sub><em>LO</em></sub> = <em>
sin</em>
(ω<sub><em>c</em></sub><em>
t</em>
).</li><li>
<a id="pgfId-1051639"></a>Table <a href="chap1.html#13541">1-7</a> shows results for the output of the PM modulator with <em>
v</em>
<sub><em>LO</em></sub> = <em>
sin</em>
(ω<sub><em>c</em></sub><em>
t</em>
).<br />
<a id="pgfId-1051711"></a><table class="webflareTable" id="#id1051640">
<caption style="text-align:left;"><p>
</p><h4>Table 1-6
<a id="pgfId-1051643"></a><a id="85460"></a>Results for the AM Modulator Output</h4></caption>
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051653">
<a id="pgfId-1051653"></a>pacphase</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051655">
<a id="pgfId-1051655"></a>L</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051657">
<a id="pgfId-1051657"></a>U</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051659">
<a id="pgfId-1051659"></a>A</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051661">
<a id="pgfId-1051661"></a>Φ</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051663"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051665"></a><em>
 j</em>
/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051667"></a>−1/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051669"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051671"></a>0</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051673"></a>45</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051678"></a><img width="40" height="47" src="images/chap1-258.gif" /></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051683"></a><img width="41" height="46" src="images/chap1-259.gif" /></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051688"></a><img width="44" height="46" src="images/chap1-260.gif" />
</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051690"></a>0 </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051692"></a>90</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051694"></a>−1/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051696"></a>1/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051698"></a><em>
j</em>
 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051700"></a>0 </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051702"></a>180</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051704"></a>−<em>
j</em>
/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051706"></a><em>
 j</em>
/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051708"></a>−1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051710"></a>0 </p>
</td>
</tr>
</tbody></table>
<a id="pgfId-1051783"></a><table class="webflareTable" id="#id1051712">
<caption style="text-align:left;"><p>
</p><h4>Table 1-7
<a id="pgfId-1051715"></a><a id="13541"></a>Results for the PM Modulator Output</h4></caption>
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051725">
<a id="pgfId-1051725"></a>pacphase</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051727">
<a id="pgfId-1051727"></a>L</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051729">
<a id="pgfId-1051729"></a>U</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051731">
<a id="pgfId-1051731"></a>A</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051733">
<a id="pgfId-1051733"></a>Φ</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051735"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051737"></a>1/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051739"></a>1/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051741"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051743"></a>1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051745"></a>45</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051750"></a><img width="40" height="45" src="images/chap1-261.gif" /></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051755"></a><img width="45" height="46" src="images/chap1-262.gif" /></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051757"></a>0 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051762"></a><img width="45" height="45" src="images/chap1-263.gif" /></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051764"></a>90</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051766"></a><em>
 j</em>
/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051768"></a><em>
 j</em>
/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051770"></a>0 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051772"></a><em>
 j </em>
</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051774"></a>180</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051776"></a>−1/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051778"></a>−1/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051780"></a>0 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051782"></a>−1 </p>
</td>
</tr>
</tbody></table></li></ul>







<p>
<a id="pgfId-1051787"></a>Finally, Table <a href="chap1.html#13726">1-8</a> shows the results for the FM modulator with <em>
v</em>
<sub><em>LO</em></sub> = <em>
cos</em>
(ω<sub><em>c</em></sub><em>
t</em>
). The FM modulator has a modulation coefficient of ω<sub>m</sub> built-in, which renormalizes the results.</p>

<p>
<a id="pgfId-1051847"></a></p>
<table class="webflareTable" id="#id1051788">
<caption style="text-align:left;"><p>
</p><h4>Table 1-8
<a id="pgfId-1051791"></a><a id="13726"></a>Results for the FM Modulator Output</h4></caption>
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051799">
<a id="pgfId-1051799"></a>pacphase</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051801">
<a id="pgfId-1051801"></a>L</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051803">
<a id="pgfId-1051803"></a>U</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1051805">
<a id="pgfId-1051805"></a>&#x2126;</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051807"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051809"></a>−1/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051811"></a>1/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051813"></a>1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051815"></a>45</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051820"></a><img width="51" height="46" src="images/chap1-264.gif" /></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051825"></a><img width="45" height="45" src="images/chap1-265.gif" /></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051830"></a><img width="45" height="46" src="images/chap1-266.gif" /></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051832"></a>90</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051834"></a>−<em>
j</em>
/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051836"></a><em>
 j</em>
/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051838"></a><em>
 j </em>
</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051840"></a>180</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051842"></a>1/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051844"></a>−1/2 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051846"></a>−1 </p>
</td>
</tr>
</tbody></table>
<h3>
<a id="pgfId-1051848"></a>Conclusion</h3>

<p>
<a id="pgfId-1051849"></a>This appendix shows that the <code>PAC</code> analysis can be used to determine the level of AM or PM modulation that appears on a carrier. This is done by applying a small signal and using the phase of the carrier along with the transfer function to the upper and lower sidebands of the carrier to compute an AM or PM transfer function.</p>

<h3>
<a id="pgfId-1051859"></a>References</h3>
<table class="webflareTable" id="#id1051850">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051852"></a>[Ziemer 76]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051854"></a>R. Ziemer and W. Tranter. Principles of Communications: Systems, Modulation, and Noise. Houghton Miffin, 1976. </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051856"></a>[Robins 96]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1051858"></a>W. Robins. <em>Phase Noise in Signal Sources (Theory and Application)</em>. IEE Telecommunications Series, 1996. </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1052420"></a>[1] </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1052422"></a>J. Roychowdhury, D. Long and P Feldmann. <em>Cyclostationary Noise Analysis of Large RF Circuits with Multitone Excitations. JSSC Vol. 33 No.3</em> 1998 </p>
</td>
</tr>
</tbody></table>


<p>
<a id="pgfId-1053337"></a>From MATLAB versions 2010a onwards, Solaris Platform is no longer supported.</p>


<p>
<a id="pgfId-1053386"></a>From MATLAB versions 2012b onwards, Linux 32-bit platform is no longer supported</p>


<p>
<a id="pgfId-1053411"></a>From MATLAB vesions 2012b onwards, Red Hat Enterprise Linux 5 is no longer supported</p>


<p>
<a id="pgfId-1053518"></a>From MATLAB versions 2010a onwards, Solaris Platform is no longer supported.</p>


<p>
<a id="pgfId-1053567"></a>From MATLAB versions 2012b onwards, Linux 32-bit platform is no longer supported</p>


<p>
<a id="pgfId-1053592"></a>From MATLAB vesions 2012b onwards, Red Hat Enterprise Linux 5 is no longer supported</p>


<br /><a href="#pagetop">Return to top</a><br /></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="preface.html" id="prev" title="Preface">Preface</a></em></b><b><em><a href="chap2.html" id="nex" title="The Spectre RF Analyses">The Spectre RF Analyses</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2020, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
</body></html>