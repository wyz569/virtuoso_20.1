
<html><head><title>Appendix D: Using the Profiler</title>
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="jaini" />
<meta name="CreateDate" content="2019-11-04" />
<meta name="CreateTime" content="1572864951" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes the Virtuoso AMS Designer simulator, a mixed-signal simulator that supports the Verilog-AMS and VHDL-AMS language standards." />
<meta name="DocTitle" content="Spectre AMS Designer and Xcelium Simulator Mixed-Signal User Guide" />
<meta name="DocType" content="User Guide" />
<meta name="FileTitle" content="Appendix D: Using the Profiler" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="prod_feature" content="" />
<meta name="prod_subfeature" content="" />
<meta name="FileType" content="Chapter" />
<meta name="Keyword" content="amssimug" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2019-11-04" />
<meta name="ModifiedTime" content="1572864951" />
<meta name="NextFile" content="Appendix_E__Using_the_Three-Step_Flow.html" />
<meta name="Group" content="Analog Mixed-Signal Simulation" />
<meta name="Platform" content="Functional Verification" />
<meta name="PrevFile" content="Appendix_C__Source_Protection.html" />
<meta name="Product" content="Xcelium" />
<meta name="ProductFamily" content="Functional Verification" />
<meta name="ProductVersion" content="19.09" />
<meta name="RightsManagement" content="Copyright 2012-2019 Cadence Design Systems Inc." />
<meta name="Title" content="Spectre AMS Designer and Xcelium Simulator Mixed-Signal User Guide -- Appendix D: Using the Profiler" />
<meta name="Version" content="19.09" />
<meta name="Renderer" content="WIKI" />
<meta name="SpaceKey" content="amssimug2003" />
<meta name="confluence-version" content="6.13.3" />
<meta name="ecms-plugin-version" content="03.30.005" />

        
        <link href="styles/site.css" rel="stylesheet" type="text/css" />
        <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
    

    </head><body style="background-color: #FFFFFF;"><!-- Begin Buttons --><header xmlns:html="http://www.w3.org/1999/xhtml"><div class="docHeadr">Product Documentation<img src="images/Cadence-Logo.jpg" /></div>
<nav class="blueHead"><ul><li><a class="content" href="amssimugTOC.html">Contents</a></li><li><a class="prev" href="Appendix_C__Source_Protection.html" title="Appendix_C__Source_Protection">Appendix_C__Source_Protection</a></li><li style="float: right;"><a class="viewPrint" href="amssimug.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="Appendix_E__Using_the_Three-Step_Flow.html" title="Appendix_E__Using_the_Three-Step_Flow">Appendix_E__Using_the_Three-St ...</a></li></ul></nav></header><!-- End Buttons --><div xmlns:html="http://www.w3.org/1999/xhtml" style="font-size:14px;line-height:1.42857142857;margin:20px 0 0 0;font-weight:bold;"><center>Spectre AMS Designer and Xcelium Simulator Mixed-Signal User Guide<br />Product Version 19.09, September 2019</center></div>
<div xmlns:html="http://www.w3.org/1999/xhtml" style="margin-left:5%;">
<p></p>

<p></p>
<div id="main-header">
                    
                    
                                                <h1 style="margin: 4px 0 4px;"><span>Appendix D: Using the Profiler</span></h1>

                    
                </div>
<div class="wiki-content group" id="main-content">
                    <div><span class="confluence-anchor-link" id="AppendixD:UsingtheProfiler-1035250"></span>
<p>The profiler measures where CPU time is spent during simulation, and it provides information that you can use to modify your designs for better simulation.</p>

<p>To run the profiler, use the <code>-profile</code>&#160;option when you run the AMS Designer simulator (<code>xmsim</code>). For more information about the <code>xmsim</code>&#160;command, see<a href="Simulating.html#Simulating-1042414"> &quot;xmsim Command Syntax and Options&quot;</a>.</p>

<p>When the simulator exits, the profiler writes the profile to a file called <code>xmprof.out </code>in the current or run directories.</p>

<p>Each profile begins with a header that provides general information.The information contained in the header can reveal performance problems such as insufficient physical memory for the size of the simulation, or low CPU utilization due to a busy machine or waiting for I/O.</p>

<p>After the header, the profile is divided into three main sections:<span style="color: rgb(0,0,0);"> Mixed-signal simulation summary</span>,<span style="color: rgb(0,0,0);"> Digital Simulation Profile Results</span>, and<span style="color: rgb(0,0,0);"> Analog Simulation Profile Results.</span> The tables in those sections share the following column headers:</p>
<div class="table-wrap"><table bgcolor="#FFFFFF" cellpadding="4" cellspacing="0" class="confluenceTable" style="width: 648.0px;"><tbody><tr><td class="confluenceTd" valign="top" width="120">
<p><code><span style="color: rgb(0,0,0);">%hits </span></code></p>
</td>
<td class="confluenceTd" valign="top" width="528">
<p>The percentage of the total hits detected in the activity</p>
</td>
</tr>
<tr><td class="confluenceTd" valign="top">
<p><code><span style="color: rgb(0,0,0);">#hits </span></code></p>
</td>
<td class="confluenceTd" valign="top">
<p>The raw number of hits detected in the activity</p>
</td>
</tr>
<tr><td class="confluenceTd" valign="top">
<p><code><span style="color: rgb(0,0,0);">%cost </span></code></p>
</td>
<td class="confluenceTd" valign="top">
<p>The percentage of simulator time-steps required to service the analog operator or expression.</p>
</td>
</tr>
<tr><td class="confluenceTd" valign="top">
<p><code><span style="color: rgb(0,0,0);">domain </span></code></p>
</td>
<td class="confluenceTd" valign="top">
<p>The solver, either analog or digital</p>
</td>
</tr>
<tr><td class="confluenceTd" valign="top">
<p><code><span style="color: rgb(0,0,0);">#inst </span></code></p>
</td>
<td class="confluenceTd" valign="top">
<p>The number of instances</p>
</td>
</tr>
<tr><td class="confluenceTd" valign="top">
<p><code><span style="color: rgb(0,0,0);">name </span></code></p>
</td>
<td class="confluenceTd" valign="top">
<p>The name or description of the activity</p>
</td>
</tr>
<tr><td class="confluenceTd" valign="top">
<p><code><span style="color: rgb(0,0,0);">type </span></code></p>
</td>
<td class="confluenceTd" valign="top">
<p>One of the following types: <code>dVar</code> (a digital variable that causes a digital to analog event), <code>cross </code>(an @cross event), <code>filter</code> (a transition)</p>
</td>
</tr>
<tr><td class="confluenceTd" valign="top">
<p><code><span style="color: rgb(0,0,0);">instance </span></code></p>
</td>
<td class="confluenceTd" valign="top">
<p>The full hierarchical name of an instance and the line number where it is defined</p>
</td>
</tr>
</tbody></table></div>
<h2 id="AppendixD:UsingtheProfiler-Mixed-SignalSimulationSummary">Mixed-Signal Simulation Summary</h2>

<p>The mixed-signal simulation summary shows how simulation time divides between the analog solver and the digital solver. For example, the following report shows that 97% of the hits occurred in the analog solver.</p>

<p><code> ------------------------------------------------------------<br />Mixed-signal simulation summary (1766 hits total)<br />------------------------------------------------------------ </code></p>

<p><code> %hits #hits domain<br />&#160;97.0  1713 Analog<br />&#160;&#160;3.0    53 Digital<br />------------------------------------------------------------ </code></p>
<h2 id="AppendixD:UsingtheProfiler-DigitalSimulationProfileResults">Digital Simulation Profile Results</h2>

<p>The digital simulation profile results section summarizes information for the digital solver in three different ways:<em><span style="color: rgb(0,0,0);"> Stream Counts </span>,<span style="color: rgb(0,0,0);"> Most Active Modules (behavioral)</span></em>, and<span style="color: rgb(0,0,0);"><em> Stream Type Summary Counts</em>.</span> For more information about interpreting the digital results, see Chapter 14, in<span style="color: rgb(0,0,0);"><em> Cadence Verilog Simulation User Guide</em>.</span></p>
<h3 id="AppendixD:UsingtheProfiler-StreamCounts">Stream Counts</h3>

<p>The<span style="color: rgb(0,0,0);"> Stream Counts </span>section provides information about time spent in individual generated code streams. These code streams correspond to specific HDL source constructs. They include</p>
<ul><li><code> always</code>&#160;blocks</li></ul><ul><li><code> initial</code>&#160;blocks</li></ul><ul><li>Continuous assignments</li></ul><ul><li>Tasks and functions</li></ul><ul><li>Non-blocking assignments</li></ul><ul><li>Quasi-continuous assignments</li></ul><ul><li>Parallel block sub-processes (statements inside fork/join)</li></ul><ul><li>Logic primitives for gates and UDPs (because logic primitives share the same code between different instances, the profiler cannot indicate which gate instances are taking up the most time)</li></ul>
<p>The beginning of the<span style="color: rgb(0,0,0);"> Stream Counts </span>section is the first place to look for inefficiency. If a few streams are taking up most of the simulation time, simulation cannot be sped up significantly without reducing the time in those streams.</p>

<p>The following example shows a<span style="color: rgb(0,0,0);"> Stream Counts </span>section.</p>

<p><code> ------------------------------------------------------------<br />Stream Counts (53 hits total)<br />------------------------------------------------------------ </code></p>

<p><code> %hits #hits  #inst  name<br /> 28.3&#160; &#160; &#160;15 [&#160; &#160;] Library function minnow (time callbacks)<br /> 24.5&#160; &#160; &#160;13 [&#160; &#160;] tcl_functions<br /> 15.1&#160; &#160; &#160; 8 [&#160; &#160;] Method SSS_KM_CL2TA (method)<br /> 15.1&#160; &#160; &#160; 8 [&#160; &#160;] outside engine<br />  5.7&#160; &#160; &#160; &#160;3 [&#160; &#160;] Method SSS_KM_FINDRFT (method)<br />  3.8&#160; &#160; &#160; &#160;2 [&#160; 1] Always stmt (file: /net/mach111/cds/ams/ldv51/tools/affirma_ams/etc/connect_lib/elect2logic.v, line: 69 in connectLib.elect2logic&#160; &#160; [module])<br />  3.8&#160; &#160; &#160; &#160;2 [&#160; &#160;] Library function rtl_analog_demand<br />  1.9&#160; &#160; &#160; &#160;1 [&#160; &#160;] Method SSS_MT_SA_PROCESS (method)<br />  1.9&#160; &#160; &#160; &#160;1 [&#160; &#160;] ssslib snare support </code></p>

<p>The example<span style="color: rgb(0,0,0);"> Stream Counts </span>section shown above contains a category called <code>outside engine</code>. This category, and another called <code>engine support</code>, are catch-all categories for activities that cannot be otherwise categorized.</p>
<h3 id="AppendixD:UsingtheProfiler-MostActiveModules">Most Active Modules</h3>

<p>The<em><span style="color: rgb(0,0,0);"> Most Active Modules </span></em>section of the profile summarizes the stream counts by module. For each module listed, the profile lists the sum of the counts in all of the streams.</p>

<p>The following example shows a<em><span style="color: rgb(0,0,0);"> Most Active Modules </span></em>section.</p>

<p><code> ------------------------------------------------------------<br />Most Active Modules (behavioral)<br />------------------------------------------------------------ </code></p>

<p><code> %hits #hits  #inst  name<br />&#160;&#160;3.8&#160;&#160;&#160;&#160;&#160;2 [&#160; 1] connectLib.elect2logic:module (file: /net/mach111/cds/ams/ldv51/tools/affirma_ams/etc/connect_lib/elect2logic.v line: 60) </code></p>
<h3 id="AppendixD:UsingtheProfiler-StreamTypeSummaryCounts">Stream Type Summary Counts</h3>

<p>The<em><span style="color: rgb(0,0,0);"> Stream Type Summary Counts </span></em>section summarizes the stream counts by the type of stream or other activity. For example, there might be a total for logic primitives, timing checks,&#160;<code>always</code>&#160;or <code>initial</code>&#160;statements, non-blocking assignments, continuous assignments, and so on.</p>

<p>The summary makes it easier to identify widespread inefficiencies in the simulation. For example, large amounts of time spent on probing, file I/O, and<a href="Glossary.html#Glossary-1035591"> PLI </a>show up most clearly in this section.</p>

<p>The following example shows a<em><span style="color: rgb(0,0,0);"> Stream Type Summary Counts </span></em>section:</p>

<p><code> ------------------------------------------------------------<br />Stream Type Summary Counts (53 hits total)<br />------------------------------------------------------------ </code></p>

<p><code> %hits #hits  #inst  name<br /> 32.1&#160; &#160; &#160;17 [&#160; &#160;] System tasks/functions or library functions<br /> 24.5&#160; &#160; &#160;13 [&#160; &#160;] VCD/SHM variable dumping<br /> 22.6&#160; &#160; &#160;12 [&#160; &#160;] Standard methods (mostly fanout propagation)<br /> 15.1&#160; &#160; &#160; 8 [&#160; &#160;] Outside engine<br />  3.8&#160; &#160; &#160; &#160;2 [&#160; 3] Always statements<br />  1.9&#160; &#160; &#160; &#160;1 [&#160; &#160;] Support for VPI callbacks (or UI) </code></p>
<h2 id="AppendixD:UsingtheProfiler-AnalogSimulationProfileResults">Analog Simulation Profile Results</h2>

<p>The<em><span style="color: rgb(0,0,0);"> Events and Operators </span></em>section of the<em><span style="color: rgb(0,0,0);"> Analog Simulation Profile Results </span></em>reports performance measurements for analog constructs, including, for Verilog<span style="color: rgb(0,0,0);"><sup>&#174;</sup></span>-AMS</p>
<ul><li><code> transition </code></li></ul><ul><li><code> @cross </code></li></ul><ul><li>Accessing digital variables and nets from an analog context</li></ul>
<p>and including, for VHDL-AMS</p>
<ul><li><code> S&#39;ramp </code></li></ul><ul><li><code> Q&#39;above </code></li></ul><ul><li>Accessing digital variables and nets from an analog context, with or without<code> break </code>statements.</li></ul>
<p>The following example shows an<em><span style="color: rgb(0,0,0);"> Events and Operators </span></em>section.</p>

<p><code> ------------------- Events and Operators -------------------<br />------------------------------------------------------------ </code></p>

<p><code> %cost #hits type     instance<br />4.4&#160;&#160;&#160;135 dVar&#160;&#160;&#160;&#160;&#160;&#160;&#160;top.dac:dacOut (file: AMS_lib/daconv.vhd line: 22)<br />4.4&#160;&#160;&#160;135 dVar&#160;&#160;&#160;&#160;&#160;&#160;&#160;top.dac:dacOut&#39;DELAYED (file: AMS_lib/daconv.vhd line: 37)<br />4.4&#160;&#160;&#160;135 filter&#160;&#160;&#160;&#160;&#160;top.dac (file: ../../../../.././AMS_lib/daconv.vhd line: 37)<br />0.5&#160;&#160;&#160;&#160;15 filter&#160;&#160;&#160;&#160;&#160;top.sh (file: AMS_lib/samplehold.vams line: 38) </code></p>
</div>

                    </div>
<br /><br /></div>
<footer xmlns:html="http://www.w3.org/1999/xhtml"><nav class="navigation"><b><em><a href="Appendix_C__Source_Protection.html" id="prev" title="Appendix_C__Source_Protection">Appendix_C__Source_Protection</a></em></b><b><em><a href="Appendix_E__Using_the_Three-Step_Flow.html" id="nex" title="Appendix_E__Using_the_Three-Step_Flow">Appendix_E__Using_the_Three-St ...</a></em></b></nav><div>
          For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2019, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved.
        </div>
</footer><br xmlns:html="http://www.w3.org/1999/xhtml" /></body></html>