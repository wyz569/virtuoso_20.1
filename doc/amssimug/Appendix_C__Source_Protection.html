
<html><head><title>Appendix C: Source Protection</title>
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="jaini" />
<meta name="CreateDate" content="2019-11-04" />
<meta name="CreateTime" content="1572864950" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes the Virtuoso AMS Designer simulator, a mixed-signal simulator that supports the Verilog-AMS and VHDL-AMS language standards." />
<meta name="DocTitle" content="Spectre AMS Designer and Xcelium Simulator Mixed-Signal User Guide" />
<meta name="DocType" content="User Guide" />
<meta name="FileTitle" content="Appendix C: Source Protection" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="prod_feature" content="" />
<meta name="prod_subfeature" content="" />
<meta name="FileType" content="Chapter" />
<meta name="Keyword" content="amssimug" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2019-11-04" />
<meta name="ModifiedTime" content="1572864950" />
<meta name="NextFile" content="Appendix_D__Using_the_Profiler.html" />
<meta name="Group" content="Analog Mixed-Signal Simulation" />
<meta name="Platform" content="Functional Verification" />
<meta name="PrevFile" content="Appendix_B__Tcl-Based_Debugging.html" />
<meta name="Product" content="Xcelium" />
<meta name="ProductFamily" content="Functional Verification" />
<meta name="ProductVersion" content="19.09" />
<meta name="RightsManagement" content="Copyright 2012-2019 Cadence Design Systems Inc." />
<meta name="Title" content="Spectre AMS Designer and Xcelium Simulator Mixed-Signal User Guide -- Appendix C: Source Protection" />
<meta name="Version" content="19.09" />
<meta name="Renderer" content="WIKI" />
<meta name="SpaceKey" content="amssimug2003" />
<meta name="confluence-version" content="6.13.3" />
<meta name="ecms-plugin-version" content="03.30.005" />

        
        <link href="styles/site.css" rel="stylesheet" type="text/css" />
        <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />
    

    </head><body style="background-color: #FFFFFF;"><!-- Begin Buttons --><header xmlns:html="http://www.w3.org/1999/xhtml"><div class="docHeadr">Product Documentation<img src="images/Cadence-Logo.jpg" /></div>
<nav class="blueHead"><ul><li><a class="content" href="amssimugTOC.html">Contents</a></li><li><a class="prev" href="Appendix_B__Tcl-Based_Debugging.html" title="Appendix_B__Tcl-Based_Debugging">Appendix_B__Tcl-Based_Debuggin ...</a></li><li style="float: right;"><a class="viewPrint" href="amssimug.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="Appendix_D__Using_the_Profiler.html" title="Appendix_D__Using_the_Profiler">Appendix_D__Using_the_Profiler</a></li></ul></nav></header><!-- End Buttons --><div xmlns:html="http://www.w3.org/1999/xhtml" style="font-size:14px;line-height:1.42857142857;margin:20px 0 0 0;font-weight:bold;"><center>Spectre AMS Designer and Xcelium Simulator Mixed-Signal User Guide<br />Product Version 19.09, September 2019</center></div>
<div xmlns:html="http://www.w3.org/1999/xhtml" style="margin-left:5%;">
<p></p>

<p></p>
<div id="main-header">
                    
                    
                                                <h1 style="margin: 4px 0 4px;"><span>Appendix C: Source Protection</span></h1>

                    
                </div>
<div class="wiki-content group" id="main-content">
                    
<p><span class="confluence-anchor-link" id="AppendixC:SourceProtection-1014265"></span></p>

<p>Spectre AMS Designer Simulator uses two different methods to protect (encrypt) source code, depending on what language you use. These two methods are similar but differ in the commands you use and in the implementation details.</p>
<div class="table-wrap"><table border="0" cellpadding="4" cellspacing="0" class="wrapped confluenceTable" style="width: 648.0px;"><colgroup><col /><col /></colgroup><tbody><tr><th class="confluenceTh" valign="middle" width="384">
<p><span>Language</span></p>
</th><th class="confluenceTh" valign="middle" width="264">
<p><span>Method for Protection</span></p>
</th></tr>
<tr><td class="confluenceTd" valign="top">
<p>Verilog-A, Verilog-AMS, Verilog (digital), VHDL-AMS, and VHDL (digital) code</p>
</td>
<td class="confluenceTd" valign="top">
<p><code><span> <a href="#AppendixC:SourceProtection-1017070">xmprotect</a></span></code></p>
</td>
</tr>
<tr><td class="confluenceTd" valign="top">
<p>Spectre code</p>
</td>
<td class="confluenceTd" valign="top">
<p><code><span> <a href="#AppendixC:SourceProtection-1017123">spectre_encrypt</a></span></code></p>
</td>
</tr>
</tbody></table></div>
<div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>You cannot probe any nets that go<span style="color: rgb(0,0,0);">&#160;through&#160;</span>an encrypted design unit.</p>
</div>
</div>

<p>You can use source protection with the following AMS Designer simulator and analog solver configurations:</p>
<ul><li>Spectre solver using the simulation front end (<a href="Elaborating.html#Elaborating-1039791">SFE</a>) parser</li></ul><ul><li>UltraSim solver&#160;<a href="Elaborating.html#Elaborating-1039791"><span>using the SFE parser </span></a></li></ul><h2 id="AppendixC:SourceProtection-Usingxmprotect1017070ncprotect">Using xmprotect<span class="confluence-anchor-link" id="AppendixC:SourceProtection-1017070"></span><span class="confluence-anchor-link" id="AppendixC:SourceProtection-ncprotect"></span></h2>

<p>When you use the&#160;<code>xmprotect</code>&#160;utility to prevent access to or modification of Verilog-AMS, Verilog (digital), VHDL-AMS, VHDL (digital), and Verilog-A source code, you can</p>
<ul><li>Protect selected design units or models</li></ul><ul><li>Protect selected regions within design units or models</li></ul><ul><li>Automatically protect all design units and models in a file</li></ul>
<p>Source protection prevents access to protected regions. When you use source protection, software or commands that normally report information that depends on code do not return any information that might reveal the contents of the protected regions. In addition, AMS either suppresses warning and error messages from protected regions or issues generic messages that do not disclose protected information. You can use the protected code as usual in the simulation flow and it produces the same results as unprotected code.</p>

<p>To protect the source description of selected modules or regions,</p>
<ol><li>Place protection pragmas in the source description to define the protected region.<br />The pragmas, which are in the form of comments, are:<br /><ul><li><code>pragma protect<br /></code><span style="color: rgb(0,0,0);">Indicates the start of a protection block. Used in conjunction with </span><code>pragma protect begin</code>.</li><li><code>pragma protect begin<br /></code><span style="color: rgb(0,0,0);">Indicates the start of the data to be encrypted.</span></li><li><code>pragma protect end<br /></code><span style="color: rgb(0,0,0);">Indicates the end of the data to be encrypted.</span></li></ul>
<p>For information about inserting the protection pragmas in your source code, see&#160;<a href="#AppendixC:SourceProtection-1017093">&quot;Using the Protection Pragmas&quot;</a>.</p>
</li><li>Run the <code>xmprotect</code>&#160;command on the input files containing the regions to be protected.<br /><br />This command creates a new source file in which the regions marked for protection are unreadable. By default, the new file has the same name as the original file, but with an <code>appended p</code>.<br /><br />Ensure that the encrypted file is not changed after it is generated, perhaps by making the file read only. Changing the encrypted code by hand corrupts the file, causing error messages such as the following:<br /><br /><code> Error while decrypting : Corrupted encrypted block, checksum did not match<br /></code>If you get such an error, you can resolve the problem by recreating or reinstalling the protected code.</li></ol>
<p>To use the protected modules, you run the compiler as usual. The compiler decrypts the encrypted files and compiles the design units in the file. You can then elaborate the design and simulate the snapshot. Downstream programs provide restricted visibility and access to the protected units.</p>
<h3 id="AppendixC:SourceProtection-1017093UsingtheProtectionPragmas"><span class="confluence-anchor-link" id="AppendixC:SourceProtection-1017093"></span>Using the Protection Pragmas</h3>

<p>You use the protection pragmas to mark regions for protection in Verilog-AMS, Verilog (digital), VHDL-AMS, and VHDL (digital) code and Verilog-A code in your model files.</p>

<p>You can use the protection pragmas <code>protect begin</code>&#160;and <code>protect end</code>&#160;inside or outside of design units, provided that you pair each <code>protect begin</code>&#160;pragma with a <code>protect end</code>&#160;pragma in the same source file. If you insert a <code>protect begin</code>&#160;pragma without a corresponding <code>protect end</code>&#160;pragma, the software issues a warning and encrypts everything remaining in the file.</p>

<p>You can use multiple sets of the <code>protect begin</code>&#160;and <code>protect end </code>pragmas within design units. However, you cannot nest blocks of source code bounded by<code> protect begin </code>and<code> protect end </code>pragmas inside one another.</p>
<div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>The following tasks do nothing when they are located inside an area that is protected: <code>$strobe</code>,<code>&#160;$fstrobe</code>,<code>&#160;$display</code>,<code>&#160;$fdisplay</code>,<code>&#160;$debug</code>,<code>&#160;$fdebug</code>,<code>&#160;$write</code>,&#160;<code>$fwrite</code>.</p>
</div>
</div>

<p><br />The following two examples show how to use the <code>protect begin</code>&#160;and <code>protect end</code>&#160;pragmas in a source file. The first example shows how to mark a region in the module <code>top_design</code>&#160;for protection:&#160;<span class="confluence-anchor-link" id="AppendixC:SourceProtection-1018616"></span><span class="confluence-anchor-link" id="AppendixC:SourceProtection-firstexample"></span></p>

<p><code> module top_design (a, b, c)<br />&#160;&#160;&#160;&#160;bottom inst ();<br />//&#160;&#160;pragma protect<br />//&#160;&#160;pragma protect begin<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;initial<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;$display (&quot;Inside module top_design&quot;);<br />//&#160;&#160;pragma protect endendmodule </code></p>

<p>This next example shows how to mark an entire module, including the module name, for protection:</p>

<p><code> // pragma protect<br />// pragma protect begin<br /> &#160;&#160;&#160;&#160;module bottom ();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;initial<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;begin<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;$display (&quot;Inside module bottom&quot;);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;endmodule<br /> // pragma protect end </code></p>

<p>The next example illustrates how to protect a region in a VHDL description:</p>

<p><code> architecture behavior of myblock is<br />-- pragma protect<br />-- pragma protect begin<br />SIGNAL s: bit:= &#39;0&#39;; </code></p>

<p><code> BEGIN<br />&#160;&#160;&#160;&#160;digital: process (s)<br />&#160;&#160;&#160;&#160;BEGIN<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;s &lt;= NOT s after 1 ms;<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;REPORT &quot;s=&quot; &amp; bit.image(s);<br />&#160;&#160;&#160;&#160;END PROCESS digital;<br />END behavior;<br />-- pragma protect end<br />END myblock; </code></p>
<h3 id="AppendixC:SourceProtection-ThexmprotectCommand">The xmprotect Command</h3>

<p>The <code>pragma protect</code>,<code> protect begin</code>, and <code>protect end</code>&#160;pragmas mark the regions you want to protect; encryption actually occurs when you run the <code>xmprotect</code>&#160;command on the source description files. The syntax of the <code>xmprotect</code>&#160;command is as follows:</p>

<p><code><span style="color: rgb(0,0,0);font-family: &quot;Courier New&quot;;font-size: small;">xmprotect [- options ] hdl_source_file [ hdl_source_file...]<br />[-APpend_log]<br />[-AUtoprotect]<br />[-Extension output_file_extension]<br />[-File filename]<br />[-Help]<br />[-LAnguage {vlog | vhdl}]<br />[-LOgfile logfile_name]<br />[-Messages]<br />[-NOCopyright]<br />[-NOLog]<br />[-NOStdout]<br />[-Overwrite]<br />[-Version]</span></code></p>

<p>For complete information, and many examples, see<span style="color: rgb(0,0,255);"><a class="message-url" href="../IPProtect/IP_Protection.html#ncprotect">&quot;xmprotect&quot;</a></span>in the<em><span style="color: rgb(0,0,0);"> Protecting IP Source Files </span></em>book.</p>

<p>Processing a source description with the <code>xmprotect</code>&#160;command generally protects only the regions marked with <code>protect begin</code>&#160;and <code>protect end</code>&#160;pragmas. The command creates a new source file that differs from the original file in the following ways:</p>
<ul><li>The pragmas <code>protect begin</code>&#160;and <code>protect end</code>&#160;become <code>protect begin_protected</code>&#160;and&#160;<code>protect end_protected</code>, respectively. The software adds other pragmas for the encryption.</li><li>The regions you marked for protection in the original source description become unreadable.</li></ul>
<p>The protected version of the<a href="#AppendixC:SourceProtection-1018616"> first example </a>in the previous section takes the following form, allowing read access to the first two lines while encrypting the remainder of the module:</p>

<p><code> module top_design (a, b, c) // readable<br />    bottom inst ();&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;// readable<br />//pragma protect begin_protected<br />//pragma protect key_keyowner=Cadence Design Systems.<br />//pragma protect key_keyname=CDS_KEY<br />//pragma protect key_method=RC5<br />//pragma protect key_block<br />hjQ2rsuJMpL9F3O43Xx7zf656dz2xxBxdnHC0GvJFJG3Y5HL0dSoPcLMN5Zy6Iq+ySMMWcOGkowbtoHVjNn3UdcZFD6NFlWHJpb7KIc8Php8iT1uEZmtwTgDSy64yqLLSCaqKffWXhnJ5n/936szbTSvc8vs2ILJYG4FnjIZeYARwKjbofvTgA==<br />//pragma protect end_key_block<br />//pragma protect digest_block<br />uilUH9+52Dwx1U6ajpWVBgZque4=<br />//pragma protect end_digest_block<br />//pragma protect data_block<br />jGZcQn3lBzXvF2kCXy+abmSjUdOfUzPOp7g7dfEzgN96O2ZRQP4aN7kqJOCA9shIjcvO6pnBhjaTNlxUJBSbBA==<br />//pragma protect end_data_block<br />//pragma protect digest_blockt<br />zEpxTPg7KWB9yMYYlqfoVE3lVk=<br />//pragma protect end_digest_block<br />//pragma protect end_protected<br />endmodule </code></p>

<p>The new, protected, source files do not overwrite the original, unprotected, source files. When you protect the original source file with <code>xmprotect</code>, you can specify an optional file extension you want the software to append to the name of the protected source file. If you do not specify an extension, the <code>xmprotect</code>&#160;command automatically appends a <code>p</code>&#160;to the source file name to create the protected file name.</p>

<p>For example, the following command protects the file <code>src.v.</code> By default, the software appends a<code> p </code>to the protected source file name: <code>src.vp.</code></p>

<p><code> xmprotect src.v </code></p>

<p>The following command specifies an extension<code> myext </code>for the protected version of <code>design.v: design.v.myext</code>.</p>

<p><code> xmprotect design.v -extension myext</code></p>
<div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>If the name of the protected file conflicts with the name of an existing file, the <code>xmprotect</code> command does not create the protected file; instead, it issues a message that alerts you to the conflict.</p>
</div>
</div>
<h3 id="AppendixC:SourceProtection-ProtectingAllModulesinaSourceDescription">Protecting All Modules in a Source Description</h3>

<p>The <code>xmprotect -autoprotect</code>&#160;command (which you can use for Verilog-AMS, Verilog [digital], VHDL-AMS, and VHDL [digital] code and Verilog-A code but not for Spectre code) protects all modules in the specified source file automatically. You do not need to insert the <code>protect begin</code>&#160;and <code>protect end</code>&#160;protection pragmas in any source description that you plan to compile with <code>-autoprotect</code>. If these pragmasalready exist in your source file, the <code>xmprotect -autoprotect</code>&#160;command ignores them.</p>

<p>This option is particularly useful for protecting libraries that contain a large number of files with many modules.</p>
<h2 id="AppendixC:SourceProtection-Usingspectre_encryptspectre_encrypt1017123">Using spectre_encrypt<span class="confluence-anchor-link" id="AppendixC:SourceProtection-spectre_encrypt"></span><span class="confluence-anchor-link" id="AppendixC:SourceProtection-1017123"></span></h2>

<p>Using <code>spectre_encrypt</code>, you can encrypt Spectre model files.</p>

<p>To encrypt part or all of a Spectre model file, do the following:</p>
<ol><li>Open the file in a text editor.</li><li>Type <code>protect</code>&#160;above the data you want to protect.</li><li>Type <code>unprotect</code>&#160;after the last line of the data you want to protect. You must use the <code>protect</code>&#160;and <code>unprotect</code>&#160;keywords in pairs.<br />For information about inserting the keywords in your model file, see&#160;<a href="#AppendixC:SourceProtection-1017136">&quot;Using the protect and unprotect Keywords&quot;</a>.</li><li>Save the netlist.</li><li>Run <code>spectre_encrypt</code>&#160;on the input files containing the regions to be protected.</li></ol><div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p><code>xrun</code> can process design files that contain models encrypted using <code>spectre_encrypt&#160;</code>(when subcircuit boundaries are not encrypted).&#160;<code>xrun</code>&#160;cannot process subcircuits or <a href="Preparing_the_Design__Using_Mixed_Languages.html#PreparingtheDesign:UsingMixedLanguages-1066571">SPICE-in-the-middle</a> constructs encrypted using <code>spectre_encrypt</code> because of the encrypted boundaries.</p>
</div>
</div>
<h3 id="AppendixC:SourceProtection-1017136UsingtheprotectandunprotectKeywords"><span class="confluence-anchor-link" id="AppendixC:SourceProtection-1017136"></span>Using the protect and unprotect Keywords</h3>

<p>You use the <code>protect</code>&#160;and <code>unprotect</code>&#160;keywords to mark regions for protection in Spectre model files. For example, the following code leaves the name and I/O pins public.</p>

<p><code> subckt inv out in protect<br />parameters wi=1u le=3u<br />mp1 mid in vd vd pmos w=wi l=le<br />mn1 mid in 0 0 nmos w=wi l=le<br />r1 mid out resistor r=2k<br />model pmos bsim3v3 type=p tnom=27.0 tox=2.9e-09<br />model nmos bsim3v3 type=n tnom=27.0 tox=2.8e-09<br />unprotect<br />ends </code></p>

<p>For more information and examples, see &quot;Encryption&quot; in the<span style="color: rgb(0,0,0);"><em> Spectre Circuit Simulator and Accelerated Parallel Simulator User Guide</em>.</span></p>
<h3 id="AppendixC:SourceProtection-Thespectre_encryptCommand">The spectre_encrypt Command</h3>

<p>Although the <code>protect</code>&#160;and <code>unprotect</code>&#160;keywords mark the regions of a Spectre model file that are to be protected, encryption actually occurs when you run the <code>spectre_encrypt </code>command on the source files. The syntax of the <code>spectre_encrypt</code>&#160;command is given below, but for complete information, see &quot;Encryption&quot; in the<span style="color: rgb(0,0,0);"><em> Spectre Circuit Simulator and Accelerated Parallel Simulator User Guide</em>.</span></p>

<p><span style="color: rgb(0,0,0);font-family: &quot;Courier New&quot;;font-size: small;">spectre_encrypt [-i<code> input_file </code>][-o<code> output_file </code>][-all]</span></p>

<p>where</p>
<div class="table-wrap"><table border="0" cellpadding="4" cellspacing="0" class="wrapped confluenceTable" style="width: 648.0px;"><tbody><tr><td class="confluenceTd" valign="top" width="112">
<p><code>input_file </code></p>
</td>
<td class="confluenceTd" valign="top" width="536">
<p>The path and name of the file to be encrypted. If you do not specify the input file, the standard input is encrypted.</p>
</td>
</tr>
<tr><td class="confluenceTd" valign="top">
<p><code>output_file </code></p>
</td>
<td class="confluenceTd" valign="top">
<p>The path and name of a file to hold the encrypted model. The extension that you use for <code>output_file</code> must be the same extension used on <code>input_file</code>. If you do not specify the output file, the encrypted model is displayed as standard output in the terminal window.</p>
</td>
</tr>
<tr><td class="confluenceTd" valign="top">
<p><span style="color: rgb(0,0,0);"><code>-all</code> </span></p>
</td>
<td class="confluenceTd" valign="top">
<p>Encrypts the entire Spectre model file, ignoring any <code>protect</code> and <code>unprotect</code> keywords.</p>
</td>
</tr>
</tbody></table></div>

<p>When you run <code>spectre_encrypt</code>, the <code>protect</code>&#160;and <code>unprotect</code>&#160;keywords are replaced with <code>pragma</code>&#160;statements in the output file. The <code>pragma</code>&#160;statements contain important information about encryption such as the method used, the key name, and the beginning and end of the encrypted block. The AMS Designer simulator uses this information while decrypting the netlist, so do not modify any <code>pragma</code>&#160;statements or the encrypted text between the <code>pragma</code>&#160;statements in the output file.</p>
<h2 id="AppendixC:SourceProtection-ProtectionGuidelines">Protection Guidelines</h2>

<p>Be aware of the following behaviors as you use source protection:</p>
<ul><li><a href="#AppendixC:SourceProtection-1017162"> Verilog-AMS Protection </a></li><li><a href="#AppendixC:SourceProtection-1017164"> Protection Guidelines for Automatically Inserted Connect Modules </a></li><li><a href="#AppendixC:SourceProtection-1017171"> Forced Use of CMI 3.0 </a></li></ul><h3 id="AppendixC:SourceProtection-1017162Verilog-AMSProtection"><span class="confluence-anchor-link" id="AppendixC:SourceProtection-1017162"></span>Verilog-AMS Protection</h3>

<p>It is not possible to partially protect a purely behavioral Verilog-AMS module or a Verilog-AMS module that contains both structural and behavioral information--if you protect anything in such a module, the entire module is protected. However, it remains possible to use Tcl or <a href="Glossary.html#Glossary-1035631">VPI</a>&#160;to create a probe or to access values in the regions of the module that are not explicitly protected.</p>
<h3 id="AppendixC:SourceProtection-1017164ProtectionGuidelinesforAutomaticallyInsertedConnectModules"><span class="confluence-anchor-link" id="AppendixC:SourceProtection-1017164"></span>Protection Guidelines for Automatically Inserted Connect Modules</h3>

<p>Automatically-inserted connect modules (AICMs) behave as follows:</p>
<ul><li>If the instance master for an AICM is protected, the instances of that master are also protected.</li><li>If an AICM instance is connected to a protected net, the AICM instance is protected.</li><li>If an AICM instance is within a protected instance, the AICM instance is protected.</li><li>If an AICM instance is connected to an implicit net (a net that is undeclared), the AICM instance is protected if the net is protected. If the net is not protected, the AICM instance is not protected.</li><li>All information related to a protected AICM instance is blocked.</li></ul><h3 id="AppendixC:SourceProtection-1017171ForcedUseofCMI3.0"><span class="confluence-anchor-link" id="AppendixC:SourceProtection-1017171"></span>Forced Use of CMI 3.0</h3>

<p>You can use only a <a href="Glossary.html#Glossary-1034535">CMI</a>&#160;3.0 device library or a device library compatible with CMI 3.0 in conjunction with source protection. Using an incompatible library in conjunction with source protection causes the simulator to stop immediately during initialization.</p>
<h2 id="AppendixC:SourceProtection-ObsoleteApproachforSourceProtection">Obsolete Approach for Source Protection</h2>

<p>This section describes an obsolete method of protecting source code, which Cadence supports for compatibility with existing designs. With this approach, you can</p>
<ul><li>Protect selected modules or regions within modules</li><li>Automatically protect all modules</li></ul><h3 id="AppendixC:SourceProtection-ProtectingSelectedRegionsinaSourceDescription">Protecting Selected Regions in a Source Description</h3>

<p>To protect the source description of selected modules or regions, follow these steps:</p>
<ol><li>Place two compiler directives in the source description to define the protected region:<br /><code> `protect </code>marks the beginning of the protected region; <code>`endprotect</code>&#160;marks the end of the protected region.</li><li>Create a copy, with a different name, of the source description file.<br />This file serves as a back-up.</li><li>Protect the original Verilog-AMS source description file with the command<br /><br /><code>verilog<code style="color: rgb(0,0,0);"> orig_source_file </code><span style="color: rgb(0,0,0);">+protect</span></code><br />This command creates a new source file in which the regions marked for protection are unreadable. By default, the new file has the same name as the original file, but with an appended <code>p</code>.</li><li>Rename the newly created file, giving it the name of the original source file.<br /><br />This step makes the protected modules available to the AMS software.</li></ol><h4 id="AppendixC:SourceProtection-The`protectand`endprotectCompilerDirectives">The `protect and `endprotect Compiler Directives</h4>

<p>You can use the compiler directives <code>`protect</code>&#160;and&#160;<code>`endprotect</code>&#160;inside or outside a module, provided that you pair each&#160;<code>`protect</code>&#160;directive with an <code>`endprotect</code>&#160;directive in the same source file. If you insert a <code>`protect</code>&#160;directive without a corresponding <code>`endprotect</code>&#160;directive, the compilation appears successful. However, when you recompile the protected source file, an error occurs.</p>

<p>You can use multiple sets of the&#160;<code>`protect</code>&#160;and <code>`endprotect</code>&#160;directives within modules. However, you cannot nest blocks of source code bounded by&#160;<code>`protect</code>&#160;and&#160;<code>`endprotect</code>&#160;directives inside one another.</p>

<p>The following two examples show how to use the <code>`protect</code>&#160;and <code>`endprotect</code>&#160;compiler directives in a source file. In the first example, the module <code>top_design</code>&#160;contains a region that is marked for protection.</p>

<p><code> module top_design (a, b, c)<br />&#160;&#160;&#160;&#160;bottom inst ();<br />&#160;&#160;&#160;&#160;`protect<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;initial<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;$display (&quot;Inside module top_design&quot;);<br />&#160;&#160;&#160;&#160;`endprotectendmodule </code></p>

<p>In the next example, the entire module, including the module name, is marked for protection.</p>

<p><code> `protect<br /> &#160;&#160;&#160;&#160;module bottom ();<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;initial<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;begin<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;$display (&quot;Inside module bottom&quot;);<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;end<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;endmodule<br /> `endprotect </code></p>
<h4 id="AppendixC:SourceProtection-The+protectCommand-LineOption">The +protect Command-Line Option</h4>

<p>Although the <code>`protect</code>&#160;and <code>`endprotect</code>&#160;directives mark the regions to be protected in your source description, the protection actually occurs when you protect the source file with the&#160;<code>verilog +protect</code>&#160;command. For example, the following example uses the <code>verilog +protect</code>&#160;command to protect several Verilog-AMS source files:</p>

<p><code> verilog src4.v src5.v src6.v +protect </code></p>

<p>Compiling a source description with the <code>verilog +protect</code>&#160;command protects only the regions marked with <code>`protect</code>&#160;and <code>`endprotect</code>&#160;compiler directives. The compiler creates a new source file that differs from the original file in the following ways:</p>
<ul><li>The directives <code>`protect</code>&#160;and <code>`endprotect</code>&#160;become <code>`protected</code>&#160;and <code>`endprotected</code>&#160;respectively.</li><li>The regions marked for protection in the original source description become unreadable.</li></ul>
<p>After the files in the previous two examples are compiled for protection, they take the following forms.</p>

<p><code> module top_design (a, b, c);<br />&#160;&#160;&#160;&#160;bottom inst ();<br />&#160;&#160;&#160;&#160;`protected<br />&#160; a*lejodi)dlj@lsfj4gRekv*9l#sIjnd&lt;;pXywUHvow%emhiITvne(@mengTVpe<br />&#160; prK58s53&lt;gf:dneURtnd&amp;8ejsWqpsu*ehtsY=wkxOrkp$<br />&#160;&#160;&#160;&#160;`endprotected<br />endmodule </code></p>

<p><code> `protected<br />&#160; fkeop*456gjkl@%^&amp;^&amp;s85Kfmv(:wjvdwLSchrmx*2uPQjsu=:wucgwigIWsuxnt<br />&#160; pr&quot;W84&amp;@(shxjMvn02:wjd8%&amp;!0s$<br />`endprotected </code></p>

<p>The new, protected source file does not overwrite the original, unprotected source file. When you compile the original source file with <code>verilog +protect</code>, you can specify an optional file extension to be automatically appended to the name of the protected source file. If you do not specify an extension, the <code>verilog +protect</code>&#160;command automatically appends a <code>p</code>&#160;to the name of the protected file.</p>

<p>For example, the following command line protects the file <code>src.v.</code> Because no extension is specified, the command produces a protected file called <code>src.vp.</code></p>

<p><code> verilog src.v +protect </code></p>

<p>The following command line specifies an extension<code> .myext </code>to be appended to the file<code> design.v.</code> As a result, the<code> verilog </code>command generates a protected source file called<code> design.v.myext.</code></p>

<p><code> verilog design.v +protect.myext</code></p>
<div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>If the name of the protected file conflicts with the name of an existing file, the <code>verilog</code> command does not create the protected file; instead, it issues a message that alerts you to the conflict.</p>
</div>
</div>
<h3 id="AppendixC:SourceProtection-ProtectingAllModulesinaSourceDescription.1">Protecting All Modules in a Source Description</h3>

<p>The <code>verilog +autoprotect</code>&#160;command protects all modules in the specified source file automatically. You do not need to insert the <code>`protect</code>&#160;and <code>`endprotect</code>&#160;compiler directives in any source description that you plan to compile with +<code>autoprotect</code>. If these directivesalready exist in your source file, the <code>verilog +autoprotect</code>&#160;command ignores them</p>

<p>This option is particularly useful for protecting libraries that contain a large number of files with many modules. Compiling a source file with <code>verilog </code><code> +autoprotect</code>&#160;creates a new source file that differs from the original source file in the following ways:</p>

<p>The directive&#160;<code>`protected</code>&#160;is inserted after all module names, immediately before their port and terminal lists.</p>

<p>The source descriptions inside all modules become unreadable.</p>

<p>The <code>`endprotected</code>&#160;directive is inserted just before the <code>endmodule</code>&#160;keyword in modules.</p>

<p>To see how compiling with <code>+autoprotect</code>&#160;alters a source file, consider the following source code:</p>

<p><code> module top_design (a, b, c);<br />&#160;&#160;&#160;&#160;input a,b;<br />&#160;&#160;&#160;&#160;output c;<br />&#160;&#160;&#160;&#160;initial<br />&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;$display (&quot;Inside module top_design&quot;);<br />endmodule </code></p>

<p>Compiling the previous module example with <code>+autoprotect</code>&#160;creates the protected file shown in the following example:</p>

<p><code> module top_design `protected a%jioDT:3e(prlXCWN67suwOpw%3(j&amp;ls)?l<br /> j8wPQhsmchALsxy23XM#&amp;0):3Wbv<br />9DwoPs,x&gt;s:2yTJfSlsBx,&gt;?uri839tkd%whfx8$<br />`endprotected endmodule </code></p>

<p>Notice that the module name and the keywords <code>module</code>&#160;and <code>endmodule</code>&#160;remain outside the protected region. Anything following the module name--typically from the port list onward--is protected. Protection ends prior to the keyword <code>endmodule</code>&#160;to make it easier to scan files during library searches.</p>

<p>The new, protected source file does not overwrite the original, unprotected source file. When you compile the original source file with <code>verilog +autoprotect</code>, you can specify an optional file extension to be automatically appended to the name of the protected source file. If you do not specify an extension, the v<code>erilog +autoprotect</code>&#160;command automatically appends a <code>p</code>&#160;to the name of the protected file.</p>

<p>For example, the following command line protects the file <code>design.v.</code></p>

<p><code> verilog design.v +autoprotect.protall </code></p>

<p>Because the extension <code>.protall</code>&#160;is specified, this command produces a file called <code>design.v.protall</code>, in which all modules are protected.</p>

<p>The next example uses <code>+autoprotect</code>&#160;to protect multiple Verilog-AMS source files.</p>

<p><code> verilog src1.v src2.v src3.v +autoprotect </code></p>

<p>Because no extension is specified, the default extension is used and the files of protected modules are called <code>src1.vp</code>,<code> src2.vp</code>, and <code>src3.vp</code>.</p>
<div class="confluence-information-macro confluence-information-macro-note"><span class="aui-icon aui-icon-small aui-iconfont-warning confluence-information-macro-icon"></span><div class="confluence-information-macro-body">
<p>If the name of a protected file conflicts with the name of an existing file, the <code>verilog +autoprotect</code> command does not create the protected file; instead, it issues a message that alerts you to the conflict.</p>
</div>
</div>

                    </div>
<br /><br /></div>
<footer xmlns:html="http://www.w3.org/1999/xhtml"><nav class="navigation"><b><em><a href="Appendix_B__Tcl-Based_Debugging.html" id="prev" title="Appendix_B__Tcl-Based_Debugging">Appendix_B__Tcl-Based_Debuggin ...</a></em></b><b><em><a href="Appendix_D__Using_the_Profiler.html" id="nex" title="Appendix_D__Using_the_Profiler">Appendix_D__Using_the_Profiler</a></em></b></nav><div>
          For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2019, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved.
        </div>
</footer><br xmlns:html="http://www.w3.org/1999/xhtml" /></body></html>