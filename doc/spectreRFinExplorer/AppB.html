
<html><head><title>Top-down RF Design Methodology</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="jommy" />
<meta name="CreateDate" content="2020-06-25" />
<meta name="CreateTime" content="1593085250" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Provides user information for Spectre Circuit Simulator and Accelerated Parallel Simulator RF Analysis" />
<meta name="DocTitle" content="Spectre Circuit Simulator and Accelerated Parallel Simulator RF Analysis in ADE Explorer User Guide" />
<meta name="DocType" content="User Guide" />
<meta name="FileTitle" content="Top-down RF Design Methodology" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-3.2.1" />
<meta name="Keyword" content="spectreRFinExplorer" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2020-06-25" />
<meta name="ModifiedTime" content="1593085250" />
<meta name="NextFile" content="AppC.html" />
<meta name="Group" content="SpectreRF" />
<meta name="Platform" content="Custom IC Design" />
<meta name="PrevFile" content="Chap9.html" />
<meta name="c_product" content="Spectre" />
<meta name="Product" content="Spectre" />
<meta name="ProductFamily" content="Spectre" />
<meta name="ProductVersion" content="19.1" />
<meta name="RightsManagement" content="Copyright 2012-2020 Cadence Design Systems Inc." />
<meta name="Title" content="Spectre Circuit Simulator and Accelerated Parallel Simulator RF Analysis in ADE Explorer User Guide -- Top-down RF Design Methodology" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="prod_feature" content="" />
<meta name="prod_subfeature" content="" />
<meta name="Version" content="19.1" />
<meta name="SpaceKey" content="spectreRFinExplorer191" />
<meta name="webflare-version" content="2.0" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" /></head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="spectreRFinExplorerTOC.html">Contents</a></li><li><a class="prev" href="Chap9.html" title="Cosimulation with MATLAB ...">Cosimulation with MATLAB ...</a></li><li style="float: right;"><a class="viewPrint" href="spectreRFinExplorer.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="AppC.html" title="Documents That Ship in the Software Hierarchy">Documents That Ship in the Sof ...</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Spectre Circuit Simulator and Accelerated Parallel Simulator RF Analysis in ADE Explorer User Guide<br />Product Version 19.1, June 2020</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;"><a name="#firstpage"></a>

<h1>10
<a id="pgfId-1065082"></a></h1>
<h1>
<a id="pgfId-1065083"></a><hr />
Top-down RF Design Methodology<hr />
</h1>

<p>
<a id="pgfId-1065319"></a>This section describes a methodology for designing analog RF subsystems that fit into larger DSP systems. In particular, this section describes how to use a canonical set of top-down behavioral baseband models for exploring RF architectures in the analog design environment. These models come from the following categories in <em>rfLib</em></p>
<ul><li>
<a id="pgfId-1065320"></a>Category <em>top_dwnBB</em> contains models of common RF function blocks.<ul><li>
<a id="pgfId-1065321"></a>The default view of each model is the baseband view (called <em>veriloga</em>).</li><li>
<a id="pgfId-1065322"></a>All models in this category also have a differential passband view (called <em>veriloga_PB</em>).</li></ul><br />
<a id="pgfId-1065323"></a>The only exceptions are the BB_loss and VGA_BB models. They are meant only for baseband analysis and have no passband view.</li><li>
<a id="pgfId-1065324"></a>Category <em>top_dwnPB</em> contains single-ended passband versions of the baseband models.</li><li>
<a id="pgfId-1065325"></a>Category <em>measurement</em> contains the instrumentation block and baseband signal generator models used to make RF measurements. These elements are not part of an RF architecture. They simply facilitate RF measurements and diagnostics.</li><li>
<a id="pgfId-1065326"></a>Category <em>testbenches</em> contains the test circuits used in this chapter to define the model specifications in the <em>rfLib</em>. Where possible, the models are specified in terms of standard RF measurements. The most precise way to describe a measurement is with a test circuit, set up instructions, and sample measurements. The circuits in the testbenches category serve that purpose</li></ul>






<p>
<a id="pgfId-1065327"></a>These models provide RF designers with a fast method to map RF system specifications into detailed RF designs. The baseband models facilitate fast evaluation of candidate RF architectures specified with DSP metrics. The passband views of the baseband models provide a behavioral system testbench for checking detailed designs of individual RF system components.</p>
<p>
<a id="pgfId-1065328"></a>Baseband models are behavioral models and all behavioral models sacrifice some accuracy for increased simulation speed. Such sacrifices are usually acceptable in architectural studies because many implementation-dependent details do not affect high level decisions. The modeling approach taken in top-down design is to simulate only those effects that drive the decisions at hand.</p>
<p>
<a id="pgfId-1065329"></a>Baseband modeling in no way replaces passband modeling. Some effects missed by equivalent baseband models can affect high level decisions. However, the application of baseband models early and passband models later minimizes the number of slow simulations needed at the lower levels of design abstraction. Baseband models help you to quickly weed out designs that would surely fail tests simulated with passband models.</p>
<p>
<a id="pgfId-1065330"></a>The success of a modeling approach to top-down design hinges on knowing how the models fit into the design flow and knowing exactly what each modeling parameter means. This chapter has two goals:</p>
<ul><li>
<a id="pgfId-1065331"></a>To describe the top-down design flow, from a modeling perspective, for baseband modeling</li><li>
<a id="pgfId-1065332"></a>To define, as clearly and concisely as possible, the parameters that specify the models</li></ul>


<h2>
<a id="pgfId-1065334"></a><a id="73627"></a>Top-Down Design of RF Systems</h2>

<p>
<a id="pgfId-1065335"></a>Ideally, the digital signal processing, or DSP, team specifies an RF subsystem that fits snugly into the DSP system. A <em>snug fit</em> means that</p>
<ul><li>
<a id="pgfId-1065336"></a>The specified RF subsystem does exactly what it needs to do at the lowest possible cost</li><li>
<a id="pgfId-1065337"></a>A functional specification exists that describes requirements for the RF subsystem</li></ul>

<p>
<a id="pgfId-1065341"></a>In a top down design flow like the one shown in <a href="AppB.html#26141">Figure&#160;10-1</a>, the DSP team writes a functional specification for an RF subsystem that has not yet been designed. The functional specification describes what the RF subsystem should and should not do without describing how to build the RF subsystem.</p>
<p>
<a id="pgfId-1065342"></a>The functional specification supplied by the DSP team describes the RF subsystem at the highest possible level of abstraction. At this point behavioral models can be specified rather than measured. This early in the design cycle, the functional specification might well be incomplete or inconsistent. A good top-down design flow can detect problems, such as omissions and inconsistencies in the design, early in the design cycle when they are easier and less expensive to fix. Problems detected later in the design cycle can be much more costly and very difficult to resolve.</p>
<p>
<a id="pgfId-1065343"></a>Using the functional specification supplied by the DSP team and the behavioral baseband models from <em>rfLib</em>, the RF system designers can easily explore RF architectures in the analog design environment. The baseband models facilitate fast evaluation of candidate RF architectures specified with DSP metrics. By switching to the passband views of the baseband models, the RF design team maps DSP measurements to RF measurements. The passband views of the baseband models provide a behavioral system testbench for checking detailed designs for individual system components.</p>
<p>
<a id="pgfId-1065344"></a>Using the functional specification and exploring and testing with the baseband and passband models, the RF team can efficiently create a detailed design specification that fully describes the RF subsystem. The design specification can include detailed instructions for building the RF subsystem. At this stage of the design cycle, everything that is known about the design is described at the lowest level of abstraction.</p>
<p>
<a id="pgfId-1065345"></a>You can now extract behavioral models of a detailed design from simulated measurements. The problem remains that detailed designs usually do not exist until the project is complete. To jump directly to a detailed design implies that the design flow is bottom up. Bottom up flows are important in many projects, but not in all.</p>
<p>
<a id="pgfId-1065346"></a>DSP and RF designers sometimes have trouble communicating through specifications because the two groups deal with different metrics. For example, DSP designers deal with <em>bit error rates</em> and <em>error vector magnitude statistics</em> whereas RF designers deal with <em>intercept points</em> and <em>noise figures</em>.</p>
<p>
<a id="pgfId-1065347"></a>The new models described here are designed to help RF system designers in two ways.</p>
<ul><li>
<a id="pgfId-1065348"></a>First, the baseband models enable RF system designers to quickly explore the RF architectural space, as specified by the DSP metrics, while letting the RF engineers specify the RF system components with RF metrics. The circuit implementations of the RF system components are easier to design and test when the components are specified with standard RF metrics.</li><li>
<a id="pgfId-1065349"></a>Second, the baseband models can be switched quickly to a passband views where the RF system model can generate end-to-end RF metrics. With end-to-end metrics, the new view can quickly simulate how the detailed design of a particular RF system component affects end-to-end performance.</li></ul>


<h3>
<a id="pgfId-1065350"></a>Use Model for Top Down Design</h3>

<p>
<a id="pgfId-1065351"></a>The following steps outline the RF design process with focus on the early phases of the design as illustrated in <a href="AppB.html#26141">Figure&#160;10-1</a>.</p>

<p><strong>Figure 10-1
<a id="pgfId-1065356"></a><a id="26141"></a>The Top Down Design Flow and Use Model</strong></p>
<p>
<a id="pgfId-1065360"></a><code></code></p>
<div class="webflare-div-image">
<img src="images/13-1flow.gif" /></div>
<h4>
<a id="pgfId-1065361"></a>Specify the RF Subsystem in Terms of DSP Metrics</h4>

<p>
<a id="pgfId-1065362"></a>Before you begin the RF subsystem top-down design flow, the DSP design team should completely specify the RF subsystem in terms of DSP metrics. This preliminary step distinguishes the end of the DSP design flow from the beginning of the RF top down design flow and formally hands-off the RF subsystem design specifications to the RF design team.</p>

<h4>
<a id="pgfId-1065363"></a>Explore Candidate Architectures with Baseband Models</h4>

<p>
<a id="pgfId-1065364"></a>The first step in top down RF design is to select a candidate RF architecture. An RF architecture is a set of interconnected RF function blocks that, taken together, describe how a receiver or transmitter operates. You specify each function block in terms of standard RF metrics such as IP3, gain, bandwidth, and noise figure.</p>
<p>
<a id="pgfId-1065365"></a>The models you use early in the design cycle as you explore candidate RF architectures must run fast. Each simulations can span hundreds of symbols and each symbol can easily span thousands of RF carrier cycles. The space defined by the function block specifications in each candidate architecture is far too vast to explore with slow, highly precise models. Models used for architectural exploration must quickly reduce the design space down to a size that can be explored with more precision.</p>
<p>
<a id="pgfId-1065366"></a>The most efficient models for architectural exploration suppress the RF (IF) carrier and are called <em>baseband</em> models. In contrast, the <em>passband</em> models (introduced in the next step) do not suppress carriers.</p>
<p>
<a id="pgfId-1065367"></a>You can use the Circuit Optimizer during architectural exploration to help balance the function block specifications for a candidate architecture. For example, you can use the Circuit Optimizer to minimize RMS EVM while ensuring that other measurements stay within acceptable limits.</p>
<p>
<a id="pgfId-1065368"></a>When you have determined the nominal specifications for each function block, you must put tolerances around them. In the analog world <em>specifications without tolerances are meaningless</em>. The tolerance space is usually explored with some mix of experience, feasibility, a variety of analyses, and outright arbitrary decisions.</p>
<p>
<a id="pgfId-1065369"></a>There are several ways that you can use the baseband models to test candidate tolerances as well as to determine some tolerances analytically.</p>
<p>
<a id="pgfId-1065370"></a>One way to test a candidate set of tolerances is to run a Monte Carlo analysis on the metric of interest, like RMS, EVM, or signal-to-noise ratio (SNR).</p>
<p>
<a id="pgfId-1065371"></a>Another approach is to use the Circuit Optimizer <em>in reverse</em>, as a de-optimizer, to determine worst case performance.</p>
<p>
<a id="pgfId-1065372"></a>Yet another approach is to compute each tolerance separately from a parametric plot. When you have determined all but 2 or 3 tolerances, you can use a multidimensional parametric analysis to map out the performance space and easily identify the remaining tolerances.</p>

<h4>
<a id="pgfId-1065373"></a>Switch to Passband Models and Create an RF System Testbench</h4>

<p>
<a id="pgfId-1065374"></a>The second step in top down RF design is to create a passband view of the system model.</p>
<p>
<a id="pgfId-1065375"></a>The passband system model performs two functions:</p>
<ul><li>
<a id="pgfId-1065376"></a>Confirms that the filters perform as expected.</li><li>
<a id="pgfId-1065377"></a>Creates an end-to-end testbench that you can use to design the individual function blocks.</li></ul>

<p>
<a id="pgfId-1065378"></a>For computational efficiency during system passband testing, at any one time, model one or two selected function blocks at the device level. Model all other blocks in the system behaviorally using passband models.</p>
<p>
<a id="pgfId-1065379"></a>Derive the tolerances by performing the same Monte Carlo analysis or Circuit Optimizer analysis you used to test the function block tolerances in the first step, but this time replace the DSP metrics with end-to-end RF metrics. After you know how far the end-to-end RF metrics can vary, you can insert a device-level model of a function block into the testbench to see how close it drives the system toward violating a derived end-to-end RF specification.</p>

<h4>
<a id="pgfId-1065380"></a>Implement the Function Blocks with Active and Passive Devices</h4>

<p>
<a id="pgfId-1065381"></a>The last step in the top down design process is to implement the function blocks with device models. Because the function blocks are specified in terms of standard RF metrics, you can easily measure the modeling parameters to make sure they fall within the specified tolerances. You can also insert the measured parameters back into the baseband model of the system to check the DSP metrics, or insert the device-level model directly into the passband testbench to check the derived end-to-end RF specifications.</p>

<h2>
<a id="pgfId-1065382"></a>Baseband Modeling</h2>

<p>
<a id="pgfId-1065383"></a>A baseband model for an RF function block simulates what happens to the baseband representation of a signal as it passes through the block. A baseband model maps input baseband signal trajectories into output baseband signal trajectories. If you sample a baseband signal periodically in time and plot the samples in the complex plane, the resulting scatter plot shows the symbol constellation.</p>
<p>
<a id="pgfId-1065387"></a><a href="AppB.html#24886">Figure&#160;10-2</a> mathematically defines a baseband representation of a passband signal. The <em>i </em>and <em>q</em> signals are the real and imaginary parts of a complex signal that rides on the two phases of an RF carrier.</p>

<p><strong>Figure 10-2
<a id="pgfId-1065389"></a><a id="24886"></a>Baseband Representation of a Passband Signal</strong></p>
<p>
<a id="pgfId-1065393"></a></p>
<div class="webflare-div-image">
<img src="images/13-2bbModels.gif" /></div>

<p>
<a id="pgfId-1065394"></a>Baseband models simulate only what happens to the carrier fundamental. Consequently, they only account for non-linearities with odd symmetry. Non-linearities with even symmetry produce no output at the carrier fundamental; they affect the carrier fundamental only when cascaded. For example, a second order non-linearity in one block can create a DC offset at it&#8217;s output. Upon passing through a subsequent block with another second order non-linearity, the DC offset can mix with the carrier to affect the output carrier fundamental. You should model cascaded blocks producing unfiltered even harmonics as a single baseband model rather than as separate baseband models cascaded together. The non-linearities that most often dominate performance have odd symmetry.</p>

<h3>
<a id="pgfId-1065395"></a>Example Comparing Baseband and Passband Models</h3>

<p>
<a id="pgfId-1065396"></a>The example in this section walks you through an Envelope analysis that illustrates the relationship between baseband and passband models. Following the simulation, you plot the baseband equivalent output signals as computed by the baseband and passband circuits.</p>
<p>
<a id="pgfId-1065400"></a>The <em>BB_test_bench </em>schematic shown in <a href="AppB.html#16286">Figure&#160;10-3</a> illustrates the difference between passband and baseband modeling. This circuit is located in the <em>rfExamples</em> library.</p>

<p><strong>Figure 10-3
<a id="pgfId-1065402"></a><a id="16286"></a>The BB_test_bench Schematic</strong></p>
<p>
<a id="pgfId-1065406"></a></p>
<div class="webflare-div-image">
<img src="images/Figure_1-3.gif" /></div>

<p>
<a id="pgfId-1065407"></a>The <em>BB_test_bench</em><code> </code>circuit shows a passband circuit (across the top of the schematic) and its baseband equivalent circuit (across the bottom of the schematic). The same baseband signals drive both circuits but only the passband circuit mixes the baseband signals up to RF. The power amplifier is not matched to either input or output impedances and both impedances are reactive.</p>
<p>
<a id="pgfId-1065409"></a>Before you start, perform the setup procedures described in <h-hot>Chapter 3</h-hot>.</p>

<h4>
<a id="pgfId-1065410"></a>Opening the Baseband Test Bench Circuit</h4>

<ol><li>
<a id="pgfId-1065411"></a>In the CIW, choose <em>File &#8211; Open</em>.<br />
<a id="pgfId-1065412"></a>The Open File form appears.</li><li>
<a id="pgfId-1065413"></a>In the Open File form,<ol><li>
<a id="pgfId-1065414"></a>Choose<em> rfExamples</em> in the <em>Library Name</em> cyclic field. (Choose the editable copy of <em>rfExamples</em> you created as described in Chapter 3.)</li><li>
<a id="pgfId-1065416"></a>Choose <em>BB_test_bench</em> in the <em>Cell Names</em> list box. Note that the <em>View Name</em> cyclic field displays <em>Schematic</em>.</li><li>
<a id="pgfId-1065417"></a>The completed Open File form appears like the one below.<br />
<a id="pgfId-1065421"></a><div class="webflare-div-image">
<img width="619" height="429" src="images/AppB-5.gif" /></div></li></ol></li><li>
<a id="pgfId-1065422"></a>Click <em>OK</em>.<br />
<a id="pgfId-1065423"></a>The Schematic window for the <em>BB_test_bench</em> appears.</li><li>
<a id="pgfId-1065424"></a>In the Schematic window, choose <em>Tools &#8211; Analog Environment</em>.<br />
<a id="pgfId-1065425"></a>The ADE window opens.<br />
<a id="pgfId-1065429"></a><div class="webflare-div-image">
<img width="646" height="459" src="images/AppB-6.gif" /></div>
<a id="pgfId-1065430"></a>You can also choose <em>Tools &#8211; Analog Environment &#8211; Simulation</em> in the CIW to open the ADE window without opening the design. You can open the design later by choosing <em>Setup &#8211; Design</em> in the ADE window and choosing the <em>BB_test_bench </em>in the Choosing Design form.</li></ol>



















<h4>
<a id="pgfId-1065432"></a><a id="84199"></a>Choosing Simulator Options</h4>

<ol><li>
<a id="pgfId-1065433"></a>Choose <em>Setup &#8211; Simulator/Directory/Host</em> in the ADE window.<br />
<a id="pgfId-1065434"></a>The Simulator/Directory/Host form appears.</li><li>
<a id="pgfId-1065435"></a>In the Simulator/Directory/Host form, specify the following:<ol><li>
<a id="pgfId-1065436"></a>Choose <em>spectre</em> for the <em>Simulator</em>.</li><li>
<a id="pgfId-1065437"></a>Type the name of the project directory, if necessary.</li><li>
<a id="pgfId-1065438"></a>Highlight the <em>local</em>, <em>remote</em>, or <em>distributed</em> button to specify the <em>Host Mode</em>.<br />
<a id="pgfId-1065439"></a>For remote simulation, type the name of the host machine and the remote directory in the appropriate fields. For distributed simulation, fill out the other fields that appear.</li></ol><br />
<a id="pgfId-1065440"></a>The completed form appears like the one below.<br />
<a id="pgfId-1065444"></a><div class="webflare-div-image">
<img width="631" height="231" src="images/AppB-7.gif" /></div></li><li>
<a id="pgfId-1065445"></a>In the Simulator/Directory/Host form, click <em>OK</em>.</li><li>
<a id="pgfId-1065446"></a>In the ADE window, choose <em>Outputs &#8211; Save All</em><em>.</em><br />
<a id="pgfId-1065447"></a>The Save Options form appears.</li><li>
<a id="pgfId-1065448"></a>In the <em>Select signals to output (save) </em>section, be sure <em>allpub</em><em>
 
is highlighted.<br />
<a id="pgfId-1065452"></a></em><div class="webflare-div-image"><em>
<img width="634" height="571" src="images/AppB-8.gif" /></em></div></li><li>
<a id="pgfId-1065453"></a>In the Save Options form, click <em>OK</em>.</li></ol>























<h4>
<a id="pgfId-1065455"></a><a id="89927"></a>Setting Up Model Libraries</h4>

<ol><li>
<a id="pgfId-1065456"></a>In the ADE window, choose <em>Setup &#8211; Model Libraries</em>.<br />
<a id="pgfId-1065457"></a>The Model Library Setup form appears.</li><li>
<a id="pgfId-1065458"></a>In the<em> Model Library File</em> field, type the full path to the model file including the file name, <code>rfModels.scs</code>.</li><li>
<a id="pgfId-1065459"></a>In the Model Library Setup form, click <em>Add</em>.<br />
<a id="pgfId-1065460"></a>The completed form appears like the one below.<br />
<a id="pgfId-1065464"></a><div class="webflare-div-image">
<img width="646" height="261" src="images/AppB-9.gif" /></div></li><li>
<a id="pgfId-1065465"></a>In the Model Library Setup form, click <em>OK</em>.</li><li>
<a id="pgfId-1065466"></a>In the ADE window, use <em>Analysis - Disable</em> to disable any analyses you ran previously. (Check the ADE window to verify whether or not an analysis is enabled.)</li></ol>











<h4>
<a id="pgfId-1065467"></a>Setting Up the Envelope Analysis</h4>

<ol><li>
<a id="pgfId-1065468"></a>Choose <em>Analyses &#8211; Choose</em> in the ADE window.<br />
<a id="pgfId-1065469"></a>The Choosing Analyses form appears.</li><li>
<a id="pgfId-1065470"></a>In the Choosing Analyses form, click <em>envlp</em><em>.</em><ol><li>
<a id="pgfId-1065471"></a>Enter <em>ff </em>in the <em>Clock Name</em> field.</li><li>
<a id="pgfId-1065472"></a>Enter <code>10u</code> in the <em>Stop Time</em> field.</li><li>
<a id="pgfId-1065473"></a>In the <em>Output Harmonics</em> cyclic field, select <em>Number of harmonics</em>.</li><li>
<a id="pgfId-1065474"></a>Enter <code>1</code> in the <em>Number of harmonics</em> field.</li><li>
<a id="pgfId-1065475"></a>Select <em>moderate</em> for the Accuracy Defaults.</li></ol><br />
<a id="pgfId-1065476"></a>The correctly filled out form appears below.<br />
<a id="pgfId-1065480"></a><div class="webflare-div-image">
<img width="631" height="645" src="images/AppB-10.gif" /></div></li><li>
<a id="pgfId-1065481"></a>In the Choosing Analyses form, click <em>OK.</em></li></ol>














<h4>
<a id="pgfId-1065482"></a>Running the Simulation</h4>

<ol><li>
<a id="pgfId-1065483"></a>In the ADE window, choose <em>Simulation &#8211; Netlist and Run</em>.<br />
<a id="pgfId-1065484"></a>The output log file appears and displays information about the simulation as it runs.<br />
<a id="pgfId-1065487"></a>Look in the CIW for a message that says the simulation completed successfully.<br /><div class="webflare-div-image">
<img width="245" height="102" src="images/AppB-11.gif" /></div></li></ol>




<h4>
<a id="pgfId-1065488"></a>Plotting the Baseband Equivalent Output Signals</h4>

<ol><li>
<a id="pgfId-1065489"></a>In the ADE window, choose <em>Results-Direct Plot-Main Form</em>.<br />
<a id="pgfId-1065490"></a>The Direct Plot form appears.</li><li>
<a id="pgfId-1065491"></a>In the Direct Plot form, do the following:<ol><li>
<a id="pgfId-1065492"></a>Highlight <em>Replace</em> for <em>Plotting Mode</em>.</li><li>
<a id="pgfId-1065493"></a>Highlight <em>envlp</em> for <em>Analysis</em>.</li><li>
<a id="pgfId-1065494"></a>Highlight <em>Voltage</em> for <em>Function</em>.</li><li>
<a id="pgfId-1065495"></a>Highlight <em>time</em> for <em>Sweep</em>.<br />
<a id="pgfId-1065496"></a>The <em>Net</em> selection appears in the <em>Select</em> cyclic field and the label <em>Description: Envelope Voltage vs Time</em> appears.</li><li>
<a id="pgfId-1065497"></a>Following the message at the bottom of the Direct Plot form<br />
<a id="pgfId-1065498"></a><em>Select Net on schematic...</em><br />
<a id="pgfId-1065499"></a>Click the <code>baseband_I_out</code> net.<br />
<a id="pgfId-1065503"></a><div class="webflare-div-image">
<img width="600" height="115" src="images/AppB-12.gif" /></div></li></ol>
<a id="pgfId-1065504"></a>The first trace appears in the waveform window.<br />
<a id="pgfId-1065508"></a><div class="webflare-div-image">
<img width="630" height="496" src="images/AppB-13.gif" /></div></li><li>
<a id="pgfId-1065509"></a>In the Direct Plot form, do the following:<ol><li>
<a id="pgfId-1065510"></a>Highlight <em>Append</em> for <em>Plotting Mode</em>.</li><li>
<a id="pgfId-1065511"></a>Leave <em>Voltage</em> set for <em>Function</em> and <em>time</em> set for <em>Sweep</em>.</li><li>
<a id="pgfId-1065512"></a>Following the message at the bottom of the Direct Plot form<br />
<a id="pgfId-1065513"></a><em>Select Net on schematic...</em><br />
<a id="pgfId-1065514"></a>Click the <code>baseband_Q_out</code> net.<br />
<a id="pgfId-1065515"></a>The second trace is added to the waveform window. Both baseband equivalent output signals for the baseband model are plotted.<br />
<a id="pgfId-1065519"></a><div class="webflare-div-image">
<img width="605" height="477" src="images/AppB-14.gif" /></div></li></ol></li><li>
<a id="pgfId-1065520"></a>In the Direct Plot form, do the following:<ol><li>
<a id="pgfId-1065521"></a>Leave <em>Append</em> for <em>Plotting Mode</em> and <em>Voltage</em> for <em>Function.</em></li><li>
<a id="pgfId-1065522"></a>Highlight <em>harmonic time</em> for <em>Sweep</em>.</li><li>
<a id="pgfId-1065523"></a>Highlight <em>Real</em> for <em>Modifier</em>.</li><li>
<a id="pgfId-1065524"></a>Following the message at the bottom of the form,<br /><pre class="webflare-pre-block webflare-courier-new" id="#id1065525">
<a id="pgfId-1065525"></a>Select Harmonic Number on this form...</pre>
<a id="pgfId-1065526"></a>Select 1 for harmonic number.</li><li>
<a id="pgfId-1065527"></a>Following the next message at the bottom of the form<br /><pre class="webflare-pre-block webflare-courier-new" id="#id1065528">
<a id="pgfId-1065528"></a>Select Net on schematic...</pre></li></ol>
<a id="pgfId-1065529"></a>Click the <code>RF_out</code> net.<br />
<a id="pgfId-1065533"></a><div class="webflare-div-image">
<img width="635" height="113" src="images/AppB-15.gif" /></div>
<a id="pgfId-1065534"></a>A third trace is added to the waveform window.<br />
<a id="pgfId-1065538"></a><div class="webflare-div-image">
<img width="632" height="506" src="images/AppB-16.gif" /></div></li><li>
<a id="pgfId-1065539"></a>In the Direct Plot form, do the following:<ol><li>
<a id="pgfId-1065540"></a>Leave <em>Append</em> for <em>Plot Mode</em>, <em>Voltage</em> for <em>Function</em>, <em>harmonic time</em> for <em>Sweep</em>, and 1 for <em>Harmonic Number</em>.</li><li>
<a id="pgfId-1065541"></a>Highlight <em>Imaginary</em> for <em>Modifier</em>.</li></ol></li><li>
<a id="pgfId-1065542"></a>Following the message at the bottom of the form<br /><pre class="webflare-pre-block webflare-courier-new" id="#id1065543">
<a id="pgfId-1065543"></a>Select Net on schematic...</pre>
<a id="pgfId-1065544"></a>Click the <code>RF_out</code> net again.<br />
<a id="pgfId-1065545"></a>A fourth trace is added to the waveform window. Both baseband equivalent output signals for the passband model are added to the plot.<br />
<a id="pgfId-1065549"></a><div class="webflare-div-image">
<img width="633" height="492" src="images/AppB-17.gif" /></div></li></ol>






































































<p>
<a id="pgfId-1065550"></a>In the waveform display window you should now see what at first appears to be two traces. When you look more closely, you should see that each trace is actually two traces, one nearly on top of the other, making a total of four traces.</p>
<p>
<a id="pgfId-1065551"></a>The plot resulting from this example illustrates how well baseband modeling corresponds to the time-varying fundamental Fourier component computed by Envelope analysis and raises two questions:</p>
<ul><li>
<a id="pgfId-1065552"></a>Why use baseband models when Envelope analysis gives the same results?</li><li>
<a id="pgfId-1065553"></a>Why not use baseband models all the time?</li></ul>

<p>
<a id="pgfId-1065554"></a>Running a transient analysis with only the baseband models answers the first question. If from the ADE window you deactivate the passband circuit by setting the <span class="webflare-courier-new" style="white-space:pre"><em>carrier_pb</em></span> variable to zero, disable the Envelope analysis, and set up and run a 10μs transient analysis, you observe the same baseband results, but the transient simulation runs over 100 times faster.</p>
<p>
<a id="pgfId-1065555"></a>Examining the Envelope results answers the second question. If you look closely at both waveforms you notice that the baseband waveforms clip at a slightly lower level than the Envelope waveforms. This is because hard limiting of the carrier generates higher-than-third-order harmonics and the behavioral baseband model only simulates third order non-linearities.</p>

<h2>
<a id="pgfId-1065556"></a>rfLib Library Overview</h2>

<p>
<a id="pgfId-1065557"></a>The <em>rfLib</em> include three kinds of models to support baseband modeling:</p>
<ul><li>
<a id="pgfId-1065558"></a>Instrumentation models</li><li>
<a id="pgfId-1065559"></a>Non-linear memoryless models</li><li>
<a id="pgfId-1065560"></a>Linear models with memory</li></ul>


<p>
<a id="pgfId-1065561"></a>The instrumentation models provide stimuli, diagnostics, and performance metrics relevant to the DSP system.</p>
<p>
<a id="pgfId-1065562"></a>Both the linear models with memory and the non-linear memoryless models simulate the function blocks in an RF architecture and are specified in terms of common RF metrics. The RF function block models include input referenced white Gaussian noise as specified by noise figure. The <em>rfLib</em> includes models for the following RF function blocks&#8212;amplifiers, mixers, filters, and phase shifters; where <em>filters</em> includes single resistors, capacitors, and inductors.</p>
<p>
<a id="pgfId-1065563"></a>The non-linear models simulate AM/AM conversion [1] with a third-order polynomial that saturates at the peak of the transfer curve. The polynomial is specified by the gain and either the input-referred IP3 or the output-referred 1 dB compression point. Only the non-linear baseband models simulate AM/PM conversion. AM/PM conversion [1] is an important effect that is hard, if not impossible, to simulate with passband behavioral models. <a href="AppB.html#22659">Figure&#160;10-4</a> shows the basic baseband non-linearity.</p>

<p><strong>Figure 10-4
<a id="pgfId-1065568"></a><a id="22659"></a>Basic, Baseband Non-Linearity</strong></p>
<p>
<a id="pgfId-1065572"></a></p>
<div class="webflare-div-image">
<img src="images/Figure_1-10a.gif" /></div>

<p>
<a id="pgfId-1065573"></a>The linear models are the key to simulating loading effects at baseband. In RF integrated circuits, loading effects are important because it is often hard to integrate impedance matching networks. The baseband models of reactive elements differentiate our approach from the spreadsheet-based approaches to RF system design. The baseband capacitor and inductor models (<em>cap_BB</em> and <em>ind_BB</em> in <em>top_dwnBB</em>) let you simulate reactive loading effects in the time domain, where non-linearities are more naturally modeled.</p>
<p>
<a id="pgfId-1065574"></a>The baseband models of reactive elements also play a key role in modeling filters. Most digital communications text books [1,2] explain that you can model a passband transfer function at baseband by simply frequency-shifting the transfer function. What these books do not describe is how to implement the resulting transfer function in a general circuit simulator such as Spectre<sup>&#174;</sup> circuit simulator RF analysis (SpectreRF). The shifted transfer function usually lacks complex conjugate symmetry about zero frequency and therefore has a complex impulse response.</p>
<p>
<a id="pgfId-1065575"></a>The first consequence of modeling RF function blocks at baseband is that all equivalent baseband models have four terminals instead of two:</p>
<ul><li>
<a id="pgfId-1065576"></a>One set of terminals represents the in-phase signals, <em>i</em><sub>in</sub><em>(t)</em> and <em>i</em><sub>out</sub><em>(t)</em></li><li>
<a id="pgfId-1065577"></a>The other set of terminals represents the quadrature signals, <em>q</em><sub>in</sub><em>(t)</em> and <em>q</em><sub>out</sub><em>(t)</em><br />
<a id="pgfId-1065581"></a>Both sets of terminals are illustrated in <a href="AppB.html#24886">Figure&#160;10-2</a>.</li></ul>


<p>
<a id="pgfId-1065588"></a>The mathematics illustrated in <a href="AppB.html#20505">Figure&#160;10-5</a> and <a href="AppB.html#11576">Figure&#160;10-6</a> summarize the ideas behind a time-varying coordinate transformation that models reactive elements at baseband. The mathematics apply to capacitors as well as inductors.</p>
<p>
<a id="pgfId-1065589"></a>There is a well-documented but little-known electro-mechanical analogy for the derivation of the inductor baseband equivalent model. The four inductor terminals resemble the stator windings of a two-phase rotating machine with shaft speed equal to the RF carrier frequency. Modulation is mathematically analogous to the flux linking a stator winding due to currents in orthogonal rotor windings. The flux depends on the shaft angle just as a modulated signal depends on the carrier phase. Transforming the vectorial equation for <em>v=Ldi/dt</em> to the rotor reference frame suppresses the RF carrier and introduces a <em>speed voltage</em> [3,4,5,6,7,8,9], or back electro-motive force (back EMF), that couples the differential equations.</p>
<p>
<a id="pgfId-1065592"></a>An expression for the real current (i.e. the passband current) appears in <a href="AppB.html#11576">Figure&#160;10-6</a>. The real current is modeled as the projection of a two-dimensional rotating vector onto a stationary axis, the <em>real</em> axis. The vector rotates with an angular velocity equal to the RF carrier frequency.</p>

<p><strong>Figure 10-5
<a id="pgfId-1065595"></a><a id="20505"></a>Passband Current for an Inductor</strong></p>
<p>
<a id="pgfId-1065599"></a></p>
<div class="webflare-div-image">
<img src="images/13-5PBcurrents.gif" /></div>

<p>
<a id="pgfId-1065600"></a>The rotating vector also has a projection onto another stationary axis orthogonal to the real axis. In the baseband literature, the orthogonal projection is the Hilbert transform of the real signal. The constitutive relationship of the inductor, <em>v=Ldi/dt</em>, is expressed in terms of coordinates in a reference frame that rotates with the vector.</p>
<p>
<a id="pgfId-1065604"></a><a href="AppB.html#11576">Figure&#160;10-6</a> shows the constitutive inductor relationship between voltage and current in the rotating reference frame. Note that the trigonometric terms, the terms that slow simulation speed, are gone and the two projections are now coupled through <em>speed voltages</em>. The term speed voltage comes from the fact that the voltages depend on the angular speed of the rotating reference frame. In motor theory, that speed is the shaft speed. Speed voltage is similar to the back EMF in a motor. Because of speed voltages, baseband models of filters and reactive elements must have their carrier frequency specified. The carrier frequency is the frequency for which the baseband signals are referenced. For example, the carrier frequency for an RF filter would be the RF frequency while the carrier frequency for an IF filter would be the IF frequency.</p>

<p><strong>Figure 10-6
<a id="pgfId-1065606"></a><a id="11576"></a>Relationship Between Voltage and Current for an Inductor</strong></p>
<p>
<a id="pgfId-1065610"></a></p>
<div class="webflare-div-image">
<img src="images/13-6VoltCurrent.gif" /></div>

<p>
<a id="pgfId-1065611"></a>The baseband counterparts of the passband filter models are built up from inductors and capacitors modeled in the rotating reference frame.</p>
<p>
<a id="pgfId-1065612"></a>In the complex expression for <em>v=Ldi/dt, </em>if you replace <em>d/dt</em> with<em> jω</em>, you find that the impedance of the inductor changes from<em> jLω</em> to <em>jL(ω+ωrf)</em>. The same holds for capacitors, which means a filter transfer function, <em>H(ω)</em>, has a baseband equivalent equal to <em>H(</em>ω+ωrf). This is simply the original passband transfer function shifted to the left by an amount equal to the carrier frequency. Our time domain baseband models are consistent with the text book frequency domain explanation of baseband modeling.</p>

<h2>
<a id="pgfId-1065615"></a><a id="16794"></a><a id="usemodelanddesignexample"></a>Use Model and Design Example</h2>

<p>
<a id="pgfId-1065616"></a>This section describes how to use the baseband models during the architectural design phase. The following examples show you how to</p>
<ul><li>
<a id="pgfId-1065617"></a>Construct a baseband model for a simple receiver<br />
<a id="pgfId-1065621"></a><div class="webflare-div-image">
<img src="images/RMSEVM01.gif" /></div></li><li>
<a id="pgfId-1065622"></a>Use the Circuit Optimizer to balance specifications among the function blocks</li><li>
<a id="pgfId-1065623"></a>Create a passband testbench for the receiver</li></ul>






<p>
<a id="pgfId-1065624"></a>The design goals were chosen arbitrarily. The example is meant simply to illustrate how to use the library and is a derivative of the design found in [10]. If you find that some <strong>parameters are not specified, leave them as default values. You construct the receiver from left to right, from input to output.</strong></p>

<h3>
<a id="pgfId-1065625"></a>Opening a New Schematic Window</h3>

<ol><li>
<a id="pgfId-1065626"></a>In the CIW, choose <em>File &#8211; New &#8211; Cellview</em>.<br />
<a id="pgfId-1065627"></a>The Create New File form appears.</li><li>
<a id="pgfId-1065628"></a>In the Create New File form,<ol><li>
<a id="pgfId-1065629"></a>Choose<em> my_rfExamples</em> in the <em>Library Name</em> cyclic field. (Choose the editable copy of <em>rfExamples</em> you created as described in Chapter 3.)</li><li>
<a id="pgfId-1065631"></a>Enter <code>receiver_example</code> in the <em>Cell Name</em> field.</li><li>
<a id="pgfId-1065632"></a>Select <em>Composer-Schematic</em> in the <em>Tool</em> cyclic field. <code>schematic</code> appears in the <em>View Name</em> field.</li><li>
<a id="pgfId-1065633"></a>The completed form appears like the one below.<br /><ffi2-fig-frame-in-2 id="#id1065637">
<a id="pgfId-1065637"></a></ffi2-fig-frame-in-2><div class="webflare-div-image">
<img width="604" height="320" src="images/AppB-22.gif" /></div></li></ol></li><li>
<a id="pgfId-1065638"></a>Click <em>OK</em>.<br />
<a id="pgfId-1065639"></a>An empty Schematic window for the <em>receiver_example</em> appears.</li></ol>













<h3>
<a id="pgfId-1065640"></a>Opening the Analog Environment</h3>

<ol><li>
<a id="pgfId-1065641"></a>In the Schematic window, choose <em>Tools &#8211; Analog Environment</em>.<br />
<a id="pgfId-1065642"></a>The ADE window opens.<br />
<a id="pgfId-1065646"></a><div class="webflare-div-image">
<img width="648" height="418" src="images/AppB-23.gif" /></div>
<a id="pgfId-1065647"></a>The <em>Library</em>, <em>Cell</em>, and <em>View</em> names appear in the <em>Design</em> section of the ADE window.</li><li>
<a id="pgfId-1065650"></a>Set the simulator options from the Simulator window as described in <a href="AppB.html#84199">&#8220;Choosing Simulator Options&#8221;</a>.</li><li>
<a id="pgfId-1065654"></a>Set up the model libraries from the Simulator window as described in <a href="AppB.html#89927">&#8220;Setting Up Model Libraries&#8221;</a>.</li></ol>









<h3>
<a id="pgfId-1065656"></a>Constructing the Baseband Model for the Receiver</h3>

<p>
<a id="pgfId-1065657"></a><strong>Construct the receiver in the Schematic window by adding blocks from left to right, from input to output, as listed in Table <a href="AppB.html#18313"></a><h-hot>10-1</h-hot><strong></strong>.</strong></p>
<p>
<a id="pgfId-1065661"></a><strong>Except for the resistor, ground, and port models (which come from the </strong><em>analogLib</em><strong>), all blocks come from the </strong><em>rfLib</em><strong>. Unless otherwise instructed, leave the port resistances at their default value of 50 Ohms.</strong></p>
<p>
<a id="pgfId-1065778"></a><strong></strong></p>
<table class="webflareTable" id="#id1065662">
<caption style="text-align:left;"><p>
</p><h4>Table 10-1
<a id="pgfId-1065665"></a><a id="18313"></a>Bl<strong>ocks Used to Create the Receiver</strong></h4></caption>
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1065671">
<a id="pgfId-1065671"></a>Block Name and Reference</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1065673">
<a id="pgfId-1065673"></a>Element Name</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1065675">
<a id="pgfId-1065675"></a>Library and Category</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065679"></a>CDMA signal source &#8212; See <a href="AppB.html#77483">Adding the CDMA Signal Source</a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065682"></a><code>CDMA_reverse_xmit</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065684"></a>From the <em>measurement</em> category in <em>rfLib</em>.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065686"></a>Resistor&#8212;attach to CDMA signal source</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065688"></a><code>res</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065690"></a>From <em>analogLib</em></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065695"></a>Driver &#8212; See <a href="AppB.html#20975">Adding the Driver</a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065697"></a><code>BB_driver</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065699"></a>From the <em>measurement</em> category in <em>rfLib</em>.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065703"></a>Low noise amplifier &#8212; See <a href="AppB.html#96268">Adding the Low Noise Amplifier</a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065706"></a><code>LNA_BB</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">

<p>
<a id="pgfId-1065708"></a>From the <em>top_dwnBB</em> category in <em>rfLib</em>.</p>

</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065710"></a>Butterworth bandpass filter &#8212; See <a href="AppB.html#95417">Adding a Butterworth Band Pass Filter</a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065715"></a><code>BB_butterworth_bp</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065717"></a>From the <em>top_dwnBB</em> category in <em>rfLib</em></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065721"></a>RF-to-IF mixer &#8212; See <a href="AppB.html#96284">Adding an RF-to-IF Mixer</a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065724"></a><code>dwn_cnvrt</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065726"></a>From the <em>top_dwnBB</em> category in <em>rfLib</em></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065728"></a>Butterworth bandpass filter &#8212; See <a href="AppB.html#88691">Adding Another Butterworth Bandpass Filter</a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065733"></a><code>BB_butterworth_bp</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065735"></a>From the <em>top_dwnBB</em> category in <em>rfLib</em></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065739"></a>IQ demodulator &#8212; See <a href="AppB.html#83830">Adding an IQ Demodulator</a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065742"></a><code>IQ_demod_BB</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065744"></a>From the <em>top_dwnBB</em> category in <em>rfLib</em></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065746"></a>Butterworth lowpass filters (create two) &#8212; See <a href="AppB.html#19609">Adding Two Butterworth Lowpass Filters</a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065751"></a><code>butterworth_lp</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065753"></a>From the <em>top_dwnPB</em> category in <em>rfLib</em></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065755"></a>Instrumentation model &#8212; See <a href="AppB.html#78025">Adding an Instrumentation Block</a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065760"></a><code>offset_comms_instr</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065762"></a>From the <em>measurement</em> category in <em>rfLib</em>.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065766"></a>Terminator &#8212; See <a href="AppB.html#46081">Adding an Instrumentation Terminator</a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065769"></a><code>instr_term</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065771"></a>From the <em>measurement</em> category in <em>rfLib</em></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065773"></a>Grounds&#8212;attach to RF-to-IF mixer, IQ demodulator, and Instrumentation model</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065775"></a><code>gnd</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065777"></a>From <em>analogLib</em></p>
</td>
</tr>
</tbody></table>

<h4>
<a id="pgfId-1065780"></a><a id="77483"></a>Adding the CDMA Signal Source</h4>

<p>
<a id="pgfId-1065781"></a>Add the first receiver block, a CDMA signal source (<code>CDMA_reverse_xmit</code>), to the schematic.</p>
<ol><li>
<a id="pgfId-1065782"></a>In the Schematic window, choose <em>Add &#8211; Instance</em>.<br />
<a id="pgfId-1065783"></a>The Add Instance form appears. It may be empty or it may display information for a previously added element. The default for the <em>View</em> field is <code>symbol</code>.</li><li>
<a id="pgfId-1065784"></a>In the Add Instance form, click <em>Browse</em>.<br />
<a id="pgfId-1065785"></a>The Library Browser - Add Instance form appears.</li><li>
<a id="pgfId-1065786"></a>In the Library Browser - Add Instance form,<ol><li>
<a id="pgfId-1065787"></a>If necessary, click <em>Show Categories</em> to display the<em> Category</em> column so you can view the elements (or cells) in the <em>rfLib</em> by category.</li><li>
<a id="pgfId-1065788"></a>In the <em>Libraries </em>column, click <em>rfLib</em> to display categories of elements in <em>rfLib</em>.<br />
<a id="pgfId-1065789"></a>The <em>Everything</em> category is displayed by default and all cells in <em>rfLib</em> are listed in the <em>Cells</em> column. (In the Add Instance form, <em>rfLib</em> displays in the<em> Library</em> field.)</li><li>
<a id="pgfId-1065790"></a>In the <em>Category</em> column, click <em>measurement</em> to list only the cells in the <em>measurement</em> category.</li><li>
<a id="pgfId-1065791"></a>In the <em>Cell</em> column, click <em>CDMA_reverse_xmit</em>.</li></ol><br />
<a id="pgfId-1065792"></a>In the Library Browser, cell <em>CDMA_reverse_xmit</em><code> </code>and it&#8217;s default view <em>symbol</em> are both selected.<br />
<a id="pgfId-1065796"></a><div class="webflare-div-image">
<img width="668" height="366" src="images/AppB-24.gif" /></div>
<a id="pgfId-1065797"></a>In the Add Instance form,<ul><li>
<a id="pgfId-1065798"></a><code>rfLib</code> appears in the <em>Library</em> field</li><li>
<a id="pgfId-1065799"></a><code>CDMA_reverse_xmit</code> displays in the <em>Cell </em>field</li><li>
<a id="pgfId-1065800"></a><code>symbol</code> displays in the <em>View</em> field</li></ul><br />
<a id="pgfId-1065801"></a>The CDF parameters for the element and their default values appear at the bottom of the form.<br />
<a id="pgfId-1065805"></a><div class="webflare-div-image">
<img width="634" height="137" src="images/AppB-25.gif" /></div></li><li>
<a id="pgfId-1065806"></a>To place a <em>CDMA_reverse_xmit</em> block in the schematic, <ol><li>
<a id="pgfId-1065807"></a>Move the cursor over the Schematic window.<br />
<a id="pgfId-1065808"></a>The outline for the <em>CDMA_reverse_xmit </em>symbol is attached to the cursor.</li><li>
<a id="pgfId-1065809"></a>Move the cursor near the top left corner of the schematic and click to place the <em>CDMA_reverse_xmit</em> block.<br />
<a id="pgfId-1065810"></a>This block models a CDMA signal source.</li><li>
<a id="pgfId-1065811"></a>Click <em>Esc</em> to remove the symbol from the cursor.<br />
<a id="pgfId-1065815"></a><div class="webflare-div-image">
<img width="632" height="318" src="images/AppB-26.gif" /></div></li></ol></li></ol>






































<h4>
<a id="pgfId-1065816"></a>Adding a Resistor to the CDMA Signal Source</h4>

<p>
<a id="pgfId-1065817"></a>Because this example does not use the binary output nodes (<code>i_bin_node</code> and <code>q_bin_node)</code> on the CDMA signal source, connect a resistor between these nodes to avoid unused pin warnings.</p>
<ol><li>
<a id="pgfId-1065818"></a>In the <em>Libraries </em>column of the Library Browser - Add Instance form, click <em>analogLib</em> to display elements in <em>analogLib</em>.<br />
<a id="pgfId-1065819"></a>If <em>Show Categories</em> is selected, the <em>Everything</em> category is displayed by default and all cells in <em>analogLib</em> are listed in the <em>Cells</em> column.</li><li>
<a id="pgfId-1065820"></a>Scroll through the list of cells in <em>analogLib</em> to locate the resistor cell, <em>res</em>.</li><li>
<a id="pgfId-1065821"></a>Click <em>res</em> in the <em>Cell</em> column.<br />
<a id="pgfId-1065822"></a>The cell <em>res</em> and it&#8217;s default view <em>symbol</em> are both selected.<br />
<a id="pgfId-1065826"></a><div class="webflare-div-image">
<img width="668" height="348" src="images/AppB-27.gif" /></div>
<a id="pgfId-1065827"></a>In the Add Instance form,<ul><li>
<a id="pgfId-1065828"></a><code>analogLib</code> displays in the<em> Library</em> field</li><li>
<a id="pgfId-1065829"></a><code>res</code> displays in the<em> Cell</em> field</li><li>
<a id="pgfId-1065830"></a>and <code>symbol</code><em> </em>displays in the<em> View </em>field</li></ul><br />
<a id="pgfId-1065831"></a>The CDF parameters for the element and their default values appear at the bottom of the form.<br />
<a id="pgfId-1065835"></a><div class="webflare-div-image">
<img width="632" height="378" src="images/AppB-28.gif" /></div></li><li>
<a id="pgfId-1065836"></a>Move the cursor over the Schematic window.</li><li>
<a id="pgfId-1065837"></a>Click to place the top resistor terminal in line with the top binary output node (<code>i_bin_out</code>) on the lower right side of the <em>CDMA_reverse_xmit</em> block</li><li>
<a id="pgfId-1065838"></a>Click <em>Esc</em> to remove the symbol from the cursor.</li></ol>





















<h4>
<a id="pgfId-1065839"></a>Wiring the Resistor to the CDMA Signal Source</h4>

<p>
<a id="pgfId-1065840"></a>Wire the resistor to the binary outputs, <code>i_bin_node</code> and <code>q_bin_node,</code> of the CDMA signal source.</p>
<ol><li>
<a id="pgfId-1065841"></a>To wire the resistor to the<em> CDMA_reverse_xmit</em> block, in the Schematic window choose <em>Add - Wire (narrow)</em>.</li><li>
<a id="pgfId-1065842"></a>Click <code>i_bin_node</code> on the <code>CDMA_reverse_xmit</code> block then move the cursor and click the top node of the resistor.</li><li>
<a id="pgfId-1065843"></a>Click <code>q_bin_node</code> on the <code>CDMA_reverse_xmit</code> block then move the cursor and click the bottom node of the resistor.</li><li>
<a id="pgfId-1065844"></a>Click <em>Esc</em> to stop wiring.<br />
<a id="pgfId-1065845"></a>The CDMA signal source and resistor wired together appear as follows.<br />
<a id="pgfId-1065849"></a><div class="webflare-div-image">
<img width="630" height="298" src="images/AppB-29.gif" /></div></li></ol>







<h4>
<a id="pgfId-1065851"></a><a id="20975"></a>Adding the Driver</h4>

<p>
<a id="pgfId-1065852"></a>Add a driver block to the right of the CDMA signal source block.</p>
<ol><li>
<a id="pgfId-1065853"></a>In the Schematic window, choose <em>Add &#8211; Instance</em> to display the Add Instance form.</li><li>
<a id="pgfId-1065854"></a>In the Add Instance form, click <em>Browse</em> to display the Library Browser - Add Instance form.</li><li>
<a id="pgfId-1065855"></a>In the Library Browser - Add Instance form, make the following selections.<br />
<a id="pgfId-1065874"></a><a id="51196"></a><table class="webflareTable webflareTableIndent" id="#id1065857">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1065859">
<a id="pgfId-1065859"></a>Library</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1065861">
<a id="pgfId-1065861"></a>Category</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1065863">
<a id="pgfId-1065863"></a>Cell</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1065865">
<a id="pgfId-1065865"></a>View</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065867"></a><em>rfLib</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065869"></a><em>measurement</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065871"></a><em>BB_driver</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065873"></a><em>symbol</em></p>
</td>
</tr>
</tbody></table><br />
<a id="pgfId-1065875"></a>At the top of the Add Instance form,<ul><li>
<a id="pgfId-1065876"></a><code>rfLib</code> displays in the<em> Library</em> field,</li><li>
<a id="pgfId-1065877"></a><code>BB_driver</code><em> </em>displays in the<em> Cell</em> field and</li><li>
<a id="pgfId-1065878"></a><code>symbol</code><em> </em>displays in the<em> View </em>field.</li><li>
<a id="pgfId-1065879"></a>The CDF parameters and their default values appear at the bottom of the Add Instance form.<br /><ffi2-fig-frame-in-2 id="#id1065883">
<a id="pgfId-1065883"></a></ffi2-fig-frame-in-2><div class="webflare-div-image">
<img width="599" height="106" src="images/AppB-30.gif" /></div></li></ul></li><li>
<a id="pgfId-1065884"></a>Move the cursor over the Schematic window.</li><li>
<a id="pgfId-1065885"></a>Click to place the <em>BB_driver</em> to the right of the <em>CDMA_reverse_xmit</em> block. Align the input pins of the driver with the analog output pins of the CDMA signal source.</li><li>
<a id="pgfId-1065886"></a>Click <em>Esc</em> to remove the symbol from the cursor.</li></ol>



















<h4><em>
<a id="pgfId-1065887"></a>Wiring the Signal Source to the Driver</em></h4>

<ol><li>
<a id="pgfId-1065888"></a>To wire the <em>BB_driver</em> block to the<em> CDMA_reverse_xmit</em> block, in the Schematic window choose <em>Add &#8211; Wire (narrow)</em>.</li><li>
<a id="pgfId-1065889"></a>Click <code>i_out_node</code> on the <em>CDMA_reverse_xmit</em> block then click <code>I_in</code> on the <em>BB_driver</em> block.</li><li>
<a id="pgfId-1065890"></a>Click <code>q_out_node</code> on the <em>CDMA_reverse_xmit</em> block then click <code>Q_in</code> on the <em>BB_driver block</em>.</li><li>
<a id="pgfId-1065891"></a>Click <em>Esc</em> to stop wiring.<br />
<a id="pgfId-1065892"></a>The schematic now appears as follows.<br />
<a id="pgfId-1065896"></a><div class="webflare-div-image">
<img width="644" height="410" src="images/AppB-31.gif" /></div></li></ol>







<h4><em>
<a id="pgfId-1065897"></a>Modifying Parameter Values for the Driver</em></h4>

<p>
<a id="pgfId-1065898"></a>Edit the value of the <em>BB_driver</em> CDF parameter <em>dBm-out@1v peak in driver</em> as follows.</p>
<ol><li>
<a id="pgfId-1065899"></a>Choose <em>Edit &#8211; Properties &#8211; Objects</em><em> </em>in the Schematic window.<br />
<a id="pgfId-1065900"></a>The Edit Object Properties form appears. You use this form to change the values of CDF (component description format) properties for the driver and modify the schematic for this simulation.</li><li>
<a id="pgfId-1065901"></a>In the Schematic window, click the <em>BB_driver</em> block.</li><li>
<a id="pgfId-1065902"></a>The Edit Object Properties form changes to display information for the <em>BB_driver </em>block</li><li>
<a id="pgfId-1065903"></a>Change the <em>dBm-out@1v peak in </em>parameter value as follows.<br />
<a id="pgfId-1065913"></a><table class="webflareTable webflareTableIndent" id="#id1065904">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1065906">
<a id="pgfId-1065906"></a>Parameter Name</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1065908">
<a id="pgfId-1065908"></a>Value</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065910"></a> <em>dBm-out@1v peak in</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065912"></a><em>-16</em><code> </code></p>
</td>
</tr>
</tbody></table><br />
<a id="pgfId-1065914"></a>The driver converts 1 peak volt from the CDMA signal source to −16 dBm referenced to the output resistance of the driver.</li><li>
<a id="pgfId-1065915"></a>Click <em>OK</em> in the Edit Object Properties form.<br />
<a id="pgfId-1065916"></a>The form closes.</li></ol>












<h4>
<a id="pgfId-1065918"></a><a id="96268"></a>Adding the Low Noise Amplifier</h4>

<p>
<a id="pgfId-1065919"></a>Add a low noise amplifier to the right of the driver.</p>
<ol><li>
<a id="pgfId-1065920"></a>In the Schematic window, choose <em>Add &#8211; Instance</em> to display the Add Instance form.<br />
<a id="pgfId-1065921"></a>The Add Instance form appears. It may be empty or it may display information for a previously added element.</li><li>
<a id="pgfId-1065922"></a>In the Add Instance form, click <em>Browse</em> to display the Library Browser - Add Instance form.</li><li>
<a id="pgfId-1065923"></a>In the Library Browser - Add Instance form, make the following selections. (If necessary, click <em>Show Categories</em> at the top of the Library Browser, to display the<em> Category</em> column.)<br />
<a id="pgfId-1065941"></a><table class="webflareTable webflareTableIndent" id="#id1065924">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1065926">
<a id="pgfId-1065926"></a>Library</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1065928">
<a id="pgfId-1065928"></a>Category</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1065930">
<a id="pgfId-1065930"></a>Cell</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1065932">
<a id="pgfId-1065932"></a>View</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065934"></a>rfLib</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065936"></a>top_dwnBB</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065938"></a>LNA_BB</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065940"></a>symbol</p>
</td>
</tr>
</tbody></table><br />
<a id="pgfId-1065942"></a>In the Library Browser, cell <em>LNA_BB</em><code> </code>and it&#8217;s default view <em>symbol</em> are both selected.<br />
<a id="pgfId-1065943"></a>At the top of the Add Instance form,<ul><li>
<a id="pgfId-1065944"></a><code>rfLib</code> displays in the<em> Library</em> field</li><li>
<a id="pgfId-1065945"></a><code>LNA_BB</code><em> </em>displays in the<em> Cell</em> field</li><li>
<a id="pgfId-1065946"></a><code>symbol</code><em> </em>displays in the<em> View </em>field</li></ul><br />
<a id="pgfId-1065947"></a>The CDF parameters for the element and their default values display at the bottom of the LNA_BB Add Instance form.<br />
<a id="pgfId-1065951"></a><div class="webflare-div-image">
<img width="634" height="353" src="images/AppB-32.gif" /></div></li><li>
<a id="pgfId-1065952"></a>Move the cursor over the Schematic window. The outline for the LNA symbol is attached to the cursor. Align the input pins of the LNA with the output pins of the driver.</li><li>
<a id="pgfId-1065953"></a>Click to place the <em>LNA_BB</em> block to the right of the <em>BB_driver</em> block.</li><li>
<a id="pgfId-1065954"></a>Click <em>Esc</em> to remove the symbol from the cursor.</li></ol>





















<h4>
<a id="pgfId-1065955"></a>Wiring the Driver to the LNA</h4>

<ol><li>
<a id="pgfId-1065956"></a>To wire the <em>LNA_BB</em> block to the<em> BB_driver</em> block, in the Schematic window choose <em>Add - Wire (narrow)</em>.</li><li>
<a id="pgfId-1065957"></a>Click <code>I_out</code> on the <em>BB_driver</em> block then click <code>I_in</code> on the <em>LNA_BB</em> block.</li><li>
<a id="pgfId-1065958"></a>Click <code>Q_out</code> on the <em>BB_driver</em> block then click <code>Q_in</code> on the <em>LNA_BB</em> block.</li><li>
<a id="pgfId-1065959"></a>Click <em>Esc</em> to stop wiring.<br />
<a id="pgfId-1065960"></a>The schematic now appears as follows.<br />
<a id="pgfId-1065964"></a><div class="webflare-div-image">
<img width="634" height="286" src="images/AppB-33.gif" /></div></li></ol>







<h4><em>
<a id="pgfId-1065965"></a>Modifying Parameter Values for the LNA</em></h4>

<ol><li>
<a id="pgfId-1065966"></a>Edit the CDF parameter values for the LNA.<ol><li>
<a id="pgfId-1065967"></a>Choose <em>Edit &#8211; Properties &#8211; Objects</em><em> </em>in the Schematic window.<br />
<a id="pgfId-1065968"></a>The Edit Object Properties form appears. You use this form to change the list of CDF (component description format) properties for the LNA and modify the schematic for this simulation.</li><li>
<a id="pgfId-1065969"></a>In the Schematic window, click the <em>LNA</em>.<br />
<a id="pgfId-1065970"></a>The Edit Object Properties form changes to display information for the LNA.</li><li>
<a id="pgfId-1065971"></a>Change the CDF parameter values for the LNA as follows.<br /><ffi2-fig-frame-in-2 id="#id1066017">
<a id="pgfId-1066017"></a></ffi2-fig-frame-in-2><table class="webflareTable webflareTableIndent" id="#id1065972">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1065974">
<a id="pgfId-1065974"></a>Parameter Name</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1065976">
<a id="pgfId-1065976"></a>Value</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065978"></a><em>Available pwr gain [dB]</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065980"></a><code>lna_gain </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065982"></a><em>Input resistance</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065984"></a><code>50 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065986"></a><em>Output resistance</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065988"></a><code>300 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065990"></a><em>Input referred IP3 [dBm]</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065992"></a><code>lna_ip3 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065994"></a><em>Noise figure [dB]</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065996"></a><code>10 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1065998"></a><em>am/pm sharpness</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066000"></a><code>2 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066002"></a><em>cmp [dBm]</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066004"></a><code>lna_ip3 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066006"></a><em>|radians| @ cmp </em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066008"></a><code>.05 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066010"></a><em>|radians| @ big input </em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066012"></a><code>.7 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066014"></a><em>{1, 0, -1} for {cw, none, ccw}</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066016"></a><code>1 </code></p>
</td>
</tr>
</tbody></table></li></ol></li><li>
<a id="pgfId-1066018"></a>Click <em>OK</em> in the Edit Object Properties form.<br />
<a id="pgfId-1066019"></a>The form closes.</li></ol>
















<h4>
<a id="pgfId-1066021"></a><a id="95417"></a>Adding a Butterworth Band Pass Filter</h4>

<p>
<a id="pgfId-1066022"></a>Add a Butterworth band pass filter to the right of the low noise amplifier.</p>
<ol><li>
<a id="pgfId-1066023"></a>In the Schematic window, choose <em>Add &#8211; Instance</em> to display the Add Instance form.<br />
<a id="pgfId-1066024"></a>Information for the LNA is still displayed in the form.</li><li>
<a id="pgfId-1066025"></a>In the Add Instance form, click <em>Browse</em> to display the Library Browser - Add Instance form.</li><li>
<a id="pgfId-1066026"></a>In the Library Browser - Add Instance form, make the following selection.<br />
<a id="pgfId-1066044"></a><table class="webflareTable webflareTableIndent" id="#id1066027">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066029">
<a id="pgfId-1066029"></a>Library</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066031">
<a id="pgfId-1066031"></a>Category</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066033">
<a id="pgfId-1066033"></a>Cell</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066035">
<a id="pgfId-1066035"></a>View</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066037"></a><em>rfLib</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066039"></a><em>top_dwnBB</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066041"></a><em>BB_butterworth_bp</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066043"></a><em>symbol</em></p>
</td>
</tr>
</tbody></table><br />
<a id="pgfId-1066045"></a>In the Library Browser, cell <em>BB_butterworth_bp</em><code> </code>and it&#8217;s default view are both selected.<br />
<a id="pgfId-1066046"></a>At the top of the Add Instance form,<ul><li>
<a id="pgfId-1066047"></a><code>rfLib</code> displays in the<em> Library</em> field</li><li>
<a id="pgfId-1066048"></a><code>BB_butterworth_bp</code><em> </em>displays in the<em> Cell</em> field</li><li>
<a id="pgfId-1066049"></a><code>symbol</code><em> </em>displays in the<em> View </em>field.</li><li>
<a id="pgfId-1066050"></a>The CDF parameters for the Butterworth band pass filter and their default values display at the bottom of the Add Instance form.<br /><ffi2-fig-frame-in-2 id="#id1066054">
<a id="pgfId-1066054"></a></ffi2-fig-frame-in-2><div class="webflare-div-image">
<img width="601" height="267" src="images/AppB-34.gif" /></div></li></ul></li><li>
<a id="pgfId-1066055"></a>Move the cursor over the Schematic window. The outline for the filter symbol is attached to the cursor. Align the input pins of the filter with the output pins of the LNA.</li><li>
<a id="pgfId-1066056"></a>Click to place the <em>BB_butterworth_bp </em>block to the right of the <em>LNA_BB </em>block.</li><li>
<a id="pgfId-1066057"></a>Click <em>Esc</em> to remove the symbol from the cursor.</li></ol>





















<h4>
<a id="pgfId-1066058"></a>Wiring the LNA to the Filter</h4>

<ol><li>
<a id="pgfId-1066059"></a>To wire the <em>BB_butterworth_bp </em>block to the<em> LNA_BB</em> block, in the Schematic window choose <em>Add &#8211; Wire (narrow)</em>.</li><li>
<a id="pgfId-1066060"></a>Click <code>I_out</code> on the <em>LNA_BB</em> block then click <code>ini</code> on the <em>BB_butterworth_bp</em> block.</li><li>
<a id="pgfId-1066061"></a>Click <code>Q_out</code> on the <em>LNA_BB</em> block then click <code>inq</code> on the <em>BB_butterworth_bp</em> block.</li><li>
<a id="pgfId-1066062"></a>Click <em>Esc</em> to stop wiring.<br />
<a id="pgfId-1066063"></a>The schematic now appears as follows.<br />
<a id="pgfId-1066067"></a><div class="webflare-div-image">
<img width="668" height="274" src="images/AppB-35.gif" /></div></li></ol>







<h4><em>
<a id="pgfId-1066068"></a>Modifying Parameter Values for the Band Pass Filter</em></h4>

<p>
<a id="pgfId-1066069"></a>Edit the CDF parameter values for the Butterworth band pass filter.</p>
<ol><li>
<a id="pgfId-1066070"></a>Choose <em>Edit &#8211; Properties &#8211; Objects</em><em> </em>in the Schematic window.<br />
<a id="pgfId-1066071"></a>The Edit Object Properties form appears. You use this form to change the list of CDF (component description format) properties for the filter and modify the schematic for this simulation.</li><li>
<a id="pgfId-1066072"></a>In the Schematic window, click the filter.<br />
<a id="pgfId-1066073"></a>The Edit Object Properties form changes to display information for the filter.</li><li>
<a id="pgfId-1066077"></a>Edit the parameter values to match those in Table <a href="AppB.html#65505">10-2</a>.</li><li>
<a id="pgfId-1066078"></a>Click <em>OK</em>.<br />
<a id="pgfId-1066117"></a><table class="webflareTable" id="#id1066079">
<caption style="text-align:left;"><p>
</p><h4>Table 10-2
<a id="pgfId-1066082"></a><a id="65505"></a>CDF Parameter Values for the Butterworth Filter</h4></caption>
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066086">
<a id="pgfId-1066086"></a>Parameter Name</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066088">
<a id="pgfId-1066088"></a>Value</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066090"></a><em>Filter order</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066092"></a><code>3 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066094"></a><em>Input impedance</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066096"></a><code>50 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066098"></a><em>Output impedance</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066100"></a><code>50 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066102"></a><em>Center frequency (Hz) </em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066104"></a><code>frf </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066106"></a><em>Relative bandwidth </em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066108"></a><code>rf_rbw </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066110"></a><em>Insertion loss (dB) </em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066112"></a><code>3 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066114"></a><em>Carrier frequency </em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066116"></a><code>frf </code></p>
</td>
</tr>
</tbody></table></li></ol>









<p>
<a id="pgfId-1066118"></a>Specify the <em>Carrier frequency</em> parameter value for the baseband equivalent model of the Butterworth band pass filter, just as you do for any reactive element. As shown in <a href="AppB.html#11576">Figure&#160;10-6</a>, the carrier frequency is used to compute speed voltages. Because filters are built up from inductors and capacitors which have speed voltages, you must specify the carrier frequency for filters.</p>
<p>
<a id="pgfId-1066122"></a>When a filter follows an RF-to-IF mixer, its <em>Carrier frequency</em> parameter value is the IF frequency.</p>
<ul><li>
<a id="pgfId-1066123"></a>The <em>Carrier frequency</em> is the frequency value to which the baseband signals are referenced.</li><li>
<a id="pgfId-1066124"></a>The <em>Center frequency</em> is the frequency for which a filter is designed. The <em>Center frequency</em> parameter value for a bandpass filter does not have to equal the <em>Carrier frequency</em> parameter value.</li></ul>


<h4>
<a id="pgfId-1066126"></a><a id="96284"></a>Adding an RF-to-IF Mixer</h4>

<p>
<a id="pgfId-1066127"></a>Add an RF-to-IF mixer (<em>dwn_cnvrt</em>) block to the right of the bandpass filter block.</p>
<ol><li>
<a id="pgfId-1066128"></a>In the Schematic window, choose <em>Add &#8211; Instance</em> to display the Add Instance form.<br />
<a id="pgfId-1066129"></a>The Add Instance form appears. It may be empty or it may display information for a previously added element.</li><li>
<a id="pgfId-1066130"></a>In the Add Instance form, click <em>Browse</em> to display the Library Browser - Add Instance form.</li><li>
<a id="pgfId-1066134"></a>In the Library Browser - Add Instance form, make the selections indicated in Table <a href="AppB.html#59173">10-3</a>.<br />
<a id="pgfId-1066161"></a><table class="webflareTable" id="#id1066135">
<caption style="text-align:left;"><p>
</p><h4>Table 10-3
<a id="pgfId-1066138"></a><a id="59173"></a>Library Browser selections for the RF to IF Mixer</h4></caption>
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066146">
<a id="pgfId-1066146"></a>Library</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066148">
<a id="pgfId-1066148"></a>Category</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066150">
<a id="pgfId-1066150"></a>Cell</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066152">
<a id="pgfId-1066152"></a>View</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066154"></a><em>rfLib</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066156"></a><em>top_dwnBB</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066158"></a><em>dwn_cnvrt</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066160"></a><em>symbol</em></p>
</td>
</tr>
</tbody></table><br />
<a id="pgfId-1066162"></a>In the Library Browser, cell <em>dwn_cnvrt</em> (the RF-to-IF mixer) and it&#8217;s default view <em>symbol </em>are both selected.<br />
<a id="pgfId-1066163"></a>At the top of the Add Instance form,<ul><li>
<a id="pgfId-1066164"></a><code>rfLib</code> displays in the<em> Library</em> field</li><li>
<a id="pgfId-1066165"></a><code>dwn_cnvrt</code><em> </em>displays in the<em> Cell</em> field</li><li>
<a id="pgfId-1066166"></a><code>symbol</code><em> </em>displays in the<em> View </em>field.</li></ul><br />
<a id="pgfId-1066167"></a>The CDF parameters for the down converter and their default values display at the bottom of the form.<br />
<a id="pgfId-1066171"></a><div class="webflare-div-image">
<img width="634" height="411" src="images/AppB-36.gif" /></div></li><li>
<a id="pgfId-1066172"></a>Move the cursor over the Schematic window. The outline for the RF-to-IF Mixer symbol is attached to the cursor. Align the input pins of the mixer with the output pins of the filter.</li><li>
<a id="pgfId-1066173"></a>Click to place the <em>dwn_cnvrt</em> block to the right of the <em>BB_butterworth_bp </em>block.</li><li>
<a id="pgfId-1066174"></a>Click <em>Esc</em> to remove the symbol from the cursor.</li></ol>





















<h4><em>
<a id="pgfId-1066175"></a>Grounding the phase_err Pin on the Mixer</em></h4>

<p>
<a id="pgfId-1066176"></a>It is necessary to ground the phase error (<em>phase_err</em>) pin on the bottom of the RF-to-IF mixer.</p>

<p>
<a id="pgfId-1066180"></a></p>
<div class="webflare-div-image">
<img width="670" height="164" src="images/AppB-37.gif" /></div>

<ol><li>
<a id="pgfId-1066181"></a>In the Schematic window, choose <em>Add &#8211; Instance</em> to display the Add Instance form.<br />
<a id="pgfId-1066182"></a>The Add Instance form appears. It may be empty or it may display information for a previously added element.</li><li>
<a id="pgfId-1066183"></a>In the Add Instance form, type<ul><li>
<a id="pgfId-1066184"></a><code>analogLib</code> in the<em> Library</em> field</li><li>
<a id="pgfId-1066185"></a><code>gnd</code> in the<em> Cell</em> field</li><li>
<a id="pgfId-1066186"></a><code>symbol</code><em> </em>in the<em> View </em>field.</li></ul></li><li>
<a id="pgfId-1066187"></a>Move the cursor over the Schematic window.</li><li>
<a id="pgfId-1066188"></a>Click to place the ground terminal in line with the phase error node (<code>phase_err</code>) on the bottom of the <em>dwn_cnvt</em> block.</li><li>
<a id="pgfId-1066189"></a>Click <em>Esc</em> to remove the symbol from the cursor.</li></ol>









<h4>
<a id="pgfId-1066190"></a>Wiring the Filter and Ground to the Mixer</h4>

<ol><li>
<a id="pgfId-1066191"></a>To wire the <em>dwn_cnvrt </em>block to the<em> BB_butterworth_bp</em> block and the ground, in the Schematic window choose <em>Add - Wire (narrow)</em>.</li><li>
<a id="pgfId-1066192"></a>Click <code>outi</code> on the <em>BB_butterworth_bp</em> block then click <code>I_in</code> on the <em>dwn_cnvrt</em> block.</li><li>
<a id="pgfId-1066193"></a>Click <code>outq</code> on the <em>BB_butterworth_bp</em> block then click <code>Q_in</code> on the <em>dwn_cnvrt</em> block.</li><li>
<a id="pgfId-1066194"></a>Click the port on the <em>gnd</em> block then click <code>phase_err</code> on the <em>dwn_cnvrt</em> block.</li><li>
<a id="pgfId-1066195"></a>Click <em>Esc</em> to stop wiring.<br />
<a id="pgfId-1066196"></a>The schematic now appears as follows.<br />
<a id="pgfId-1066200"></a><div class="webflare-div-image">
<img width="668" height="236" src="images/AppB-38.gif" /></div></li></ol>








<h4><em>
<a id="pgfId-1066201"></a>Modifying Parameter Values for the RF-to-IF Mixer</em></h4>

<ol><li>
<a id="pgfId-1066202"></a>Edit the CDF parameter values for the RF-to-IF mixer (<em>dwn_cnvrt</em>) as listed in <a href="AppB.html#82216">Table&#160;10-4</a>.<ol><li>
<a id="pgfId-1066206"></a>Choose <em>Edit &#8211; Properties &#8211; Objects</em><em> </em>in the Schematic window.<br />
<a id="pgfId-1066207"></a>The Edit Object Properties form appears. You use this form to change the list of CDF (component description format) properties for <em>dwn_cnvrt</em> and modify the schematic for this simulation.</li><li>
<a id="pgfId-1066208"></a>In the Schematic window, click <em>dwn_cnvrt</em>.<br />
<a id="pgfId-1066209"></a>The Edit Object Properties form changes to display information for <em>dwn_cnvrt</em>.</li><li>
<a id="pgfId-1066213"></a>Change the parameter values to match those in Table <a href="AppB.html#82216">10-4</a>.</li><li>
<a id="pgfId-1066214"></a>Click OK.<br />
<a id="pgfId-1066273"></a><table class="webflareTable" id="#id1066215">
<caption style="text-align:left;"><p>
</p><h4>Table 10-4
<a id="pgfId-1066218"></a><a id="82216"></a>CDF Parameter Values for the RF-to-IF Mixer</h4></caption>
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066222">
<a id="pgfId-1066222"></a>Parameter Name</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066224">
<a id="pgfId-1066224"></a>Value</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066226"></a>available power gain[dB]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066228"></a><code>if_mx_gain</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066230"></a>Input resistance</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066232"></a><code>50 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066234"></a>output resistance</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066236"></a><code>50 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066238"></a>input referred ip3[dBm]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066240"></a><code>if_mx_ip</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066242"></a>noise figure [dB]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066244"></a><code>10</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066246"></a>RF frequency</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066248"></a><code>frf</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066250"></a>LO frequency</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066252"></a><code>flo1</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066254"></a>AM/PM input point[dBm]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066256"></a>-30</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066258"></a>phase shift at cmp[rad]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066260"></a>.7</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066262"></a>phase shift at infinity</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066264"></a>2</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066266"></a>sharpness factor</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066268"></a>2</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066270"></a>{1,0,−1} = {cw,none,ccw}</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066272"></a><code>0</code></p>
</td>
</tr>
</tbody></table></li></ol></li></ol>













<h4>
<a id="pgfId-1066275"></a><a id="88691"></a>Adding Another Butterworth Bandpass Filter</h4>

<p>
<a id="pgfId-1066276"></a>Add another Butterworth band pass filter block to the right of the RF-to-IF Mixer block.</p>
<ol><li>
<a id="pgfId-1066277"></a>In the Schematic window, choose <em>Add &#8211; Instance</em> to display the Add Instance form.</li><li>
<a id="pgfId-1066278"></a>In the Add Instance form, click <em>Browse</em> to display the Library Browser - Add Instance form.</li><li>
<a id="pgfId-1066279"></a>In the Library Browser - Add Instance form, make the following selection.<br />
<a id="pgfId-1066297"></a><table class="webflareTable webflareTableIndent" id="#id1066280">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066282">
<a id="pgfId-1066282"></a>Library</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066284">
<a id="pgfId-1066284"></a>Category</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066286">
<a id="pgfId-1066286"></a>Cell</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066288">
<a id="pgfId-1066288"></a>View</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066290"></a><em>rfLib</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066292"></a><em>top_dwnBB</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066294"></a><em>BB_butterworth_bp</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066296"></a><em>symbol</em></p>
</td>
</tr>
</tbody></table><br />
<a id="pgfId-1066298"></a>In the Library Browser, cell <em>BB_butterworth_bp</em><code> </code>and it&#8217;s default view are both selected.<br />
<a id="pgfId-1066299"></a>At the top of the Add Instance form,<ul><li>
<a id="pgfId-1066300"></a><code>rfLib</code> displays in the<em> Library</em> field</li><li>
<a id="pgfId-1066301"></a><code>BB_butterworth_bp</code><em> </em>displays in the<em> Cell</em> field</li><li>
<a id="pgfId-1066302"></a><code>symbol</code><em> </em>displays in the<em> View </em>field.</li></ul><br />
<a id="pgfId-1066303"></a>The CDF parameters for the Butterworth band pass filter and their default values display at the bottom of the Add Instance form.<br />
<a id="pgfId-1066307"></a><div class="webflare-div-image">
<img width="632" height="267" src="images/AppB-39.gif" /></div></li><li>
<a id="pgfId-1066308"></a>Move the cursor over the Schematic window. The outline for the filter symbol is attached to the cursor. Align the input pins of the filter with the output pins of the LNA.</li><li>
<a id="pgfId-1066309"></a>Click to place the <em>BB_butterworth_bp </em>block to the right of the <em>LNA_BB </em>block.</li><li>
<a id="pgfId-1066310"></a>Click <em>Esc</em> to remove the symbol from the cursor.</li></ol>




















<h4>
<a id="pgfId-1066311"></a>Wiring the Mixer to the Filter</h4>

<ol><li>
<a id="pgfId-1066312"></a>To wire the <em>BB_butterworth_bp </em>block to the<em> </em><em>dwn_cnvrt</em> block, in the Schematic window choose <em>Add - Wire (narrow)</em>.</li><li>
<a id="pgfId-1066313"></a>Click <code>I_out</code> on the <em>dwn_cnvrt</em> block then click <code>ini</code> on the <em>BB_butterworth_bp</em> block.</li><li>
<a id="pgfId-1066314"></a>Click <code>Q_out</code> on the <em>dwn_cnvrt</em> block then click <code>inq</code> on the <em>BB_butterworth_bp</em> block.</li><li>
<a id="pgfId-1066315"></a>Click <em>Esc</em> to stop wiring.<br />
<a id="pgfId-1066316"></a>The schematic now appears as follows.<br />
<a id="pgfId-1066320"></a><div class="webflare-div-image">
<img width="668" height="236" src="images/AppB-40.gif" /></div></li></ol>







<h4><em>
<a id="pgfId-1066321"></a>Modifying Parameter Values for the Band Pass Filter</em></h4>

<ol><li>
<a id="pgfId-1066324"></a>Edit the CDF parameter values for the Butterworth band pass filter as listed in <a href="AppB.html#38928">Table&#160;10-5</a>.<ol><li>
<a id="pgfId-1066326"></a>Choose <em>Edit &#8211; Properties &#8211; Objects</em><em> </em>in the Schematic window.<br />
<a id="pgfId-1066327"></a>The Edit Object Properties form appears. You use this form to change the list of CDF (component description format) properties for the filter and modify the schematic for this simulation.</li><li>
<a id="pgfId-1066328"></a>In the Schematic window, click the filter.<br />
<a id="pgfId-1066329"></a>The Edit Object Properties form changes to display information for the filter.</li><li>
<a id="pgfId-1066333"></a>Change the parameter values to match those in Table <a href="AppB.html#38928">10-5</a>.</li><li>
<a id="pgfId-1066334"></a>Click OK.<br />
<a id="pgfId-1066373"></a><table class="webflareTable" id="#id1066335">
<caption style="text-align:left;"><p>
</p><h4>Table 10-5
<a id="pgfId-1066338"></a><a id="38928"></a>CDF Parameter Values for the Second Butterworth Filter</h4></caption>
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066342">
<a id="pgfId-1066342"></a>Parameter Name</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066344">
<a id="pgfId-1066344"></a>Value</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066346"></a>Filter Order</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066348"></a><code>3 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066350"></a>Input impedance</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066352"></a><code>50 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066354"></a>Output impedance</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066356"></a><code>50 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066358"></a>Center frequency (Hz) </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066360"></a>−<code>frf</code>+<code>flo1 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066362"></a>Relative bandwidth </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066364"></a><code>if_rbw </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066366"></a>Insertion loss (dB) </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066368"></a><code>1 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066370"></a>Carrier frequency </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066372"></a>−<code>frf</code>+<code>flo1 </code></p>
</td>
</tr>
</tbody></table></li></ol></li></ol>














<p>
<a id="pgfId-1066374"></a>As for the first band pass filter, specify the carrier frequency for the baseband equivalent model of the Butterworth band pass filter, just as you do for any reactive element. As shown in <a href="AppB.html#11576">Figure&#160;10-6</a>, the carrier frequency is used to compute speed voltages. Because filters are built up from inductors and capacitors which have speed voltages, you must specify the carrier frequency for filters.</p>
<p>
<a id="pgfId-1066378"></a>When a filter follows an RF-to-IF mixer, its carrier frequency is the IF frequency. The carrier frequency is the frequency to which the baseband signals are referenced. The center frequency of the bandpass filter does not have to equal the carrier frequency. The center frequency is the frequency for which a filter is designed.</p>

<h4>
<a id="pgfId-1066380"></a><a id="83830"></a>Adding an IQ Demodulator</h4>

<p>
<a id="pgfId-1066381"></a>Add an IQ Demodulator (<em>IQ_demod_BB</em>) block to the right of the bandpass filter block.</p>
<ol><li>
<a id="pgfId-1066382"></a>In the Schematic window, choose <em>Add &#8211; Instance</em> to display the Add Instance form.<br />
<a id="pgfId-1066383"></a>The Add Instance form appears. It may be empty or it may display information for a previously added element.</li><li>
<a id="pgfId-1066384"></a>In the Add Instance form, click <em>Browse</em> to display the Library Browser - Add Instance form.</li><li>
<a id="pgfId-1066385"></a>In the Library Browser - Add Instance form,<ol><li>
<a id="pgfId-1066386"></a>If necessary, click <em>Show Categories</em> to display the<em> Category</em> column.</li><li>
<a id="pgfId-1066387"></a>Click <em>rfLib</em> to display elements in <em>rfLib</em>. The <em>Everything</em> category is displayed by default and all cells in <em>rfLib</em> are listed in the <em>Cells</em> column.</li><li>
<a id="pgfId-1066388"></a>In the <em>Category</em> column, click <em>top_dwnBB</em> to display cells in the <em>top_dwnBB</em> category.</li><li>
<a id="pgfId-1066389"></a>In the <em>Cell</em> column, click <em>IQ_demod_BB</em>.</li></ol><br />
<a id="pgfId-1066390"></a>In the Library Browser, cell <em>IQ_demod_BB </em>(the IQ demodulator) and it&#8217;s default view <em>symbol</em> are both selected.<br />
<a id="pgfId-1066394"></a><div class="webflare-div-image">
<img width="668" height="279" src="images/AppB-41.gif" /></div>
<a id="pgfId-1066395"></a>At the top of the Add Instance form, <code>rfLib</code> displays in the<em> Library</em> field,<em> </em><code>IQ_demod_BB </code>displays in the<em> Cell</em> field and <code>symbol</code><em> </em>displays in the<em> View </em>field. The CDF parameters for the IQ demodulator and their default values display at the bottom of the form.<br />
<a id="pgfId-1066399"></a><div class="webflare-div-image">
<img width="632" height="569" src="images/AppB-42.gif" /></div></li><li>
<a id="pgfId-1066400"></a>Move the cursor over the Schematic window. The outline for the IQ demodulator symbol is attached to the cursor. Align the input pins of the IQ demodulator with the output pins of the filter and click to place the <em>IQ_demod_BB</em> block to the right of the second <em>BB_butterworth_bp </em>block.</li><li>
<a id="pgfId-1066401"></a>Click <em>Esc</em> to remove the symbol from the cursor.</li></ol>




















<h4><em>
<a id="pgfId-1066402"></a>Grounding the phase_err Pin on the IQ Demodulator</em></h4>

<p>
<a id="pgfId-1066403"></a>It is necessary to ground the phase error (<em>phase_err</em>) pin on the bottom of the IQ demodulator.</p>

<p>
<a id="pgfId-1066407"></a></p>
<div class="webflare-div-image">
<img width="670" height="169" src="images/AppB-43.gif" /></div>

<ol><li>
<a id="pgfId-1066408"></a>In the Schematic window, choose <em>Add &#8211; Instance</em> to display the Add Instance form.<br />
<a id="pgfId-1066409"></a>The Add Instance form appears. It may be empty or it may display information for a previously added element.</li><li>
<a id="pgfId-1066410"></a>In the Add Instance form, type<ul><li>
<a id="pgfId-1066411"></a><code>analogLib</code> in the<em> Library</em> field</li><li>
<a id="pgfId-1066412"></a><code>gnd</code> in the<em> Cell</em> field</li><li>
<a id="pgfId-1066413"></a><code>symbol</code><em> </em>in the<em> View </em>field.</li></ul></li><li>
<a id="pgfId-1066414"></a>Move the cursor over the Schematic window.</li><li>
<a id="pgfId-1066415"></a>Click to place the ground terminal in line with the phase error node (<code>phase_err</code>) on the bottom of the <em>IQ_demod_BB</em> block.</li><li>
<a id="pgfId-1066416"></a>Click <em>Esc</em> to remove the symbol from the cursor.</li></ol>









<h4>
<a id="pgfId-1066417"></a>Wiring the Filter and Ground to the IQ Demodulator</h4>

<ol><li>
<a id="pgfId-1066418"></a>To wire the <em>IQ_demod_BB </em>block to the<em> BB_butterworth_bp</em> block and the ground, in the Schematic window choose <em>Add - Wire (narrow)</em>.</li><li>
<a id="pgfId-1066419"></a>Click <code>outi</code> on the <em>BB_butterworth_bp</em> block then click <code>I_in</code> on the <em>IQ_demod_BB</em> block.</li><li>
<a id="pgfId-1066420"></a>Click <code>outq</code> on the <em>BB_butterworth_bp</em> block then click <code>Q_in</code> on the <em>IQ_demod_BB</em> block.</li><li>
<a id="pgfId-1066421"></a>Click the port on the <em>gnd</em> block then click <code>phase_err</code> on the <em>IQ_demod_BB</em> block.</li><li>
<a id="pgfId-1066422"></a>Click <em>Esc</em> to stop wiring.<br />
<a id="pgfId-1066423"></a>The schematic now appears as follows.<br />
<a id="pgfId-1066427"></a><div class="webflare-div-image">
<img width="632" height="217" src="images/AppB-44.gif" /></div></li></ol>








<h4><em>
<a id="pgfId-1066428"></a>Modifying Parameter Values for the IQ Demodulator</em></h4>

<ol><li>
<a id="pgfId-1066429"></a>Edit the CDF parameter values for the IQ Demodulator (<em>IQ_demod_BB</em>) as listed in <a href="AppB.html#68790">Table&#160;10-6</a>.<ol><li>
<a id="pgfId-1066433"></a>Choose <em>Edit &#8211; Properties &#8211; Objects</em><em> </em>in the Schematic window.<br />
<a id="pgfId-1066434"></a>The Edit Object Properties form appears. You use this form to change the list of CDF (component description format) properties for <em>IQ_demod_BB</em> and modify the schematic for this simulation.</li><li>
<a id="pgfId-1066435"></a>In the Schematic window, click <em>IQ_demod_BB</em>.<br />
<a id="pgfId-1066436"></a>The Edit Object Properties form changes to display information for <em>IQ_demod_BB</em>.</li><li>
<a id="pgfId-1066440"></a>Change the parameter values to match those in Table <a href="AppB.html#68790">10-6</a>.</li><li>
<a id="pgfId-1066441"></a>Click OK.<br />
<a id="pgfId-1066524"></a><table class="webflareTable" id="#id1066442">
<caption style="text-align:left;"><p>
</p><h4>Table 10-6
<a id="pgfId-1066445"></a><a id="68790"></a>CDF Parameter Values for the IQ Demodulator</h4></caption>
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066449">
<a id="pgfId-1066449"></a>Parameter Name</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066451">
<a id="pgfId-1066451"></a>Value</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066453"></a>available I-mixer gain[dB]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066455"></a><code>0</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066457"></a>available Q-mixer gain[dB]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066459"></a>0</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066461"></a>Input resistance</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066463"></a><code>50 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066465"></a>output resistance</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066467"></a><code>50 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066469"></a>I−[dBm] input referred IP3</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066471"></a><code>40</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066473"></a>Q−[dBm] input referred IP3</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066475"></a>40</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066477"></a>noise figure [dB]</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066479"></a><code>2</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066481"></a>quadrature error</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066483"></a><code>0</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066485"></a>I−sharpness factor </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066487"></a><code>2</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066489"></a>Q−sharpness factor </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066491"></a>2</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066493"></a>I_cmp </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066495"></a>−30</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066497"></a>Q_cmp </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066499"></a>−30</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066501"></a>I−radians@I_cmp </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066503"></a>.7</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066505"></a>Q−radians@Q_cmp </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066507"></a>.7</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066509"></a>I−radians@big I-input</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066511"></a>2</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066513"></a>Q−radians@big Q-input</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066515"></a>2</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066517"></a>I {1,0,−1} for {cw,none,ccw}</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066519"></a>0</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066521"></a>Q {1,0,−1} for {cw,none,ccw}</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066523"></a><code>0</code></p>
</td>
</tr>
</tbody></table></li></ol></li></ol>













<h4>
<a id="pgfId-1066526"></a><a id="19609"></a>Adding Two Butterworth Lowpass Filters</h4>

<ol><li>
<a id="pgfId-1066527"></a>Add two Butterworth low pass filters to the right of the IQ demodulator block.<ul><li>
<a id="pgfId-1066528"></a>Align one filter with the demodulator&#8217;s <code>i_out</code> pin.</li><li>
<a id="pgfId-1066529"></a>Align the other filter with its <code>q_out</code> pin.</li></ul></li><li>
<a id="pgfId-1066530"></a>In the Schematic window, choose <em>Add &#8211; Instance</em> to display the Add Instance form.</li><li>
<a id="pgfId-1066531"></a>In the Add Instance form, click <em>Browse</em> to display the Library Browser - Add Instance form.</li><li>
<a id="pgfId-1066532"></a>In the Library Browser - Add Instance form, make the following selections.<br />
<a id="pgfId-1066550"></a><table class="webflareTable webflareTableIndent" id="#id1066533">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066535">
<a id="pgfId-1066535"></a>Library</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066537">
<a id="pgfId-1066537"></a>Category</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066539">
<a id="pgfId-1066539"></a>Cell</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066541">
<a id="pgfId-1066541"></a>View</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066543"></a><em>rfLib</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066545"></a><em>top_dwnPB</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066547"></a><em>butterworth_lp</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066549"></a><em>symbol</em></p>
</td>
</tr>
</tbody></table><br />
<a id="pgfId-1066551"></a>In the Library Browser, cell <em>butterworth_lp</em><code> </code>and it&#8217;s default view are both selected.<br />
<a id="pgfId-1066552"></a>At the top of the Add Instance form,<ul><li>
<a id="pgfId-1066553"></a><code>rfLib</code> displays in the<em> Library</em> field</li><li>
<a id="pgfId-1066554"></a><code>butterworth_lp</code><em> </em>displays in the<em> Cell</em> field</li><li>
<a id="pgfId-1066555"></a><code>symbol</code><em> </em>displays in the<em> View </em>field.</li><li>
<a id="pgfId-1066556"></a>The CDF parameters for the Butterworth low pass filter and their default values display at the bottom of the Add Instance form.<br /><ffi2-fig-frame-in-2 id="#id1066560">
<a id="pgfId-1066560"></a></ffi2-fig-frame-in-2><div class="webflare-div-image">
<img width="601" height="197" src="images/AppB-45.gif" /></div></li></ul></li><li>
<a id="pgfId-1066561"></a>Move the cursor over the Schematic window. The outline for the butterworth low pass filter symbol is attached to the cursor.<br />
<a id="pgfId-1066562"></a>Align the <em>in</em> pin of the first butterworth low pass filter with the <em>I_out</em> pin (the top pin) of the IQ demodulator and click to place the filter close to the demodulator. Align the <em>in</em> pin of the second butterworth low pass filter with the <em>Q_out</em> pin (the bottom pin) of the IQ demodulator. You have to place it further from the demodulator to align it with the <em>Q_out</em> pin.</li><li>
<a id="pgfId-1066563"></a>Click <em>Esc</em> to remove the symbol from the cursor.</li></ol>























<h4>
<a id="pgfId-1066564"></a>Wiring the IQ Demodulator to the Filters</h4>

<ol><li>
<a id="pgfId-1066565"></a>To wire the <em>IQ_demod_BB </em>block to the<em> butterworth_lp</em> blocks, in the Schematic window choose <em>Add - Wire (narrow)</em>.</li><li>
<a id="pgfId-1066566"></a>Click <code>I_out</code> on the <em>IQ_demod_BB</em> block then click <code>in</code> on the first <em>butterworth_lp </em>block.</li><li>
<a id="pgfId-1066567"></a>Click <code>Q_out </code>on the <em>IQ_demod_BB</em> block then click <code>in</code> on the second <em>butterworth_lp</em> block.</li><li>
<a id="pgfId-1066568"></a>Click <em>Esc</em> to stop wiring.<br />
<a id="pgfId-1066569"></a>The schematic now appears as follows.<br />
<a id="pgfId-1066573"></a><div class="webflare-div-image">
<img width="634" height="214" src="images/AppB-46.gif" /></div></li></ol>







<h4><em>
<a id="pgfId-1066574"></a>Modifying Parameter Values for Both Low Pass Filters</em></h4>

<ol><li>
<a id="pgfId-1066577"></a>Edit the CDF parameter values for the Butterworth low pass filters as listed in <a href="AppB.html#20656">Table&#160;10-7</a>.<ol><li>
<a id="pgfId-1066579"></a>Choose <em>Edit &#8211; Properties &#8211; Objects</em><em> </em>in the Schematic window.<br />
<a id="pgfId-1066580"></a>The Edit Object Properties form appears. You use this form to change the list of CDF (component description format) properties for each filter and modify the schematic for this simulation.</li><li>
<a id="pgfId-1066581"></a>In the Schematic window, click the first low pass filter.<br />
<a id="pgfId-1066582"></a>The Edit Object Properties form changes to display information for the filter.</li><li>
<a id="pgfId-1066586"></a>Change the parameter values to match those in Table <a href="AppB.html#20656">10-7</a>.<br />
<a id="pgfId-1066617"></a><table class="webflareTable" id="#id1066587">
<caption style="text-align:left;"><p>
</p><h4>Table 10-7
<a id="pgfId-1066590"></a><a id="20656"></a>CDF Parameter Values for the Butterworth Low Pass Filters</h4></caption>
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066594">
<a id="pgfId-1066594"></a>Parameter Name</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066596">
<a id="pgfId-1066596"></a>Value</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066598"></a>Filter Order</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066600"></a><code>3 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066602"></a>Input impedance</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066604"></a><code>50 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066606"></a>Output impedance</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066608"></a><code>50 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066610"></a>Corner frequency (Hz) </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066612"></a>10M</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066614"></a>Insertion loss (dB) </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066616"></a><code>0</code></p>
</td>
</tr>
</tbody></table></li><li>
<a id="pgfId-1066618"></a>Click Apply.</li><li>
<a id="pgfId-1066619"></a>In the Schematic window, click the second low pass filter.<br />
<a id="pgfId-1066620"></a>The Edit Object Properties form displays the information you entered for the filter as shown in Table <a href="AppB.html#20656">10-7</a>.</li><li>
<a id="pgfId-1066624"></a>Click OK.</li></ol></li></ol>




















<h4>
<a id="pgfId-1066626"></a><a id="78025"></a>Adding an Instrumentation Block</h4>

<p>
<a id="pgfId-1066627"></a>Add an instrumentation block (<em>offset_comms_instr</em>) block to the right of the low pass filter blocks.</p>
<ol><li>
<a id="pgfId-1066628"></a>In the Schematic window, choose <em>Add &#8211; Instance</em> to display the Add Instance form.<br />
<a id="pgfId-1066629"></a>The Add Instance form appears. It may be empty or it may display information for a previously added element.</li><li>
<a id="pgfId-1066630"></a>In the Add Instance form, click <em>Browse</em> to display the Library Browser - Add Instance form.</li><li>
<a id="pgfId-1066631"></a>In the Library Browser - Add Instance form, make the following selections. (If necessary, click Show Categories at the top of the Library Browser, to display the Category column.)<br />
<a id="pgfId-1066649"></a><table class="webflareTable webflareTableIndent" id="#id1066632">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066634">
<a id="pgfId-1066634"></a>Library</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066636">
<a id="pgfId-1066636"></a>Category</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066638">
<a id="pgfId-1066638"></a>Cell</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066640">
<a id="pgfId-1066640"></a>View</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066642"></a><em>rfLib</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066644"></a><em>measurement</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066646"></a><em>offset_comms_instr</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066648"></a><em>symbol</em></p>
</td>
</tr>
</tbody></table><br />
<a id="pgfId-1066650"></a>In the Library Browser, cell <em>offset_comms_instr </em>and it&#8217;s default view <em>symbol</em> are both selected.<br />
<a id="pgfId-1066651"></a>At the top of the Add Instance form,<ul><li>
<a id="pgfId-1066652"></a><code>rfLib</code> displays in the<em> Library</em></li><li>
<a id="pgfId-1066653"></a><code>offset_comms_instr</code> displays in the<em> Cell</em> field</li><li>
<a id="pgfId-1066654"></a><code>symbol</code><em> </em>displays in the<em> View </em>field</li></ul><br />
<a id="pgfId-1066655"></a>The CDF parameters for the <em>offset_comms_instr</em> and their default values display at the bottom of the form.<br />
<a id="pgfId-1066659"></a><div class="webflare-div-image">
<img width="632" height="353" src="images/AppB-47.gif" /></div></li><li>
<a id="pgfId-1066660"></a>Move the cursor over the Schematic window. The outline for the <em>offset_comms_instr</em> block symbol is attached to the cursor. Align the <em>I_in</em> and <em>Q_in</em> pins of the <em>offset_comms_instr</em> block with the <em>out</em> pins of the butterworth low pass filters and click to place the <em>offset_comms_instr </em>block to the right of the low pass filter blocks.</li><li>
<a id="pgfId-1066661"></a>Click <em>Esc</em> to remove the symbol from the cursor.</li></ol>




















<h4><em>
<a id="pgfId-1066662"></a>Grounding the Reference Pins on the Instrumentation Block</em></h4>

<p>
<a id="pgfId-1066663"></a>It is necessary to ground the reference pins (<em>I_ref</em> and <em>Q_ref</em>) pin near the lower left corner of the instrumentation block.</p>

<p>
<a id="pgfId-1066667"></a></p>
<div class="webflare-div-image">
<img width="668" height="120" src="images/AppB-48.gif" /></div>
<h4><em>
<a id="pgfId-1066668"></a>Grounding the phase_err Pin on the Mixer</em></h4>

<ol><li>
<a id="pgfId-1066669"></a>In the Schematic window, choose <em>Add &#8211; Instance</em> to display the Add Instance form.<br />
<a id="pgfId-1066670"></a>The Add Instance form appears. It may be empty or it may display information for a previously added element.</li><li>
<a id="pgfId-1066671"></a>In the Add Instance form, type<ul><li>
<a id="pgfId-1066672"></a><code>analogLib</code> in the<em> Library</em> field</li><li>
<a id="pgfId-1066673"></a><code>gnd</code> in the<em> Cell</em> field</li><li>
<a id="pgfId-1066674"></a><code>symbol</code><em> </em>in the<em> View </em>field.</li></ul></li><li>
<a id="pgfId-1066675"></a>Move the cursor over the Schematic window.</li><li>
<a id="pgfId-1066676"></a>Click to place the ground terminal in line with the <code>Q_ref</code> node on the bottom of the <em>offset_comms_instr</em> block.</li><li>
<a id="pgfId-1066677"></a>Click <em>Esc</em> to remove the symbol from the cursor.</li></ol>









<h4>
<a id="pgfId-1066678"></a>Wiring the Filter and Ground to the Instrumentation Block</h4>

<ol><li>
<a id="pgfId-1066679"></a>To wire the low pass filters to the<em> </em><em>offset_comms_instr</em> block and the ground, in the Schematic window choose <em>Add - Wire (narrow)</em>.</li><li>
<a id="pgfId-1066680"></a>Click <code>out</code> on the upper <em>butterworth_lp</em> block (the low pass filter connected to the <code>I_out</code> node on the IQ demodulator) then click <code>I_in</code> on the <em>offset_comms_instr</em> block.</li><li>
<a id="pgfId-1066681"></a>Click <code>out</code> on the lower <em>butterworth_lp</em> block (the low pass filter connected to the <code>Q_out</code> node on the IQ demodulator) then click <code>Q_in</code> on the <em>offset_comms_instr</em> block.</li><li>
<a id="pgfId-1066682"></a>Click the port on the <em>gnd</em> block then click the <code>Q_ref</code> node on the <em>offset_comms_instr</em> block.</li><li>
<a id="pgfId-1066683"></a>Click the port on the <em>gnd</em> block then click the <code>I_ref</code> node on the <em>offset_comms_instr</em> block.</li><li>
<a id="pgfId-1066684"></a>Click <em>Esc</em> to stop wiring.<br />
<a id="pgfId-1066685"></a>The schematic now appears as follows.<br />
<a id="pgfId-1066689"></a><div class="webflare-div-image">
<img width="631" height="476" src="images/AppB-49.gif" /></div></li></ol>









<h4><em>
<a id="pgfId-1066690"></a>Modifying Parameter Values for the Instrumentation Block</em></h4>

<ol><li>
<a id="pgfId-1066693"></a>Edit the CDF parameter values for the <em>offset_comms_instr</em> as listed in <a href="AppB.html#85499">Table&#160;10-8</a>.<ol><li>
<a id="pgfId-1066695"></a>Choose <em>Edit &#8211; Properties &#8211; Objects</em><em> </em>in the Schematic window.<br />
<a id="pgfId-1066696"></a>The Edit Object Properties form appears. You use this form to change the list of CDF (component description format) properties for <em>offset_comms_instr</em> and modify the schematic for this simulation.</li><li>
<a id="pgfId-1066697"></a>In the Schematic window, click the <em>offset_comms_instr</em> block.<br />
<a id="pgfId-1066698"></a>The Edit Object Properties form changes to display information for <em>offset_comms_instr</em> block.</li><li>
<a id="pgfId-1066702"></a>Change the parameter values to match those in Table <a href="AppB.html#85499">10-8</a>.</li><li>
<a id="pgfId-1066703"></a>Click OK.<br />
<a id="pgfId-1066754"></a><table class="webflareTable" id="#id1066704">
<caption style="text-align:left;"><p>
</p><h4>Table 10-8
<a id="pgfId-1066707"></a><a id="85499"></a>CDF Parameter Values for the Instrumentation Block</h4></caption>
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066711">
<a id="pgfId-1066711"></a>Parameter Name</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066713">
<a id="pgfId-1066713"></a>Value</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066715"></a>symbols per second</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066717"></a>1228800</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066719"></a>I-sampling delay (secs) </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066721"></a><code>134n</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066723"></a>number of symbols</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066725"></a><code>2</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066727"></a>max eye-diag volts</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066729"></a><code>1</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066731"></a>min eye volts</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066733"></a>−1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066735"></a>number of hstgm bins</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066737"></a><code>100</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066739"></a>I-noise (volts<sup>2</sup>)</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066741"></a><code>0</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066743"></a>Q-noise (volts<sup>2</sup>)</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066745"></a><code>0</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066747"></a>statistics start time</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066749"></a>30u</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066751"></a>input resistance</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066753"></a>50</p>
</td>
</tr>
</tbody></table></li></ol></li></ol>













<h4>
<a id="pgfId-1066756"></a><a id="46081"></a>Adding an Instrumentation Terminator</h4>

<p>
<a id="pgfId-1066757"></a>Add an instrumentation termination (<em>instr_term</em>) block to the right of the instrumentation block. The <em>instr_term </em>block terminates the outputs on the instrumentation block and prevents unused pin warnings.</p>
<ol><li>
<a id="pgfId-1066758"></a>In the Schematic window, choose <em>Add &#8211; Instance</em> to display the Add Instance form.<br />
<a id="pgfId-1066759"></a>The Add Instance form appears. It may be empty or it may display information for a previously added element.</li><li>
<a id="pgfId-1066760"></a>In the Add Instance form, click <em>Browse</em> to display the Library Browser - Add Instance form.</li><li>
<a id="pgfId-1066761"></a>In the Library Browser - Add Instance form, make the following selections. (If necessary, click Show Categories at the top of the Library Browser, to display the Category column.)<br />
<a id="pgfId-1066779"></a><table class="webflareTable webflareTableIndent" id="#id1066762">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066764">
<a id="pgfId-1066764"></a>Library</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066766">
<a id="pgfId-1066766"></a>Category</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066768">
<a id="pgfId-1066768"></a>Cell</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066770">
<a id="pgfId-1066770"></a>View</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066772"></a><em>rfLib</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066774"></a><em>measurement</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066776"></a><em>instr_term</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066778"></a><em>symbol</em></p>
</td>
</tr>
</tbody></table><br />
<a id="pgfId-1066780"></a>In the Library Browser, cell <em>instr_term </em>and it&#8217;s default view <em>symbol</em> are both selected.<br />
<a id="pgfId-1066781"></a>At the top of the Add Instance form,<ul><li>
<a id="pgfId-1066782"></a><code>rfLib</code> displays in the<em> Library</em></li><li>
<a id="pgfId-1066783"></a><code>instr_term</code> displays in the<em> Cell</em> field</li><li>
<a id="pgfId-1066784"></a><code>symbol</code><em> </em>displays in the<em> View </em>field</li></ul><br />
<a id="pgfId-1066785"></a>There are no CDF parameters for the <em>instr_term </em>cell.</li><li>
<a id="pgfId-1066786"></a>Move the cursor over the Schematic window. The outline for the <em>instr_term </em>symbol is attached to the cursor. Move the <em>instr_term</em><em> </em>block to the right of the instrumentation block and align the input pins of the instrumentation termination block with the output pins of the instrumentation block.</li><li>
<a id="pgfId-1066787"></a>Click to place the <em>instr_term</em><em> </em>block.</li><li>
<a id="pgfId-1066788"></a>Click <em>Esc</em> to remove the symbol from the cursor.</li></ol>

















<h4>
<a id="pgfId-1066789"></a>Wiring the Termination Block to the Instrumentation Block</h4>

<ol><li>
<a id="pgfId-1066790"></a>To wire the instrumentation (<em>offset_comms_instr) </em>block to the Instrumentation terminator (<em>instr_term) </em>block, in the Schematic window choose <em>Add - Wire (narrow)</em>.</li><li>
<a id="pgfId-1066791"></a>Wire the aligned pins straight across.</li><li>
<a id="pgfId-1066792"></a>Click <em>Esc</em> to stop wiring.<br />
<a id="pgfId-1066793"></a>The schematic should look as follows.<br />
<a id="pgfId-1066797"></a><div class="webflare-div-image">
<img width="632" height="521" src="images/AppB-50.gif" /></div></li><li>
<a id="pgfId-1066798"></a>In the Schematic window, choose <em>Design &#8211; Design Check and Save</em>.<br />
<a id="pgfId-1066799"></a>The completed schematic is verified and saved.</li></ol>









<p>
<a id="pgfId-1066802"></a>The schematic for the complete receiver model should look like the one in <a href="AppB.html#30727">Figure&#160;10-7</a>.</p>

<p><strong>Figure 10-7
<a id="pgfId-1066805"></a><a id="30727"></a>Completed receiver model</strong></p>
<p>
<a id="pgfId-1066809"></a></p>
<div class="webflare-div-image">
<img width="667" height="509" src="images/AppB-51.gif" /></div>
<h3>
<a id="pgfId-1066810"></a>Setting Variable Values for the Receiver Schematic</h3>

<p>
<a id="pgfId-1066811"></a>Copy the variables you entered as CDF parameters for the individual blocks from the receiver schematic to the ADE window. Then edit each variable to give it the value specified in <a href="AppB.html#25994">Table&#160;10-9</a>.</p>
<ol><li>
<a id="pgfId-1066815"></a>In the ADE window, choose <em>Variables &#8211; Copy From Cellview</em> to copy the variables from the receiver schematic to the Design Variables area on the ADE window.<br />
<a id="pgfId-1066816"></a>The copied variables display in the <em>Design Variables</em> area in the ADE window.<br />
<a id="pgfId-1066820"></a><div class="webflare-div-image">
<img width="635" height="249" src="images/AppB-52.gif" /></div></li><li>
<a id="pgfId-1066821"></a>In the ADE window, choose <em>Variables &#8211; Edit</em> to open the Editing Design Variables form.<br />
<a id="pgfId-1066825"></a><div class="webflare-div-image">
<img width="632" height="271" src="images/AppB-53.gif" /></div></li></ol>









<h4>
<a id="pgfId-1066826"></a>Adding the Values to the Copied Variables</h4>

<p>
<a id="pgfId-1066827"></a>In the Editing Design Variables form, one by one, select each variable in the <em>Table of Design Variables</em> and associate with each one, the value listed in Table <a href="AppB.html#25994">10-9</a>.</p>

<p>
<a id="pgfId-1066873"></a></p>
<table class="webflareTable" id="#id1066831">
<caption style="text-align:left;"><p>
</p><h4>Table 10-9
<a id="pgfId-1066834"></a><a id="25994"></a>Values for Receiver Variables</h4></caption>
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066838">
<a id="pgfId-1066838"></a>Variable </span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1066840">
<a id="pgfId-1066840"></a>Value</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066842"></a><code>lna_gain</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066844"></a>15</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066846"></a><code>lna_ip3</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066848"></a>−5</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066850"></a><code>if_mx_gain</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066852"></a>10</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066854"></a><code>if_mx_ip</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066856"></a>35</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066858"></a><code>frf</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066860"></a>2.14G</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066862"></a><code>flo1</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066864"></a>2.354G</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066866"></a><code>if_rbw</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066868"></a>200m</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066870"></a><code>rf_rbw</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1066872"></a>100m</p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1066874"></a>To associate a value with a design variable</p>
<ol><li>
<a id="pgfId-1066875"></a>In the <em>Table of Design Variables</em>, click <code>lna_gain</code>.<br />
<a id="pgfId-1066876"></a><code>lna_gain</code> displays in the <em>Name</em> field.</li><li>
<a id="pgfId-1066880"></a>In the <em>Value (Expr)</em> field, enter the number <code>15,</code> the value from <a href="AppB.html#25994">Table&#160;10-9</a>.</li><li>
<a id="pgfId-1066881"></a>Click <em>Change</em> to list the variable name and its value from the <em>Table of Design Variables.</em></li><li>
<a id="pgfId-1066883"></a>Repeat these steps for the remaining variables listed in the <em>Table of Design Variables </em>to associate the values from <a href="AppB.html#25994">Table&#160;10-9</a> with the variable names.</li><li>
<a id="pgfId-1066887"></a>Click <em>OK</em> in the Editing Design Variables form after you have added all the variable values.<br />
<a id="pgfId-1066888"></a>The table of <em>Design Variables</em> in the ADE window is updated and the Editing Design Variables form is closed.<br />
<a id="pgfId-1066892"></a><div class="webflare-div-image">
<img width="632" height="242" src="images/AppB-54.gif" /></div></li></ol>









<h3>
<a id="pgfId-1066894"></a><a id="70721"></a>Setting Up and Running a Transient Analysis</h3>

<ol><li>
<a id="pgfId-1066895"></a>In the ADE window, choose <em>Analyses &#8211; Choose</em> to display the Choosing Analyses form.</li><li>
<a id="pgfId-1066896"></a>In the Choosing Analyses form, if necessary, click <em>tran</em> to select a transient analysis.</li><li>
<a id="pgfId-1066897"></a>In the Choosing Analyses form, enter <code>130u</code> in the <em>Stop Time</em> field.</li><li>
<a id="pgfId-1066898"></a>Highlight <em>moderate</em> for <em>Accuracy Defaults (errpreset)</em>.<br />
<a id="pgfId-1066902"></a><div class="webflare-div-image">
<img width="631" height="472" src="images/AppB-55.gif" /></div></li><li>
<a id="pgfId-1066903"></a>In the Choosing Analyses form, click <em>Options</em> to display the Transient Options form.</li><li>
<a id="pgfId-1066904"></a>In the Transient Options form, enter <code>30u </code>in the <em>outputstart</em> field.<br />
<a id="pgfId-1066908"></a><div class="webflare-div-image">
<img width="631" height="137" src="images/AppB-56.gif" /></div>
<a id="pgfId-1066909"></a>By delaying the output start, you remove start-up transients from the eye-diagrams and scatter plots.</li><li>
<a id="pgfId-1066910"></a>Click <em>OK</em> in the Transient Options form.</li><li>
<a id="pgfId-1066911"></a>Click <em>OK</em> in the Choosing Analyses form.</li><li>
<a id="pgfId-1066912"></a>If you have not already done so, set up the simulator and model libraries with the following steps.<ol><li>
<a id="pgfId-1066915"></a>Set the simulator options from the Simulator window as described in <a href="AppB.html#84199">&#8220;Choosing Simulator Options&#8221;</a>.</li><li>
<a id="pgfId-1066919"></a>Set up the model libraries from the Simulator window as described in <a href="AppB.html#89927">&#8220;Setting Up Model Libraries&#8221;</a>.</li></ol></li><li>
<a id="pgfId-1066921"></a>In the ADE window, choose <em>Simulation &#8211; Netlist and Run</em>.<br />
<a id="pgfId-1066922"></a>Messages display in the CIW. The simulation log window opens. Watch for messages stating that the simulation has completed successfully.<br />
<a id="pgfId-1066923"></a>Watch the CIW for messages stating the simulation is running and that it has completed successfully.</li></ol>























<h3>
<a id="pgfId-1066924"></a>Examining the Results: Eye Diagram, Histogram, and Scatter Plot</h3>

<p>
<a id="pgfId-1066925"></a>In this section we examine the results of the transient analysis of the receiver.</p>

<h4>
<a id="pgfId-1066926"></a>Plotting the Eye Diagram (and Transient Response)</h4>

<p>
<a id="pgfId-1066927"></a>First plot an eye diagram.</p>
<ol><li>
<a id="pgfId-1066928"></a>In the ADE window, choose <em>Results &#8211; Direct Plot &#8211; Transient Signal</em>.<br />
<a id="pgfId-1066929"></a>The Virtuoso Schematic Editing window appears.</li><li>
<a id="pgfId-1066930"></a>Following the prompts at the bottom of the window,<br />
<a id="pgfId-1066931"></a><em>&gt; Select nodes or terminals, press &lt;esc&gt; to finish selection</em><ol><li>
<a id="pgfId-1066932"></a>In the Schematic window, click the <em>sawtooth</em> net from the instrumentation (<em>offset_comms_instr</em>) block.<br /><ffi2-fig-frame-in-2 id="#id1066936">
<a id="pgfId-1066936"></a></ffi2-fig-frame-in-2><div class="webflare-div-image">
<img src="images/907_sawtoothNetSelect.gif" /></div></li><li>
<a id="pgfId-1066937"></a>Click the <em>I_eye</em> net from the instrumentation (<em>offset_comms_instr</em>) block.<br /><ffi2-fig-frame-in-2 id="#id1066941">
<a id="pgfId-1066941"></a></ffi2-fig-frame-in-2><div class="webflare-div-image">
<img src="images/908_IeyeNetSelect.gif" /></div></li><li>
<a id="pgfId-1066942"></a>Press <em>Esc</em> to indicate that you have finished selecting outputs.<br />
<a id="pgfId-1066943"></a>This opens a waveform window and creates a plot of the Transient Response of the net.<br /><ffi2-fig-frame-in-2 id="#id1066947">
<a id="pgfId-1066947"></a></ffi2-fig-frame-in-2><div class="webflare-div-image">
<img src="images/908_Net21Transient.gif" /></div></li></ol></li><li>
<a id="pgfId-1066948"></a>In the waveform window, double-click the X axis.<br />
<a id="pgfId-1066949"></a>The Axis Attributes form displays:<ol><li>
<a id="pgfId-1066950"></a>In the <em>Plot vs </em>field, select the <code>sawtooth</code> net, such as <code>/net15</code>.<br /><ffi2-fig-frame-in-2 id="#id1066954">
<a id="pgfId-1066954"></a></ffi2-fig-frame-in-2><div class="webflare-div-image">
<img src="images/909_AxisAttributes.gif" /></div></li><li>
<a id="pgfId-1066955"></a>Click <em>OK</em>.</li></ol><br />
<a id="pgfId-1066959"></a>You see the eye-diagram shown in <a href="AppB.html#42400">Figure&#160;10-8</a>.<br /><strong class="webflare-fig-line-height">Figure 10-8
<a id="pgfId-1066961"></a><a id="42400"></a>Eye-diagram</strong>
<a id="pgfId-1066965"></a><div class="webflare-div-image">
<img src="images/910_net21EyeDiagram.gif" /></div>
<a id="pgfId-1066966"></a>The I-sampling delay parameter in the instrumentation block (<em>I_del</em>) is chosen with respect to this eye diagram. The delay is the time when the eye opens the widest.<br />
<a id="pgfId-1066967"></a>The instrumentation block samples the input waveforms with this delay to compute all statistics and to produce scatter plots.</li><li>
<a id="pgfId-1066968"></a>In the waveform window, choose <em>File &#8211; Close</em>.<br />
<a id="pgfId-1066969"></a>The waveform window closes.</li></ol>






































<h4>
<a id="pgfId-1066970"></a>Generate the Histogram</h4>

<p>
<a id="pgfId-1066971"></a>Now generate a histogram of the I-voltage at the sampling times.</p>
<ol><li>
<a id="pgfId-1066972"></a>In the ADE window, choose <em>Results &#8211; Direct Plot &#8211; Transient Signal</em>.<br />
<a id="pgfId-1066973"></a>The Virtuoso Schematic Editing window appears.</li><li>
<a id="pgfId-1066974"></a>Following the prompts at the bottom of the window,<ol><li>
<a id="pgfId-1066975"></a>Click the <em>eye_hist</em> net from the instrumentation (<em>offset_comms_instr) </em>block.</li><li>
<a id="pgfId-1066976"></a>Click the <em>eye_count_hist</em> net from <em>offset_comms_instr</em>.</li><li>
<a id="pgfId-1066977"></a>Press <em>Esc</em> to indicate that you have finished selecting outputs.<br />
<a id="pgfId-1066978"></a>This creates a plot in the waveform window.</li></ol></li><li>
<a id="pgfId-1066979"></a>In the waveform window, double-click the X axis.<br />
<a id="pgfId-1066980"></a>The Axis Attributes form displays:<ol><li>
<a id="pgfId-1066981"></a>In the <em>Plot vs </em>field, select the <em>eye_hist</em> output, such as <code>/net17</code>.</li><li>
<a id="pgfId-1066982"></a>Click <em>OK</em>.</li></ol><br />
<a id="pgfId-1066983"></a>This creates an unintelligible intermediate plot in the waveform window.</li><li>
<a id="pgfId-1066984"></a>In the waveform window, double-click the trace in the graph.<br />
<a id="pgfId-1066985"></a>The Trace Attributes form displays.<ol><li>
<a id="pgfId-1066986"></a>In the <em>Type/Style </em>cyclic field, select <em>Bars</em>.</li><li>
<a id="pgfId-1066987"></a>Click <em>OK</em>.</li></ol><br />
<a id="pgfId-1066991"></a>You see a plot like <a href="AppB.html#15712">Figure&#160;10-9</a>.<br /><strong class="webflare-fig-line-height">Figure 10-9
<a id="pgfId-1066993"></a><a id="15712"></a>Histogram</strong>
<a id="pgfId-1066997"></a><div class="webflare-div-image">
<img src="images/13Histogram.gif" /></div></li><li>
<a id="pgfId-1066998"></a>In the waveform window, choose <em>File &#8211; Close</em>.<br />
<a id="pgfId-1066999"></a>The waveform window closes.</li></ol>


























<h4>
<a id="pgfId-1067000"></a>Generating the Scatter Plot</h4>

<p>
<a id="pgfId-1067001"></a>Generate a scatter plot of the received symbols.</p>
<ol><li>
<a id="pgfId-1067002"></a>In the ADE window, choose <em>Results &#8211; Direct Plot &#8211; Transient Signal</em>.<br />
<a id="pgfId-1067003"></a>This displays the waveform window.</li><li>
<a id="pgfId-1067004"></a>Following the prompts at the bottom of the waveform window,<br />
<a id="pgfId-1067005"></a>In the Schematic window:<ol><li>
<a id="pgfId-1067006"></a>Click the <em>I_scatter</em> output from the instrumentation (<em>offset_comms_instr) </em>block.</li><li>
<a id="pgfId-1067007"></a>Click the <em>Q_scatter</em> output from <em>offset_comms_instr</em>.</li><li>
<a id="pgfId-1067008"></a>Click <em>Esc</em> to indicate that you have finished selecting outputs.<br />
<a id="pgfId-1067009"></a>This creates a plot in the waveform window.</li></ol></li><li>
<a id="pgfId-1067010"></a>In the waveform window, double-click the X axis.<br />
<a id="pgfId-1067011"></a>The Axis Attributes form displays:<ol><li>
<a id="pgfId-1067012"></a>In the <em>Plot vs </em>field, select the <em>I_scatter</em> output, such as <code>/net22</code>.</li><li>
<a id="pgfId-1067013"></a>Click <em>OK</em>.</li></ol></li><li>
<a id="pgfId-1067014"></a>In the waveform window, double-click the trace in the graph.<br />
<a id="pgfId-1067015"></a>The Trace Attributes form displays.<ol><li>
<a id="pgfId-1067016"></a>In the <em>Type/Style </em>cyclic field, select <em>Points</em>.</li><li>
<a id="pgfId-1067017"></a>Click <em>OK</em>.</li></ol><br />
<a id="pgfId-1067021"></a>You see a scatter plot like <a href="AppB.html#39327">Figure&#160;10-10</a>.<br /><strong class="webflare-fig-line-height">Figure 10-10
<a id="pgfId-1067023"></a><a id="39327"></a>Scatter Plot</strong>
<a id="pgfId-1067027"></a><div class="webflare-div-image">
<img src="images/917_ScatterPlot.gif" /></div></li><li>
<a id="pgfId-1067028"></a>In the waveform window, choose <em>File &#8211; Close</em>.<br />
<a id="pgfId-1067029"></a>The waveform window closes.</li></ol>


























<h4>
<a id="pgfId-1067030"></a>The Various Instrumentation Blocks</h4>

<p>
<a id="pgfId-1067031"></a>The CDMA source (<em>CDMA_reverse_xmit) </em>produced offset QPSK symbols. Offset QPSK modulation avoids traversing the origin by staggering the digital changes in the I and Q signals. Running the baseband trajectory through the origin increases spectral regrowth in the transmitters.</p>
<p>
<a id="pgfId-1067032"></a>The instrumentation block (<em>offset_comms_instr</em>) samples the I and Q signals at different times then plots the two staggered samples against each other. The resulting scatter plot shows the received symbols. A scatter plot of the unstaggered samples reveals only what is happening in one dimension, either the I or Q dimension.</p>
<p>
<a id="pgfId-1067033"></a>For non-offset QPSK and QAM modulation schemes, use the <em>comms_instr</em> instrumentation block instead of the <em>offset_comms_instr</em> block.</p>

<h4>
<a id="pgfId-1067034"></a>Measuring RMS EVM</h4>

<p>
<a id="pgfId-1067035"></a>You can use the same instrumentation block (<em>offset_comms_instr</em>) to compute root-mean-squared error vector magnitude (RMS EVM). The error vector is the vectorial difference between the ideal received symbol and the actual received symbol.</p>
<ul><li>
<a id="pgfId-1067036"></a>EVM (error vector magnitude) is the magnitude of the error vector.</li><li>
<a id="pgfId-1067037"></a>RMS EVM is the root-mean-squared value of a sequence of EVMs.</li></ul>

<p>
<a id="pgfId-1067038"></a>RMS EVM is one measure of a receiver&#8217;s quality. RMS EVM can account for as much or as little distortion and noise as you like. The trick is to figure out where the ideal received symbol lies. You can do this using the <em>I_ref</em> and <em>Q_ref</em> inputs to the <em>offset_comms_instr</em> instrumentation block.</p>
<p>
<a id="pgfId-1067039"></a>To calculate RMS EVM, you</p>
<ul><li>
<a id="pgfId-1067040"></a>Create a duplicate copy of the receiver chain from the <em>BB_driver</em> to the <em>IQ_demod_BB</em> including these two blocks</li><li>
<a id="pgfId-1067041"></a>Place the duplicate copy below the original receiver chain in the Schematic window</li><li>
<a id="pgfId-1067042"></a>Modify the duplicate receiver chain to make it as <em>ideal</em> as you like by changing parameter values for the individual function blocks.<br />
<a id="pgfId-1067043"></a>For example, to see the effect of just the LNA&#8217;s IP3 value on RMS EVM, in the duplicate receiver chain make the LNA&#8217;s IP3 absurdly large.</li></ul>




<h4>
<a id="pgfId-1067044"></a>Constructing the Ideal Receiver Chain</h4>

<p>
<a id="pgfId-1067045"></a>The <em>ideal</em> receiver chain (the duplicated and modified receiver chain) is driven from the same input, the <em>CDMA_reverse_xmit</em> block<em>, </em>as the original receiver chain. The output of the ideal receiver chain drives the instrumentation block&#8217;s <em>I_ref</em> and <em>Q_ref</em> inputs.</p>
<p>
<a id="pgfId-1067046"></a>In the ideal receiver chain, you copy the first receiver chain and make every block ideal.</p>
<ol><li>
<a id="pgfId-1067047"></a>Remove the <em>gnd</em> from the <em>I_ref</em> and <em>Q_ref</em> pins on the instrumentation block.<ol><li>
<a id="pgfId-1067048"></a>In the Schematic window, choose <em>Edit - Delete</em>.</li><li>
<a id="pgfId-1067049"></a>In the Schematic window, click each wire and the <em>Gnd</em> symbol attached to the <em>I_ref</em> and <em>Q_ref</em> pins.<br /><ffi2-fig-frame-in-2 id="#id1067053">
<a id="pgfId-1067053"></a></ffi2-fig-frame-in-2><div class="webflare-div-image">
<img src="images/RMSEVM1.gif" /></div></li><li>
<a id="pgfId-1067054"></a>Click <em>esc</em> to stop deleting.</li></ol></li><li>
<a id="pgfId-1067055"></a>Duplicate the receiver chain from the <em>BB_driver</em> to the <em>IQ_demod_BB </em>inclusive. Do not duplicate the filters. Follow the prompts at the bottom of the Schematic window.<ol><li>
<a id="pgfId-1067056"></a>In the Schematic window, choose <em>Edit &#8211; Copy</em>.</li><li>
<a id="pgfId-1067057"></a>In the Schematic window, draw a box around the blocks to copy by clicking to the left of and above the <em>BB_driver</em> block and dragging the cursor to a point below and to the right of the <em>IQ_demod_BB</em> block. Click again to complete the box.<br />
<a id="pgfId-1067058"></a>The blocks within the box are highlighted.</li><li>
<a id="pgfId-1067059"></a>Click within the highlighted area.<br />
<a id="pgfId-1067060"></a>A copy of the highlighted blocks in the receiver chain now moves with the cursor.</li><li>
<a id="pgfId-1067061"></a>Place the duplicate receiver chain so that the output pins on the <em>IQ_demod_BB</em> are in line with the <em>I_ref</em> and <em>Q_ref</em> pins on the instrumentation block.<br /><ffi2-fig-frame-in-2 id="#id1067065">
<a id="pgfId-1067065"></a></ffi2-fig-frame-in-2><div class="webflare-div-image">
<img src="images/RMSEVM2.gif" /></div></li></ol></li><li>
<a id="pgfId-1067066"></a>Wire the duplicate receiver chain to the CDMA signal source (<em>CDMA_reverse_xmit) </em>and the instrumentation block (<em>offset_comms_instr</em>).<ol><li>
<a id="pgfId-1067067"></a>In the Schematic window, choose<em> Add - Wire (narrow).</em></li><li>
<a id="pgfId-1067068"></a>Connect the <em>IQ_demod_BB</em> outputs on the duplicate receiver to the <em>I_ref</em> and <em>Q_ref </em>pins on the instrumentation block.</li><li>
<a id="pgfId-1067069"></a>Connect the output pins on <em>CDMA_reverse_xmit</em> to the input pins of the duplicate <em>BB_driver</em>. This drives the duplicate receiver from the CDMA signal source.</li><li>
<a id="pgfId-1067070"></a>Click <em>esc</em> to stop wiring.</li></ol></li></ol>































<p>
<a id="pgfId-1067074"></a>The schematic with the duplicate receiver chain wired up looks like Figure <a href="AppB.html#62269">10-11</a>.</p>

<p><strong>Figure 10-11
<a id="pgfId-1067076"></a><a id="62269"></a>Receiver Model with Duplicated Receiver Chain</strong></p>
<p>
<a id="pgfId-1067080"></a></p>
<div class="webflare-div-image">
<img src="images/RMSEVM3.gif" /></div>
<h4>
<a id="pgfId-1067081"></a>Modifying Parameter Values to Make the Blocks Ideal</h4>

<p>
<a id="pgfId-1067082"></a>Now modify the parameter values for each block in the duplicate receiver chain to create ideal blocks. Block names, parameter names, and parameter values are given in Table <a href="AppB.html#42731">10-10</a>.</p>

<p>
<a id="pgfId-1067130"></a></p>
<table class="webflareTable" id="#id1067086">
<caption style="text-align:left;"><p>
</p><h4>Table 10-10
<a id="pgfId-1067089"></a><a id="42731"></a>Parameter Values <strong>to Create an Ideal Receiver</strong></h4></caption>
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1067095">
<a id="pgfId-1067095"></a>Block Names</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1067097">
<a id="pgfId-1067097"></a>Parameter Names </span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1067099">
<a id="pgfId-1067099"></a>New Parameter
Values </span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067101"></a><code>LNA_BB</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067103"></a><em>Input referred IP3 [dBm]</em> 
<em>{1,0,-1} for {cw, none, ccw}</em> </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067105"></a><code>100 <br />0 </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067107"></a><code>BB_butterworth_bp</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067109"></a><em>Cell Name</em> </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067111"></a><code>BB_loss</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067113"></a><code>dwn_cnvrt</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067115"></a><em>Input referred IP3 [dBm]</em> </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067117"></a><code>100</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067119"></a><code>BB_butterworth_bp</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067121"></a><em>Cell Name</em></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067123"></a><code>BB_loss </code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067125"></a><code>IQ_demod_BB</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067127"></a><em>I-[dBm] Input referred IP3</em><code> <br /></code><em>Q-[dBm] Input referred IP3</em><code> </code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067129"></a><code>100 <br />100</code></p>
</td>
</tr>
</tbody></table>

<ol><li>
<a id="pgfId-1067131"></a>In the Schematic window, choose <em>Edit &#8211; Properties &#8211; Objects</em> to open the Edit Object Properties form.</li><li>
<a id="pgfId-1067132"></a>In the Schematic window, select the <em>LNA_BB</em> block.<br />
<a id="pgfId-1067133"></a>The Edit Object Properties form changes to display properties for the <em>LNA_BB</em> block.<ol><li>
<a id="pgfId-1067134"></a>Set <em>Input referred IP3 [dBm]</em> to 100.</li><li>
<a id="pgfId-1067135"></a>Set <em>{1, 0,-1} for {cw, none, ccw} </em>to 0. (This eliminates AM/PM conversion.)</li><li>
<a id="pgfId-1067136"></a>Click <em>Apply</em>.</li></ol></li><li>
<a id="pgfId-1067137"></a>In the Schematic window, select the first RF <em>BB_butterworth_bp</em> block.<br />
<a id="pgfId-1067138"></a>The Edit Object Properties form changes to display properties for the <em>BB_butterworth_bp </em>block.<ol><li>
<a id="pgfId-1067139"></a>Change the <em>Cell Name</em> to <em>BB_loss</em>.</li><li>
<a id="pgfId-1067140"></a>Click <em>Apply</em>.</li></ol><br />
<a id="pgfId-1067141"></a>The properties and symbol change to those for the <em>BB_loss</em> block. The sole purpose of the <em>BB_loss</em> model is to replace a filter in an RMS EVM analysis.<br />
<a id="pgfId-1067142"></a>The <em>Reference impedance</em> for the <em>BB_loss</em> block should equal the <em>Output impedance</em> of the <em>BB_butterworth_bp</em> bandpass filter block it replaces. The value should be 50 ohms for both blocks and you should not have to change it.<br />
<a id="pgfId-1067143"></a>The <em>BB_loss</em> model retains the filter&#8217;s loss but eliminates the filter&#8217;s dynamics so you can see what, if any, affect the filter has on EVM through inter-symbol interference. To eliminate the loss as well as the dynamics, you might even replace the filter with straight wires. This example uses the <em>BB_loss</em> block instead.</li><li>
<a id="pgfId-1067144"></a>In the Schematic window, select the <em>dwn_cnvrt</em> block.<br />
<a id="pgfId-1067145"></a>The Edit Object Properties form changes to display properties for the <em>dwn_cnvrt </em>block<ol><li>
<a id="pgfId-1067146"></a>Set <em>Input referred IP3 [dBm]</em> to 100.</li><li>
<a id="pgfId-1067147"></a>Click <em>Apply</em>.</li></ol></li><li>
<a id="pgfId-1067148"></a>In the Schematic window, select the second <em>BB_butterworth_bp</em> block.<br />
<a id="pgfId-1067149"></a>The Edit Object Properties form changes to display properties for the <em>BB_butterworth_bp </em>block<ol><li>
<a id="pgfId-1067150"></a>Change the <em>Cell Name</em> to <em>BB_loss</em>.</li><li>
<a id="pgfId-1067151"></a>Click <em>Apply</em>.</li></ol></li><li>
<a id="pgfId-1067152"></a>In the Schematic window, select the <em>IQ_demod_BB</em> block.<br />
<a id="pgfId-1067153"></a>The Edit Object Properties form changes to display properties for the <em>IQ_demod_BB </em>block<ol><li>
<a id="pgfId-1067154"></a>Set <em>I-[dBm] input referred IP3 </em>to 100.</li><li>
<a id="pgfId-1067155"></a>Set <em>Q-[dBm] input referred IP3 </em>to 100.</li><li>
<a id="pgfId-1067156"></a>Click <em>Apply</em>.</li></ol></li><li>
<a id="pgfId-1067157"></a>In the Edit Object Properties form, click <em>OK </em>to close the form.</li><li>
<a id="pgfId-1067158"></a>In the Schematic window, choose <em>Design &#8211; Check and Save</em> to check and save your modifications to the circuit.</li></ol>


































<h4>
<a id="pgfId-1067159"></a>Set Up and Run a Transient Analysis</h4>

<p>
<a id="pgfId-1067162"></a>Set up and run a transient analysis as described in <a href="AppB.html#70721">&#8220;Setting Up and Running a Transient Analysis&#8221;</a>. Set the <em>Stop Time</em> to <code>130u</code> and the <em>outputstart</em> option to <code>30u</code>. Click <em>OK</em> in both the Transient Options and Choosing Analyses forms. Choose <em>Simulation &#8211; Netlist and Run</em> to run the transient analysis.</p>
<p>
<a id="pgfId-1067164"></a>Look for messages in the CIW stating that the simulation is starting. Watch the simulation log window for messages that the simulation has completed successfully.</p>

<h4>
<a id="pgfId-1067165"></a>Plot the RMS EVM Output</h4>

<p>
<a id="pgfId-1067166"></a>After the simulation, plot the RMS_EVM output of the instrumentation block.</p>
<ol><li>
<a id="pgfId-1067167"></a>In the ADE window, choose <em>Results &#8211; Direct Plot &#8211; Transient Signal</em>.<br />
<a id="pgfId-1067168"></a>This displays the waveform window.</li><li>
<a id="pgfId-1067169"></a>Following the prompts at the bottom of the waveform window,<ol><li>
<a id="pgfId-1067170"></a>In the schematic, click the <em>rms_EVM </em>output net from the instrumentation (<em>offset_comms_instr) </em>block.</li><li>
<a id="pgfId-1067171"></a>Click <em>Esc</em> to indicate that you have finished selecting outputs.<br />
<a id="pgfId-1067174"></a>This creates the RMS EVM plot in the waveform window as shown in <a href="AppB.html#92542">Figure&#160;10-12</a>.<br /><strong class="webflare-fig-line-height">Figure 10-12
<a id="pgfId-1067177"></a><a id="92542"></a>RMS EVM</strong>
<a id="pgfId-1067181"></a><div class="webflare-div-image">
<img src="images/RMSEVM4.gif" /></div></li></ol>
<a id="pgfId-1067182"></a>The RMS EVM trace starts at 30us, which is the <code>statistics start time</code> parameter of the instrumentation block. The <code>statistics start time</code> parameter keeps start-up transients out of the statistics.<br />
<a id="pgfId-1067183"></a>The trace settles out at 25.84 Volts. This means that after 130us of data is collected, and ignoring the first 30us, the RMS EVM is 25.84%. The EVM measurement is normalized to the RMS magnitude of the ideal symbol then multiplied by 100 to express the measurement as a percentage.</li><li>
<a id="pgfId-1067184"></a>In the waveform window, choose <em>File &#8211; Close</em>.</li></ol>
















<h3>
<a id="pgfId-1067185"></a>Computing Minimized RMS Noise Using the Optimizer</h3>

<p>
<a id="pgfId-1067186"></a>There is one more construction step before proceeding to the Circuit Optimizer application. You set up the Circuit Optimizer to minimize RMS noise subject to performance constraints. This step replicates the receiver chain yet one more time to generate the noise measurement.</p>
<ol><li>
<a id="pgfId-1067187"></a>Duplicate the original receiver chain from the <em>BB_driver </em>up to and including both low pass filters (<em>butterworth_lp</em>). Follow the prompts at the bottom of the Schematic window.<ol><li>
<a id="pgfId-1067188"></a>In the Schematic window, choose <em>Edit &#8211; Copy</em>.</li><li>
<a id="pgfId-1067189"></a>In the Schematic window, draw a box around the blocks to copy by clicking to the left of and above the <em>BB_driver</em> block and dragging the cursor to a point below and to the right of the <em>butterworth_lp</em> filter blocks. Click again to complete the box.<br />
<a id="pgfId-1067190"></a>The blocks within the box are highlighted.</li><li>
<a id="pgfId-1067191"></a>Click within the highlighted area.<br />
<a id="pgfId-1067192"></a>A copy of the highlighted blocks in the receiver chain now moves with the cursor.</li><li>
<a id="pgfId-1067193"></a>Place the duplicate receiver chain above the original receiver chain.<br />
<a id="pgfId-1067197"></a><div class="webflare-div-image">
<img src="images/RMSEVM5.gif" /></div></li></ol></li><li>
<a id="pgfId-1067198"></a>In the duplicate receiver chain, ground the <em>Q_in</em> pin on the <em>BB_driver</em> block.<ol><li>
<a id="pgfId-1067199"></a>In the Schematic window, choose <em>Add &#8211; Wire.</em></li><li>
<a id="pgfId-1067200"></a>Click the <em>Q_in</em> pin and run the wire to the <em>Gnd</em> symbol below the <em>dwn_cnvrt</em> block.</li><li>
<a id="pgfId-1067201"></a>Click the <em>Gnd</em> symbol below the <em>dwn_cnvrt</em> block.</li><li>
<a id="pgfId-1067202"></a>Click <em>esc</em> to stop wiring.</li></ol></li><li>
<a id="pgfId-1067203"></a>Add a 50mV DC voltage source to the left of the <em>BB_driver</em> block to drive the <em>I_in</em> pin on the <em>BB_driver</em> block. At the same time add a <em>gnd</em> symbol below the <em>port</em> in the schematic.<ol><li>
<a id="pgfId-1067204"></a>In the Schematic window, choose <em>Add &#8211; Instance</em> to display the Add Instance form.</li><li>
<a id="pgfId-1067205"></a>In the Add Instance form, click <em>Browse</em> to display the Library Browser - Add Instance form.</li><li>
<a id="pgfId-1067206"></a>In the Library Browser - Add Instance form, click <em>analogLib</em>.</li><li>
<a id="pgfId-1067207"></a>Scroll the elements in the <em>Cell</em> column and click <em>port</em>.</li><li>
<a id="pgfId-1067208"></a>The outline for the <em>port </em>symbol is attached to the cursor. Move the <em>port</em><em> </em>symbol to the left of the <em>BB_driver </em>block and click to place the <em>port</em><em> </em>symbol.</li><li>
<a id="pgfId-1067209"></a>Return to the Library Browser - Add Instance form and scroll the elements in the <em>Cell</em> column and click <em>gnd</em>.</li><li>
<a id="pgfId-1067210"></a>The outline for the <em>gnd </em>symbol is attached to the cursor. Move the <em>gnd</em><em> </em>symbol below the <em>port</em><em> </em>symbol and click to place it there.</li><li>
<a id="pgfId-1067211"></a>Click <em>Esc</em> to remove the <em>gnd</em> symbol from the cursor.<br /><ffi2-fig-frame-in-2 id="#id1067215">
<a id="pgfId-1067215"></a></ffi2-fig-frame-in-2><div class="webflare-div-image">
<img src="images/RMSEVM6.gif" /></div></li></ol></li><li>
<a id="pgfId-1067216"></a>In the Schematic window, choose <em>Edit &#8211; Object &#8211; Properties</em> to modify the <em>port</em> symbol using the Edit Object Properties form.<ol><li>
<a id="pgfId-1067217"></a>In the Schematic window, click the <em>port</em> symbol.<br />
<a id="pgfId-1067218"></a>The Edit Object Properties form changes to display information for the <em>port</em> symbol.</li><li>
<a id="pgfId-1067219"></a>In the <em>Source Type</em> cyclic field, select <em>dc</em>.</li><li>
<a id="pgfId-1067220"></a>In the <em>DC Voltage </em>field, enter 50m.</li><li>
<a id="pgfId-1067221"></a>Highlight <em>Display small signal params</em> to display small signal parameters.</li><li>
<a id="pgfId-1067222"></a>In the <em>AC Magnitude</em> field type <code>1V</code>.</li><li>
<a id="pgfId-1067223"></a>In the <em>AC Phase</em> field type <code>0</code>.</li><li>
<a id="pgfId-1067224"></a>Click <em>OK</em> in the Edit Object Properties form.</li></ol></li><li>
<a id="pgfId-1067225"></a>Load the low pass filters with a <em>res_BB</em> model from the <em>top_dwnBB</em> category of <em>rfLib</em>. Use the default parameters and ground the output pins.<ol><li>
<a id="pgfId-1067226"></a>In the Schematic window, choose <em>Add &#8211; Instance</em> to display the Add Instance form.</li><li>
<a id="pgfId-1067227"></a>In the Add Instance form, click <em>Browse</em> to display the Library Browser - Add Instance form.</li><li>
<a id="pgfId-1067228"></a>In the Library Browser - Add Instance form, click <em>rfLib</em>.</li><li>
<a id="pgfId-1067229"></a>Scroll the elements in the <em>Cell</em> column and click <em>res_BB</em>.<br />
<a id="pgfId-1067230"></a>The outline for the <em>res_BB </em>symbol is attached to the cursor.</li><li>
<a id="pgfId-1067231"></a>Move the <em>res_BB</em><em> </em>symbol to the right of the two low pass filters (<em>butterworth_lp</em>) and click to place the <em>res_BB</em><em> </em>symbol.</li><li>
<a id="pgfId-1067232"></a>Return to the Library Browser - Add Instance form and click <em>analogLib.</em></li><li>
<a id="pgfId-1067233"></a>Scroll the elements in the <em>Cell</em> column and click <em>gnd</em>.<br />
<a id="pgfId-1067234"></a>The outline for the <em>gnd </em>symbol is attached to the cursor.</li><li>
<a id="pgfId-1067235"></a>Move the <em>gnd</em><em> </em>symbol to the right of the <em>res_BB</em><em> </em>symbol and click to place it there.</li><li>
<a id="pgfId-1067236"></a>Click <em>Esc</em> to remove the symbol from the cursor.<br /><ffi2-fig-frame-in-2 id="#id1067240">
<a id="pgfId-1067240"></a></ffi2-fig-frame-in-2><div class="webflare-div-image">
<img src="images/RMSEVM7.gif" /></div></li></ol></li><li>
<a id="pgfId-1067241"></a>In the duplicate receiver chain, wire the <em>port</em>, the <em>res_BB</em> block, and their <em>gnd</em> blocks.<ol><li>
<a id="pgfId-1067242"></a>In the Schematic window, choose <em>Add &#8211; Wire.</em></li><li>
<a id="pgfId-1067243"></a>Click the <em>I_in</em> pin on the <em>BB_driver</em>, then click the top pin on the <em>port</em>.</li><li>
<a id="pgfId-1067244"></a>Click the bottom pin on the <em>port</em>, then click the <em>gnd</em> pin just below it.</li><li>
<a id="pgfId-1067245"></a>Click the <em>out</em> pin on the top <em>butterworth_lp</em> filter, then click the <em>I_in</em> pin on the <em>res_BB </em>block.</li><li>
<a id="pgfId-1067246"></a>Click the <em>out</em> pin on the lower <em>butterworth_lp</em> filter, then click the Q<em>_in</em> pin on the <em>res_BB </em>block.</li><li>
<a id="pgfId-1067247"></a>Click the <em>I_out</em> pin on the <em>res_BB </em>block. Then click the top pin on the <em>gnd </em>located to it&#8217;s right.</li><li>
<a id="pgfId-1067248"></a>Click the Q<em>_out</em> pin on the <em>res_BB </em>block. Then click the top pin on the same <em>gnd</em>.<br /><ffi2-fig-frame-in-2 id="#id1067252">
<a id="pgfId-1067252"></a></ffi2-fig-frame-in-2><div class="webflare-div-image">
<img src="images/RMSEVM8.gif" /></div></li><li>
<a id="pgfId-1067253"></a>Click <em>esc</em> to stop wiring.</li></ol></li><li>
<a id="pgfId-1067254"></a>In the Schematic window, choose <em>Design &#8211; Check and Save</em> to check and save the schematic.</li></ol>





















































































<p>
<a id="pgfId-1067258"></a>The schematic with the third receiver chain is shown in Figure <a href="AppB.html#82279">10-13</a>.</p>

<p><strong>Figure 10-13
<a id="pgfId-1067260"></a><a id="82279"></a>Schematic with Noise Generating Receiver</strong></p>
<p>
<a id="pgfId-1067264"></a></p>
<div class="webflare-div-image">
<img src="images/RMSEVM9.gif" /></div>
<h4>
<a id="pgfId-1067265"></a>Set Up and Run Transient and Noise Analyses</h4>

<p>
<a id="pgfId-1067268"></a>Set up a transient analysis as described in <a href="AppB.html#70721">&#8220;Setting Up and Running a Transient Analysis&#8221;</a>. Set the <em>Stop Time</em> to <code>130u</code> and the <em>outputstart</em> option to <code>30u</code> and make sure that the transient analysis is enabled.</p>
<p>
<a id="pgfId-1067270"></a>Set up a noise analysis as follows:</p>
<ol><li>
<a id="pgfId-1067271"></a>In the Choosing Analyses form, click <em>noise</em> to select a noise analysis.</li><li>
<a id="pgfId-1067272"></a>For <em>Sweep Variable</em>, click <em>Frequency</em>.</li><li>
<a id="pgfId-1067273"></a>For <em>Sweep Range</em>, click <em>Start-Stop</em>.</li><li>
<a id="pgfId-1067274"></a>Set up the analysis to sweep frequency from 0 to100 MHz.<ol><li>
<a id="pgfId-1067275"></a>For the starting frequency, in the <em>Start</em> field enter <code>0</code>.</li><li>
<a id="pgfId-1067276"></a>For the stop frequency, in the <em>Stop</em> field enter <code>100M</code>.</li></ol></li><li>
<a id="pgfId-1067277"></a>Set up the <em>Output Noise</em> source.<ol><li>
<a id="pgfId-1067278"></a>In the <em>Output Noise</em> cyclic field, select <em>voltage.</em></li><li>
<a id="pgfId-1067279"></a>To select the <em>Positive Output Node</em>, click <em>Select</em> next to the <em>Positive Output Node</em> field. Then, in the Schematic window, click the net next to the <em>I_in</em> pin on the <em>res_BB</em> block.<br /><ffi2-fig-frame-in-2 id="#id1067283">
<a id="pgfId-1067283"></a></ffi2-fig-frame-in-2><div class="webflare-div-image">
<img src="images/RMSEVM11.gif" /></div></li><li>
<a id="pgfId-1067284"></a>To select the <em>Negative Output Node</em>, click <em>Select</em> next to the <em>Negative Output Node</em> field. Then, in the Schematic window, click the net next to the <em>I_out</em> pin on the <em>res_BB</em> block.</li></ol></li><li>
<a id="pgfId-1067285"></a>Set up the <em>Input Noise</em> source.<ol><li>
<a id="pgfId-1067286"></a>In the <em>Input Noise</em> cyclic field, select <em>port.</em></li><li>
<a id="pgfId-1067287"></a>To select the <em>Input Port Source</em>, click <em>Select</em> next to the <em>Input Port Source </em>field. Then, in the Schematic window, click the <em>DC input port </em>model.<br /><ffi2-fig-frame-in-2 id="#id1067291">
<a id="pgfId-1067291"></a></ffi2-fig-frame-in-2><div class="webflare-div-image">
<img src="images/RMSEVM10.gif" /></div></li></ol></li><li>
<a id="pgfId-1067292"></a>Click <em>Enabled</em>.<br />
<a id="pgfId-1067293"></a>The <em>Output Noise</em> and<em> Input Noise</em> sections of the Noise analysis form look as follows. (The net instance numbers might be different, however.)<br />
<a id="pgfId-1067297"></a><div class="webflare-div-image">
<img src="images/RMSEVM12.gif" /></div></li><li>
<a id="pgfId-1067298"></a>Verify that <em>Enabled</em> is highlighted and click <em>OK</em> in the Choosing Analyses form.</li><li>
<a id="pgfId-1067299"></a>In the ADE window, check the Analysis area to verify that both the transient and noise analyses are set up properly and that they are both enabled.<br />
<a id="pgfId-1067303"></a><div class="webflare-div-image">
<img src="images/RMSEVM13.gif" /></div></li><li>
<a id="pgfId-1067304"></a>In the ADE window, choose <em>Simulation &#8211; Netlist and Run</em> to start the simulations.<br />
<a id="pgfId-1067305"></a>Watch the messages in the CIW to verify that everything is set up properly and that the simulations start. Check the simulation log window to see that the simulations run and complete properly.</li></ol>









































<h4>
<a id="pgfId-1067306"></a>Set Up to Run the Circuit Optimizer</h4>

<ol><li>
<a id="pgfId-1067307"></a>In the ADE window, choose <em>Tools &#8211; Calculator</em> to open the calculator window.<br />
<a id="pgfId-1067311"></a><div class="webflare-div-image">
<img src="images/RMSEVM15Calc.gif" /></div></li><li>
<a id="pgfId-1067312"></a>In the ADE window, choose <em>Tools &#8211; Optimization </em>to open the Circuit Optimizer window.<br />
<a id="pgfId-1067316"></a><div class="webflare-div-image">
<img src="images/RMSEVM14Opt.gif" /></div></li></ol>








<h4><em>
<a id="pgfId-1067317"></a>Add the First Goal</em></h4>

<ol><li>
<a id="pgfId-1067318"></a>In the calculator window&#8217;s function panel, select <em>rmsNoise</em>.</li><li>
<a id="pgfId-1067319"></a>When the RMS Noise panel opens,<ol><li>
<a id="pgfId-1067320"></a>In the <em>From</em> field, enter <code>0</code>.</li><li>
<a id="pgfId-1067321"></a>In the <em>To</em> field, enter <code>100M</code>.</li><li>
<a id="pgfId-1067322"></a>Click <em>OK</em>.<br />
<a id="pgfId-1067323"></a>The expression<pre class="webflare-pre-block webflare-courier-new" id="#id1067324">
<a id="pgfId-1067324"></a><code>rmsNoise(0,100M)</code></pre>
<a id="pgfId-1067325"></a>displays in the buffer of the calculator window.</li></ol></li><li>
<a id="pgfId-1067326"></a>In the Circuit Optimizer window, choose <em>Goals &#8211; Add</em> to add the first goal.<br />
<a id="pgfId-1067327"></a>The Adding Goals form opens.</li><li>
<a id="pgfId-1067328"></a>Fill in the Adding Goals form.<ol><li>
<a id="pgfId-1067329"></a>In the <em>Name</em> field, type <code>rmsNoise</code>.</li><li>
<a id="pgfId-1067330"></a>Click the <em>Get Expression</em> button to the right of the <em>Calculator</em> label.<br />
<a id="pgfId-1067331"></a>The expression <code>rmsNoise(0 100000000)</code> displays in the <em>Expression</em> field.</li><li>
<a id="pgfId-1067332"></a>Ensure that the <em>Direction</em> is minimize.<br />
<a id="pgfId-1067333"></a>The default for the Optimizer is to minimize goals.</li><li>
<a id="pgfId-1067334"></a>In the <em>Target</em> field, enter <code>0.1u</code>.</li><li>
<a id="pgfId-1067335"></a>In the <em>Acceptable</em> field, enter <code>20u</code>.</li><li>
<a id="pgfId-1067336"></a>Verify that the form is enabled.<br />
<a id="pgfId-1067337"></a>The Adding Goals form looks like this.<br /><ffi2-fig-frame-in-2 id="#id1067341">
<a id="pgfId-1067341"></a></ffi2-fig-frame-in-2><div class="webflare-div-image">
<img src="images/RMSEVM17.gif" /></div></li><li>
<a id="pgfId-1067342"></a>Click <em>OK</em>.</li></ol><br />
<a id="pgfId-1067343"></a>The first goal is added to the Circuit Optimizer window.<br />
<a id="pgfId-1067347"></a><div class="webflare-div-image">
<img src="images/RMSEVM18.gif" /></div></li></ol>




































<h4><em>
<a id="pgfId-1067348"></a>Add the Second Goal</em></h4>

<ol><li>
<a id="pgfId-1067349"></a>In the calculator window, under the <em>tran</em> tab, click the <em>vt</em> button.<br />
<a id="pgfId-1067350"></a>The Schematic Editing window becomes active.</li><li>
<a id="pgfId-1067351"></a>In the Schematic window, click the <em>rms_EVM</em> output net of the instrumentation block.<br />
<a id="pgfId-1067352"></a>An expression similar to <code>VT(&quot;/net24&quot;)</code> displays in the calculator buffer.</li><li>
<a id="pgfId-1067353"></a>In the calculator window&#8217;s function panel, select <em>value</em>.<br />
<a id="pgfId-1067354"></a>When the Value panel appears<ol><li>
<a id="pgfId-1067355"></a>Enter <code>130u</code> in the <em>Interpolate At</em> field.</li><li>
<a id="pgfId-1067356"></a>Click <em>OK</em>.<br />
<a id="pgfId-1067357"></a>The expanded expression <code>value(VT(&quot;/net24&quot;) 130u )</code> displays in the buffer of the calculator window.</li></ol></li><li>
<a id="pgfId-1067358"></a>In the Circuit Optimizer, choose <em>Goals &#8211; Add</em>.<br />
<a id="pgfId-1067359"></a>When the Adding Goals form opens<ol><li>
<a id="pgfId-1067360"></a>In the <em>Name</em> field, enter <code>evm</code>.</li><li>
<a id="pgfId-1067361"></a>Click the <em>Get Expression</em> button to the right of the <em>Calculator</em> label.<br />
<a id="pgfId-1067362"></a>An expression similar to<pre class="webflare-pre-block webflare-courier-new" id="#id1067363">
<a id="pgfId-1067363"></a>value(VT(&quot;/net24&quot;) 0.00013)</pre>
<a id="pgfId-1067364"></a>displays in the <em>Expression</em> field.</li><li>
<a id="pgfId-1067365"></a>In the <em>Direction</em> cyclic field, select <em>&lt;=</em></li><li>
<a id="pgfId-1067366"></a>In the <em>Target</em> field, enter <code>25</code>.</li><li>
<a id="pgfId-1067367"></a>In the <em>Acceptable</em> field, enter <code>10</code>.</li><li>
<a id="pgfId-1067368"></a>Click the <em>% within Target</em> button.</li><li>
<a id="pgfId-1067369"></a>Verify that <em>Enabled</em> is active.<br />
<a id="pgfId-1067370"></a>The Adding Goals form looks like this.<br /><ffi2-fig-frame-in-2 id="#id1067374">
<a id="pgfId-1067374"></a></ffi2-fig-frame-in-2><div class="webflare-div-image">
<img src="images/RMSEVM19.gif" /></div></li><li>
<a id="pgfId-1067375"></a>Click <em>OK</em>.<br />
<a id="pgfId-1067376"></a>The second goal is added to the Circuit Optimizer window.<br /><ffi2-fig-frame-in-2 id="#id1067380">
<a id="pgfId-1067380"></a></ffi2-fig-frame-in-2><div class="webflare-div-image">
<img src="images/RMSEVM20.gif" /></div></li></ol></li></ol>






































<h4><em>
<a id="pgfId-1067381"></a>Add the Third Goal</em></h4>

<ol><li>
<a id="pgfId-1067382"></a>In the calculator window, click <em>Clear</em>.<br />
<a id="pgfId-1067383"></a>The buffer is cleared.</li><li>
<a id="pgfId-1067384"></a>Under the <em>tran</em> tab, click the <em>vt</em> button.<br />
<a id="pgfId-1067385"></a>The Schematic Editing window becomes active.</li><li>
<a id="pgfId-1067386"></a>In the Schematic window, click the <em>I_in </em>pin of the instrumentation block.<br />
<a id="pgfId-1067390"></a><div class="webflare-div-image">
<img src="images/RMSEVM20a.gif" /></div>
<a id="pgfId-1067391"></a>An expression similar to <code>VT(&quot;/net14&quot;)</code> displays in the buffer of the calculator window.</li><li>
<a id="pgfId-1067392"></a>In the calculator window&#8217;s function panel, select <em>rms</em>.<br />
<a id="pgfId-1067393"></a>An expanded expression similar to<pre class="webflare-pre-block webflare-courier-new" id="#id1067394">
<a id="pgfId-1067394"></a><code>rms(VT(&quot;/net14&quot;))</code> </pre>
<a id="pgfId-1067395"></a>displays in the buffer of the calculator window.<br />
<a id="pgfId-1067396"></a>The objective is to keep the <em>rms</em> value of this signal level above 300 mV. Note that all goals must be scalars.</li><li>
<a id="pgfId-1067397"></a>In the Circuit Optimizer, choose <em>Goals - Add</em>.<br />
<a id="pgfId-1067398"></a>The Adding Goals form opens.</li><li>
<a id="pgfId-1067399"></a>Fill in the fields of the Adding Goals form.<ol><li>
<a id="pgfId-1067400"></a>In the <em>Name</em> field, enter <code>sig_level</code>.</li><li>
<a id="pgfId-1067401"></a>Click the <em>Get Expression</em> button to the right of the <em>Calculator</em> label.<br />
<a id="pgfId-1067402"></a>And expression similar to<pre class="webflare-pre-block webflare-courier-new" id="#id1067403">
<a id="pgfId-1067403"></a><code>rms(VT(&quot;/net14&quot;))</code></pre>
<a id="pgfId-1067404"></a>displays in the <em>Expression</em> field.</li><li>
<a id="pgfId-1067405"></a>In the <em>Direction</em> cyclic field, select <em>&gt;=</em></li><li>
<a id="pgfId-1067406"></a>In the <em>Target</em> field, enter <code>300m</code>.</li><li>
<a id="pgfId-1067407"></a>In the <em>Acceptable</em> field, enter <code>10</code>.</li><li>
<a id="pgfId-1067408"></a>Click the <em>% within Target</em> button.</li><li>
<a id="pgfId-1067409"></a>Verify that the <em>Enabled</em> button is active.<br />
<a id="pgfId-1067410"></a>The Adding Goals form looks like this.<br /><ffi2-fig-frame-in-2 id="#id1067414">
<a id="pgfId-1067414"></a></ffi2-fig-frame-in-2><div class="webflare-div-image">
<img src="images/RMSEVM22.gif" /></div></li><li>
<a id="pgfId-1067415"></a>Click <em>OK</em>.<br />
<a id="pgfId-1067416"></a>The third goal is added to the Circuit Optimizer window.<br /><ffi2-fig-frame-in-2 id="#id1067420">
<a id="pgfId-1067420"></a></ffi2-fig-frame-in-2><div class="webflare-div-image">
<img src="images/RMSEVM23.gif" /></div></li></ol></li></ol>









































<h4><em>
<a id="pgfId-1067421"></a>Add the Circuit Variables to the Optimizer</em></h4>

<p>
<a id="pgfId-1067422"></a>Add the variables to the Circuit Optimizer window.</p>
<ol><li>
<a id="pgfId-1067423"></a>In the Circuit Optimizer window, choose <em>Variables &#8211; Add/Edit</em>.</li><li>
<a id="pgfId-1067424"></a>When the Editing Variables form opens<ol><li>
<a id="pgfId-1067425"></a>In the <em>Name</em> list box, click the <em>lna_ip3</em> variable.<br />
<a id="pgfId-1067426"></a>The <em>lna_ip3</em> variable is highlighted in the list box and it&#8217;s current value <code>-5</code> displays in the <em>Initial Value</em> field.</li><li>
<a id="pgfId-1067427"></a>In the <em>Minimum Value</em> field, enter <code>-9</code>.</li><li>
<a id="pgfId-1067428"></a>In the <em>Maximum Value</em> field, enter <code>10</code>.</li><li>
<a id="pgfId-1067429"></a>If necessary, click <em>Enabled</em>.<br />
<a id="pgfId-1067430"></a>The Editing Variables form appears as follows.<br /><ffi2-fig-frame-in-2 id="#id1067434">
<a id="pgfId-1067434"></a></ffi2-fig-frame-in-2><div class="webflare-div-image">
<img src="images/RMSEVM24.gif" /></div></li><li>
<a id="pgfId-1067435"></a>Click <em>Apply</em>.</li></ol><br />
<a id="pgfId-1067436"></a>Information for the <em>lna_ip3</em> variable displays in the <em>Variables</em> section of the Circuit Optimizer.<br />
<a id="pgfId-1067440"></a><div class="webflare-div-image">
<img src="images/RMSEVM25.gif" /></div></li><li>
<a id="pgfId-1067444"></a>Repeat this procedure to add all the variables and values listed in Table <a href="AppB.html#31203">10-11</a></li></ol>





















<h4>
<a id="pgfId-1067495"></a><a id="31203"></a>Variables and Values for the Optimizer</h4>
<table class="webflareTable webflareTableIndent" id="#id1067445">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1067447">
<a id="pgfId-1067447"></a>Variable Name</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1067449">
<a id="pgfId-1067449"></a>Initial Value</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1067451">
<a id="pgfId-1067451"></a>Minimum Value</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1067453">
<a id="pgfId-1067453"></a>Maximum Value</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067455"></a><span class="webflare-courier-new" style="white-space:pre"><em>lna_ip3</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067457"></a>-5</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067459"></a>-9</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067461"></a>10</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067463"></a><span class="webflare-courier-new" style="white-space:pre"><em>lna_gain</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067465"></a>15</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067467"></a>10</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067469"></a>30</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067471"></a><span class="webflare-courier-new" style="white-space:pre"><em>if_mx_gain</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067473"></a>10</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067475"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067477"></a>50</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067479"></a><span class="webflare-courier-new" style="white-space:pre"><em>if_rbw</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067481"></a>200m</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067483"></a>50m</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067485"></a>300m</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067487"></a><span class="webflare-courier-new" style="white-space:pre"><em>rf_rbw</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067489"></a>100m</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067491"></a>50m</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1067493"></a>300m</p>
</td>
</tr>
</tbody></table>

<ol><li>
<a id="pgfId-1067496"></a>Click <em>OK</em> to close the Editing Variables form.<br />
<a id="pgfId-1067497"></a>In the Circuit Optimizer window, the variables and optimization goals appear as shown in <a href="AppB.html#33516">Figure&#160;10-14</a>.<br /><strong class="webflare-fig-line-height">Figure 10-14
<a id="pgfId-1067502"></a><a id="33516"></a>Circuit Optimizer Setup</strong>
<a id="pgfId-1067506"></a><div class="webflare-div-image">
<img src="images/RMSEVM26Opt.gif" /></div></li></ol>





<h4>
<a id="pgfId-1067507"></a>Run the Circuit Optimizer</h4>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1067508"></a>This Circuit Optimizer analysis might take several hours to complete.</div>

<ol><li>
<a id="pgfId-1067509"></a>In the Circuit Optimizer, choose <em>Optimizer &#8211; Run n</em> to display the <em>Run for Fixed Number of Iterations</em> form.</li><li>
<a id="pgfId-1067510"></a>In the <em>Number of Iterations</em> field, move the slider to the right until <em>12</em> displays.<br />
<a id="pgfId-1067514"></a><div class="webflare-div-image">
<img src="images/RMSEVM27.gif" /></div></li><li>
<a id="pgfId-1067515"></a>Click <em>OK.</em><br />
<a id="pgfId-1067516"></a>The <em>Run for Fixed Number of Iterations</em> form closes and the Circuit Optimizer starts running.<br />
<a id="pgfId-1067517"></a>Watch for simulator startup messages in the CIW. Monitor the progress of the analysis in the log window.<br />
<a id="pgfId-1067518"></a>The waveform window opens when the first simulation completes. As simulations complete, the results are added to the plots in the waveform window.</li></ol>










<h4>
<a id="pgfId-1067519"></a>Viewing the Circuit Optimizer Output</h4>

<p>
<a id="pgfId-1067522"></a>The Circuit Optimizer results displayed in the waveform window are shown in <a href="AppB.html#31270">Figure&#160;10-15</a>.</p>
<ul><li>
<a id="pgfId-1067524"></a>The traces on the left show the EVM and RMS output signal level, and the RMS noise at each Circuit Optimizer iteration.</li><li>
<a id="pgfId-1067525"></a>The traces on the right show the variable function block specifications at each Circuit Optimizer iteration.<br /><strong class="webflare-fig-line-height">Figure 10-15
<a id="pgfId-1067527"></a><a id="31270"></a>Circuit Optimizer Results After 12 Iterations</strong>
<a id="pgfId-1067531"></a><div class="webflare-div-image">
<img src="images/Figure_1-19.gif" /></div></li></ul>






<p>
<a id="pgfId-1067532"></a>Although the example is contrived, it illustrates the use model. After the Circuit Optimizer met the constraints it tried to minimize RMS noise.</p>
<ol><li>
<a id="pgfId-1067533"></a>Save the initial state of the Analog Design Environment in case you want to start over.</li><li>
<a id="pgfId-1067534"></a>Then in the Circuit Optimizer window, click <em>Results &#8211; Update Design</em>. The last click updates the variables in the Analog Design Environment window with the last set of variables found by the Circuit Optimizer. You use these states in the passband view.</li></ol>


<h3>
<a id="pgfId-1067545"></a>Summarizing the Design Procedure</h3>

<p>
<a id="pgfId-1067546"></a>To summarize, the semi-automated design procedure consists of</p>
<ol><li>
<a id="pgfId-1067547"></a>Setting up the measurements</li><li>
<a id="pgfId-1067548"></a>Placing tolerances on the block parameters</li><li>
<a id="pgfId-1067549"></a>Constraining the system performance</li><li>
<a id="pgfId-1067550"></a>Identifying a quantity to minimize (or maximize)</li><li>
<a id="pgfId-1067551"></a>Running the Optimizer</li><li>
<a id="pgfId-1067552"></a>Evaluating the results</li></ol>





<p>
<a id="pgfId-1067553"></a>This is why the process is called <em>semi</em>-automated. After evaluating results for the first or second time you probably need to</p>
<ol><li>
<a id="pgfId-1067554"></a>Refine tolerances</li><li>
<a id="pgfId-1067555"></a>Refine goals</li><li>
<a id="pgfId-1067556"></a>Add or delete constraints</li><li>
<a id="pgfId-1067557"></a>Add or delete variables</li></ol>



<p>
<a id="pgfId-1067558"></a>Each simulation covers 100s, or about 80 CDMA symbols. The suppressed carriers are an RF carrier at 2.14 GHz, an LO carrier at 2.354GHz, and an IF carrier at 214 MHz. The symbol rate is 1.2288 Mega-symbols per second.</p>

<h3>
<a id="pgfId-1067559"></a>Creating a Passband View of the Architectural Model</h3>

<p>
<a id="pgfId-1067560"></a>After you have designed an architecture, you can quickly create a passband view of the architectural model. (Currently, the passband behavioral models in the <em>top_dwnPB</em> category and in the passband view do not introduce any specifications that are not in the baseband models.)</p>
<p>
<a id="pgfId-1067561"></a>The passband view checks for problems that might have escaped detection in the baseband view. For example, although the baseband view quickly assesses what filters do to the baseband signal, baseband models do not indicate whether the filters are indeed removing undesired carrier harmonics.</p>
<p>
<a id="pgfId-1067562"></a>Baseband modeling is also not the best way to evaluate image rejection. Although the baseband model accurately simulates how the desired signal propagates through an image rejection receiver, it does not accurately simulate how much of the image signal propagates to the receiver output.</p>
<p>
<a id="pgfId-1067565"></a>The passband view also creates a system testbench as mentioned in <a href="AppB.html#73627">&#8220;Top-Down Design of RF Systems&#8221;</a>.</p>

<h4>
<a id="pgfId-1067567"></a>Procedures for Creating the Passband Model of the Receiver</h4>

<p>
<a id="pgfId-1067568"></a>The procedures described in this section illustrate how to</p>
<ul><li>
<a id="pgfId-1067569"></a>Switch from a baseband to a passband view</li><li>
<a id="pgfId-1067570"></a>Make an end-to-end RF measurement</li><li>
<a id="pgfId-1067571"></a>Measure the one dB compression point<br />
<a id="pgfId-1067572"></a>The one dB compression point is usually a transmitter specification but it is used to demonstrate this flow because it is easier to set up.</li></ul>



<p>
<a id="pgfId-1069490"></a>Perform the following steps to create the passband model of the receiver:</p>
<ol><li>
<a id="pgfId-1067573"></a>Copy the original receiver model from the Circuit Optimizer analysis to a new schematic window. Copy everything from the LNA to the low pass filters.</li><li>
<a id="pgfId-1067574"></a>Edit the properties of the IQ_demodulator (<code>IQ_demod_BB</code>) to set the last parameter, <em>flo</em>, to<em> </em><em>
-frf+flo1</em>
. The baseband view does not need the local oscillator frequency but the passband view does.</li><li>
<a id="pgfId-1067575"></a>Load the low pass filters with ports.</li><li>
<a id="pgfId-1067576"></a>Connect a port across the LNA_BB inputs. Set the Frequency name to <code>fin</code>, the frequency to <code>frf</code>, and the amplitude to <code>power</code>. (Do not abbreviate <code>power</code> to <code>pwr </code>because <code>pwr</code> is a reserved variable and you do not get any warning. SpectreRF may complain about a mysterious indexed undefined variable that increments from run to run.)</li><li>
<a id="pgfId-1067580"></a>Add loaded voltage-controlled-voltage sources as shown in <a href="AppB.html#16477">Figure&#160;10-16</a> to observe intermediate differential voltages.<br /><strong class="webflare-fig-line-height">Figure 10-16
<a id="pgfId-1067582"></a><a id="16477"></a>Passband View</strong>
<a id="pgfId-1067586"></a><div class="webflare-div-image">
<img src="images/Figure_1-21.gif" /></div></li><li>
<a id="pgfId-1067587"></a>Check and save the schematic</li><li>
<a id="pgfId-1067588"></a>Close the schematic window.</li><li>
<a id="pgfId-1067589"></a>Bring up a Library Manager and select but do not open the schematic you just created.</li><li>
<a id="pgfId-1067590"></a>In the Library Manager window click <em>File &#8211; New &#8211; Cell View</em>.</li><li>
<a id="pgfId-1067591"></a>In the window that comes up, select Hierarchy Editor for the Tool. Click <em>OK</em>.</li><li>
<a id="pgfId-1067592"></a>Type in <code>schematic</code> for the View then click <em>Use Template</em>.</li><li>
<a id="pgfId-1067593"></a>Set the <em>Name</em> to <code>Spectre</code>.</li><li>
<a id="pgfId-1067594"></a>Enter <code>veriloga_PB</code> as the first item in the View List, then click <em>OK</em>.</li><li>
<a id="pgfId-1067595"></a>In the Hierarchy Editor window, click <em>File &#8211; Save</em>. This is important.</li><li>
<a id="pgfId-1067596"></a>Click the <em>Open</em> button to bring up the schematic.</li><li>
<a id="pgfId-1067597"></a>Bring up an Analog Design Environment tool and use the states from the last Circuit Optimizer iteration.</li><li>
<a id="pgfId-1067598"></a>Recall the states you saved from the last Circuit Optimizer iteration. Add the <code>power</code> variable and set it to -16.</li><li>
<a id="pgfId-1067599"></a>Delete the previous analyses and set up a PSS analysis. Enter a new Fundamental Tone named <code>LO</code> and make it 2.354GHz. <em>Auto Calculate</em> the <em>Beat Frequency</em> and type <code>1</code> for the <em>Number of harmonics</em>.</li><li>
<a id="pgfId-1067600"></a>Run the analysis and observe the intermediate differential voltages. The model is indeed now a passband model. At the higher power levels the LNA output contains odd harmonics of the RF carrier. The filter reflects the odd harmonics back to the LNA and does not let them propagate forward. The baseband model does not simulate the odd harmonics but it does simulate the intermodulation term between the second harmonic and fundamental that falls at the fundamental. One reason to simulate the passband view is to check for peak voltage levels that might exceed voltage ratings. The baseband models only simulate peak voltage at the carrier fundamental, not the absolute peak.</li><li>
<a id="pgfId-1067601"></a>Set up a swept PSS analysis. Sweep <em>power</em> from -32 to 0 in 10 steps.</li><li>
<a id="pgfId-1067602"></a>After the sweep finishes, click <em>Results &#8211; Direct Plot</em> in the Environment window, select <em>Compression point</em>, <em>1dB</em>, <em>Output Referred</em>. Select the 0 harmonic because the end-to-end system produces a baseband output. Then click the port loading the top output low pass filter. You should see the compression point plot shown in <a href="AppB.html#29816">Figure&#160;10-17</a>.<br /><strong class="webflare-fig-line-height">Figure 10-17
<a id="pgfId-1067607"></a><a id="29816"></a>End-to-end RF measurement, one dB compression point at the I-baseband output.</strong>
<a id="pgfId-1067611"></a><div class="webflare-div-image">
<img src="images/Figure_1-23.gif" /></div></li><li>
<a id="pgfId-1067612"></a>Repeat the last step but this time click the lower output port. You should see the compression plot in <a href="AppB.html#10091">Figure&#160;10-18</a>.<br /><strong class="webflare-fig-line-height">Figure 10-18
<a id="pgfId-1067617"></a><a id="10091"></a>End-to-end RF measurement, one dB compression point at the Q-baseband output.</strong>
<a id="pgfId-1067621"></a><div class="webflare-div-image">
<img src="images/Figure_1-22.gif" /></div></li></ol>



































<h3>
<a id="pgfId-1067622"></a>Comparing Baseband and Passband Models</h3>

<p>
<a id="pgfId-1067623"></a>This section illustrates how to compare baseband and passband models by:</p>
<ol><li>
<a id="pgfId-1067624"></a>Setting up a Transient analysis with the passband view</li><li>
<a id="pgfId-1067625"></a>Setting up a Transient analysis with the baseband view</li><li>
<a id="pgfId-1067626"></a>Directly comparing the baseband and passband models.</li></ol>


<p>
<a id="pgfId-1067627"></a>You run one analysis of the baseband view and two analyses of the passband view. You perform the second passband analysis with tightened tolerances.</p>
<ol><li>
<a id="pgfId-1067628"></a>Save the passband schematic under a different name. You use the new copy.</li><li>
<a id="pgfId-1067629"></a>Repeat steps 9 through 17 from the last recipe for the new copy but do not enter the <code>veriloga_PB</code> view in the <em>View List</em> yet. You do a baseband analysis first.</li><li>
<a id="pgfId-1067630"></a>Delete the port driving the LNA.</li><li>
<a id="pgfId-1067631"></a>Delete the loaded voltage-controlled-voltage sources.</li><li>
<a id="pgfId-1067632"></a>You need to synthesize an antenna signal. Add an <code>IQ_mod_BB</code> from the <code>top_dwnBB</code> category. Set the I and Q gains to 0 dB. Set the 1dB compression points to 1000 so that the modulator is ideal. Instantiate it in front of the LNA with the pins aligned, then wire the pins straight across. Ground the <code>phase_err</code> pin.</li><li>
<a id="pgfId-1067633"></a>Drive the <code>I_in</code> pin of the IQ modulator with a port. Set the port frequency to 2MHz and name the frequency BB1. Set the amplitude to -16dBm.</li><li>
<a id="pgfId-1067634"></a>Do the same for the <code>Q_in</code> modulator input.</li><li>
<a id="pgfId-1067635"></a>Load or duplicate the states from the 12-iteration Circuit Optimizer analysis but delete the Noise and Transient analyses.</li><li>
<a id="pgfId-1067636"></a>Remove AM/PM conversion from the LNA by setting the last parameter in the properties list to zero.<br />
<a id="pgfId-1067637"></a>It is not fair to compare passband and baseband views with AM/PM conversion because the passband view does not capture it.</li><li>
<a id="pgfId-1067638"></a>Set up a 1us Transient analysis with default options.</li><li>
<a id="pgfId-1067639"></a>Run the analysis and plot the filtered baseband outputs, the outputs of the low pass filters.<br />
<a id="pgfId-1067643"></a>Note how fast the simulation runs. Save the results so you can plot them again later. <a href="#pgfId-1067642">1</a></li><li>
<a id="pgfId-1067644"></a>Switch to the passband view by entering &#8220;veriloga_PB&#8221; in the View List in the Hierarchy Editor. Click the update button in the hierarchy editor.</li><li>
<a id="pgfId-1067645"></a>After you switch to the <code>veriloga_PB</code> view, edit the IQ modulator properties to set <em>flo</em> to <code>frf</code>. Edit the demodulator properties and set its <em>flo</em> to <code>flo1-frf.</code></li><li>
<a id="pgfId-1067646"></a>Click <em>Results &#8211; Printing Plotting Options</em> then click the <em>Overlay Plots</em> button.</li><li>
<a id="pgfId-1067647"></a>Overlay the passband results with the baseband results. You see the waveforms in <a href="AppB.html#12393">Figure&#160;10-19</a>. The comparison is not very good.</li><li>
<a id="pgfId-1067651"></a>Rerun the analysis with conservative options and set reltol to 1e-6. This run takes longer.</li><li>
<a id="pgfId-1067652"></a>Plot the results.</li><li>
<a id="pgfId-1067653"></a>Recall the saved baseband results and overlay them with those from the last simulation. You see the waveforms in <a href="AppB.html#30675">Figure&#160;10-20</a>. The passband results now lay right on top of the baseband results but took much longer to compute! It was not obvious without the baseband results that the first passband simulation did not run with tight enough numerical tolerances.<br /><strong class="webflare-fig-line-height">Figure 10-19
<a id="pgfId-1067658"></a><a id="12393"></a>Passband and baseband results with default options in the passband analysis</strong>
<a id="pgfId-1067662"></a><div class="webflare-div-image">
<img src="images/Figure_1-24.gif" /></div><strong>Figure 10-20
<a id="pgfId-1067664"></a><a id="30675"></a>Passband and baseband results with tighter options in the passband analysis</strong>
<a id="pgfId-1067668"></a><div class="webflare-div-image">
<img src="images/Figure_1-25.gif" /></div></li></ol>


























<h2>
<a id="pgfId-1067669"></a>Relationship Between Baseband and Passband Noise</h2>

<p>
<a id="pgfId-1067670"></a>Noise analysis at baseband can be confusing because factors of two appear in a number of places throughout the calculations. For example:</p>
<ul><li>
<a id="pgfId-1067671"></a>Each passband node becomes two equivalent baseband nodes.<ul><li>
<a id="pgfId-1067672"></a>Does noise injected at a passband node split between the two equivalent baseband nodes?</li><li>
<a id="pgfId-1067673"></a>If so, does the noise split evenly?</li></ul></li><li>
<a id="pgfId-1067674"></a>As shown in the <code>BB_test_bench</code> example, baseband models simulate peak in-phase and peak quadrature components of the carrier.<br />
<a id="pgfId-1067675"></a>When analyzing signal-to-noise ratios, does that mean you have to use half the square of the baseband signals?</li><li>
<a id="pgfId-1067676"></a>The analog design environment displays single sided power spectral densities.<br />
<a id="pgfId-1067677"></a>Because the baseband power spectral density is the two-sided passband density shifted down, is there another factor of two because we can only see the baseband density for positive frequencies?</li><li>
<a id="pgfId-1067678"></a>White noise at the input of a mixer mixes up to the carrier from DC but there is also noise at twice the carrier that mixers down to the carrier.<br />
<a id="pgfId-1067679"></a>Does the baseband model account for this?</li></ul>








<p>
<a id="pgfId-1067680"></a>These questions are answered in this section.</p>
<p>
<a id="pgfId-1067681"></a>Before sorting out the factors of two, note that baseband noise analysis is valid only for small signals. If any element in the architecture operates in a non-linear fashion, the noise analysis might be inaccurate. This is due to the fact that a baseband noise analysis follows a DC operating point analysis, rather than a PSS analysis.</p>
<p>
<a id="pgfId-1067682"></a>Instantaneous incremental gain in a passband static non-linear model dithers at the carrier frequency.</p>
<ul><li>
<a id="pgfId-1067683"></a>When the carrier swings through zero, the incremental gain is large and noise at the input is amplified.</li><li>
<a id="pgfId-1067684"></a>When the carrier reaches its peak and drives the circuit into saturation, the incremental gain is smaller.</li></ul>

<p>
<a id="pgfId-1067685"></a>The average gain is greater than the minimum gain. The baseband model remains in the non-linear region because it only simulates peak voltages. Consequently, the incremental gain is always a minimum and the baseband model under-estimates the amount of noise propagating to the output. If the peak input signal drives the model into saturation, be sure to scale the baseband noise results accordingly.</p>

<h3>
<a id="pgfId-1067686"></a>Introduction to Analysis</h3>

<p>
<a id="pgfId-1067687"></a>The circuit discussed here is called <code>noise_test_circuit</code><em> </em>and you can find it in the <code>rfExamples</code> library. The circuit looks as shown in <a href="AppB.html#36438">Figure&#160;10-21</a>.</p>

<p><strong>Figure 10-21
<a id="pgfId-1067692"></a><a id="36438"></a>The noise_test_circuit in the rfExamples Library</strong></p>
<p>
<a id="pgfId-1067696"></a></p>
<div class="webflare-div-image">
<img src="images/Figure_1-26.gif" /></div>

<p>
<a id="pgfId-1067697"></a>The <code>noise_test_circuit</code><em> </em>shows the relationship between baseband and passband noise. One branch consists of passband models. The other branch is a baseband equivalent of the first. You can assess noise at each of three observation points located in each branch of the circuit. At each observation point, you can examine both the noise and pnoise summaries.</p>
<p>
<a id="pgfId-1067698"></a>The I and Q inputs are both driven by the same DC source so that you only have to view one baseband output, the other baseband output is identical by symmetry. Noise parameters in the passband and baseband models are identical. Aside from the behavioral blocks at the end of each branch, each behavioral block has noise injected at its input.</p>

<h3>
<a id="pgfId-1067699"></a>Preparation Steps for Analyses</h3>

<ol><li>
<a id="pgfId-1067700"></a>Set up a PSS analysis.<br />
<a id="pgfId-1067701"></a>Because the local oscillator is inside the passband mixer models you have to manually enter the frequency (1GHz) into the PSS analysis form. Let the beat frequency be <em>autocalculated</em> and use 1 harmonic.</li><li>
<a id="pgfId-1067702"></a>Set up a pnoise analysis.<br />
<a id="pgfId-1067703"></a>Set the start frequency equal to 0 Hz, the stop frequency equal to 100MHz, use a linear sweep with 100 steps. Set the Maximum sideband to 1. For the input source select <em>none </em>and for the output use <em>voltage</em>. For the positive output node, select the I-input of the IQ_modulator in the passband branch. Use ground for the negative node.</li><li>
<a id="pgfId-1067704"></a>Set up a noise analysis.<br />
<a id="pgfId-1067705"></a>Sweep the frequency from 0 to 100MHz linearly in 100 steps. Use voltage for the output noise and select the I-input of the <em>IQ_mod_BB</em> component in the baseband branch for the positive node. Select ground for the negative node. Set the input noise port to any one of the ports in the circuit. Noise from that port does not affect either passband or baseband branches.</li><li>
<a id="pgfId-1067706"></a>Run the analysis.</li><li>
<a id="pgfId-1067707"></a>When the analysis finishes, go to the analog design environment simulation window and click <em>results &#8211; print &#8211; pss noise summary</em>.</li><li>
<a id="pgfId-1067708"></a>In the form that appears, include All types, set <em>Type</em> to <em>integrated noise</em>, look at noise from 0 to 100MHz, select <em>truncate by number</em>, and view the top 2 noise contributors.<br />
<a id="pgfId-1067709"></a>There are only 2 noise contributors at this point, noise at the I/Q inputs and noise from the low pass resistors.</li><li>
<a id="pgfId-1067710"></a>Print the noise summary (which is different from the pnoise summary).<br />
<a id="pgfId-1067711"></a>Again, print integrated noise (from 0 to 100MHz). Select All types and print noise from the top 2 noise contributors.<br />
<a id="pgfId-1067715"></a><a href="AppB.html#35721">Figure&#160;10-22</a> shows the noise summaries. The two summaries agree because at this point in the circuit, both nodes are really baseband nodes.<br /><strong>Figure 10-22
<a id="pgfId-1067717"></a><a id="35721"></a>Noise Summaries for the First PSS pnoise and Noise Analyses</strong>
<a id="pgfId-1067721"></a><div class="webflare-div-image">
<img src="images/Figure_1-27.gif" /></div></li><li>
<a id="pgfId-1067722"></a>Repeat the analyses.<br />
<a id="pgfId-1067723"></a>This time select the <code>outi</code> pins on the low pass filters as outputs in the appropriate noise analyses. Again print the same noise summaries but this time look at the top 12 noise contributors in each summary.<br />
<a id="pgfId-1067727"></a><a href="AppB.html#38599">Figure&#160;10-23</a> shows the noise summaries for the second analysis. The top 7 noise contributors in the baseband and passband branches agree. The remaining noise contributors are negligible, and should be negligible for the circuit because it has no AM/PM conversion.<br /><strong class="webflare-fig-line-height">Figure 10-23
<a id="pgfId-1067729"></a><a id="38599"></a>Noise Summaries for the Second PSS pnoise Analyses</strong>
<a id="pgfId-1067733"></a><div class="webflare-div-image">
<img src="images/Figure_1-28.gif" /></div></li><li>
<a id="pgfId-1067734"></a>Repeat the analysis again.<br />
<a id="pgfId-1067735"></a>This time change the Pnoise sweep to run from 900MHz to 1.1GHz in 200 linear steps and select the power amplifier output as the noise output node. For the noise analysis, leave the sweep at zero to 100MHz, use 100 steps as before, and change the output node to be the I-output of the power amplifier.<br />
<a id="pgfId-1067736"></a>Look at the top 7 noise contributors in each analysis. This time, integrate noise from 900MHz to 1.1GHz for the pnoise run and integrate noise from 0 to 100MHz for the noise run.<br />
<a id="pgfId-1067740"></a><a href="AppB.html#30352">Figure&#160;10-24</a> shows the new summaries. Although the noise analyses agree at the ends of the branches, the noise analyses appear to disagree at a point where the baseband node is only a baseband equivalent, not a true baseband node.<br /><strong>Figure 10-24
<a id="pgfId-1067742"></a><a id="30352"></a>Noise Summaries for the Third PSS pnoise Analyses</strong>
<a id="pgfId-1067746"></a><div class="webflare-div-image">
<img src="images/Figure_1-29.gif" /></div>
<a id="pgfId-1067750"></a>The <em>apparent</em> disagreement shown in <a href="AppB.html#30352">Figure&#160;10-24</a> requires an explanation. Let us examine the noise contributors and try to answer some the questions we posed earlier.</li></ol>




































<h4>
<a id="pgfId-1067751"></a>Noise at the power amplifier output due to noise injected at a passband node</h4>

<ul><li>
<a id="pgfId-1067752"></a>Passband model contributors: <em>PA_PB</em> and <em>IQ_demodulator</em>, port 9.</li><li>
<a id="pgfId-1067753"></a>Baseband model contributors: <em>PA_BB_i</em>, <em>IQ_demod_BB_i</em>, port 13.</li></ul>

<p>
<a id="pgfId-1067754"></a>Passband and baseband counterparts contribute the same amount of noise. However, in the baseband model, from symmetry you see the same numbers if you look at the Q-node. This means the baseband model predicts twice as much total noise due to noise injected between the modulators.</p>
<p>
<a id="pgfId-1067755"></a>This factor of two is intentionally introduced to maintain the correct signal-to-noise ratio. The baseband model simulates peak signals; the carrier is suppressed. Without the carrier, signal power equals the square of the peak rather than one half of the square. This factor of two is not as arbitrary as it seems. The baseband model predicts the correct noise after demodulation because the passband demodulator model includes an extra factor of two to offset the factor of two inherent in the demodulation process.</p>
<p>
<a id="pgfId-1067756"></a>Let the modulated carrier be <code>i(t)*cos(wc*t) -q(t)*sin(wc*t) + noise(t)</code>.</p>
<p>
<a id="pgfId-1067757"></a>Now consider the I-output. To generate the I-output, the demodulator multiplies the signal by <code>cos(wc*t)</code>. The only part that propagates through the subsequent filter is <code>(1/2)i(t) + noise(t)*cos(wc*t)</code>. To recover <code>i(t)</code>, the passband demodulator model must scale this sum by two. (The baseband demodulator does not need to scale by two to extract the baseband signal because the carrier is suppressed.)</p>
<p>
<a id="pgfId-1067758"></a>Thus, noise at passband demodulator model output equals <code>2*noise(t)*cos(wc*t)</code>. The filtered noise power density is then <code>4*(</code><em>input noise density</em><code>)/2</code>. The factor of 1/2 comes from the cosine. The filtered output noise density is twice the input noise density.</p>
<p>
<a id="pgfId-1067759"></a>In the baseband model, doubling the noise injected at the passband nodes was not simply a matter of convenience.</p>
<p>
<a id="pgfId-1067760"></a>So, to answer questions 1 and 2,</p>
<ul><li>
<a id="pgfId-1067761"></a>Yes, noise injected at a passband node splits evenly between the two equivalent baseband nodes<br />
<a id="pgfId-1067762"></a>but</li><li>
<a id="pgfId-1067763"></a>Because each split is doubled, the ratio of <em>peak</em> signal to total noise equals the true signal-to-noise ratio.</li></ul>


<p>
<a id="pgfId-1067764"></a>Question 3 is rendered moot by using the noise summary and integrating over the proper band. If the pnoise analysis only integrated from 1GHz to 1.1GHz, (instead of from 900MHz to 1.1GHz), there would be a mysterious factor of two error.</p>
<p>
<a id="pgfId-1067765"></a>In the baseband model, phase noise entering on the phase error pin propagates to both the I and Q outputs. In the baseband model, the same noise power appears on just the one output. Again, the total noise in the baseband model is twice that of the passband model to maintain the correct signal-to-noise ratio.</p>

<h4>
<a id="pgfId-1067766"></a>Noise injected at the modulator input (resistors and modulator noise)</h4>

<p>
<a id="pgfId-1067767"></a>Total noise in the baseband model due to modulator and input resistor noise is twice what it is from just one phase. Thus, the total noise due to sources on the input sides of the modulators differ by a factor of two. This occurs because the passband model is a real multiplier, which modulates the noise. If the peak signal voltage agrees with the baseband model, the passband modulator model attenuates input noise most of the time. The important thing is that the signal-to-noise ratios in the passband and baseband models agree anywhere in the system.</p>
<p>
<a id="pgfId-1067768"></a>Now, copy the circuit, remove the capacitors at the modulator inputs, and repeat the last set of noise analyses. You see that in the passband model, the input resistors, R20 and R21, together contribute twice as much as the baseband counterpart, R22. With the capacitors, R20 and R21 together contribute just as much as R22. Without the capacitors, the input noise is truly white over the frequencies of interest. The same thing happens to the modulator noise itself. <a href="AppB.html#15360">Figure&#160;10-25</a> shows the results.</p>
<p>
<a id="pgfId-1067772"></a><strong>In particular, the modulator now also has noise at twice the carrier frequency and that noise mixes down to the carrier frequency. </strong>The baseband model is just that, a baseband model. The answer to question 4 is <em>no</em>. The baseband models do not account for noise, or signals, at carrier harmonics. The baseband equivalent noise analysis is valid only if noise injected into the modulators has no power beyond the local oscillator frequency. Phase noise injected at the phase noise pins should also be band limited.</p>

<p><strong>Figure 10-25
<a id="pgfId-1067774"></a><a id="15360"></a>Noise Summaries with the input capacitors removed.</strong></p>
<p>
<a id="pgfId-1067778"></a></p>
<div class="webflare-div-image">
<img src="images/Figure_1-30.gif" /></div>

<p>
<a id="pgfId-1067779"></a></p>
<p>
<a id="pgfId-1065073"></a></p>



<ol><li>
<a id="pgfId-1067642"></a>Note that the baseband outputs are out of phase with each other, even though the baseband inputs are in phase. In the baseband model, changing the RF-IF mixer LO from &#8220;flo1&#8221; to &#8220;-flo1&#8221; fixes the sign problem. In the passband model, the IQ_demodulator flo should be frf-flo1. To maintain the convention, in the baseband model the IF filter&#8217;s carrier frequency should be frf-flo1.</li></ol>


<br /><a href="#pagetop">Return to top</a><br /></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="Chap9.html" id="prev" title="Cosimulation with MATLAB ...">Cosimulation with MATLAB ...</a></em></b><b><em><a href="AppC.html" id="nex" title="Documents That Ship in the Software Hierarchy">Documents That Ship in the Sof ...</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2020, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
</body></html>