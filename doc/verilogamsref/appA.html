
<html><head><title>Nodal Analysis</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="jommy" />
<meta name="CreateDate" content="2019-09-18" />
<meta name="CreateTime" content="1568827668" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes the analog and mixed-signal aspects of the Cadence Verilog-AMS language. With Verilog-AMS, you can create and use modules that describe the high-level behavior and structure of analog, digital, and mixed-signal components and systems." />
<meta name="DocTitle" content="Cadence Verilog-AMS Language Reference" />
<meta name="DocType" content="User Guide" />
<meta name="FileTitle" content="Nodal Analysis" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-3.1" />
<meta name="Keyword" content="verilogamsref" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2019-09-18" />
<meta name="ModifiedTime" content="1568827668" />
<meta name="NextFile" content="appB.html" />
<meta name="Group" content="Analog Mixed-Signal Simulation" />
<meta name="Platform" content="Functional Verification" />
<meta name="PrevFile" content="chap12.html" />
<meta name="Product" content="Xcelium" />
<meta name="ProductFamily" content="Xcelium" />
<meta name="ProductVersion" content="19.09" />
<meta name="RightsManagement" content="Copyright 2012-2019 Cadence Design Systems Inc." />
<meta name="Title" content="Cadence Verilog-AMS Language Reference -- Nodal Analysis" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="product_feature" content="" />
<meta name="product_subfeature" content="" />
<meta name="Version" content="19.09" />
<meta name="SpaceKey" content="verilogamsref1909" />
<meta name="webflare-version" content="1.4" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" /></head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="verilogamsrefTOC.html">Contents</a></li><li><a class="prev" href="chap12.html" title="Controlling the Compiler">Controlling the Compiler</a></li><li style="float: right;"><a class="viewPrint" href="verilogamsref.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="appB.html" title="Analog Probes and Sources">Analog Probes and Sources</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Cadence Verilog-AMS Language Reference<br />Product Version 19.09, September 2019</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;">

<h1>A
<a id="pgfId-1031797"></a></h1>
<h1>
<a id="pgfId-1031799"></a><hr />
<a id="40937"></a>Nodal Analysis<hr />
</h1>

<p>
<a id="pgfId-1031800"></a>This appendix briefly introduces Kirchhoff&#8217;s Laws and describes how the simulator uses them to simulate an analog system. For information, see</p>

<ul><li>
<a id="pgfId-1031803"></a><a href="appA.html#21205">Kirchhoff&#8217;s Laws</a></li><li>
<a id="pgfId-1031807"></a><a href="appA.html#18915">Simulating an Analog System</a></li></ul>

<h2>
<a id="pgfId-1031810"></a><a id="marker-1041671"></a><a id="21205"></a>Kirchhoff&#8217;s Laws</h2>

<p>
<a id="pgfId-1031811"></a>Simulation of the analog content of Verilog<sup>&#174;</sup>-AMS language modules is based on two sets of relationships. The first set, called the <em>constitutive relationships</em><a id="marker-1031812"></a>, consists of formulas that describe the behavior of each component. Some formulas are supplied as <a id="marker-1031813"></a>built-in primitives. You provide other formulas in the form of module definitions.</p>
<p>
<a id="pgfId-1031815"></a>The second set of relationships, the<em> interconnection relationships</em><a id="marker-1031814"></a>, describes the structure of the network. This set, which contains information on how the nodes of the components are connected, is independent of the behavior of the constituent components. Kirchhoff&#8217;s laws provide the following properties relating the quantities present on the nodes and on the branches that connect the nodes.</p>

<ul><li>
<a id="pgfId-1031817"></a><a id="marker-1031816"></a>Kirchhoff&#8217;s Flow Law<br />
<a id="pgfId-1031818"></a>The algebraic sum of all the flows out of a node at any instant is zero.</li><li>
<a id="pgfId-1031820"></a><a id="marker-1031819"></a>Kirchhoff&#8217;s Potential Law<br />
<a id="pgfId-1031821"></a>The algebraic sum of all the branch potentials around a loop at any instant is zero.</li></ul>






<p>
<a id="pgfId-1031823"></a>These laws assume that a <a id="marker-1031822"></a>node is infinitely small so that there is negligible difference in potential between any two points on the node and a negligible accumulation of flow.</p>

<p>
<a id="pgfId-1032999"></a></p>
<div class="webflare-div-image">
<img width="667" height="312" src="images/appA-2.gif" /></div>
<h2>
<a id="pgfId-1031916"></a><a id="marker-1041673"></a><a id="18915"></a>Simulating an Analog System</h2>

<p>
<a id="pgfId-1031919"></a><a id="marker-1031917"></a>To describe an analog network, simulators combine constitutive relationships with <a id="marker-1031918"></a>Kirchhoff&#8217;s laws in <a id="marker-1031920"></a><em>nodal analysis</em> to form a system of differential-algebraic equations of the form</p>
<p>
<a id="pgfId-1031924"></a><img width="365" height="44" src="images/appA-3.gif" /></p>



<p>
<a id="pgfId-1031928"></a><img width="132" height="30" src="images/appA-4.gif" /></p>



<p>
<a id="pgfId-1031930"></a>These equations are a restatement of <a id="marker-1031929"></a>Kirchhoff&#8217;s Flow Law.</p>
<p class="webflare-indent1">
<a id="pgfId-1031931"></a><em>v</em> is a vector containing all node potentials.</p>
<p class="webflare-indent1">
<a id="pgfId-1031932"></a><em>t</em> is time.</p>
<p class="webflare-indent1">
<a id="pgfId-1031933"></a><em>q</em> and <em>i</em> are the dynamic and static portions of the flow.</p>
<p class="webflare-indent1">
<a id="pgfId-1031934"></a><em>f</em> is a vector containing the total flow out of each node.</p>
<p class="webflare-indent1">
<a id="pgfId-1031935"></a><em>v</em><sub>0</sub> is the vector of initial conditions.</p>

<h3>
<a id="pgfId-1031937"></a><a id="marker-1031936"></a>Transient Analysis</h3>

<p>
<a id="pgfId-1031938"></a>The equation describing the network is differential and nonlinear, which makes it impossible to solve directly. There are a number of different approaches to solving this problem numerically. However, all approaches break time into increments and solve the nonlinear equations iteratively.</p>
<p>
<a id="pgfId-1031940"></a>The simulator replaces the time derivative operator (<span class="webflare-courier-new" style="white-space:pre"><em>dq/dt</em></span>) with a discrete-time finite difference approximation. The simulation time interval is discretized and solved at individual time points along the interval. The simulator controls the interval between the time points to ensure the accuracy of the finite difference approximation. At each time point, the simulator solves iteratively a system of nonlinear algebraic equations. Like most circuit simulators, the <a id="marker-1031939"></a><a id="marker-1031941"></a>AMS Designer simulator uses the Newton-Raphson method to solve this system.</p>

<h3>
<a id="pgfId-1031944"></a><a id="marker-1031942"></a><a id="30937"></a>Convergence</h3>

<p>
<a id="pgfId-1031946"></a>In Verilog-AMS, the analog behavioral description is evaluated iteratively until the <a id="marker-1031945"></a>Newton-Raphson method converges. (For a graphical representation of this process, see <a href="chap1.html#25266">&#8220;Simulator Flow for Analog Systems&#8221;</a>.) On the first iteration, the signal values used in Verilog-AMS expressions are approximate and do not satisfy Kirchhoff&#8217;s laws. </p>
<p>
<a id="pgfId-1031950"></a>In fact, the initial values might not be reasonable; so you must write models that do something reasonable even when given unreasonable signal values. </p>
<p>
<a id="pgfId-1031951"></a>For example, if you compute the log or square root of a signal value, some signal values cause the arguments to these functions to become negative, even though a real-world system never exhibits negative values.</p>
<p>
<a id="pgfId-1031952"></a>As the iteration progresses, the signal values approach the solution. Iteration continues until two convergence criteria are satisfied. The first criterion is that the proposed solution on this iteration, <e-equation>
v(j)(t)</e-equation>
, must be close to the proposed solution on the previous iteration, <e-equation>
v</e-equation>
(j-1)(t), and</p>

<p>
<a id="pgfId-1035788"></a></p><p>
<img width="432" height="47" src="images/appA-5.gif" /></p>

<p>
<a id="pgfId-1031962"></a>where <span class="webflare-courier-new" style="white-space:pre"><em>reltol</em></span><a id="marker-1031956"></a> is the relative tolerance and <span class="webflare-courier-new" style="white-space:pre"><em>abstol</em></span><a id="marker-1031957"></a><a id="marker-1031958"></a><a id="marker-1031959"></a> is the <a id="marker-1031960"></a>absolute <a id="marker-1031961"></a>tolerance.</p>
<p>
<a id="pgfId-1031963"></a><span class="webflare-courier-new" style="white-space:pre"><em>reltol</em></span> is set as a simulator option and typically has a value of 0.001. There can be many absolute tolerances, and which one is used depends on the resolved discipline of the net. You set absolute tolerances by specifying the <span class="webflare-courier-new" style="white-space:pre"><em>abstol</em></span> attribute for the natures you use. The absolute tolerance is important when <span class="webflare-courier-new" style="white-space:pre"><em>vn</em></span> is converging to zero. Without <span class="webflare-courier-new" style="white-space:pre"><em>abstol</em></span>, the iteration never converges. </p>
<p>
<a id="pgfId-1032077"></a>The second criterion ensures that <a id="marker-1032076"></a>Kirchhoff&#8217;s Flow Law is satisfied:</p>

<p>
<a id="pgfId-1035792"></a><img width="341" height="44" src="images/appA-6.gif" /></p>

<p>
<a id="pgfId-1032082"></a>where <span class="webflare-courier-new" style="white-space:pre"><em>fni(v(j))</em></span> is the flow exiting node <code>n</code> from branch <code>i</code>.</p>
<p>
<a id="pgfId-1031972"></a>Both of these criteria specify the absolute tolerance to ensure that convergence is not precluded when <span class="webflare-courier-new" style="white-space:pre"><em>vn </em></span>or <span class="webflare-courier-new" style="white-space:pre"><em>f</em></span>n(v)<e-equation />
go to zero. While you can set the relative tolerance once in an options statement in the analog simulation control file (<code>.scs</code>) to work effectively on any node in the circuit, you must scale the absolute tolerance appropriately for the associated branches. Set the absolute tolerance to be the largest value that is negligible on all the branches with which it is associated.</p>
<p>
<a id="pgfId-1031973"></a>The simulator uses absolute tolerance to get an idea of the scale of signals. Absolute tolerances are typically 1,000 to 1,000,000 times smaller than the largest typical value for signals of a particular quantity. For example, in a typical integrated circuit, the largest potential is about 5 volts; so the default absolute tolerance for voltage is 1 μV. The largest current is about 1 mA; so the default absolute tolerance for current is 1 pA.</p>
<p>
<a id="pgfId-1031793"></a></p>

<br /><a href="#pagetop">Return to top</a><br /></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="chap12.html" id="prev" title="Controlling the Compiler">Controlling the Compiler</a></em></b><b><em><a href="appB.html" id="nex" title="Analog Probes and Sources">Analog Probes and Sources</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2019, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
</body></html>