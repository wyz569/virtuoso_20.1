
<html><head><title>Analog Probes and Sources</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="jommy" />
<meta name="CreateDate" content="2019-09-18" />
<meta name="CreateTime" content="1568827671" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes the analog and mixed-signal aspects of the Cadence Verilog-AMS language. With Verilog-AMS, you can create and use modules that describe the high-level behavior and structure of analog, digital, and mixed-signal components and systems." />
<meta name="DocTitle" content="Cadence Verilog-AMS Language Reference" />
<meta name="DocType" content="User Guide" />
<meta name="FileTitle" content="Analog Probes and Sources" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-3.1" />
<meta name="Keyword" content="verilogamsref" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2019-09-18" />
<meta name="ModifiedTime" content="1568827671" />
<meta name="NextFile" content="appD.html" />
<meta name="Group" content="Analog Mixed-Signal Simulation" />
<meta name="Platform" content="Functional Verification" />
<meta name="PrevFile" content="appA.html" />
<meta name="Product" content="Xcelium" />
<meta name="ProductFamily" content="Xcelium" />
<meta name="ProductVersion" content="19.09" />
<meta name="RightsManagement" content="Copyright 2012-2019 Cadence Design Systems Inc." />
<meta name="Title" content="Cadence Verilog-AMS Language Reference -- Analog Probes and Sources" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="product_feature" content="" />
<meta name="product_subfeature" content="" />
<meta name="Version" content="19.09" />
<meta name="SpaceKey" content="verilogamsref1909" />
<meta name="webflare-version" content="1.4" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" /></head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="verilogamsrefTOC.html">Contents</a></li><li><a class="prev" href="appA.html" title="Nodal Analysis">Nodal Analysis</a></li><li style="float: right;"><a class="viewPrint" href="verilogamsref.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="appD.html" title="Sample Model Library">Sample Model Library</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Cadence Verilog-AMS Language Reference<br />Product Version 19.09, September 2019</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;">

<h1>B
<a id="pgfId-1031801"></a></h1>
<h1>
<a id="pgfId-1031803"></a><hr />
Analog <a id="35587"></a>Probes and Sources<hr />
</h1>

<p>
<a id="pgfId-1031804"></a>This appendix describes what analog probes and sources are and gives some examples of using them. For information, see</p>
<ul><li>
<a id="pgfId-1031807"></a><a href="appB.html#21928">Probes</a></li><li>
<a id="pgfId-1050018"></a><a href="appB.html#98857">Port Branches</a></li><li>
<a id="pgfId-1032863"></a><a href="appB.html#88535">Sources</a></li></ul>


<p>
<a id="pgfId-1031813"></a>For examples, see</p>
<ul><li>
<a id="pgfId-1031816"></a><a href="appB.html#42339">Linear Conductor</a></li><li>
<a id="pgfId-1031820"></a><a href="appB.html#41792">Linear Resistor</a></li><li>
<a id="pgfId-1031824"></a><a href="appB.html#35656">RLC Circuit</a></li><li>
<a id="pgfId-1031828"></a><a href="appB.html#35805">Simple Implicit Diode</a></li></ul>




<h2>
<a id="pgfId-1031831"></a><a id="marker-1044660"></a><a id="77104"></a>Overview of Probes and Sources</h2>

<p>
<a id="pgfId-1031833"></a>A <em>probe</em><a id="marker-1031832"></a> is a branch in which no value is assigned for either the potential or the flow, anywhere in the module. A <em>source</em><a id="marker-1031834"></a> is a branch in which either the potential or the flow is assigned a value by a contribution statement somewhere in the module.</p>
<p>
<a id="pgfId-1031836"></a>You might find it useful to describe component behavior as a network of <a id="marker-1031835"></a>probes and <a id="marker-1031837"></a>sources. </p>
<ul><li>
<a id="pgfId-1031838"></a>It is sometimes easier to describe a component first as a network of probes and sources, and then use the rules presented here to map the network into a behavioral description. </li><li>
<a id="pgfId-1031839"></a>A complex behavioral description is sometimes easier to understand if it is converted into a network of probes and sources.</li></ul>

<p>
<a id="pgfId-1031840"></a>The probe and source interpretation provides the additional benefit of unambiguously defining what the response will be when you manipulate a signal.</p>

<h2>
<a id="pgfId-1031842"></a><a id="marker-1044662"></a><a id="21928"></a>Probes</h2>

<p>
<a id="pgfId-1031845"></a>A <em>flow probe</em><a id="marker-1031843"></a><a id="marker-1031844"></a> is a branch in which the flow is used in an expression somewhere in the module. A<em> potential probe</em><a id="marker-1031846"></a><a id="marker-1031847"></a> is a branch in which the potential is used. You must not measure both the potential and the flow of a probe branch.</p>
<p>
<a id="pgfId-1031857"></a>The equivalent circuit model for a potential probe is</p>

<p>
<a id="pgfId-1032236"></a></p>
<div class="webflare-div-image">
<img width="140" height="20" src="images/appB-2.gif" /></div>

<p>
<a id="pgfId-1031858"></a>The branch flow of a potential probe is zero. </p>
<p>
<a id="pgfId-1031866"></a>The equivalent circuit model for a flow probe is</p>

<p>
<a id="pgfId-1032237"></a></p>
<div class="webflare-div-image">
<img width="139" height="39" src="images/appB-3.gif" /></div>

<p>
<a id="pgfId-1031867"></a>The branch potential of a flow probe is zero.</p>

<h2>
<a id="pgfId-1050024"></a>Port Branches<a id="98857"></a></h2>

<p>
<a id="pgfId-1050026"></a>You can use the port access function to monitor the flow into the port of a module. The name of the access function is derived from the flow nature of the discipline of the port and you use the <code>(&lt;&gt;)</code><a id="marker-1050025"></a> operator to delimit the port name. For example, <code>I(&lt;a&gt;)</code> accesses the current through module port <code>a</code>.</p>
<p>
<a id="pgfId-1033546"></a>A port branch, which is a special form of a flow probe, measures the flow into a port rather than across a branch. When a port is connected to numerous branches, using a port branch provides a quick way of summing the flow.</p>
<p>
<a id="pgfId-1050031"></a><a id="marker-1044664"></a>The expression <code>V(&lt;a&gt;)</code> is invalid for ports and nets, where <code>V</code> is a potential access function. The port branch probe <code>I(&lt;a&gt;)</code> cannot be used on the left side of a contribution operator &lt;+. As a result of these restrictions, you cannot use port branches to create behavioral resistors, capacitors, and inductors.</p>
<p>
<a id="pgfId-1050032"></a>In the following example, the simulator issues a warning if the current through the diode becomes too large.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1050033"></a>module diode (a, c) ;<br />electrical a, c ;<br />branch (a, c) diode, cap ;<br />parameter real is=1e-14, tf=0, cjo=0, imax=1, phi=0.7 ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1050034"></a>analog begin
&#160;&#160;&#160;&#160;I(diode) &lt;+ is*(limexp(V(diode)/$vt) &#8211; 1) ;
&#160;&#160;&#160;&#160;I(cap) &lt;+ ddt(tf*I(diode) - 2 * cjo * sqrt(phi * (phi * V(cap)))) ;
&#160;&#160;&#160;&#160;if (I(&lt;a&gt;) &gt; imax) // Checks current through port
&#160;&#160;&#160;&#160;    $strobe( &quot;Warning: diode is melting!&quot; ) ;
&#160;&#160;&#160;&#160;end <br />endmodule</pre>
<p>
<a id="pgfId-1032779"></a></p>
<h2>
<a id="pgfId-1032692"></a><a id="marker-1044666"></a><a id="88535"></a>Sources</h2>

<p>
<a id="pgfId-1031913"></a>A <em>potential source</em><a id="marker-1031911"></a><a id="marker-1031912"></a> is a branch in which the potential is assigned a value by a contribution statement somewhere in the module. A<em> flow source</em><a id="marker-1031914"></a><a id="marker-1031915"></a> is a branch in which the flow is assigned a value. A branch cannot simultaneously be both a potential and a flow source, although it can switch between the two kinds. For additional information, see <a href="appB.html#18248">&#8220;Switch Branches&#8221;</a>.</p>
<p>
<a id="pgfId-1031920"></a>The circuit model for a <a id="marker-1031919"></a>potential source branch shows that you can obtain both the flow and the potential for a potential source branch.</p>

<p>
<a id="pgfId-1032240"></a></p>
<div class="webflare-div-image">
<img width="676" height="201" src="images/appB-4.gif" /></div>

<p>
<a id="pgfId-1031952"></a>Similarly, the circuit model for a <a id="marker-1031951"></a>flow source branch shows that you can obtain the flow and potential for a flow source branch.</p>

<p>
<a id="pgfId-1032241"></a></p>
<div class="webflare-div-image">
<img width="676" height="212" src="images/appB-5.gif" /></div>

<p>
<a id="pgfId-1031981"></a>With the flow and potential sources, you can model the four basic <a id="marker-1031980"></a>controlled <a id="marker-1031982"></a>sources, using node or branch declarations and contribution statements like those in the following code fragments.</p>
<p>
<a id="pgfId-1031985"></a>The model for a <em>voltage-controlled voltage source</em><a id="marker-1031983"></a><a id="marker-1031984"></a> is</p>

<pre class="webflare-courier-new">
<a id="pgfId-1031986"></a>branch (ps,ns) in, (p,n) out;<br />V(out) &lt;+ A * V(in);</pre>

<p>
<a id="pgfId-1031989"></a>The model for a<em> voltage-controlled current source</em><a id="marker-1031987"></a><a id="marker-1031988"></a> is</p>

<pre class="webflare-courier-new">
<a id="pgfId-1031990"></a>branch (ps,ns) in, (p,n) out;<br />I(out) &lt;+ A * V(in);</pre>

<p>
<a id="pgfId-1031993"></a>The model for a<em> current-controlled voltage source</em><a id="marker-1031991"></a><a id="marker-1031992"></a> is</p>

<pre class="webflare-courier-new">
<a id="pgfId-1031994"></a>branch (ps,ns) in, (p,n) out;<br />V(out) &lt;+ A * I(in);</pre>

<p>
<a id="pgfId-1031997"></a>The model for a <em>current-controlled current source</em><a id="marker-1031995"></a><a id="marker-1031996"></a> is</p>

<pre class="webflare-courier-new">
<a id="pgfId-1031998"></a>branch (ps,ns) in, (p,n) out;<br />I(out) &lt;+ A * I(in);</pre>
<h3>
<a id="pgfId-1032001"></a><a id="marker-1044668"></a><a id="marker-1031999"></a>Unassigned <a id="marker-1032000"></a>Sources</h3>

<p>
<a id="pgfId-1032004"></a>If you do not assign a value to a branch, the <a id="marker-1032002"></a><a id="marker-1032003"></a>branch flow, by default, is set to zero. In the following fragment, for example, when <code>closed</code> is true, <code>V(p,n)</code> is set to zero. When <code>closed</code> is false, the current <code>I(p,n)</code> is set to zero. </p>

<pre class="webflare-courier-new">
<a id="pgfId-1032005"></a>if (closed)
&#160;&#160;&#160;&#160;V(p,n) &lt;+ 0 ;
else
&#160;&#160;&#160;&#160;I(p,n) &lt;+ 0 ;</pre>

<p>
<a id="pgfId-1032006"></a>Alternatively, you could achieve the same result with</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032007"></a>if (closed)
&#160;&#160;&#160;&#160;V(p,n) &lt;+ 0 ;</pre>

<p>
<a id="pgfId-1032008"></a>This code fragment also sets <code>V(p,n)</code> to zero when <code>closed</code> is true. When <code>closed</code> is false, the current is set to zero by default.</p>

<h3>
<a id="pgfId-1032010"></a><a id="marker-1044670"></a><a id="18248"></a>Switch Branches</h3>

<p>
<a id="pgfId-1032013"></a><em>Switch branches</em><a id="marker-1032011"></a><a id="marker-1032012"></a> are branches that change from source potential branches into source flow branches, and vice versa. Switch branches are useful when you want to model ideal switches or mechanical stops. </p>
<p>
<a id="pgfId-1032015"></a>To switch a branch to being a <a id="marker-1032014"></a>potential source, assign to its potential. To switch a branch to being a<a id="marker-1032016"></a> flow source, assign to its flow. The circuit model for a switch <a id="marker-1032017"></a>branch illustrates the effect, with the position of the switch dependent upon whether you assign to the potential or to the flow of the <a id="marker-1032018"></a>branch.</p>

<p>
<a id="pgfId-1032291"></a></p>
<div class="webflare-div-image">
<img width="677" height="227" src="images/appB-6.gif" /></div>

<p>
<a id="pgfId-1032064"></a>As an example of a switch branch, consider the <a id="marker-1032062"></a>module <code>idealRelay</code><a id="marker-1032063"></a>. </p>

<pre class="webflare-courier-new">
<a id="pgfId-1032065"></a>module idealRelay (pout, nout, psense, nsense) ;
input psense, nsense ;
output pout, nout ;
electrical pout, nout, psense, nsense ;
parameter real thresh = 2.5 ;
analog begin
&#160;&#160;&#160;&#160;if (V(psense, nsense) &gt; thresh)
&#160;&#160;&#160;&#160;    V(pout, nout) &lt;+ 0.0 ; // Becomes potential source
&#160;&#160;&#160;&#160;else
&#160;&#160;&#160;&#160;    I(pout, nout) &lt;+ 0.0 ; // Becomes flow source
&#160;&#160;&#160;&#160;end<br />endmodule</pre>

<p>
<a id="pgfId-1032067"></a>The simulator assumes that a <a id="marker-1032066"></a>discontinuity of order zero occurs whenever the branch switches; so you do not have to use the <a id="marker-1032068"></a>discontinuity function with switch branches. For more information about the discontinuity function, see <a href="chap9.html#14167">&#8220;Announcing Discontinuity&#8221;</a>.</p>
<p>
<a id="pgfId-1049972"></a><a id="marker-1049981"></a>Contributing a flow to a branch that already has a <a id="marker-1049980"></a>value retained for the potential results in the potential being discarded and the branch being converted to a flow source. Conversely, contributing a potential to a branch that already has a value retained for the flow results in the flow being discarded and the branch being converted to a potential source. For example, in the following code, each of the contribution statements is discarded when the next is encountered.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1049973"></a>analog begin<br />   V(out) &lt;+ 1.0; // Discarded<br />   I(out) &lt;+ 1.0; // Discarded<br />   V(out) &lt;+ 1.0;<br />end</pre>

<p>
<a id="pgfId-1049982"></a>In the next example,</p>

<pre class="webflare-courier-new">
<a id="pgfId-1049983"></a>I(out) &lt;+ 1.0;<br />V(out) &lt;+ I(out);</pre>

<p>
<a id="pgfId-1049990"></a>the result of <code>V(out)</code> is not 1.0. Instead, these two statements are equivalent to</p>

<pre class="webflare-courier-new">
<a id="pgfId-1049993"></a>// I(out) &lt;+ 1.0;<br />V(out) &lt;+ I(out);</pre>

<p>
<a id="pgfId-1050000"></a>because the flow contribution is discarded. The simulator reminds you of this behavior by issuing a warning similar to the following, </p>

<pre class="webflare-courier-new">
<a id="pgfId-1050001"></a>The statement on line 12 contributes either a potential to a flow source or a flow to a potential source. To match the requirements of value retention, the statement is ignored.</pre>
<h2>
<a id="pgfId-1042559"></a><a id="marker-1044672"></a><a id="marker-1044674"></a>Examples of Sources and Probes</h2>

<p>
<a id="pgfId-1032073"></a>The following examples illustrate how to construct models using sources and probes. </p>

<h3>
<a id="pgfId-1032075"></a><a id="42339"></a>Linear Conductor</h3>

<p>
<a id="pgfId-1032099"></a>The model for a <a id="marker-1032076"></a>linear <a id="marker-1032077"></a>conductor is</p>

<p>
<a id="pgfId-1032305"></a></p>
<div class="webflare-div-image">
<img width="511" height="135" src="images/appB-7.gif" /></div>

<p>
<a id="pgfId-1032100"></a>The contribution to <code>I(cond)</code> makes <code>cond</code> a current (flow) source branch, and <code>V(cond)</code> accesses the potential probe built into the current source branch.</p>

<h3>
<a id="pgfId-1032102"></a><a id="41792"></a>Linear Resistor</h3>

<p>
<a id="pgfId-1032125"></a>The model for a <a id="marker-1032103"></a>linear <a id="marker-1032104"></a>resistor is</p>

<p>
<a id="pgfId-1032321"></a></p>
<div class="webflare-div-image">
<img width="499" height="135" src="images/appB-8.gif" /></div>

<p>
<a id="pgfId-1032126"></a>The contribution to <code>V(res)</code> makes <code>res</code> a potential source branch.<code> I(res)</code> accesses the flow probe built into the potential source branch.</p>

<h3>
<a id="pgfId-1032324"></a><a id="marker-1044680"></a><a id="35656"></a>RLC Circuit</h3>

<p>
<a id="pgfId-1032330"></a>A series <a id="marker-1032325"></a>RLC <a id="marker-1032326"></a>circuit is formulated by summing the voltage across the three components.</p>

<p>
<a id="pgfId-1033438"></a><img width="247" height="43" src="images/appB-9.gif" /></p>

<p>
<a id="pgfId-1032331"></a>To describe the series RLC circuit with probes and sources, you might write </p>

<pre class="webflare-courier-new">
<a id="pgfId-1036634"></a>V(p,n) &lt;+ R*I(p,n) + L*ddt(I(p,n)) + idt(I(p,n))/C ;</pre>

<p>
<a id="pgfId-1036638"></a>A parallel RLC circuit is formulated by summing the currents through the three components.</p>

<p>
<a id="pgfId-1036642"></a><img width="242" height="43" src="images/appB-10.gif" /></p>

<p>
<a id="pgfId-1036639"></a>To describe the parallel RLC circuit, you might code</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032142"></a>I(p,n) &lt;+ V(p,n)/R + C*ddt(V(p,n)) + idt(V(p,n))/L ;</pre>
<h3>
<a id="pgfId-1032144"></a><a id="marker-1044682"></a><a id="35805"></a>Simple Implicit Diode</h3>

<p>
<a id="pgfId-1032147"></a>This example illustrates a case where the model equation is <a id="marker-1032145"></a>implicit<a id="marker-1032146"></a>. The model equation is implicit because the current <code>I(a,c)</code> appears on both sides of the contribution operator. The equation specifies the current of the branch, making it a flow source branch. In addition, both the voltage and the current of the branch are used in the behavioral description.<a id="marker-1032148"></a></p>

<pre class="webflare-courier-new">
<a id="pgfId-1032149"></a>I(a,c) &lt;+ is * (limexp((V(a,c) &#8211; rs * I(a,c)) / Vt) &#8211; 1) ;</pre>
<br /><a href="#pagetop">Return to top</a><br /></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="appA.html" id="prev" title="Nodal Analysis">Nodal Analysis</a></em></b><b><em><a href="appD.html" id="nex" title="Sample Model Library">Sample Model Library</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2019, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
</body></html>