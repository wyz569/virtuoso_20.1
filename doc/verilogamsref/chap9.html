
<html><head><title>Simulator Functions</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="jommy" />
<meta name="CreateDate" content="2019-09-18" />
<meta name="CreateTime" content="1568827718" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes the analog and mixed-signal aspects of the Cadence Verilog-AMS language. With Verilog-AMS, you can create and use modules that describe the high-level behavior and structure of analog, digital, and mixed-signal components and systems." />
<meta name="DocTitle" content="Cadence Verilog-AMS Language Reference" />
<meta name="DocType" content="User Guide" />
<meta name="FileTitle" content="Simulator Functions" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-3.1" />
<meta name="Keyword" content="verilogamsref" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2019-09-18" />
<meta name="ModifiedTime" content="1568827718" />
<meta name="NextFile" content="chap10.html" />
<meta name="Group" content="Analog Mixed-Signal Simulation" />
<meta name="Platform" content="Functional Verification" />
<meta name="PrevFile" content="chap8.html" />
<meta name="Product" content="Xcelium" />
<meta name="ProductFamily" content="Xcelium" />
<meta name="ProductVersion" content="19.09" />
<meta name="RightsManagement" content="Copyright 2012-2019 Cadence Design Systems Inc." />
<meta name="Title" content="Cadence Verilog-AMS Language Reference -- Simulator Functions" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="product_feature" content="" />
<meta name="product_subfeature" content="" />
<meta name="Version" content="19.09" />
<meta name="SpaceKey" content="verilogamsref1909" />
<meta name="webflare-version" content="1.4" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" /></head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="verilogamsrefTOC.html">Contents</a></li><li><a class="prev" href="chap8.html" title="Analog">Analog </a></li><li style="float: right;"><a class="viewPrint" href="verilogamsref.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="chap10.html" title="Instantiating Modules and Primitives">Instantiating Modules and Prim ...</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Cadence Verilog-AMS Language Reference<br />Product Version 19.09, September 2019</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;">

<h1>9
<a id="pgfId-1031799"></a></h1>
<h1>
<a id="pgfId-1031801"></a><hr />
<a id="10792"></a>Simulator Functions<hr />
</h1>

<p>
<a id="pgfId-1079296"></a>This chapter describes the Cadence<sup>&#174;</sup> Verilog<sup>&#174;</sup>-AMS language simulator functions. The simulator functions let you access information about a simulation and manage the simulation&#8217;s current state. You can also use the simulator functions to display and record simulation results. </p>
<p>
<a id="pgfId-1031803"></a>For information about using simulator functions, see</p>
<ul><li>
<a id="pgfId-1031806"></a><a href="chap9.html#14167">Announcing Discontinuity</a></li><li>
<a id="pgfId-1031810"></a><a href="chap9.html#13520">Bounding the Time Step</a></li><li>
<a id="pgfId-1031814"></a><a href="chap9.html#30404">Finding When a Signal Is Zero</a></li><li>
<a id="pgfId-1031818"></a><a href="chap9.html#18823">Querying the Simulation Environment</a></li><li>
<a id="pgfId-1034157"></a><a href="chap9.html#34735">Obtaining and Setting Signal Values</a></li><li>
<a id="pgfId-1034161"></a><a href="chap9.html#24940">Determining the Current Analysis Type</a></li><li>
<a id="pgfId-1166524"></a><a href="chap9.html#13674">Examining Drivers</a></li><li>
<a id="pgfId-1034165"></a><a href="chap9.html#31835">Implementing Small-Signal AC Sources</a></li><li>
<a id="pgfId-1031834"></a><a href="chap9.html#33540">Implementing Small-Signal Noise Sources</a></li><li>
<a id="pgfId-1031838"></a><a href="chap9.html#25632">Generating Random Numbers</a></li><li>
<a id="pgfId-1088401"></a><a href="chap9.html#12212">Generating Random Numbers in Specified Distributions</a></li><li>
<a id="pgfId-1088850"></a><a href="chap9.html#45758">Interpolating with Table Models</a></li><li>
<a id="pgfId-1171183"></a><a href="chap9.html#31757">Node/Net Aliasing System Functions</a></li></ul>












<p>
<a id="pgfId-1088852"></a>For information on analog operators and filters, see</p>
<ul><li>
<a id="pgfId-1088856"></a><a href="chap9.html#18262">Limited Exponential Function</a></li><li>
<a id="pgfId-1031851"></a><a href="chap9.html#18023">Time Derivative Operator</a></li><li>
<a id="pgfId-1031855"></a><a href="chap9.html#31165">Time Integral Operator</a></li><li>
<a id="pgfId-1031859"></a><a href="chap9.html#36508">Circular Integrator Operator</a></li><li>
<a id="pgfId-1031863"></a><a href="chap9.html#36934">Delay Operator</a></li><li>
<a id="pgfId-1031867"></a><a href="chap9.html#20376">Transition Filter</a></li><li>
<a id="pgfId-1031871"></a><a href="chap9.html#32642">Slew Filter</a></li><li>
<a id="pgfId-1031875"></a><a href="chap9.html#12971">Implementing Laplace Transform S-Domain Filters</a></li><li>
<a id="pgfId-1031879"></a><a href="chap9.html#16172">Implementing Z-Transform Filters</a></li></ul>








<p>
<a id="pgfId-1031881"></a>For descriptions of functions used to control input and output, see</p>
<ul><li>
<a id="pgfId-1031884"></a><a href="chap9.html#37809">Displaying Results</a></li><li>
<a id="pgfId-1031888"></a><a href="chap9.html#37176">Working with Files</a></li></ul>

<p>
<a id="pgfId-1031890"></a>For descriptions of functions used to control the simulator, see</p>
<ul><li>
<a id="pgfId-1031893"></a><a href="chap9.html#14667">Simulator Control Functions</a></li></ul>
<p>
<a id="pgfId-1031895"></a>For a description of the <code>$pwr</code> function, which is used to specify power consumption in a module, see</p>
<ul><li>
<a id="pgfId-1031898"></a><a href="chap9.html#26375">Specifying Power Consumption</a></li></ul>
<p>
<a id="pgfId-1031900"></a>For information on using user-defined functions in the Verilog-AMS language, see</p>
<ul><li>
<a id="pgfId-1031903"></a><a href="chap9.html#30341">Declaring an Analog User-Defined Function</a></li><li>
<a id="pgfId-1031907"></a><a href="chap9.html#36620">Calling a User-Defined Analog Function</a></li></ul>


<h2>
<a id="pgfId-1031912"></a><a id="marker-1134300"></a><a id="14167"></a>Announcing <a id="marker-1031910"></a>Discontinuity<a id="marker-1031911"></a></h2>

<p>
<a id="pgfId-1031914"></a>Use the <code>$discontinuity</code> function to tell the simulator about a discontinuity in signal behavior. <a id="marker-1031913"></a></p>

<pre class="webflare-courier-new">
<a id="pgfId-1031915"></a>discontinuity_function ::=
&#160;&#160;&#160;&#160;    <strong>$discontinuity</strong>[ <strong>(</strong><code><em>constant_expression</em></code><strong>) </strong>]</pre>

<p>
<a id="pgfId-1037177"></a><span class="webflare-courier-new" style="white-space:pre"><em>constant_expression</em></span>, which must be zero or a positive integer, is the degree of the discontinuity. For example, <code>$discontinuity</code>, which is equivalent to <code>$discontinuity(0)</code>, indicates a discontinuity in the equation, and <code>$discontinuity(1)</code> indicates a discontinuity in the slope of the equation.</p>
<p>
<a id="pgfId-1031920"></a>You do not need to announce discontinuities created by switch branches or built-in functions such as <code>transition</code> and <code>slew</code>.</p>
<p>
<a id="pgfId-1031921"></a>Be aware that using the <code>$discontinuity</code> function does not guarantee that the simulator will be able to handle a discontinuity successfully. If possible, you should avoid discontinuities in the circuits you model.</p>
<p>
<a id="pgfId-1031922"></a>The following example shows how you might use the <code>$discontinuity</code> function while describing the behavior of a source that generates a triangular wave. As the <a href="chap9.html#19219">Triangular Wave</a> figure shows, the triangular wave is continuous, but as the <a href="chap9.html#12665">Triangular Wave First Derivative</a> figure shows, the first derivative of the wave is discontinuous.</p>

<ft-figtabl-title id="#id1031940">
<a id="pgfId-1031940"></a><a id="19219"></a>Triangular Wave</ft-figtabl-title>
<p>
<a id="pgfId-1035412"></a></p>
<div class="webflare-div-image">
<img width="666" height="71" src="images/chap9-2.gif" /></div>
<ft-figtabl-title id="#id1031953">
<a id="pgfId-1031953"></a><a id="12665"></a>Triangular Wave First Derivative</ft-figtabl-title>
<p>
<a id="pgfId-1035413"></a></p>
<div class="webflare-div-image">
<img width="668" height="69" src="images/chap9-3.gif" /></div>

<p>
<a id="pgfId-1031955"></a>The module <code>trisource</code> describes this triangular wave source.<a id="marker-1031954"></a></p>

<pre class="webflare-courier-new">
<a id="pgfId-1031956"></a>module trisource (vout) ;<br />output vout ;<br />voltage vout ;<br />parameter real wavelength = 10.0, amplitude = 1.0 ;<br />integer slope ;<br />real wstart ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051437"></a>analog begin
&#160;&#160;&#160;&#160;@(timer(0, wavelength)) begin
&#160;&#160;&#160;&#160;    slope = +1 ;
&#160;&#160;&#160;&#160;    wstart = $abstime ;
&#160;&#160;&#160;&#160;    $discontinuity (1);        // Change from neg to pos slope
&#160;&#160;&#160;&#160;end
&#160;&#160;&#160;&#160;@(timer(wavelength/2, wavelength)) begin
&#160;&#160;&#160;&#160;    slope = -1 ;
&#160;&#160;&#160;&#160;    wstart = $abstime ;
&#160;&#160;&#160;&#160;    $discontinuity (1);        // Change from pos to neg slope
&#160;&#160;&#160;&#160;end
&#160;&#160;&#160;&#160;V(vout) &lt;+ amplitude * slope * (4 * ($abstime - wstart) / wavelength-1) ;<br />end<br />endmodule</pre>

<p>
<a id="pgfId-1034991"></a>The two <code>$discontinuity</code> functions in <code>trisource </code>tell the simulator about the discontinuities in the derivative. In response, the simulator uses analysis techniques that take the discontinuities into account.</p>
<p>
<a id="pgfId-1034992"></a>The module <code>relay</code>, as another example, uses the <code>$discontinuity</code> function while modeling a <a id="marker-1034993"></a>relay.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1031960"></a>module relay (c1, c2, pin, nin) ;<br />inout c1, c2 ;<br />input pin, nin ;<br />electrical c1, c2, pin, nin ;<br />parameter real r = 1 ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051439"></a>analog begin
&#160;&#160;&#160;&#160;@(cross(V(pin, nin) - 1, 0, 0.01n, pin.potential.abstol)) $discontinuity(0);
&#160;&#160;&#160;&#160;if (V(pin, nin) &gt;= 1)
&#160;&#160;&#160;&#160;    I(c1, c2) &lt;+ V(c1, c2) / r ;
&#160;&#160;&#160;&#160;else
&#160;&#160;&#160;&#160;    I(c1, c2) &lt;+ 0 ;<br />end<br />endmodule</pre>

<p>
<a id="pgfId-1031961"></a>The $<code>discontinuity</code> function in <code>relay</code> tells the simulator that there is a discontinuity in the current when the voltage crosses the value 1. For example, passing a triangular wave like that shown in the <a href="chap9.html#16599">Relay Voltage</a> figure through module <code>relay</code> produces the discontinuous current shown in the <a href="chap9.html#26829">Relay Current</a> figure.</p>

<ft-figtabl-title id="#id1031985">
<a id="pgfId-1031985"></a><a id="16599"></a>Relay Voltage</ft-figtabl-title>
<p>
<a id="pgfId-1035414"></a></p>
<div class="webflare-div-image">
<img width="307" height="103" src="images/chap9-4.gif" /></div>
<ft-figtabl-title id="#id1032007">
<a id="pgfId-1032007"></a><a id="26829"></a>Relay Current</ft-figtabl-title>
<p>
<a id="pgfId-1035415"></a></p>
<div class="webflare-div-image">
<img width="320" height="104" src="images/chap9-5.gif" /></div>
<h2>
<a id="pgfId-1147503"></a><a id="marker-1147500"></a><a id="13520"></a>Bounding the <a id="marker-1147502"></a>Time Step</h2>

<p>
<a id="pgfId-1147506"></a>Use the <code>$bound_step</code><a id="marker-1147504"></a> function to specify the maximum time allowed between adjacent time points during simulation.<a id="marker-1147505"></a></p>

<pre class="webflare-courier-new">
<a id="pgfId-1147507"></a>bound_step_function ::=
&#160;&#160;&#160;&#160;    <strong>$bound_step</strong> <strong>(</strong> max_step <strong>)</strong></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1147508"></a>max_step ::=
&#160;&#160;&#160;&#160;    constant_expression</pre>

<p>
<a id="pgfId-1147509"></a>By specifying appropriate time steps, you can force the simulator to track signals as closely as your model requires. For example, module <code>sinwave</code> forces the simulator to simulate at least 50 time points during each cycle.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1147510"></a>module sinwave (outsig) ;<br />output outsig ;<br />voltage outsig ;<br />parameter real freq = 1.0, ampl = 1.0 ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1147511"></a>analog begin
&#160;&#160;&#160;&#160;V(outsig) &lt;+ ampl * sin(2.0 * &#8216;M_PI * freq * $abstime) ;
&#160;&#160;&#160;&#160;$bound_step(0.02 / freq) ;            // Max time step = 1/50 period<br />end<br />endmodule</pre>
<h2>
<a id="pgfId-1032010"></a><a id="marker-1134302"></a>Announcing and Handling Nonlinearities</h2>

<p>
<a id="pgfId-1155052"></a>Use the <code>$limit</code><a id="marker-1155050"></a> function to announce nonlinearities that are other than exponential. This information is used to improve convergence.<a id="marker-1155051"></a></p>

<pre class="webflare-courier-new">
<a id="pgfId-1155056"></a>limit_call_function ::=
&#160;&#160;&#160;&#160;    <strong>$limit</strong> <strong>(</strong> access_function_reference <strong>)<br /></strong> |&#160;&#160; <strong>$limit</strong> <strong>(</strong> access_function_reference, string, arg_list<strong>)<br /></strong> |&#160;&#160; <strong>$limit</strong> <strong>(</strong> access_function_reference, analog_function_ID, arg_list<strong>)</strong></pre>

<p>
<a id="pgfId-1155018"></a><code>access_function_reference</code> is the reference that is being limited.</p>
<p>
<a id="pgfId-1155035"></a><code>string</code> is a built-in simulator function that you recommend be used to compute the return value. In this release, the syntax of <code>string</code> is not checked.</p>
<p>
<a id="pgfId-1155036"></a><code>analog_function_ID</code> is a user-defined analog function that you recommend be used to compute the return value. In this release, the syntax of <code>analog_function_ID</code> is not checked.</p>
<p>
<a id="pgfId-1155040"></a><code>arg_list</code> is a list of arguments for the built-in or user-defined function. In this release, the syntax of <code>arg_list</code> is not checked.</p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1155063"></a>Although the <code>$limit</code> function is allowed, Cadence tools, in this release, do nothing with the information. Consequently, coding</div>

<pre class="webflare-courier-new">
<a id="pgfId-1155064"></a>vdio = $limit(V(a,c), spicepnjlim, $vt, vcrit);</pre>

<p>
<a id="pgfId-1155065"></a>is equivalent to coding</p>
<p>
<a id="pgfId-1155061"></a>vdio = V(a,c);</p>

<h2>
<a id="pgfId-1032018"></a><a id="30404"></a>Finding When a Signal Is Zero</h2>

<p>
<a id="pgfId-1032021"></a>Use the <code>last_crossing</code><a id="marker-1032019"></a> function to find out what the simulation time was when a signal expression last crossed zero.<a id="marker-1032020"></a></p>

<pre class="webflare-courier-new">
<a id="pgfId-1032022"></a>last_crossing_function ::=
&#160;&#160;&#160;&#160;    <strong>last_crossing</strong> <strong>(</strong> <code><em>signal_expression</em></code> <strong>,</strong> <code><em>direction</em></code> <strong>)</strong></pre>

<p>
<a id="pgfId-1032041"></a><a id="marker-1032023"></a>Set <span class="webflare-courier-new" style="white-space:pre"><em>direction</em></span> to indicate which crossings the simulator should detect.</p>

<p>
<a id="pgfId-1091568"></a></p>
<table class="webflareTable" id="#id1032024">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1032026">
<a id="pgfId-1032026"></a>If you want to</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1032028">
<a id="pgfId-1032028"></a>Then</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032030"></a>Detect all crossings</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032032"></a>Set <span class="webflare-courier-new" style="white-space:pre"><em>direction</em></span> equal to 0</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032034"></a>Detect only crossings where the value is increasing</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032036"></a>Set <span class="webflare-courier-new" style="white-space:pre"><em>direction</em></span> equal to +1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032038"></a>Detect only crossings where the value is decreasing</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032040"></a>Set <span class="webflare-courier-new" style="white-space:pre"><em>direction</em></span> equal to -1</p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1032042"></a>Before the first detectable crossing, the <code>last_crossing</code> function returns a negative value.</p>
<p>
<a id="pgfId-1035653"></a>The <code>last_crossing</code> function is subject to the restrictions listed in <a href="chap9.html#27794">&#8220;Restrictions on Using Analog Operators&#8221;</a>.</p>
<p>
<a id="pgfId-1032048"></a>The <code>last_crossing</code> function does not control the time step to get accurate results and uses interpolation to estimate the time of the last crossing. To improve the accuracy, you might want to use the <code>last_crossing</code><a id="marker-1032049"></a> function together with the <code>cross</code> function.</p>
<p>
<a id="pgfId-1032051"></a>For example, module <code>period</code> calculates the period of the input signal, using the <code>cross</code><a id="marker-1032050"></a> function to resolve the times accurately.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032052"></a>module period (in) ;<br />input in ;<br />voltage in ;<br />integer crosscount ;<br />real latest, earlier ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051445"></a>analog begin
&#160;&#160;&#160;&#160;@(initial_step) begin
&#160;&#160;&#160;&#160;    crosscount = 0 ;
&#160;&#160;&#160;&#160;    earlier = 0 ;
&#160;&#160;&#160;&#160;end<br /></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1032053"></a> @(cross(V(in), +1)) begin<br />     crosscount = crosscount + 1 ;<br />     earlier = latest ;<br /> end<br /> latest = last_crossing(V(in), +1) ;<br /> @(final_step) begin<br />     if (crosscount &lt; 2)<br />         $strobe(&quot;Could not measure the period.&quot;) ;<br />     else<br />         $strobe(&quot;Period = %g, Crosscount = %d&quot;, latest-earlier, crosscount) ;<br /> end<br />end<br />endmodule</pre>
<h2>
<a id="pgfId-1032056"></a><a id="marker-1134306"></a><a id="18823"></a>Querying the <a id="marker-1032055"></a>Simulation Environment</h2>

<p>
<a id="pgfId-1032058"></a>Use the simulation environment <a id="marker-1032057"></a><a id="marker-1134494"></a>functions described in the following sections to obtain information about the current simulation environment.</p>

<h3>
<a id="pgfId-1034344"></a><a id="marker-1134308"></a>Obtaining the Current Simulation Time</h3>

<p>
<a id="pgfId-1037139"></a>Verilog-AMS provide two environment parameter functions that you can use to obtain the current simulation time: <code>$abstime</code> and <code>$realtime</code>.</p>

<h4>
<a id="pgfId-1037149"></a><a id="marker-1134310"></a>$abstime Function</h4>

<p>
<a id="pgfId-1037154"></a>Use the $abstime function to obtain the current simulation time in seconds.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1037159"></a>abstime_function ::=
&#160;&#160;&#160;&#160;    <strong>$abstime</strong></pre>
<h4>
<a id="pgfId-1034345"></a><a id="marker-1134312"></a>$realtime Function</h4>

<p>
<a id="pgfId-1037143"></a>Use the <code>$realtime</code> function to obtain the current simulation time in seconds.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1034346"></a>realtime_function ::=
&#160;&#160;&#160;&#160;    <strong>$realtime</strong>[<strong>(</strong><code><em>time_scale</em></code><strong>)</strong>]</pre>

<p>
<a id="pgfId-1054982"></a><span class="webflare-courier-new" style="white-space:pre"><em>time_scale</em></span> is a value used to scale the returned simulation time. The valid values are the integers 1, 10, and 100, followed by one of the scale factors in the following table.</p>

<p>
<a id="pgfId-1091570"></a></p>
<table class="webflareTable" id="#id1054983">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1054985">
<a id="pgfId-1054985"></a>Scale Factor</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1054987">
<a id="pgfId-1054987"></a>Meaning</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1054989"></a><code>s</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1054991"></a>Seconds</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1054993"></a><code>ms</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1054995"></a>Milliseconds</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1054997"></a><code>us</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1054999"></a>Microseconds</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1055001"></a><code>ns</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1055003"></a>Nanoseconds</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1055005"></a><code>ps</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1055007"></a>Picoseconds</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1055009"></a><code>fs</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1055011"></a>Femtoseconds</p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1032109"></a>If you do not specify <span class="webflare-courier-new" style="white-space:pre"><em>time_scale</em></span>, the return value is scaled to the<code> &#8216;time_unit</code> of the module that invokes the function.</p>
<p>
<a id="pgfId-1055094"></a>For example, to print out the current simulation time in seconds, you might code</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032110"></a>$strobe(&quot;Simulation time = %e&quot;, $realtime(1s)) ; </pre>
<h3>
<a id="pgfId-1032112"></a><a id="marker-1134314"></a>Obtaining the C<a id="temperature_digital"></a>urrent Ambient Temperature</h3>

<p>
<a id="pgfId-1034430"></a>Use the <code>$temperature</code> function to obtain the ambient temperature of a circuit in degrees Kelvin.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1034431"></a>temperature_function ::=
&#160;&#160;&#160;&#160;    <strong>$temperature</strong></pre>

<p>
<a id="pgfId-1170888"></a>The <code>$temperature</code> function is supported in both analog and digital contexts. In digital context, the <code>$temperature</code> function can be used only in <code>initial</code> and <code>always</code> blocks, continuous assignments, and system tasks and functions. It is not supported in port connections.</p>
<p>
<a id="pgfId-1170913"></a>In a digital mixed-signal design (DMS), the <code>$temperature</code> function returns the value 300.15 degree Kelvin units by default.</p>

<h3>
<a id="pgfId-1034427"></a><a id="marker-1134316"></a>Obtaining the Thermal Voltage</h3>

<p>
<a id="pgfId-1034454"></a>Use the <code>$vt</code> function to obtain the thermal voltage, <code>(kT/q)</code>, of a circuit.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1034462"></a>vt_function ::=
&#160;&#160;&#160;&#160;    <strong>$vt</strong>[<strong>(</strong><code><em>temp</em></code><strong>)</strong>]</pre>

<p>
<a id="pgfId-1034460"></a><span class="webflare-courier-new" style="white-space:pre"><em>temp</em></span> is the temperature, in degrees Kelvin, at which the thermal voltage is to be calculated. If you do not specify <span class="webflare-courier-new" style="white-space:pre"><em>temp</em></span>, the thermal voltage is calculated at the temperature returned by the <code>$temperature</code> function.</p>

<h3>
<a id="pgfId-1141201"></a>Querying the scale, gmin, and iteration Simulation Parameters</h3>

<p>
<a id="pgfId-1141202"></a>Use the <code>$simparam</code> function to query the value of the <code>scale</code>, <code>gmin</code>, or <code>iteration</code> simulation parameters. The returned value is always a real value.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1141205"></a>simparam_function ::=
&#160;&#160;&#160;&#160;    <strong>$simparam</strong> <strong>(&quot;</strong><code><em>param</em></code><strong>&quot;</strong><code><em> </em></code>[<strong>,</strong> <code><em>expression</em></code>]<strong>)</strong></pre>

<p>
<a id="pgfId-1141206"></a><span class="webflare-courier-new" style="white-space:pre"><em>param</em></span> is one of the following simulation parameters.</p>

<p>
<a id="pgfId-1141236"></a></p>
<table class="webflareTable" id="#id1141207">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1141209">
<a id="pgfId-1141209"></a>Simulation Parameter</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1141211">
<a id="pgfId-1141211"></a>Meaning</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1141213"></a><code>scale</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1141215"></a>Scale factor for device instance geometry parameters.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1141217"></a><code>gmin</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1141268"></a>Minimum conductance placed in parallel with nonlinear branches.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1141221"></a><code>iteration</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1141223"></a>Iteration number of the analog solver.</p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1141237"></a><span class="webflare-courier-new" style="white-space:pre"><em>expression</em></span> is an expression whose value is returned if <span class="webflare-courier-new" style="white-space:pre"><em>param</em></span> is not recognized.</p>
<p>
<a id="pgfId-1141238"></a>For example, to return the value of the simulation parameter named <code>gmin</code>, you might code</p>

<pre class="webflare-courier-new">
<a id="pgfId-1141239"></a>$strobe(&quot;gmin = %e&quot;, $simparam(&quot;gmin&quot;)) ; </pre>

<p>
<a id="pgfId-1147548"></a>To specify that a value of 2.0 is to be returned when the specified simulation parameter is not found, you might code</p>

<pre class="webflare-courier-new">
<a id="pgfId-1148163"></a>$strobe(&quot;gmin = %e&quot;, $simparam(&quot;gmin&quot;, 2.0)) ;</pre>
<h2>
<a id="pgfId-1148174"></a><a id="34735"></a>Obtaining and Se<a id="access_functions"></a>tting Signal Values<a id="marker-1167198"></a></h2>

<p>
<a id="pgfId-1148177"></a>Use the <a id="marker-1148175"></a>access <a id="marker-1148176"></a>functions to obtain or set the signal values.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032116"></a>access_function_reference ::=
&#160;&#160;&#160;&#160;    bvalue
&#160;&#160;&#160;&#160;|&#160;&#160; pvalue</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051447"></a>bvalue ::=
&#160;&#160;&#160;&#160;    <code><em>access_identifier</em></code> <strong>( </strong>analog_signal_list <strong>)</strong></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172480"></a>pvalue ::=
&#160;&#160;&#160;&#160; <code><em>access_identifier</em></code> <strong>(&lt;</strong>port_scalar_expression<strong>&gt;)</strong><vlog-bold />
</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1032117"></a>access_identifier ::=
&#160;&#160;&#160;&#160;nature_access_identifier
&#160;&#160;&#160;&#160;|potential
&#160;&#160;&#160;&#160;|flow</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172526"></a>analog_signal_list ::=
&#160;&#160;&#160;&#160;    <code><em>branch_identifier<br /></em></code> |   array_branch_identifier [ genvar_expression ]<br /> |   net_or_port_scalar_expression <br /> |&#160;&#160; net_or_port_scalar_expression <strong>,</strong> net_or_port_scalar_expression</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1034980"></a>net_or_port_scalar_expression ::=
&#160;&#160;&#160;&#160;    <code><em>net_or_port_identifier<br /></em></code> |&#160;&#160; <code><em>vector_net_or_port_identifier</em></code> [ genvar_expression ]</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1166586"></a>port_scalar_expression ::=
&#160;&#160;&#160;&#160;    <code><em>port_identifier<br /></em></code> |&#160;&#160; <code><em>array_port_identifier</em></code> [ <code><em>constant_expression</em></code> ]
&#160;&#160;&#160;&#160;|&#160;&#160; <code><em>vector_port_identifier</em></code> [ <code><em>constant_expression</em></code> ]</pre>

<p>
<a id="pgfId-1034984"></a>Access functions in Verilog-AMS take their names from the <a id="marker-1032118"></a>discipline associated with a node, port, or branch. Specifically, the access function names are defined by the access attributes specified for the discipline&#8217;s natures.</p>
<p>
<a id="pgfId-1032123"></a>For example, the <code>electrical</code> discipline, as defined in the standard definitions, uses the nature <code>Voltage</code> for potential. The nature <code>Voltage</code> is defined with the access attribute equal to <code>V</code>. Consequently, the access function for electrical potential is named <code>V</code>. For more information, see the files installed in <span class="webflare-courier-new" style="white-space:pre"><em>your_install_dir</em></span><code>/tools/spectre/etc/ahdl</code>.</p>
<p>
<a id="pgfId-1032128"></a>To <a id="marker-1032127"></a><a id="marker-1134488"></a>set a voltage, use the <code>V</code> access function on the left side of a contribution statement.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032129"></a>V(out) &lt;+ I(in) * Rparam ;</pre>

<p>
<a id="pgfId-1032131"></a>To <a id="marker-1032130"></a>obtain a voltage, you might use the<code> V</code> access function as illustrated in the following fragment. </p>

<pre class="webflare-courier-new">
<a id="pgfId-1032132"></a>I(c1, c2) &lt;+ V(c1, c2) / r ;</pre>

<p>
<a id="pgfId-1172569"></a>You can also use the <code>potential</code> or <code>flow</code> access function to access the potential or flow of a named or unnamed branch. If an unnamed branch comprises of two nets, ensure that the disciplines of both nets is the same before using the <code>potential</code> and <code>flow</code> functions, as shown below.</p>
<p>
<a id="pgfId-1166591"></a>electrical in, out;<br />potential( in, out ) &lt;+ flow( in, out ) * 1k;</p>
<p>
<a id="pgfId-1172561"></a>The simulator provides specialized support for obtaining (from analog contexts only) the voltages of nets or ports specified by out-of-module references. For example, you can use a block like the following: </p>

<pre class="webflare-courier-new">
<a id="pgfId-1166592"></a>analog begin<br />   tmp_a_b = V(top.level1.level2.node_a, top.level1.level2.node_b);<br />   tmp_a = V(top.level1.level2.node_a);<br />   tmp_c_b = V(top.level1.level2.node_c[1], top.level1.level2.node_b[1]);<br />   $display(&quot;tmp_a_b = %g, tmp_a = %g, tmp_c_b =%g\n&quot;, tmp_a_b, tmp_a, tmp_c_b);<br />end</pre>

<p>
<a id="pgfId-1167316"></a>If you want to set the voltage on a net or port that is an out-of-module reference, you must be sure to define the discipline of that net or port explicitly as <code>electrical</code>. For example: </p>

<pre class="webflare-courier-new">
<a id="pgfId-1167246"></a>// Contents of oomr.v <br />`include &quot;disciplines.vams&quot;<br />
module top;

&#160;&#160; <strong>electrical a;</strong>   // node <strong>a</strong> referenced in module sub <br />   electrical gnd;<br />
&#160;&#160; sub <a id="marker-1167668"></a>(* integer library_binding = &quot;work_lib&quot;; *) Isub (  );<br />
&#160;&#160; resistor #(.r(1.000)) (* integer library_binding = &quot;analogLib&quot;; *) R1 (a, gnd);<br />
&#160;&#160; analog begin<br />      V(gnd) &lt;+ 0.0;<br />      V(<strong>Isub.b</strong>) &lt;+ 18.0;   // out-of-module reference to node b, <br />                          // explicitly declared as electrical in module sub <br />   end<br />
endmodule</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1167569"></a>// Contents of sub.v<br />`include &quot;disciplines.vams&quot;<br />
module sub;
&#160;&#160; <strong>electrical b;</strong>   // node <strong>b</strong> referenced in module top <br />
&#160;&#160; electrical gnd;<br />
&#160;&#160; resistor #(.r(1.000)) (* integer library_binding = &quot;analogLib&quot;; *) R1 (b ,gnd );<br />
&#160;&#160; analog begin<br />      V(<strong>top.a</strong>) &lt;+ 17.0;   // out-of-module reference to top.a, <br />                          // explicitly declared as electrical in module top <br />      V(gnd)&lt;+ 0.0;<br />   end<br />
endmodule</pre>

<p>
<a id="pgfId-1166593"></a>The simulator provides limited support for obtaining (from analog contexts only) the currents of nets or ports specified by out-of-module references. For more information, see <a href="chap9.html#24387">&#8220;Obtaining Currents Using Out-of-Module References&#8221;</a>.</p>
<p>
<a id="pgfId-1036353"></a>You can apply access functions only to scalars or to individual elements of a vector. You select the scalar element of a vector using an index. For example, <code>V(in[1])</code> accesses the voltage <code>in[1]</code>. </p>
<p>
<a id="pgfId-1032134"></a>To see how you can use access functions, see the &#8220;Access Function Formats&#8221; table, below. In the table, <code>b1</code> refers to a branch, <code>n1</code> and <code>n2</code> refer to either nodes or ports, and <code>p1</code> refers to a port. The branches, nodes, and ports in this table belong to the <code>electrical</code> discipline, where <code>V</code> is the name of the access function for the voltage (potential) and <code>I</code> is the name of the access function for the current (flow). Access functions for other disciplines have different names, but you use them in the same ways. For example, <code>MMF</code> is the access function for potential in the <code>magnetic</code> discipline. </p>

<p>
<a id="pgfId-1091571"></a></p>
<table class="webflareTable" id="#id1032135">
<caption style="text-align:left;"><p>
<ft-figtabl-title id="#id1032140">
<a id="pgfId-1032140"></a><a id="34643"></a>Access <a id="marker-1167240"></a>Function <a id="marker-1167239"></a>Formats </ft-figtabl-title>
</p></caption>
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1032145">
<a id="pgfId-1032145"></a>Format</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1032147">
<a id="pgfId-1032147"></a>Effect</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032149"></a><code>V(b1)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032151"></a>Accesses the potential across branch <code>b1</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1172590"></a>potential(b1)</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1172592"></a>Alternative method to access the voltage across branch <code>b1</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032153"></a><code>V(n1)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032155"></a>Accesses the potential of <code>n1</code> relative to ground</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032157"></a><code>V(n1,n2)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032159"></a>Accesses the potential difference on the unnamed branch between <code>n1</code> and <code>n2</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032162"></a><code>I(b1)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032164"></a>Accesses the current on branch <code>b1</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1172606"></a>flow(b1)</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1172610"></a>Alternative method to access the current on branch <code>b1</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032166"></a><code>I(n1)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032168"></a>Accesses the current flowing from <code>n1</code> to ground</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032170"></a><code>I(n1, n2)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032172"></a>Accesses the current flowing on the unnamed branch between <code>n1</code> and <code>n2</code>; node <code>n1</code> and node <code>n2</code> cannot be the same node</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032174"></a><code>I(&lt;p1&gt;)</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032176"></a>Accesses the current flow into the module through port <code>p1</code>.</p>
</td>
</tr>
</tbody></table>
<p>
<a id="pgfId-1166601"></a>Notice the use of the port access operator (<code>&lt;&gt;</code>) in the last format. The port identifier in a port access function must be a scalar or resolve to a constant node of a bus port accessed by a constant expression. You cannot use the port access operator to access potential, nor can you use the port access operator on the left side of a contribution operator. You can use the port access operator only in modules that do not instantiate sub-hierarchies or primitives. </p>

<p>
<a id="pgfId-1034941"></a>You can use a port access to monitor the flow. In the following example, the simulator issues a warning if the total diode current becomes too large. </p>

<pre class="webflare-courier-new">
<a id="pgfId-1034942"></a>module diode (a, c) ;<br />electrical a, c ;<br />branch (a, c) diode, cap ;<br />parameter real is=1e-14, tf=0, cjo=0, imax=1, phi=0.7 ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051451"></a>analog begin
&#160;&#160;&#160;&#160;I(diode) &lt;+ is*(limexp(V(diode)/$vt) -1) ;
&#160;&#160;&#160;&#160;I(cap) &lt;+ ddt(tf*I(diode) - 2 * cjo * sqrt(phi * (phi * V(cap)))) ;
&#160;&#160;&#160;&#160;if (I(&lt;a&gt;) &gt; imax) // Checks current through port
&#160;&#160;&#160;&#160;    $strobe( &quot;Warning: diode is melting!&quot; ) ;
&#160;&#160;&#160;&#160;end <br />endmodule</pre>
<h3>
<a id="pgfId-1166625"></a>Obtaining Currents Using Out-of-Module References<a id="24387"></a><a id="marker-1167235"></a></h3>

<p>
<a id="pgfId-1166626"></a>Use the Cadence-provided system task <code>$cds_iprobe</code> to return the current of an out-of-module port. </p>

<pre class="webflare-courier-new">
<a id="pgfId-1166627"></a>OOM_current_reference ::=
&#160;&#160;&#160;&#160;    <strong>$cds_iprobe(&quot;</strong><code><em>hierarchical_name</em></code><strong>&quot;)</strong></pre>

<p>
<a id="pgfId-1166628"></a><span class="webflare-courier-new" style="white-space:pre"><em>hierarchical_name</em></span> is the hierarchical name of the out-of-module scalar port or individual bit of a vector port whose current you want to access.</p>
<p>
<a id="pgfId-1166629"></a>The <code>$cds_iprobe</code> task is subject to the following limitations:</p>
<ul><li>
<a id="pgfId-1166630"></a>The returned value is always the value at the last accepted simulation point. The value remains constant until the next simulation point is accepted. As a consequence, you cannot use the <code>$cds_iprobe</code> task to model a source for a current controlled device.</li><li>
<a id="pgfId-1166631"></a>The <code>$cds_iprobe</code> task can be used only in analog contexts.</li><li>
<a id="pgfId-1166632"></a>The <code>$cds_iprobe</code> task can be used only when the Spectre solver is active. This task cannot be used with the UltraSim solver, nor with the <code>xmelab -amsfastspice</code> option.</li><li>
<a id="pgfId-1166633"></a>You must have an active Tcl current probe set up to probe the current that the <code>$cds_iprobe</code> task returns.</li></ul>



<p>
<a id="pgfId-1166634"></a>For example, you set up a Tcl probe with the following command.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1166635"></a>xcelium&gt; probe -create -flow -shm -port top.I1</pre>

<p>
<a id="pgfId-1166636"></a>You create and simulate the following modules:</p>

<pre class="webflare-courier-new">
<a id="pgfId-1166637"></a>module top;<br />  electrical a, gnd;<br />  ground gnd;<br />  real x;<br />  vsource #(.type(&quot;sine&quot;), .ampl(11), .freq(1k)) V1(a,gnd);<br />  leaf l1(a,gnd);<br />  analog begin<br />//   The top.I1.a below is an out-of-module reference.<br />     $display(&quot;I&lt;top.l1.a&gt;=%g\n&quot;, $cds_iprobe(&quot;top.l1.a&quot;));<br />  end<br />endmodule</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1166638"></a>module leaf(a,b);<br />  electrical a, b;<br />  resistor #(.r(1.0)) r1(a,b);<br />Endmodule</pre>

<p>
<a id="pgfId-1166639"></a>The <code>$display</code> statement in the analog block displays the current of port <code>a</code> in the instance of the <code>leaf</code> module.</p>

<h2>
<a id="pgfId-1034172"></a>Accessing Attributes</h2>

<p>
<a id="pgfId-1036367"></a>Use the hierarchical referencing operator to access the attributes for a node or branch.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1036368"></a>attribute_reference ::=
&#160;&#160;&#160;&#160;    <code><em>node_identifier</em></code><strong>.</strong>pot_or_flow<strong>.</strong><code><em>attribute_identifier</em></code></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051453"></a>pot_or_flow ::=
&#160;&#160;&#160;&#160;    <strong>potential<br /></strong> |&#160;&#160; <strong>flow</strong></pre>

<p>
<a id="pgfId-1036372"></a><span class="webflare-courier-new" style="white-space:pre"><em>node_identifier</em></span> is the node or branch whose attribute you want to access.</p>
<p>
<a id="pgfId-1036395"></a><span class="webflare-courier-new" style="white-space:pre"><em>attribute_identifier</em></span> is the attribute you want to access.</p>
<p>
<a id="pgfId-1036394"></a>For example, the following fragment illustrates how to access the abstol values for a node and a branch.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1036373"></a>electrical a, b, n1, n2;
branch (n1, n2) cap ;
parameter real c= 1p;
analog begin 
&#160;&#160;&#160;&#160;I(a,b) &lt;+ c*ddt(V(a,b), a.potential.abstol) ;  // Access abstol for node
&#160;&#160;&#160;&#160;I(cap) &lt;+ c*ddt(V(cap), n1.potential.abstol) ; // Access abstol for branch<br />end</pre>
<h2>
<a id="pgfId-1166645"></a><a id="marker-1134324"></a>Examining Drivers<a id="13674"></a></h2>

<p>
<a id="pgfId-1166647"></a>A <em>driver</em><a id="marker-1166646"></a> of a signal is one of the following:</p>
<ul><li>
<a id="pgfId-1166648"></a>A process that assigns a value to the signal</li><li>
<a id="pgfId-1166649"></a>A connection of the signal to an output port of a module instance or simulation primitive</li></ul>

<p>
<a id="pgfId-1166651"></a>Each driver can have both a present value and a pending value. The present value is the present contribution of the driver to the signal. The pending value is the next scheduled contribution, if any, of the driver to the signal. <a id="marker-1166650"></a></p>
<p>
<a id="pgfId-1166653"></a>The drivers associated with a signal are numbered from zero to one less than the number of drivers. For example, if there are five associated drivers, then they have the numbers 0, 1, 2, 3, and 4.<a id="marker-1166652"></a></p>
<p>
<a id="pgfId-1166654"></a>The next sections describe the Verilog-AMS driver access functions you can use to create connect modules that are controlled by the digital drivers in ordinary modules. Note that </p>
<ul><li>
<a id="pgfId-1166655"></a>Driver access functions (including the <code>driver_update</code> event keyword) can be used only in the digital behavioral blocks of connect modules. They cannot be used in ordinary modules.</li><li>
<a id="pgfId-1166656"></a>Driver access functions (including the <code>driver_update</code> event keyword) are sensitive to drivers of only ordinary modules</li><li>
<a id="pgfId-1166657"></a>. These functions automatically ignore any drivers found inside connect modules.</li></ul>



<h3>
<a id="pgfId-1166658"></a>Counting the Number of Drivers<a id="driver_count"></a></h3>

<p>
<a id="pgfId-1166661"></a>Use the <code>$driver_count</code><a id="marker-1166659"></a> function to determine how many <a id="marker-1166660"></a>drivers are associated with a specified digital signal.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1166662"></a>driver_count_function ::=
&#160;&#160;&#160;&#160;    <strong>$driver_count</strong> <strong>(</strong> <code><em>signal</em></code> <strong>)</strong></pre>

<p>
<a id="pgfId-1166663"></a><span class="webflare-courier-new" style="white-space:pre"><em>signal</em></span> is the name of the digital signal.</p>
<p>
<a id="pgfId-1166664"></a>The <code>$driver_count</code> function returns an integer, which is the number of drivers associated with <span class="webflare-courier-new" style="white-space:pre"><em>signal</em></span>.</p>

<h3>
<a id="pgfId-1166674"></a>Determining the Value Contribution of a Driver</h3>

<p>
<a id="pgfId-1166678"></a>Use the <code>driver_state</code><a id="marker-1166675"></a><a id="marker-1166676"></a> function to determine the present <a id="marker-1166677"></a>value contribution of a specified driver to a specified signal.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1166679"></a>driver_state_function ::=
&#160;&#160;&#160;&#160;    <strong>$driver_state</strong> <strong>(</strong> <code><em>signal</em></code> <strong>,</strong> <code><em>driver_index</em></code> <strong>)</strong></pre>

<p>
<a id="pgfId-1166680"></a><span class="webflare-courier-new" style="white-space:pre"><em>signal</em></span> is the name of the digital signal.</p>
<p>
<a id="pgfId-1166681"></a><span class="webflare-courier-new" style="white-space:pre"><em>driver_index</em></span> is an integer number between 0 and N-1 where N is the total number of drivers contributing to the signal value.</p>
<p>
<a id="pgfId-1166682"></a>The <code>driver_state</code> function returns one of the following state values: 0, 1, <code>x</code>, or <code>z</code>.</p>

<h3>
<a id="pgfId-1166683"></a>Determining the Strength of a Driver</h3>

<p>
<a id="pgfId-1166687"></a>Use the <code>driver_strength</code><a id="marker-1166684"></a><a id="marker-1166685"></a><a id="marker-1166686"></a> function to determine the strength contribution of a specified driver to a specified signal.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1166688"></a>driver_strength_function ::=
&#160;&#160;&#160;&#160;    <strong>$driver_strength</strong> <strong>(</strong> <code><em>signal</em></code> <strong>,</strong> <code><em>driver_index</em></code> <strong>)</strong></pre>

<p>
<a id="pgfId-1166689"></a><span class="webflare-courier-new" style="white-space:pre"><em>signal</em></span> is the name of the digital signal.</p>
<p>
<a id="pgfId-1166690"></a><span class="webflare-courier-new" style="white-space:pre"><em>driver_index</em></span> is an integer number between 0 and N-1 where N is the total number of drivers contributing to the signal value.</p>
<p>
<a id="pgfId-1166691"></a>The <code>driver_strength</code> function returns two strengths: bits 5 through 3 for <code>strength0</code> and bits 2 through 0 for <code>strength1</code>.</p>
<p>
<a id="pgfId-1166692"></a>If the value returned is 0 or 1, <code>strength0</code> returns the high end of the strength range and <code>strength1</code> returns the low end of the strength range. Otherwise, the strengths of both <code>strength0</code> and <code>strength1</code> are defined as shown below.</p>

<p>
<a id="pgfId-1166926"></a></p>
<table class="webflareTable" id="#id1166693">
<tbody><tr>
<th class="webflareTh" colspan="9" rowspan="1">
<span class="tbl-head" id="#id1166695">
<a id="pgfId-1166695"></a>strength0</span>
</th>
<th class="webflareTh" colspan="9" rowspan="1">
<span class="tbl-head" id="#id1166713">
<a id="pgfId-1166713"></a>strength1</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="2">
<p>
<a id="pgfId-1166731"></a>Bits</p>
</td>
<td class="webflareTd" colspan="1" rowspan="2">
<p>
<a id="pgfId-1166733"></a>7</p>
<p>
<a id="pgfId-1166734"></a>Su0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="2">
<p>
<a id="pgfId-1166736"></a>6</p>
<p>
<a id="pgfId-1166737"></a>St0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="2">
<p>
<a id="pgfId-1166739"></a>5</p>
<p>
<a id="pgfId-1166740"></a>Pu0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="2">
<p>
<a id="pgfId-1166742"></a>4</p>
<p>
<a id="pgfId-1166743"></a>La0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="2">
<p>
<a id="pgfId-1166745"></a>3</p>
<p>
<a id="pgfId-1166746"></a>We0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="2">
<p>
<a id="pgfId-1166748"></a>2</p>
<p>
<a id="pgfId-1166749"></a>Me0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="2">
<p>
<a id="pgfId-1166751"></a>1</p>
<p>
<a id="pgfId-1166752"></a>Sm0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="2">
<p>
<a id="pgfId-1166754"></a>0</p>
<p>
<a id="pgfId-1166755"></a>HiZ0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="2">
<p>
<a id="pgfId-1166757"></a>0</p>
<p>
<a id="pgfId-1166758"></a>HiZ1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="2">
<p>
<a id="pgfId-1166760"></a>1</p>
<p>
<a id="pgfId-1166761"></a>Sm1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="2">
<p>
<a id="pgfId-1166763"></a>2</p>
<p>
<a id="pgfId-1166764"></a>Me1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="2">
<p>
<a id="pgfId-1166766"></a>3</p>
<p>
<a id="pgfId-1166767"></a>We1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="2">
<p>
<a id="pgfId-1166769"></a>4</p>
<p>
<a id="pgfId-1166770"></a>La1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="2">
<p>
<a id="pgfId-1166772"></a>5</p>
<p>
<a id="pgfId-1166773"></a>Pu1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="2">
<p>
<a id="pgfId-1166775"></a>6</p>
<p>
<a id="pgfId-1166776"></a>St1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="2">
<p>
<a id="pgfId-1166778"></a>7</p>
<p>
<a id="pgfId-1166779"></a>Su1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="2">
<p>
<a id="pgfId-1166781"></a>Bits</p>
</td>
</tr>
<tr />
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166819"></a>B5</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166821"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166823"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166825"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166827"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166829"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166831"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166833"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166835"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166837"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166839"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166841"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166843"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166845"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166847"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166849"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166851"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166853"></a>B2</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166855"></a>B4</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166857"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166859"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166861"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166863"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166865"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166867"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166869"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166871"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166873"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166875"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166877"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166879"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166881"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166883"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166885"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166887"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166889"></a>B1</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166891"></a>B3</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166893"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166895"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166897"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166899"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166901"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166903"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166905"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166907"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166909"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166911"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166913"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166915"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166917"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166919"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166921"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166923"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1166925"></a>B0</p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1166927"></a>For more information, see the &#8220;Logic Strength Modeling&#8221; section, of the &#8220;Gate and Switch Level Modeling&#8221; chapter, in the <em>Verilog-XL Reference</em>.</p>

<h3>
<a id="pgfId-1166928"></a>Detecting Updates to Drivers</h3>

<p>
<a id="pgfId-1166929"></a>Use the <code>driver_update</code> event keyword to determine when a driver of a signal is updated by the addition of a new pending value.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1166930"></a>driver_update_event_keyword ::=
&#160;&#160;&#160;&#160;    <strong>driver_update</strong> <strong>(</strong> <code><em>signal</em></code> <strong>)</strong></pre>

<p>
<a id="pgfId-1166931"></a><span class="webflare-courier-new" style="white-space:pre"><em>signal</em></span> is the name of the digital signal.</p>
<p>
<a id="pgfId-1166932"></a>The <code>driver_update</code> event occurs any time a new pending value is added to the driver, even when there is no change in the resolved value of the signal.</p>
<p>
<a id="pgfId-1166933"></a>Use the <code>driver_update</code> event keyword in conjunction with the event detection operator to detect updates. For example, the <code>statement</code> in the following code executes any time a driver of the <code>clock</code> signal is updated.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1166934"></a>always @ (driver_update clock)
&#160;&#160;&#160;&#160;statement ;</pre>
<h2>
<a id="pgfId-1083389"></a>Analysis-Dependent Functions</h2>

<p>
<a id="pgfId-1032178"></a>The analysis-dependent functions change their behavior according to the type of analysis being performed.</p>

<h3>
<a id="pgfId-1032180"></a><a id="marker-1134326"></a><a id="24940"></a>Determining the Current Analysis Type</h3>

<p>
<a id="pgfId-1032183"></a>Use the <code>analysis</code><a id="marker-1032181"></a><a id="marker-1032182"></a> function to determine whether the current analysis type matches a specified type. By using this function, you can design modules that change their behavior during different kinds of analyses.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032184"></a><strong>analysis</strong> <strong>(</strong> analysis_list <strong>)</strong></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051455"></a>analysis_list ::=
&#160;&#160;&#160;&#160;    analysis_name { <strong>,</strong> analysis_name }</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051457"></a>analysis_name ::=
&#160;&#160;&#160;&#160;    <strong>&quot;</strong><code><em>analysis_type</em></code><strong>&quot;</strong></pre>

<p>
<a id="pgfId-1054761"></a><span class="webflare-courier-new" style="white-space:pre"><em>analysis_type</em></span> is one of the following analysis types.</p>

<p>
<a id="pgfId-1091574"></a></p>
<table class="webflareTable" id="#id1032186">
<caption style="text-align:left;"><p>
<ft-figtabl-title id="#id1032191">
<a id="pgfId-1032191"></a><a id="16072"></a>Analysis Types and Descriptions </ft-figtabl-title>
</p></caption>
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1032197">
<a id="pgfId-1032197"></a><a id="marker-1032196"></a>Analysis Type</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1032200">
<a id="pgfId-1032200"></a><a id="marker-1032199"></a>Analysis Description</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1110573"></a><code>dc</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1110575"></a>OP or DC analysis</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1110637"></a><code>static</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1110639"></a>Any equilibrium point calculation, including a DC analysis as well as those that precede another analysis, such as the DC analysis that precedes an AC or noise analysis, or the initial-condition analysis that precedes a transient analysis</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1110657"></a><code>tran</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1110659"></a>Transient analysis</p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1032253"></a>The following table describes the values returned by the <code>analysis</code> function for some of the commonly used analyses. A return value of 1 represents <code>TRUE</code> and a value of 0 represents <code>FALSE</code>.</p>

<p>
<a id="pgfId-1091576"></a></p>
<table class="webflareTable" id="#id1036875">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1036877">
<a id="pgfId-1036877"></a></span>
</th>
<th class="webflareTh" colspan="7" rowspan="1">
<span class="tbl-head" id="#id1036879">
<a id="pgfId-1036879"></a>Simulator Analysis Type</span>
</th>
</tr>
<tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1036893">
<a id="pgfId-1036893"></a>Argument</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1036895">
<a id="pgfId-1036895"></a>DC</span>
</th>
<th class="webflareTh" colspan="2" rowspan="1">
<span class="tbl-head" id="#id1036897">
<a id="pgfId-1036897"></a>TRAN
OP        TRAN</span>
</th>
<th class="webflareTh" colspan="2" rowspan="1">
<span class="tbl-head" id="#id1036901">
<a id="pgfId-1036901"></a>AC
OP            AC</span>
</th>
<th class="webflareTh" colspan="2" rowspan="1">
<span class="tbl-head" id="#id1036905">
<a id="pgfId-1036905"></a>NOISE
OP            AC</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036925"></a><code>static</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036927"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036929"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036931"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036933"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036935"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036937"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036939"></a>0</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036941"></a><code>ic</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036943"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036945"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036947"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036949"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036951"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036953"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036955"></a>0</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036957"></a><code>dc</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036959"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036961"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036963"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036965"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036967"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036969"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036971"></a>0</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036973"></a><code>tran</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036975"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036977"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036979"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036981"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036983"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036985"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036987"></a>0</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036989"></a><code>ac</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036991"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036993"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036995"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036997"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1036999"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1037001"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1037003"></a>0</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1037005"></a><code>noise</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1037007"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1037009"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1037011"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1037013"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1037015"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1037017"></a>1</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1037019"></a>1</p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1032254"></a>You can use the <code>analysis</code> function to make module behavior dependent on the current analysis type.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032255"></a>if (analysis(&quot;dc&quot;, &quot;ic&quot;))
&#160;&#160;&#160;&#160;out = ! V(in) &gt; 0.0 ;
else
&#160;&#160;&#160;&#160;@(cross (V(in),0)) out = ! out<br />V(out) &lt;+ transition (out, 5n, 1n, 1n) ;</pre>
<h3>
<a id="pgfId-1034497"></a><a id="marker-1134328"></a><a id="31835"></a>Implementing Small-Signal AC Sources</h3>

<p>
<a id="pgfId-1034501"></a>Use the <code>ac_stim</code><a id="marker-1034498"></a> function to implement a sinusoidal stimulus for small-signal analysis.<a id="marker-1034499"></a><a id="marker-1034500"></a></p>

<pre class="webflare-courier-new">
<a id="pgfId-1034502"></a><strong>ac_stim</strong> <strong>(</strong> [ <strong>&quot;</strong><code><em>analysis_type</em></code><strong>&quot;</strong> [ <strong>,</strong> <code><em>mag</em></code> [ <strong>,</strong> <code><em>phase</em></code>]]] <strong>)</strong></pre>

<p>
<a id="pgfId-1032263"></a><span class="webflare-courier-new" style="white-space:pre"><em>analysis_type</em></span>, if you specify it, must be one of the analysis types listed in the <a href="chap9.html#16072">Analysis Types and Descriptions</a> table. The default for <span class="webflare-courier-new" style="white-space:pre"><em>analysis_type</em></span> is <code>ac</code>. The <span class="webflare-courier-new" style="white-space:pre"><em>mag</em></span> argument is the magnitude, with a default of 1. <span class="webflare-courier-new" style="white-space:pre"><em>phase</em></span> is the phase in radians, with a default of 0.</p>
<p>
<a id="pgfId-1043213"></a>The <code>ac_stim</code> function models a source with magnitude <span class="webflare-courier-new" style="white-space:pre"><em>mag</em></span> and phase <span class="webflare-courier-new" style="white-space:pre"><em>phase</em></span> only during the <span class="webflare-courier-new" style="white-space:pre"><em>analysis_type</em></span> analysis. During all other small-signal analyses, and during large-signal analyses, the <code>ac_stim</code> function returns 0.</p>

<h3>
<a id="pgfId-1043219"></a><a id="marker-1134330"></a><a id="33540"></a>Implementing Small-Signal Noise Sources</h3>

<p>
<a id="pgfId-1032270"></a>Verilog-AMS provides three functions to support noise modeling during small-signal analyses:</p>
<ul><li>
<a id="pgfId-1032271"></a><code>white_noise</code> function</li><li>
<a id="pgfId-1043225"></a><code>flicker_noise</code> function</li><li>
<a id="pgfId-1173206"></a><code>noise_table</code> function</li></ul>



<h4>
<a id="pgfId-1173208"></a>White_noise Function</h4>

<p>
<a id="pgfId-1032277"></a>Use the<a id="marker-1032275"></a> <code>white_noise</code><a id="marker-1032276"></a> function to generate white noise, noise whose current value is completely uncorrelated with any previous or future values. </p>

<pre class="webflare-courier-new">
<a id="pgfId-1032278"></a><strong>white_noise(</strong> <code><em>PSD</em></code> [ <strong>,</strong> <strong>&quot;</strong><code><em>name</em></code><strong>&quot;</strong>]<strong>)</strong></pre>

<p>
<a id="pgfId-1032279"></a><span class="webflare-courier-new" style="white-space:pre"><em>PSD</em></span> is the power spectral density of the source where <span class="webflare-courier-new" style="white-space:pre"><em>PSD</em></span> is specified in units of <code>A2/Hz</code> or <code>V</code>2/Hz.</p>
<p>
<a id="pgfId-1032280"></a><span class="webflare-courier-new" style="white-space:pre"><em>name</em></span> is a label for the noise source. The simulator uses <span class="webflare-courier-new" style="white-space:pre"><em>name</em></span> to identify the contributions of noise sources to the total output noise. The simulator combines into a single source all noise sources with the same name from the same module instance.</p>
<p>
<a id="pgfId-1032281"></a>The <code>white_noise</code> function is active only during small-signal noise analyses and returns 0 otherwise.</p>
<p>
<a id="pgfId-1032282"></a>For example, you might include the following fragment in a module describing the behavior of a diode.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032283"></a>I(diode) &lt;+ white_noise(2 * &#8216;P_Q * Id, &quot;shot&quot; ) ;</pre>

<p>
<a id="pgfId-1124548"></a>For a resistor, you might use a fragment like the following.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1124549"></a>V(res) &lt;+ white_noise(4 * &#8216;P_K * $temperature * rs, &quot;thermal&quot;);</pre>
<h4>
<a id="pgfId-1032284"></a><a id="marker-1134334"></a>flicker_noise Function</h4>

<p>
<a id="pgfId-1169345"></a>Use the <code>flicker_noise</code><a id="marker-1091579"></a><a id="marker-1091580"></a> function to generate pink noise that varies in proportion to:<a id="marker-1091581"></a></p>

<p>
<a id="pgfId-1169965"></a><img width="99" height="45" src="images/chap9-6.gif" /></p>

<p>
<a id="pgfId-1091604"></a>The syntax for the <code>flicker_noise</code> function is</p>

<pre class="webflare-courier-new">
<a id="pgfId-1091587"></a><strong>flicker_noise(</strong> <code><em>power</em></code><strong>, </strong><code><em>exp</em></code> [ <strong>,</strong> <strong>&quot;</strong><code><em>name</em></code><strong>&quot;</strong>]<strong>)</strong></pre>

<p>
<a id="pgfId-1032293"></a><span class="webflare-courier-new" style="white-space:pre"><em>power</em></span> is the power of the source at 1 Hz. </p>
<p>
<a id="pgfId-1032294"></a><span class="webflare-courier-new" style="white-space:pre"><em>name</em></span> is a label for the noise source. The simulator uses <span class="webflare-courier-new" style="white-space:pre"><em>name</em></span> to identify the contributions of noise sources to the total output noise. The simulator combines into a single source all noise sources with the same name from the same module instance.</p>
<p>
<a id="pgfId-1032295"></a>The <code>flicker_noise</code> function is active only during small-signal noise analyses and returns 0 otherwise.</p>
<p>
<a id="pgfId-1032296"></a>For example, you might include the following fragment in a module describing the behavior of a diode:</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032297"></a>I(diode) &lt;+ flicker_noise( kf * pow(abs(I(diode)),af),ef) ;</pre>
<h4>
<a id="pgfId-1172401"></a><a id="marker-1172398"></a><a id="76480"></a>noise_table Fu<a id="noise_table"></a>nction</h4>

<p>
<a id="pgfId-1172405"></a>Use the <code>noise_table</code><a id="marker-1172402"></a> function to generate noise where the spectral density of the noise varies as a piecewise linear function of frequency.<a id="marker-1172403"></a><a id="marker-1172404"></a></p>

<pre class="webflare-courier-new">
<a id="pgfId-1172406"></a><strong>noise_table(</strong><code><em>vector </em></code><code>|</code><code><em> string </em></code>[ <strong>,</strong> <strong>&quot;</strong><code><em>name</em></code><strong>&quot;</strong> ]<strong>)</strong></pre>

<p>
<a id="pgfId-1172407"></a>The first argument to the <code>noise_table</code> function is a vector or a string.</p>
<p>
<a id="pgfId-1172408"></a><span class="webflare-courier-new" style="white-space:pre"><em>vector</em></span> is an array containing pairs of real numbers. The first number in each pair represents the frequency in hertz and the second number is the power at that frequency. </p>
<p>
<a id="pgfId-1172409"></a><span class="webflare-courier-new" style="white-space:pre"><em>string</em></span> is an input file containing frequency and power values specified in pairs. Each pair is specified in a new line and is separated by space(s) or tab(s). You can comment a line by inserting a comment (#) at the beginning of the line. Comments end with a new line. The input file can only be a text file and the values must be real numbers or integers. In addition, each frequency value must be unique.</p>
<p>
<a id="pgfId-1172410"></a>It is recommended that you specify each noise pair in the order of ascending frequency. However, if required, the simulator internally sorts the pairs in the order of ascending frequency. </p>
<p>
<a id="pgfId-1172411"></a>The <code>noise_table</code> function uses the linear interpolation method to calculate the spectral density for each frequency. The power associated with the lowest frequency specified in the table is taken as the associated power for all frequencies below the smallest frequency. Similarly, the power associated with the highest frequency specified in the table is taken as the associated power for all frequencies above the highest frequency.</p>
<p>
<a id="pgfId-1172412"></a>The following is an example of the input file:</p>

<pre class="webflare-courier-new">
<a id="pgfId-1172413"></a># noise_table_input.tbl</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172414"></a># Example of input file format for noise_table</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172415"></a>#</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172416"></a># freq&#160;&#160;      pwr</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172417"></a>1.0e0&#160;&#160;     1.348720e-23</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172418"></a>1.0e1&#160;&#160;     5.482480e-23</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172419"></a>1.0e2&#160;&#160;     7.135790e-23</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172420"></a>1.0e3&#160;&#160;     1.811153e-22</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172421"></a>1.0e4&#160;&#160;     3.726892e-22</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172422"></a>1.0e5&#160;&#160;     7.412361e-22</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172423"></a>1.0e6&#160;&#160;     2.172611e-21</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172424"></a># End</pre>

<p>
<a id="pgfId-1172425"></a><span class="webflare-courier-new" style="white-space:pre"><em>name</em></span> is a label for the noise source. The simulator uses <span class="webflare-courier-new" style="white-space:pre"><em>name</em></span> to identify the contributions of noise sources to the total output noise. The simulator combines into a single source all noise sources with the same name from the same module instance.</p>
<p>
<a id="pgfId-1172426"></a>The <code>noise_table</code> function is active only during small-signal noise analyses and returns 0 otherwise.</p>
<p>
<a id="pgfId-1172427"></a>For example, you might include the following fragment in an analog block:</p>

<pre class="webflare-courier-new">
<a id="pgfId-1172428"></a>V(p,n) &lt;+ noise_table({1,2,100,4,1000,5,1000000,6}, &quot;noitab&quot;);</pre>

<p>
<a id="pgfId-1126670"></a>In this example, the power at every frequency lower than 1 is assumed to be 2; the power at every frequency above 1000000 is assumed to be 6.</p>

<h2>
<a id="pgfId-1032309"></a><a id="marker-1134338"></a><a id="25632"></a>Generating <a id="marker-1032308"></a>Random Numbers</h2>

<p>
<a id="pgfId-1032313"></a>Use the <a id="marker-1032310"></a><a id="marker-1032311"></a><code>$random</code><a id="marker-1032312"></a> function to generate a signed integer, 32-bit, pseudorandom number.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032314"></a><strong>$random</strong> [ <strong>(</strong> <code><em>seed</em></code> <strong>)</strong> ] <strong>;</strong></pre>

<p>
<a id="pgfId-1032315"></a><span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> is a reg, integer, or time variable used to initialize the function. The seed provides a starting point for the number sequence and allows you to restart at the same point. If, as Cadence recommends, you use <span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span>, you must assign a value to the variable before calling the <code>$random</code> function.</p>
<p>
<a id="pgfId-1032316"></a>The <code>$random</code> function generates a new number every time step.</p>
<p>
<a id="pgfId-1032317"></a>Individual <code>$random</code> statements with different seeds generate different sequences, and individual <code>$random</code> statements with the same seed generate identical sequences.</p>
<p>
<a id="pgfId-1032318"></a>The following code fragment uses the absolute value function and the modulus operator to generate integers between 0 and 99. </p>

<pre class="webflare-courier-new">
<a id="pgfId-1032319"></a>// There is a 5% chance of signal loss.<br />module randloss (pinout) ;<br />electrical pinout ;<br />integer randseed, randnum;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1071873"></a>analog begin
&#160;&#160;&#160;&#160;@ (initial_step) begin
&#160;&#160;&#160;&#160;    randseed = 123 ;    // Initialize the seed just once
&#160;&#160;&#160;&#160;end
&#160;&#160;&#160;&#160;randnum = abs($random(randseed) % 100) ;
&#160;&#160;&#160;&#160;if (randnum &lt; 5) 
&#160;&#160;&#160;&#160; V(pinout) &lt;+ 0.0 ;<br /> else<br />  V(pinout) &lt;+ 3.0 ;<br />end // of analog block</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1071877"></a>endmodule</pre>
<h2>
<a id="pgfId-1032321"></a><a id="marker-1134340"></a><a id="12212"></a>Generating Random Numbers in Specified Distributions</h2>

<p>
<a id="pgfId-1032322"></a>Verilog-AMS provides functions that generate random numbers in the following distribution patterns:</p>
<ul><li>
<a id="pgfId-1032323"></a>Uniform </li><li>
<a id="pgfId-1032324"></a>Normal (Gaussian)</li><li>
<a id="pgfId-1032325"></a>Exponential</li><li>
<a id="pgfId-1032326"></a>Poisson</li><li>
<a id="pgfId-1032327"></a>Chi-square</li><li>
<a id="pgfId-1032328"></a>Student&#8217;s T</li><li>
<a id="pgfId-1032329"></a>Erlang</li></ul>






<p>
<a id="pgfId-1093425"></a>In releases prior to IC5.0, the functions beginning with <code>$dist</code> return real numbers rather than integer numbers. If you need to continue getting real numbers in more recent releases, change each <code>$dist</code> function to the corresponding <code>$rdist</code> function.</p>

<h3>
<a id="pgfId-1032335"></a><a id="marker-1134342"></a><a id="marker-1032330"></a><a id="marker-1032331"></a><a id="marker-1032332"></a><a id="marker-1032333"></a><a id="marker-1032334"></a>Uniform Distribution</h3>

<p>
<a id="pgfId-1032336"></a>Use the <code>$rdist_uniform</code> function to generate random real numbers (or the <code>$dist_uniform</code> function to generate integer numbers) that are evenly distributed throughout a specified range. The <code>$rdist_uniform</code> function is not supported in digital contexts.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032337"></a><strong>$rdist_uniform</strong> <strong>(</strong> <code><em>seed</em></code> <strong>,</strong> <code><em>start</em></code> <strong>,</strong> <code><em>end</em></code> <strong>)</strong> <strong>;<br />$dist_uniform</strong> <strong>(</strong> <code><em>seed</em></code> <strong>,</strong> <code><em>start</em></code> <strong>,</strong> <code><em>end</em></code> <strong>)</strong> <strong>;</strong></pre>

<p>
<a id="pgfId-1032338"></a><span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> is a scalar integer variable used to initialize the sequence of generated numbers. <span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> must be a variable because the function updates the value of <span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> at each iteration. To ensure generation of a uniform distribution, change the value of <span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> only when you initialize the sequence. </p>
<p>
<a id="pgfId-1032339"></a><span class="webflare-courier-new" style="white-space:pre"><em>start</em></span> is an integer or real expression that specifies the smallest number that the <code>$dist_uniform</code> function is allowed to return. <span class="webflare-courier-new" style="white-space:pre"><em>start</em></span> must be smaller than <span class="webflare-courier-new" style="white-space:pre"><em>end</em></span>.</p>
<p>
<a id="pgfId-1032340"></a><span class="webflare-courier-new" style="white-space:pre"><em>end</em></span> is an integer or real expression that specifies the largest number that the <code>$dist_uniform</code> function is allowed to return. <span class="webflare-courier-new" style="white-space:pre"><em>end</em></span> must be larger than <span class="webflare-courier-new" style="white-space:pre"><em>start</em></span>.</p>
<p>
<a id="pgfId-1032341"></a>The following module returns a series of real numbers, each of which is between 20 and 60 inclusively. </p>

<pre class="webflare-courier-new">
<a id="pgfId-1035131"></a>module distcheck (pinout) ;<br />electrical pinout ;<br />parameter integer start_range = 20 ;        // A parameter<br />integer seed, end_range;<br />real rrandnum ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051459"></a>analog begin
&#160;&#160;&#160;&#160;@ (initial_step) begin
&#160;&#160;&#160;&#160;    seed = 23 ;                        // Initialize the seed just once
&#160;&#160;&#160;&#160;    end_range = 60 ;                   // A variable
&#160;&#160;&#160;&#160;end
&#160;&#160;&#160;&#160;rrandnum = $rdist_uniform(seed, start_range, end_range);
&#160;&#160;&#160;&#160;$display (&quot;Random number is %g&quot;, rrandnum ) ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051461"></a>// The next line shows how the seed changes at each<br />// iterative use of the distribution function.</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051463"></a> $display (&quot;Current seed is %d&quot;, seed) ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051465"></a> V(pinout) &lt;+ rrandnum ;<br />end // of analog block</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051467"></a>endmodule</pre>
<h3>
<a id="pgfId-1032348"></a><a id="marker-1134344"></a><a id="marker-1032343"></a><a id="marker-1032344"></a><a id="marker-1032345"></a><a id="marker-1032346"></a><a id="marker-1032347"></a>Normal (Gaussian) Distribution</h3>

<p>
<a id="pgfId-1032349"></a>Use the <code>$rdist_normal</code> function to generate random real numbers (or the <code>$dist_normal</code> function to generate integer numbers) that are normally distributed. The <code>$rdist_normal</code> function is not supported in digital contexts.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032350"></a><strong>$rdist_normal</strong> <strong>(</strong> <code><em>seed</em></code> <strong>,</strong> <code><em>mean</em></code> <strong>,</strong> <code><em>standard_deviation</em></code> <strong>)</strong> <strong>;<br />$dist_normal</strong> <strong>(</strong> <code><em>seed</em></code> <strong>,</strong> <code><em>mean</em></code> <strong>,</strong> <code><em>standard_deviation</em></code> <strong>)</strong> <strong>;</strong></pre>

<p>
<a id="pgfId-1032351"></a><span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> is a scalar integer variable used to initialize the sequence of generated numbers. <span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> must be a variable because the function updates the value of <span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> at each iteration. To ensure generation of a normal distribution, change the value of <span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> only when you initialize the sequence. </p>
<p>
<a id="pgfId-1032352"></a><span class="webflare-courier-new" style="white-space:pre"><em>mean</em></span> is an integer or real expression that specifies the value to be approached by the mean value of the generated numbers. </p>
<p>
<a id="pgfId-1032353"></a><span class="webflare-courier-new" style="white-space:pre"><em>standard_deviation</em></span> is an integer or real expression that determines the width of spread of the generated values around <span class="webflare-courier-new" style="white-space:pre"><em>mean</em></span>. Using a larger <span class="webflare-courier-new" style="white-space:pre"><em>standard_deviation</em></span> spreads the generated values over a wider range. </p>
<p>
<a id="pgfId-1032356"></a>To generate a <a id="marker-1032354"></a><a id="marker-1032355"></a>gaussian distribution, use a <span class="webflare-courier-new" style="white-space:pre"><em>mean</em></span> of 0 and a <span class="webflare-courier-new" style="white-space:pre"><em>standard_deviation</em></span> of 1. For example, the following module returns a series of real numbers that together form a gaussian distribution.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032357"></a>module distcheck (pinout) ;<br />electrical pinout ;<br />integer seed ;<br />real rrandnum ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051469"></a>analog begin
&#160;&#160;&#160;&#160;@ (initial_step) begin
&#160;&#160;&#160;&#160;    seed = 23 ;
&#160;&#160;&#160;&#160;end 
&#160;&#160;&#160;&#160;rrandnum = $rdist_normal( seed, 0, 1 ) ;
&#160;&#160;&#160;&#160;$display (&quot;Random number is %g&quot;, rrandnum ) ;
&#160;&#160;&#160;&#160;V(pinout) &lt;+ rrandnum ;<br />end // of analog block</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051471"></a>endmodule</pre>
<h3>
<a id="pgfId-1032363"></a><a id="marker-1032358"></a><a id="marker-1032359"></a><a id="marker-1032360"></a><a id="marker-1032361"></a><a id="marker-1032362"></a>Exponential Distribution</h3>

<p>
<a id="pgfId-1032364"></a>Use the <code>$rdist_exponential</code> function to generate random real numbers (or the <code>$dist_exponential</code> function to generate integer numbers) that are exponentially distributed. The <code>$rdist_exponential</code> function is not supported in digital contexts.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032365"></a><strong>$rdist_exponential</strong> <strong>(</strong> <code><em>seed</em></code> <strong>,</strong> <code><em>mean</em></code> <strong>)</strong> <strong>;<br />$dist_exponential</strong> <strong>(</strong> <code><em>seed</em></code> <strong>,</strong> <code><em>mean</em></code> <strong>)</strong> <strong>;</strong></pre>

<p>
<a id="pgfId-1032366"></a><span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> is a scalar integer variable used to initialize the sequence of generated numbers. <span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> must be a variable because the function updates the value of <span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> at each iteration. To ensure generation of an exponential distribution, change the value of <span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> only when you initialize the sequence. </p>
<p>
<a id="pgfId-1032367"></a><span class="webflare-courier-new" style="white-space:pre"><em>mean</em></span> is an integer or real value greater than zero. <span class="webflare-courier-new" style="white-space:pre"><em>mean</em></span> specifies the value to be approached by the mean value of the generated numbers. </p>
<p>
<a id="pgfId-1032368"></a>For example, the following module returns a series of real numbers that together form an exponential distribution.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032369"></a>module distcheck (pinout) ;<br />electrical pinout ;<br />integer seed, mean ;<br />real rrandnum ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051473"></a>analog begin
&#160;&#160;&#160;&#160;@ (initial_step) begin
&#160;&#160;&#160;&#160;    seed = 23 ;
&#160;&#160;&#160;&#160;    mean = 5 ;              // Mean must be &gt; 0
&#160;&#160;&#160;&#160;end 
&#160;&#160;&#160;&#160;rrandnum = $rdist_exponential(seed, mean) ;
&#160;&#160;&#160;&#160;$display (&quot;Random number is %g&quot;, rrandnum ) ;
&#160;&#160;&#160;&#160;V(pinout) &lt;+ rrandnum ;<br />end // of analog block</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051475"></a>endmodule</pre>
<h3>
<a id="pgfId-1032375"></a><a id="marker-1134348"></a><a id="marker-1032370"></a><a id="marker-1032371"></a><a id="marker-1032372"></a><a id="marker-1032373"></a><a id="marker-1032374"></a>Poisson Distribution</h3>

<p>
<a id="pgfId-1032376"></a>Use the <code>$rdist_poisson</code> function to generate random real numbers (or the <code>$dist_poisson</code> function to generate integer numbers) that form a Poisson distribution. The <code>$rdist_poisson</code> function is not supported in digital contexts.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032377"></a><strong>$rdist_poisson</strong> <strong>(</strong> <code><em>seed</em></code> <strong>,</strong> <code><em>mean</em></code> <strong>)</strong> <strong>;<br />$dist_poisson</strong> <strong>(</strong> <code><em>seed</em></code> <strong>,</strong> <code><em>mean</em></code> <strong>)</strong> <strong>;</strong></pre>

<p>
<a id="pgfId-1032378"></a><span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> is a scalar integer variable used to initialize the sequence of generated numbers. <span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> must be a variable because the function updates the value of <span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> at each iteration. To ensure generation of a Poisson distribution, change the value of <span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> only when you initialize the sequence. </p>
<p>
<a id="pgfId-1032379"></a><span class="webflare-courier-new" style="white-space:pre"><em>mean</em></span> is an integer or real value greater than zero. <span class="webflare-courier-new" style="white-space:pre"><em>mean</em></span> specifies the value to be approached by the mean value of the generated numbers. </p>
<p>
<a id="pgfId-1032380"></a>For example, the following module returns a series of real numbers that together form a Poisson distribution.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032381"></a>module distcheck (pinout) ;<br />electrical pinout ;<br />integer seed, mean ;<br />real rrandnum ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051477"></a>analog begin
&#160;&#160;&#160;&#160;@ (initial_step) begin
&#160;&#160;&#160;&#160;    seed = 23 ;
&#160;&#160;&#160;&#160;    mean = 5 ;                    // Mean must be &gt; 0
&#160;&#160;&#160;&#160;end 
&#160;&#160;&#160;&#160;rrandnum = $rdist_poisson(seed, mean) ;
&#160;&#160;&#160;&#160;$display (&quot;Random number is %g&quot;, rrandnum ) ;
&#160;&#160;&#160;&#160;V(pinout) &lt;+ rrandnum ;<br />end // of analog block</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051479"></a>endmodule</pre>
<h3>
<a id="pgfId-1032387"></a><a id="marker-1032382"></a><a id="marker-1032383"></a><a id="marker-1032384"></a><a id="marker-1032385"></a><a id="marker-1032386"></a>Chi-Square Distribution</h3>

<p>
<a id="pgfId-1032388"></a>Use the <code>$rdist_chi_square</code> function to generate random real numbers (or the <code>$dist_chi_square</code> function to generate integer numbers) that form a chi-square distribution. The <code>$rdist_chi_square</code> function is not supported in digital contexts.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032389"></a><strong>$rdist_chi_square</strong> <strong>(</strong> <code><em>seed</em></code> <strong>,</strong> <code><em>degree_of_freedom</em></code> <strong>)</strong> <strong>;<br />$dist_chi_square</strong> <strong>(</strong> <code><em>seed</em></code> <strong>,</strong> <code><em>degree_of_freedom</em></code> <strong>)</strong> <strong>;</strong></pre>

<p>
<a id="pgfId-1032390"></a><span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> is a scalar integer variable used to initialize the sequence of generated numbers. <span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> must be a variable because the function updates the value of <span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> at each iteration. To ensure generation of a chi-square distribution, change the value of <span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> only when you initialize the sequence. </p>
<p>
<a id="pgfId-1032391"></a><span class="webflare-courier-new" style="white-space:pre"><em>degree_of_freedom</em></span> is an integer value greater than zero. <span class="webflare-courier-new" style="white-space:pre"><em>degree_of_freedom</em></span> determines the width of spread of the generated values. Using a larger <span class="webflare-courier-new" style="white-space:pre"><em>degree_of_freedom</em></span> spreads the generated values over a wider range.</p>
<p>
<a id="pgfId-1032392"></a>For example, the following module returns a series of real numbers that together form a chi-square distribution.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032393"></a>module distcheck (pinout) ;<br />electrical pinout ;<br />integer seed, dof ;<br />real rrandnum ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051481"></a>analog begin
&#160;&#160;&#160;&#160;@ (initial_step) begin
&#160;&#160;&#160;&#160;    seed = 23 ;
&#160;&#160;&#160;&#160;    dof = 5 ;           // Degree of freedom must be &gt; 0
&#160;&#160;&#160;&#160;end 
&#160;&#160;&#160;&#160;rrandnum = $rdist_chi_square(seed, dof) ;
&#160;&#160;&#160;&#160;$display (&quot;Random number is %g&quot;, rrandnum ) ;
&#160;&#160;&#160;&#160;V(pinout) &lt;+ rrandnum ;<br />end // of analog block</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051483"></a>endmodule</pre>
<h3>
<a id="pgfId-1032399"></a><a id="marker-1134352"></a><a id="marker-1032394"></a><a id="marker-1032395"></a><a id="marker-1032396"></a><a id="marker-1032397"></a><a id="marker-1032398"></a>Student&#8217;s T Distribution</h3>

<p>
<a id="pgfId-1032400"></a>Use the <code>$rdist_t</code> function to generate random real numbers (or the <code>$dist_t</code> function to generate integer numbers) that form a Student&#8217;s T distribution. The <code>$rdist_t</code> function is not supported in digital contexts.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032401"></a><strong>$rdist_t</strong> <strong>(</strong> <code><em>seed</em></code> <strong>,</strong> <code><em>degree_of_freedom</em></code> <strong>)</strong> <strong>;<br />$dist_t</strong> <strong>(</strong> <code><em>seed</em></code> <strong>,</strong> <code><em>degree_of_freedom</em></code> <strong>)</strong> <strong>;</strong></pre>

<p>
<a id="pgfId-1032402"></a><span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> is a scalar integer variable used to initialize the sequence of generated numbers. <span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> must be a variable because the function updates the value of <span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> at each iteration. To ensure generation of a Student&#8217;s T distribution, change the value of <span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> only when you initialize the sequence. </p>
<p>
<a id="pgfId-1032403"></a><span class="webflare-courier-new" style="white-space:pre"><em>degree_of_freedom</em></span> is an integer value greater than zero. <span class="webflare-courier-new" style="white-space:pre"><em>degree_of_freedom</em></span> determines the width of spread of the generated values. Using a larger <span class="webflare-courier-new" style="white-space:pre"><em>degree_of_freedom</em></span> spreads the generated values over a wider range.</p>
<p>
<a id="pgfId-1032404"></a>For example, the following module returns a series of real numbers that together form a Student&#8217;s T distribution.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032405"></a>module distcheck (pinout) ;<br />electrical pinout ;<br />integer seed, dof ;<br />real rrandnum ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051485"></a>analog begin
&#160;&#160;&#160;&#160;@ (initial_step) begin
&#160;&#160;&#160;&#160;    seed = 23 ;
&#160;&#160;&#160;&#160;    dof = 15 ; // Degree of freedom must be &gt; 0
&#160;&#160;&#160;&#160;end 
&#160;&#160;&#160;&#160;rrandnum = $rdist_t(seed, dof) ;
&#160;&#160;&#160;&#160;$display (&quot;Random number is %g&quot;, rrandnum ) ;
&#160;&#160;&#160;&#160;V(pinout) &lt;+ rrandnum ;<br />end // of analog block</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051487"></a>endmodule</pre>
<h3>
<a id="pgfId-1032411"></a><a id="marker-1134354"></a><a id="marker-1032406"></a><a id="marker-1032407"></a><a id="marker-1032408"></a><a id="marker-1032409"></a><a id="marker-1032410"></a>Erlang Distribution</h3>

<p>
<a id="pgfId-1032412"></a>Use the <code>$rdist_erlang</code> function to generate random real numbers (or the <code>$dist_erlang</code> function to generate integer numbers) that form an Erlang distribution. The <code>$rdist_erlang</code> function is not supported in digital contexts.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032413"></a><strong>$rdist_erlang</strong> <strong>(</strong> <code><em>seed</em></code> <strong>,</strong> <code><em>k</em></code> <strong>,</strong> <code><em>mean</em></code> <strong>) ;<br />$dist_erlang</strong> <strong>(</strong> <code><em>seed</em></code> <strong>,</strong> <code><em>k</em></code> <strong>,</strong> <code><em>mean</em></code> <strong>) ;</strong></pre>

<p>
<a id="pgfId-1032414"></a><span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> is a scalar integer variable used to initialize the sequence of generated numbers. <span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> must be a variable because the function updates the value of <span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> at each iteration. To ensure generation of an Erlang distribution, change the value of <span class="webflare-courier-new" style="white-space:pre"><em>seed</em></span> only when you initialize the sequence. </p>
<p>
<a id="pgfId-1032415"></a><span class="webflare-courier-new" style="white-space:pre"><em>k</em></span> is an integer value greater than zero. Using a larger value for <span class="webflare-courier-new" style="white-space:pre"><em>k</em></span> decreases the variance of the distribution.</p>
<p>
<a id="pgfId-1032416"></a><span class="webflare-courier-new" style="white-space:pre"><em>mean</em></span> is an integer or real value greater than zero. <span class="webflare-courier-new" style="white-space:pre"><em>mean</em></span> specifies the value to be approached by the mean value of the generated numbers. </p>
<p>
<a id="pgfId-1032417"></a>For example, the following module returns a series of real numbers that together form an Erlang distribution.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032418"></a>module distcheck (pinout) ;<br />electrical pinout ;<br />integer seed, k, mean ;<br />real rrandnum ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051489"></a>analog begin
&#160;&#160;&#160;&#160;@ (initial_step) begin
&#160;&#160;&#160;&#160;    seed = 23 ;
&#160;&#160;&#160;&#160;    k = 20 ;                // k must be &gt; 0
&#160;&#160;&#160;&#160;    mean = 15 ;             // Mean must be &gt; 0
&#160;&#160;&#160;&#160;end 
&#160;&#160;&#160;&#160;rrandnum = $rdist_erlang(seed, k, mean) ;
&#160;&#160;&#160;&#160;$display (&quot;Random number is %g&quot;, rrandnum ) ;
&#160;&#160;&#160;&#160;V(pinout) &lt;+ rrandnum ;<br />end // of analog block</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051491"></a>endmodule</pre>
<h2>
<a id="pgfId-1084938"></a><a id="45758"></a>Interpolating with Table <a id="table_model"></a>Models<a id="marker-1167683"></a></h2>

<p>
<a id="pgfId-1084939"></a>Use the <code>$table_model</code> function to model the behavior of a design by interpolating between and extrapolating outside of data points.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1084940"></a>table_model_declaration ::=
&#160;&#160;&#160;&#160;<strong>$table_model(</strong>variables <strong>,</strong> table_source [ <strong>,</strong> ctrl_string ] <strong>)</strong></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1084941"></a>variables ::=
&#160;&#160;&#160;&#160;    <code><em>independent_var</em></code> { <strong>,</strong> <code><em>2nd_independent_var</em></code> [ <strong>,</strong><code><em> nth_independent_var </em></code>]}</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1154602"></a>table_source ::=
&#160;&#160;&#160;&#160;    data_file
&#160;&#160;&#160;&#160;|&#160;&#160; table_model_array</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1084942"></a>data_file ::=
&#160;&#160;&#160;&#160;    <strong>&quot;</strong><code><em>filename</em></code><strong>&quot;
&#160;&#160;&#160;&#160;|&#160;&#160; </strong><code><em>string_param</em></code></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1154605"></a>table_model_array ::=
&#160;&#160;&#160;&#160;    <code><em>array_ID</em></code> { <strong>,</strong> <code><em>2nd</em></code>_<code><em>array_ID </em></code>[ <strong>,</strong><code><em> nth_array_ID </em></code>]}<strong>,</strong><code><em> output_array_ID</em></code></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1084944"></a>ctrl_string ::=
&#160;&#160;&#160;&#160;    <strong>&quot;</strong>sub_ctrl_string [ <strong>,</strong> sub_ctrl_string ][; dependent_selector ]<strong>&quot;</strong></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1084946"></a>sub_ctrl_string ::=
&#160;&#160;&#160;&#160; <strong>I<br /></strong> | <strong>D<br /></strong> | [ degree_char ] [ extrap_char [ extrap_char ]]</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1084947"></a>degree_char ::=
&#160;&#160;&#160;&#160;    <strong>1</strong> | <strong>2</strong> | <strong>3</strong></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1084948"></a>extrap_char ::=
&#160;&#160;&#160;&#160;    <strong>C</strong> | <strong>L</strong> | <strong>S</strong><strong> </strong>| <strong>E</strong></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1170754"></a>dependent_selector ::=
&#160;&#160;&#160;&#160;positive_integer_number</pre>

<p>
<a id="pgfId-1084949"></a><span class="webflare-courier-new" style="white-space:pre"><em>independent_var</em></span> is an independent model variable. An <span class="webflare-courier-new" style="white-space:pre"><em>independent_var</em></span> can be any legal numerical expression that you can assign to an analog signal. You must specify an independent model variable for each dimension with a corresponding <code>sub_ctrl_string</code> <em>other than</em> <code>I</code> (ignore). You must <em>not</em> specify an independent model variable for dimensions that have a <code>sub_ctrl_string</code> of <code>I</code> (ignore). </p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1167626"></a>The <code>I</code> (ignore) <code>sub_ctrl_string</code> and support for more than one dimension are extensions beyond the Verilog-AMS LRM, Version 2.2. </div>
<p>
<a id="pgfId-1084950"></a><code>data_file</code> is the text file that stores the sample points. You can either give the file name directly or use a string parameter. For more information, see <a href="chap9.html#87816">&#8220;Table Model File Format&#8221;</a>.</p>
<p>
<a id="pgfId-1154617"></a><code>table_model_array</code> is a set of one-dimensional arrays that contains the data points to pass to the <code>$table_model</code> function. The size of the arrays is the same as the number of sample points. The data is stored in the arrays so that for the <span class="webflare-courier-new" style="white-space:pre"><em>k</em></span><sup>th</sup> dimension of the <span class="webflare-courier-new" style="white-space:pre"><em>i</em></span><sup>th</sup> sample point, <span class="webflare-courier-new" style="white-space:pre"><em>kth_dim_array_identifier</em></span>[<span class="webflare-courier-new" style="white-space:pre"><em>i</em></span>] = <span class="webflare-courier-new" style="white-space:pre"><em>X</em></span><code><sub><em>ik</em></sub></code> and so that for the <span class="webflare-courier-new" style="white-space:pre"><em>i</em></span><sup>th</sup> sample point <span class="webflare-courier-new" style="white-space:pre"><em>output_array_identifier</em></span>[<span class="webflare-courier-new" style="white-space:pre"><em>i</em></span>] = <span class="webflare-courier-new" style="white-space:pre"><em>Y</em></span><code><sub><em>i</em></sub></code>. For an example, see <a href="chap9.html#68725">&#8220;Example: Preparing Data in One-Dimensional Array Format&#8221;</a>.</p>
<p>
<a id="pgfId-1087227"></a><code>ctrl_string</code> controls the numerical aspects of the interpolation process. It consists of subcontrol strings for each dimension.</p>
<p>
<a id="pgfId-1139117"></a><code>sub_ctrl_string</code> specifies the handling for each dimension.</p>
<p class="webflare-indent1">
<a id="pgfId-1139165"></a>When you specify <code>I</code> (ignore), the software ignores the corresponding dimension (column) in the data file. You might use this setting to skip over index numbers, for example. When you associate the <code>I</code> (ignore) value with a dimension, you must not specify a corresponding <span class="webflare-courier-new" style="white-space:pre"><em>independent_var</em></span> for that dimension. </p>
<p class="webflare-indent1">
<a id="pgfId-1139166"></a>When you specify <code>D</code> (discrete), the software does not use interpolation for this dimension. If the software cannot find the exact value for the dimension in the corresponding dimension in the data file, it issues an error message and the simulation stops.</p>
<p>
<a id="pgfId-1087239"></a><code>degree_char</code> is the degree of the splines used for interpolation. The degree can be 1 (linear interpolation), 2 (quadratic spline interpolation), and 3 (cubic spline interpolation). The default value is 1.</p>
<p>
<a id="pgfId-1084956"></a><code>extrap_char</code> controls how the simulator evaluates a point that is outside the region of sample points included in the data file. The <code>C</code> (clamp) extrapolation method uses a horizontal line that passes through the nearest sample point, also called the end point, to extend the model evaluation. The <code>L</code> (linear) extrapolation method, which is the default method, models the extrapolation through a tangent line at the end point. The <code>S</code> (spline) extrapolation method uses the polynomial for the nearest segment (the segment at the end) to evaluate a point beyond the interpolation area. The <code>E</code> (error) extrapolation method issues a warning when the point to be evaluated is beyond the interpolation area.</p>
<p>
<a id="pgfId-1084957"></a>You can specify the extrapolation method to be used for each end of the sample point region. When you do not specify an <code>extrap_char</code> value, the linear extrapolation method is used for both ends. When you specify only one <code>extrap_char</code> value, the specified extrapolation method is used for both ends. When you specify two <code>extrap_char</code> values, the first character specifies the extrapolation method for the end with the smaller coordinate value, and the second character specifies the method for the end with the larger coordinate value.</p>
<p>
<a id="pgfId-1170983"></a><code>dependent_selector</code> enables you to select the dependent column in the table that needs to be interpolated. Multiple dependent variables are supported. For example, in the table control string &#8216;<code>I,1L;3</code>&#8217;, <code>3</code> is the dependent selector. This means that:</p>
<ul><li>
<a id="pgfId-1170984"></a>the first column will be ignored</li><li>
<a id="pgfId-1170845"></a>the second column will be the only dimension and the dimension will be linear interpolated and linear extrapolated</li><li>
<a id="pgfId-1170852"></a>the third, fourth, and fifth columns are the dependent variables numbered 1, 2, and 3 respectively, and the third dependent variable (column 5) will be selected for interpolation.</li></ul>


<p>
<a id="pgfId-1167938"></a><a id="table_model_digital_context"></a>You can use the <code>$table_model</code> function in the <a href="glossary.html#56602">analog context</a> (in an <code>analog</code> block) and in the digital context (such as in an <code>initial</code> or an <code>always</code> block). In the analog context, the <code>$table_model</code> function is subject to the same restrictions as analog operators with respect to where you can use the function. For more information, see <a href="chap9.html#27794">&#8220;Restrictions on Using Analog Operators&#8221;</a>. </p>
<p>
<a id="pgfId-1173303"></a>In digital context, you can use an environment variable to specify the location of the table file. For example:</p>

<pre class="webflare-courier-new">
<a id="pgfId-1173388"></a>initial begin</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1173389"></a>  out1 = $table_model(wb,&quot;$WORKAREA/$FILENAME&quot;, &quot;&quot;);</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1173390"></a>end</pre>

<p>
<a id="pgfId-1173341"></a>You can also specify a real model table array in a digital block. For example:</p>

<pre class="webflare-courier-new">
<a id="pgfId-1173369"></a>real tvar1[0:50];</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1173370"></a>real ftyp[0:50]; </pre>
<pre class="webflare-courier-new">
<a id="pgfId-1173371"></a></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1173372"></a>always @ (en) begin </pre>
<pre class="webflare-courier-new">
<a id="pgfId-1173373"></a>  test_out_real = $table_model(w_t_in , tvar1, ftyp,&quot;3CC&quot;); </pre>
<pre class="webflare-courier-new">
<a id="pgfId-1173361"></a>end</pre>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1167928"></a>To use the <code>$table_model</code> function in a digital context, you must be using digital mixed-signal licensing or Spectre AMS Designer simulator licensing. </div>
<p>
<a id="pgfId-1167866"></a>See also </p>
<ul><li>
<a id="pgfId-1167867"></a><a href="chap9.html#87816">Table Model File Format</a> </li><li>
<a id="pgfId-1167874"></a><a href="chap9.html#92837">Example: Using the $table_model Function</a> </li><li>
<a id="pgfId-1167879"></a><a href="chap9.html#68725">Example: Preparing Data in One-Dimensional Array Format</a> </li><li>
<a id="pgfId-1167883"></a><a href="chap9.html#77759">Example: Using $table_model as a Built-In Digital System Task</a> </li></ul>




<h3>
<a id="pgfId-1124038"></a><a id="87816"></a>Table Model File <a id="table_model_format"></a>Format<a id="marker-1167894"></a></h3>

<p>
<a id="pgfId-1124053"></a>The data in the table model file must be in the form of a family of ordered isolines. An <em>isoline</em> is a curve of at least two values generated when one variable is swept and all other variables are held constant. An <em>ordered isoline</em> is an isoline in which the sweeping variable is either monotonically increasing or monotonically decreasing. A <em>monotonically increasing</em> variable is one in which every subsequent value is equal to or greater than the previous value. A <em>monotonically decreasing</em> variable is one in which every subsequent value is equal to or less than the previous value. </p>
<p>
<a id="pgfId-1124080"></a>For example, a bipolar transistor can be described by a family of isolines, where each isoline is generated by holding the base current constant and sweeping the collector voltage from 0 to some maximum voltage. If the collector voltage sweeps monotonically, the generated isoline is an ordered isoline. In this example, the collector voltage takes many values for each of the isolines so the voltage is the <em>fastest changing</em> independent variable and the base current is the <em>slowest changing</em> independent variable. You need to know the fastest changing and slowest changing independent variables to arrange the data correctly in the table model file.</p>
<p>
<a id="pgfId-1124044"></a>The sample points are stored in the file in the following format:</p>
<p>
<a id="pgfId-1124045"></a><span class="webflare-courier-new" style="white-space:pre"><em>P</em></span><code><sub><em>1<br /></em></sub></code><span class="webflare-courier-new" style="white-space:pre"><em>P</em></span><code><sub><em>2<br /></em></sub></code><span class="webflare-courier-new" style="white-space:pre"><em>P</em></span><code><sub><em>3<br /></em></sub></code>...<br /><span class="webflare-courier-new" style="white-space:pre"><em>P</em></span><code><sub><em>M</em></sub></code></p>
<p>
<a id="pgfId-1124040"></a>where <span class="webflare-courier-new" style="white-space:pre"><em>P</em></span><code><sub><em>i</em></sub></code> (<span class="webflare-courier-new" style="white-space:pre"><em>i</em></span> = 1...<span class="webflare-courier-new" style="white-space:pre"><em>M</em></span>) are the sample points. Each sample point <span class="webflare-courier-new" style="white-space:pre"><em>P</em></span><code><sub><em>i</em></sub></code> is on a separate line and is represented as a sequence of numbers, <span class="webflare-courier-new" style="white-space:pre"><em>X</em></span><code><sub><em>i1</em></sub></code> <span class="webflare-courier-new" style="white-space:pre"><em>X</em></span><code><sub><em>i2</em></sub></code> ..<span class="webflare-courier-new" style="white-space:pre"><em>X</em></span><code><sub><em>ik</em></sub></code>... <span class="webflare-courier-new" style="white-space:pre"><em>X</em></span><code><sub><em>iN</em></sub></code> <span class="webflare-courier-new" style="white-space:pre"><em>Y</em></span><code><sub><em>i</em></sub></code> where <span class="webflare-courier-new" style="white-space:pre"><em>N</em></span> is the highest dimension of the model. <span class="webflare-courier-new" style="white-space:pre"><em>X</em></span><code><sub><em>ik</em></sub></code> is the coordinate of the sample point in the <span class="webflare-courier-new" style="white-space:pre"><em>k</em></span>th dimension, and <span class="webflare-courier-new" style="white-space:pre"><em>Y</em></span><code><sub><em>i</em></sub></code> is the model value at this point. <span class="webflare-courier-new" style="white-space:pre"><em>X</em></span><code><sub><em>i1</em></sub></code> (the leftmost variable) must be the slowest changing variable and <span class="webflare-courier-new" style="white-space:pre"><em>X</em></span><code><sub><em>iN</em></sub></code> (the rightmost variable other than the model value) must be the fastest changing variable. The other variables must be arranged in between from slowest changing to fastest changing. Comments, which begin with <code>#</code>, can be inserted at any place in the file and can continue to the end of the line.</p>
<p>
<a id="pgfId-1124158"></a>For example, to create a table model with three ordered isolines representing the function</p>

<pre class="webflare-courier-new">
<a id="pgfId-1124160"></a>z = f(x,y) = x+y<sup>2</sup></pre>

<p>
<a id="pgfId-1124162"></a>build the model as follows, assuming that you want to have four sample values on each isoline. The <code>y</code> values used here are all the same and equally spaced on each isoline, but they do not have to be.</p>
<p>
<a id="pgfId-1124166"></a>Isoline 1: <code>x=1</code></p>

<pre class="webflare-courier-new">
<a id="pgfId-1124168"></a>y = 1, 2, 3, 4<br />z = 2, 5, 10, 17</pre>

<p>
<a id="pgfId-1124171"></a>Isoline 2: <code>x=2</code></p>

<pre class="webflare-courier-new">
<a id="pgfId-1124172"></a>y = 1, 2, 3, 4<br />z = 3, 6, 11, 18</pre>

<p>
<a id="pgfId-1124175"></a>Isoline 3: <code>x=3</code></p>

<pre class="webflare-courier-new">
<a id="pgfId-1124176"></a>y = 1, 2, 3, 4<br />z = 4, 7, 12, 19</pre>

<p>
<a id="pgfId-1154862"></a>Finally, prefix each row with an index. The function will be specified to ignore this new column of data.</p>
<p>
<a id="pgfId-1124179"></a>Enter the table model data into the file as follows:</p>

<pre class="webflare-courier-new">
<a id="pgfId-1124394"></a># Indx is the index column to be ignored.<br /># x is the slowest changing independent variable.<br /># y is the fastest changing independent variable.<br /># z is the table model value at each point.<br />#  Indx   x   y   z<br />   1      1   1   2<br />   2      1   2   5<br />   3      1   3  10<br />   4      1   4  17<br />   5      2   1   3<br />   6      2   2   6<br />   7      2   3  11<br />   8      2   4  18<br />   9      3   1   4<br />   10     3   2   7<br />   11     3   3  12<br />   12     3   4  19<br /></pre>
<h3>
<a id="pgfId-1084958"></a><a id="92837"></a>Example: Using the $table_model Function</h3>

<p>
<a id="pgfId-1124039"></a>For example, assume that you have a data file named <code>nmos.tbl</code>, which contains the data given above. You might use it in a module as follows: </p>

<pre class="webflare-courier-new">
<a id="pgfId-1084959"></a>&#8216;include &quot;disciplines.vams&quot;
&#8216;include &quot;constants.vams&quot;

module mynmos (g, d, s);
electrical g, d, s;
inout g, d, s;

analog begin
&#160;&#160;&#160;&#160;I(d, s) &lt;+ $table_model (V(g, s), V(d, s), &quot;nmos.tbl&quot;, &quot;I,3CL,3CL&quot;);<br />end<br />
endmodule
</pre>

<p>
<a id="pgfId-1084963"></a>In this example, the program ignores the first column of data. The independent variables are <code>V(g,s)</code> and <code>V(d,s)</code>. The degree of the splines that the program uses for interpolation is three for each of the two active dimensions. For each of these dimensions, the extrapolation method for the lower end is clamping and the extrapolation for the upper end is linear.</p>
<p>
<a id="pgfId-1173958"></a>When <code>table_model</code> is used in a digital context, <code>$table_model</code> does not support quadratic spline interpolation. The simulator uses linear spline interpolation instead.</p>

<h3>
<a id="pgfId-1167743"></a><a id="68725"></a>Example: Preparing Data in One-Dimensional Array Format</h3>

<p>
<a id="pgfId-1154824"></a>In this example, there are 18 sample points. Consequently, each of the one-dimensional arrays contains 18 bits. Each point has two independent variables, represented by <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> and <span class="webflare-courier-new" style="white-space:pre"><em>y</em></span>, and a value, represented by <span class="webflare-courier-new" style="white-space:pre"><em>f_xy</em></span>.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1154711"></a>module measured_resistance (a, b);
electrical a, b;
inout a, b;
real x[0:17], y[0:17], f_xy[0:17];
analog begin
&#160;&#160;&#160;&#160;@(initial_step) begin
&#160;&#160;&#160;&#160;    x[0]= -10; y[0]=-10; f_xy[0]=0; // 0th sample point
&#160;&#160;&#160;&#160;    x[1]= -10; y[1]=-8; f_xy[1]=-0.4; // 1st sample point
&#160;&#160;&#160;&#160;    x[2]= -10; y[2]=-6; f_xy[2]=-0.8; // 2nd sample point
&#160;&#160;&#160;&#160;    x[3]= -9; y[3]=-10; f_xy[3]=0.2;
&#160;&#160;&#160;&#160;    x[4]= -9; y[4]=-8; f_xy[4]=-0.2;
&#160;&#160;&#160;&#160;    x[5]= -9; y[5]=-6; f_xy[5]=-0.6;
&#160;&#160;&#160;&#160;    x[6]= -9; y[6]=-4; f_xy[6]=-1;
&#160;&#160;&#160;&#160;    x[7]= -8; y[7]=-10; f_xy[7]=0.4;
&#160;&#160;&#160;&#160;    x[8]= -8; y[8]=-9; f_xy[8]=0.2;
&#160;&#160;&#160;&#160;    x[9]= -8; y[9]=-7; f_xy[9]=-0.2;
&#160;&#160;&#160;&#160;    x[10]= -8; y[10]=-5; f_xy[10]=-0.6;
&#160;&#160;&#160;&#160;    x[11]= -8; y[11]=-3; f_xy[11]=-1;
&#160;&#160;&#160;&#160;    x[12]= -7; y[12]=-10; f_xy[12]=0.6;
&#160;&#160;&#160;&#160;    x[13]= -7; y[13]=-9; f_xy[13]=0.4;
&#160;&#160;&#160;&#160;    x[14]= -7; y[14]=-8; f_xy[14]=0.2;
&#160;&#160;&#160;&#160;    x[15]= -7; y[15]=-7; f_xy[15]=0;
&#160;&#160;&#160;&#160;    x[16]= -7; y[16]=-6; f_xy[16]=-0.2;
&#160;&#160;&#160;&#160;    x[17]= -7; y[17]=-5; f_xy[17]=-0.4;
&#160;&#160;&#160;&#160;end
&#160;&#160;&#160;&#160;I(a, b) &lt;+ $table_model (V(a), V(b), x, y, f_xy, &quot;3L,1L&quot;);<br />end<br />endmodule</pre>
<h3>
<a id="pgfId-1167746"></a><a id="77759"></a>Example: Using $<a id="table_model_digitalBlock"></a>table_model as a Built-In Digital System Task</h3>

<p>
<a id="pgfId-1167763"></a>You can use the <code>$table_model</code> function as a built-in digital system task in an <code>initial</code> or <code>always</code> block, such as: </p>

<pre class="webflare-courier-new">
<a id="pgfId-1171166"></a>module example(rout, rin1, rin2, clk);<br />wreal rout, rin1, rin2;<br />input rin1, rin2;<br />output rout;<br />wire clk;<br />input clk;<br />
real out;

assign rout = out;

always @clk begin
&#160;&#160;  out = <strong>$table_model</strong>(rin1, rin2,&quot;sample.dat&quot;);<br />end<br />endmodule<br /></pre>
<h2>
<a id="pgfId-1171167"></a><a id="31757"></a>Node/Net Aliasing Sy<a id="node_alias"></a>stem Functions</h2>

<p>
<a id="pgfId-1171176"></a>You can use the <code>$analog_node_alias()</code> system function to alias a local node to a hierarchical node through a string reference within connect modules and regular modules. In addition, you can use the Cadence proprietary system function <code>$real_net_alias()</code> to alias a local net to a hierarchical net through a string reference within connect modules and regular modules.</p>

<h3>
<a id="pgfId-1171254"></a>Aliasing Local Nodes to Hierarchical Nodes with $analog_node_alias</h3>

<p>
<a id="pgfId-1171534"></a>Use the <code>$analog_node_alias</code><a id="analog_node_alias"></a> system function to alias a local node to a hierarchical node through a string reference within connect modules and regular modules.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1171276"></a>analog_node_alias_system_function ::=</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171264"></a> $analog_node_alias ( analog_net_reference , hierarchical_reference_string )</pre>

<p>
<a id="pgfId-1171291"></a><code>analog_net_reference</code> is a node that is declared in the module containing the system function call and can be either a scalar node or a vector continuous node. In case of vector node, it references the full vector node and cannot be a bit-select or part-select of the vector node. In addition, <code>analog_net_reference</code> cannot be a port or part of port connections.</p>
<p>
<a id="pgfId-1171354"></a><code>hierarchical_reference_string</code> can be a string literal or a string parameter containing hierarchical reference to the continuous node. <code>hierarchical_reference_string </code>cannot reference a node that is used as <code>analog_net_reference </code>in another <code>$analog_node_alias</code> system function. </p>
<p>
<a id="pgfId-1173171"></a>The <code>$analog_node_alias</code> system function returns 1 if <code>hierarchical_reference_string </code>points to a valid continuous node and aliases the <code>analog_net_reference </code>to the hierarchical node.</p>
<p>
<a id="pgfId-1173757"></a>When both <code>analog_net_reference</code> and <code>hierarchical_reference_string</code> are electrical bus, each bit of the 1st argument connects to each of the 2nd argument.</p>
<p>
<a id="pgfId-1173172"></a>The following rules determine whether a node is valid:</p>
<ul><li>
<a id="pgfId-1173173"></a><code>hierarchical_reference_string</code> refers to a scalar continuous node or a scalar element of a continuous vector node</li><li>
<a id="pgfId-1171511"></a>disciplines of <code>analog_net_reference</code> and the resolved hierarchical node reference are compatible</li><li>
<a id="pgfId-1173778"></a>when <code>hierarchical_reference_string</code> is an electrical bus, the width of both the arguments must be same</li><li>
<a id="pgfId-1171518"></a>the resolved hierarchical node&#8217;s reference is a port</li></ul>



<p>
<a id="pgfId-1171525"></a>If the system function returns zero (0), the node referenced by <code>analog_net_reference</code> is treated as a normal continuous node declared in the module containing the system function call.</p>
<p>
<a id="pgfId-1171682"></a>If a particular node is involved in multiple calls to the system function, then the last evaluated call takes precedence.</p>
<p>
<a id="pgfId-1171653"></a>The <code>$analog_node_alias</code> system function can only be used within an <code>analog initial</code> block. In general, the <code>$analog_node_alias</code> system function cannot be used inside a conditional statement. However, it can be used in a conditional statement if the conditional expression controlling the statement consists of terms that do not change during the simulation.</p>
<p>
<a id="pgfId-1171553"></a>The following is an example of the <code>$analog_node_alias</code> system function:</p>

<pre class="webflare-courier-new">
<a id="pgfId-1171578"></a>connectmodule elect_to_logic(el, cm);</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171579"></a>    input el;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171580"></a>    output cm;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171581"></a>    reg cm;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171582"></a>    electrical el;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171583"></a>    ddiscrete cm;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171584"></a>    electrical vdd, vss;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171585"></a>    parameter string vddname = &quot;(not_given)&quot;; // Set via the CR</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171586"></a>    parameter string vssname = &quot;(not given)&quot;; // Set via the CR</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171587"></a> </pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171588"></a> analog initial begin</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171589"></a>    if ($analog_node_alias(vdd, vddname) == 0)</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171590"></a>       $display(&quot;Unable to resolve power supply: %s&quot;, vddname);</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171591"></a>    if ($analog_node_alias(vss, vssname) == 0)</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171592"></a>       $display(&quot;Unable to resolve ground: %s&quot;, vssname);</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171593"></a> end</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171594"></a>  </pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171595"></a> always @(cross(V(el) - V(vdd)/2.0, 1))</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171596"></a>        cm = 1;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171597"></a> always @(cross(V(el) - V(vdd)/2.0, -1))</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171598"></a>        cm = 0;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171599"></a> </pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171600"></a> endmodule</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171601"></a> </pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171602"></a>connectmodule logic_to_elect(cm, el);</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171603"></a>    input cm;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171604"></a>    output el;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171605"></a>    ddiscrete cm;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171606"></a>    electrical el;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171607"></a>    electrical vdd, vss;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171608"></a>    parameter string vddname = &quot;(not_given)&quot;; // Set via the CR</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171609"></a>    parameter string vssname = &quot;(not given)&quot;; // Set via the CR</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171610"></a> </pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171611"></a> analog initial begin</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171612"></a>    if ($analog_node_alias(vdd, vddname) == 0)</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171613"></a>       $error(&quot;Unable to resolve power supply: %s&quot;, vddname);</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171614"></a>    if ($analog_node_alias(vss, vssname) == 0)</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171615"></a>       $error(&quot;Unable to resolve ground: %s&quot;, vssname);</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171616"></a> end</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171617"></a> </pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171618"></a> analog V(el) &lt;+ V(vdd) * transition((cm == 1) ? 1 : 0);</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171619"></a> </pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171563"></a>endmodule</pre>
<h3>
<a id="pgfId-1171641"></a>Aliasin<a id="real_net_alias"></a>g Local Nets to Hierarchical Nets with $real_net_alias</h3>

<p>
<a id="pgfId-1171734"></a>Use the <code>$real_net_alias</code><a id="real_net_alias"></a> Cadence proprietary system function to alias a local net to a hierarchical net through a string reference within connect modules and regular modules.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1171735"></a>real_net_alias_system_function ::=</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171816"></a> $real_net_alias ( real_net_reference , hierarchical_reference_string )</pre>

<p>
<a id="pgfId-1171817"></a>Here, <code>real_net_reference</code> is a net that is declared in the module containing the system function call. It can be a local scalar, a vector wreal net, a wreal array, or SV-UDN real net array. In addition, <code>real_net_reference</code> cannot be a bit-select or part-select of a vector net.</p>
<p>
<a id="pgfId-1171855"></a><code>hierarchical_reference_string</code> can be a string literal or a string parameter containing hierarchical reference to the wreal net, a scalar element of a vector wreal net, a wreal array, SV-UDN real net array. The array reference can be bit-select or part-select. <code>hierarchical_reference_string </code>should refer to a scalar wreal net or a scalar element of a wreal net.</p>
<p>
<a id="pgfId-1173865"></a>When both the <code>real_net_reference</code> and <code>hierarchical_reference_string</code> arguments are arrays, each bit of the first argument connects to each of the second argument. When <code>real_net_reference</code> is array and <code>hierarchical_reference_string</code> is scalar or bit-select, each bit of the array connects to the scalar or bit-select. And, when the <code>hierarchical_reference_string</code> is array, the width of both arguments should be identical.</p>
<p>
<a id="pgfId-1171789"></a>The <code>$real_net_alias</code> system function returns 1 if <code>hierarchical_reference_string </code>points to a valid discrete wreal net and returns zero (0) otherwise. If the return value is 1, then the <code>real_net_reference</code> is aliased to that hierarchical net. If the system function returns zero (0), then the net referenced by <code>real_net_reference</code> is treated as a normal local wreal net declared in the module containing the system function call.</p>
<p>
<a id="pgfId-1171795"></a>If a particular net is involved in multiple calls to the system function, then the last evaluated call (in the module context) takes precedence.</p>
<p>
<a id="pgfId-1171779"></a>The <code>$real_net_alias</code> system function can only be used in a digital block. You can use the <code>$real_net_alias</code> system function in both connect modules and Verilog-AMS modules.</p>
<p>
<a id="pgfId-1171977"></a>The following example shows the usage of the <code>$real_net_alias</code> system function in a Verilog-AMS connect module:</p>

<pre class="webflare-courier-new">
<a id="pgfId-1171992"></a>module top;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171993"></a>    wreal a, b;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171994"></a>    reg r1, r2, r3, r4;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171995"></a>    foo f1();</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171996"></a>    parameter string p = &quot;top.f1.y&quot;;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171997"></a>    initial begin</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171998"></a>        r1 = $real_net_alias(a, &quot;top.f1.x&quot;);    // #1, valid, but this does not &#160;&#160;&#160;&#160; &#160;&#160;                                              take effect because of #4 below</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171999"></a>        if (r1) $display(&quot;top.f1.x is legal &quot;); // #2, $display works</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172000"></a>    end</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172001"></a>    initial begin</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172002"></a>        #0;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172003"></a>        $display(&quot;a = &quot;, a);                    // #3, wreal net &#39;a&#39; get assigned                                                 at time zero</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172004"></a>        #3;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172005"></a>        r2 = $real_net_alias(a, p);             // #4, this is the last valid func-                                               call for &#39;a&#39;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172006"></a>        $display(&quot;a = &quot;, a,,r2,,top.f1.y,,b);   // #5</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172007"></a>        #3;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172008"></a>        r3 = $real_net_alias(a, &quot;top.f1.no&quot;);   // #6, invalid, this function call                                                does not work, r3 = 0</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172009"></a>        r4 = $real_net_alias(b, &quot;top.f1.y&quot;);    // #7, valid, this takes effect and                                               result is shown in #5 above</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172010"></a>    end</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172011"></a>endmodule</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172012"></a>module foo;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172013"></a>    wreal x, y;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172014"></a>    assign x = 1.11;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172015"></a>    assign y = 5.43;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172016"></a>endmodule</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172017"></a> </pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172018"></a>Simulation outputs:</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172019"></a>top.f1.x is legal</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172020"></a>a = 5.43</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1171984"></a>a = 5.43 1 5.43 5.43</pre>

<p>
<a id="pgfId-1172049"></a>The following example shows the usage of the <code>$real_net_alias</code> function in a dynamic supply connect module:</p>

<pre class="webflare-courier-new">
<a id="pgfId-1172067"></a>connectrules ddiscrete_dynsup_full_fast_cr;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172068"></a>    connect L2R_dynsup #(.vddname(&quot;top.f1.a&quot;), .vssname(&quot;top.f1.x&quot;)) ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172069"></a>    ......</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172070"></a>endconnectrules</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172071"></a>`timescale 1ns / 1ps</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172072"></a>connectmodule L2R_dynsup(Rout, Lin);</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172073"></a>   input Lin;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172074"></a>   output  Rout; wreal Rout;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172075"></a>   wreal vss, vdd;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172076"></a>   parameter string vddname = &quot;(no value)&quot;;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172077"></a>   parameter string vssname = &quot;(no value)&quot;;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172078"></a>   parameter real vsup_min=0.5 from (0:inf); // min supply for normal operation</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172079"></a>   parameter real vlo = 0;                   // logic low voltage</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172080"></a>   reg supOK;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172081"></a>   real L_conv, v_vdd, v_vss;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172082"></a>   initial begin</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172083"></a>      L_conv = `wrealZState;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172084"></a>      v_vdd = $real_net_alias(vdd, vddname); </pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172085"></a>      v_vss = $real_net_alias(vss, vssname);</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172086"></a>      if (!v_vss || !v_vdd) begin   </pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172087"></a>         $display(&quot;==== Invalid Parameter(s) at %m: vddname=&quot;, vddname,,&quot;vssname=&quot;, vssname); </pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172088"></a>         $finish;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172089"></a>      end  </pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172090"></a>      else  </pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172091"></a>         $display(&quot;==== Valid Parameter(s) at %m: vddname=&quot;, vddname,,&quot;vssname=&quot;, vssname);</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172092"></a>   end</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172093"></a>   always begin</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172094"></a>      if ( vdd - vss &gt; vsup_min)</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172095"></a>         supOK = 1&#39;b1; </pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172096"></a>      else</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172097"></a>         supOK = 1&#39;b0;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172098"></a>      @(vdd, vss);</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172099"></a>   end</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172100"></a>   // Determine the value of L and convert to a real value</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172101"></a>   always begin</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172102"></a>      if ( supOK ) begin</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172103"></a>         case (Lin)</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172104"></a>          1&#39;b0:</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172105"></a>             L_conv = vss;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172106"></a>          1&#39;b1:</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172107"></a>            L_conv = vdd;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172108"></a>          1&#39;bz:</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172109"></a>            L_conv = `wrealZState;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172110"></a>          default:</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172111"></a>            L_conv = `wrealXState;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172112"></a>         endcase</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172113"></a>       end</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172114"></a>      else</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172115"></a>         L_conv = `wrealXState;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172116"></a>      @(Lin, supOK, vss, vdd);</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172117"></a>   end</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172118"></a>   // drive the converted value back onto the output R pin</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172119"></a>   assign Rout = L_conv;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172059"></a>endmodule</pre>
<h2>
<a id="pgfId-1171358"></a><a id="marker-1171356"></a><a id="42564"></a>Analog Operators </h2>

<p>
<a id="pgfId-1032423"></a><a id="marker-1032421"></a>Analog <a id="marker-1032422"></a>operators are functions that operate on more than just the current value of their arguments. These functions maintain an internal state and produce a return value that is a function of an input expression, the arguments, and their internal state.</p>
<p>
<a id="pgfId-1032424"></a>The analog operators are the</p>
<ul><li>
<a id="pgfId-1032425"></a>Limited exponential function</li><li>
<a id="pgfId-1032426"></a>Time derivative operator</li><li>
<a id="pgfId-1032427"></a>Time integral operator</li><li>
<a id="pgfId-1032428"></a>Circular integrator operator</li><li>
<a id="pgfId-1032429"></a>Delay operator</li><li>
<a id="pgfId-1032430"></a>Transition filter</li><li>
<a id="pgfId-1032431"></a>Slew filter</li><li>
<a id="pgfId-1032432"></a>Laplace transform filters</li><li>
<a id="pgfId-1032433"></a>Z-transform filters</li></ul>









<h3>
<a id="pgfId-1034520"></a><a id="marker-1134366"></a><a id="27794"></a>Restrictions on Using Analog Operators</h3>

<p>
<a id="pgfId-1032435"></a>Analog operators are subject to these <a id="marker-1032434"></a>restrictions:</p>
<ul><li>
<a id="pgfId-1032436"></a>You can use analog operators inside an <code>if</code> or <code>case</code> construct only if the controlling conditional expression consists entirely of <code>genvar</code> expressions, literal numerical constants, parameters, or the <code>analysis</code> function.</li><li>
<a id="pgfId-1032437"></a>You cannot use analog operators in <code>repeat</code>, <code>while</code>, or <code>for</code> statements.</li><li>
<a id="pgfId-1032438"></a>You cannot use analog operators inside a function. </li><li>
<a id="pgfId-1166976"></a>You cannot use analog operators inside <code>initial</code> blocks, <code>always</code> blocks, or user-defined functions.</li><li>
<a id="pgfId-1035625"></a>You cannot specify a null argument in the argument list of an analog operator.</li></ul>





<h3>
<a id="pgfId-1032440"></a><a id="18262"></a>Limited Exponential Function</h3>

<p>
<a id="pgfId-1032443"></a>Use the <a id="marker-1032441"></a>limited <a id="marker-1032442"></a>exponential function to calculate the exponential of a real argument.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032447"></a><strong>limexp(</strong><a id="marker-1032444"></a><a id="marker-1032445"></a><a id="marker-1032446"></a> <code><em>expr</em></code> <strong>)</strong></pre>

<p>
<a id="pgfId-1032448"></a><span class="webflare-courier-new" style="white-space:pre"><em>expr</em></span> is a dynamic expression of type real.</p>
<p>
<a id="pgfId-1032449"></a>The <code>limexp</code> function limits the iteration step size to improve convergence. <code>limexp</code> behaves like the <code>exp</code> function, except that using <code>limexp</code> to model semiconductor junctions generally results in dramatically improved convergence. For information on the <code>exp</code> function, see <a href="chap7.html#11906">&#8220;Standard Mathematical Functions&#8221;</a>.</p>
<p>
<a id="pgfId-1032453"></a>The <code>limexp</code> function is subject to the restrictions listed in <a href="chap9.html#27794">&#8220;Restrictions on Using Analog Operators&#8221;</a>.</p>

<h3>
<a id="pgfId-1032458"></a><a id="18023"></a>Time Derivative Operator</h3>

<p>
<a id="pgfId-1032462"></a>Use the <a id="marker-1032459"></a>time derivative <a id="marker-1032460"></a>operator to calculate the time <a id="marker-1032461"></a>derivative of an argument.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1089589"></a><strong>ddt(</strong><a id="marker-1032463"></a> <code><em>input</em></code> [ <strong>,</strong> <code><em>abstol</em></code> | <code><em>nature</em></code> ] <strong>)</strong></pre>

<p>
<a id="pgfId-1032464"></a><span class="webflare-courier-new" style="white-space:pre"><em>input</em></span> is a dynamic expression.</p>
<p>
<a id="pgfId-1034795"></a><span class="webflare-courier-new" style="white-space:pre"><em>abstol</em></span> is a constant specifying the absolute tolerance that applies to the output of the <code>ddt</code> operator. Set <span class="webflare-courier-new" style="white-space:pre"><em>abstol</em></span> at the largest signal level that you consider negligible. In this release of Verilog-AMS, <span class="webflare-courier-new" style="white-space:pre"><em>abstol</em></span> is ignored.</p>
<p>
<a id="pgfId-1034606"></a><span class="webflare-courier-new" style="white-space:pre"><em>nature</em></span> is a nature from which the absolute tolerance is to be derived. In this release of Verilog-AMS, <span class="webflare-courier-new" style="white-space:pre"><em>nature</em></span> is ignored.</p>
<p>
<a id="pgfId-1034538"></a>The time derivative operator is subject to the restrictions listed in <a href="chap9.html#27794">&#8220;Restrictions on Using Analog Operators&#8221;</a>.</p>
<p>
<a id="pgfId-1089476"></a>In DC analyses, the <code>ddt</code> operator returns 0. To define a higher order derivative, you must use an internal node or signal. For example, a statement such as the following is illegal.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032476"></a>V(out) &lt;+ ddt(ddt(V(in))) // ILLEGAL!</pre>

<p>
<a id="pgfId-1032477"></a>For an example illustrating how to define higher order derivatives correctly, see <a href="chap2.html#30954">&#8220;Using Integration and Differentiation with Analog Signals&#8221;</a>.</p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1167154"></a>You cannot output the result of the <code>ddt</code> operator using statements such as <code>$print</code>, <code>$strobe</code>, and <code>$fopen</code>. Instead, you can use an internal node to record the value, then output the value of the internal node. </div>

<h3>
<a id="pgfId-1167157"></a><a id="31165"></a>Time Integral Operator</h3>

<p>
<a id="pgfId-1032486"></a>Use the <a id="marker-1032483"></a>time integral <a id="marker-1032484"></a>operator to calculate the time <a id="marker-1032485"></a>integral of an argument.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032487"></a><strong>idt( </strong><code><em>input</em></code> [ <strong>,</strong> <code><em>ic</em></code> [ <strong>,</strong> <code><em>assert</em></code> [ <strong>,</strong> <code><em>abstol</em></code> | <code><em>nature</em></code> ] ] ] <strong>)</strong></pre>

<p>
<a id="pgfId-1032488"></a><span class="webflare-courier-new" style="white-space:pre"><em>input</em></span> is a dynamic expression to be integrated.</p>
<p>
<a id="pgfId-1035430"></a><span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span> is a dynamic expression specifying the initial condition.</p>
<p>
<a id="pgfId-1032490"></a><span class="webflare-courier-new" style="white-space:pre"><em>assert</em></span> is a dynamic integer-valued parameter. To reset the integration, set <span class="webflare-courier-new" style="white-space:pre"><em>assert</em></span> to a nonzero value.</p>
<p>
<a id="pgfId-1032491"></a><span class="webflare-courier-new" style="white-space:pre"><em>abstol</em></span> is a constant explicit absolute tolerance that applies to the input of the <code>idt</code> operator. Set <span class="webflare-courier-new" style="white-space:pre"><em>abstol</em></span> at the largest signal level that you consider negligible.</p>
<p>
<a id="pgfId-1034614"></a><span class="webflare-courier-new" style="white-space:pre"><em>nature</em></span> is a nature from which the absolute tolerance is to be derived.</p>
<p>
<a id="pgfId-1032492"></a>The time integral operator is subject to the restrictions listed in <a href="chap9.html#27794">&#8220;Restrictions on Using Analog Operators&#8221;</a>.</p>
<p>
<a id="pgfId-1032496"></a>The value returned by the <code>idt</code> operator during DC or AC analysis depends on which of the parameters you specify.</p>

<p>
<a id="pgfId-1091607"></a></p>
<table class="webflareTable" id="#id1032497">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1032499">
<a id="pgfId-1032499"></a>If you specify</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1032501">
<a id="pgfId-1032501"></a>Then idt returns</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032503"></a><span class="webflare-courier-new" style="white-space:pre"><em>input</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1170263"></a><img width="80" height="48" src="images/chap9-7.gif" /></p>
<p>
<a id="pgfId-1091608"></a>The time-integral of <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> from 0 to <span class="webflare-courier-new" style="white-space:pre"><em>t</em></span> with the initial condition being computed in the <a id="marker-1169381"></a>DC analysis.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032511"></a><span class="webflare-courier-new" style="white-space:pre"><em>input</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1170282"></a><img width="111" height="45" src="images/chap9-8.gif" /></p>
<p>
<a id="pgfId-1091613"></a>The time-integral of <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> from 0 to <span class="webflare-courier-new" style="white-space:pre"><em>t</em></span> with initial condition <span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span>. In DC or IC analyses, returns <span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span><a id="marker-1032517"></a>.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032519"></a><span class="webflare-courier-new" style="white-space:pre"><em>input</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>assert</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1170301"></a><img width="110" height="47" src="images/chap9-9.gif" /></p>
<p>
<a id="pgfId-1091616"></a>The time-integral of <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> from <span class="webflare-courier-new" style="white-space:pre"><em>t</em></span><subscript>
0
 to <span class="webflare-courier-new" style="white-space:pre"><em>t</em></span> with initial condition <span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span>. In DC or IC analyses, and when <span class="webflare-courier-new" style="white-space:pre"><em>assert</em></span> is nonzero, returns <span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span>. <span class="webflare-courier-new" style="white-space:pre"><em>t</em></span><sub>0</sub> is the time when <span class="webflare-courier-new" style="white-space:pre"><em>assert</em></span> last became 0.</subscript></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032526"></a><span class="webflare-courier-new" style="white-space:pre"><em>input</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>assert</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>abstol</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1170324"></a><img width="110" height="47" src="images/chap9-10.gif" /></p>
<p>
<a id="pgfId-1091617"></a>The time-integral of <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> from <span class="webflare-courier-new" style="white-space:pre"><em>t</em></span><subscript>
0
 to <span class="webflare-courier-new" style="white-space:pre"><em>t</em></span> with initial condition <span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span>. In DC or IC analysis, and when <span class="webflare-courier-new" style="white-space:pre"><em>assert</em></span> is nonzero, returns <span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span>. <span class="webflare-courier-new" style="white-space:pre"><em>t</em></span><sub>0</sub> is the time when <span class="webflare-courier-new" style="white-space:pre"><em>assert</em></span> last became 0.</subscript></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1034620"></a><span class="webflare-courier-new" style="white-space:pre"><em>input</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>assert</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>nature</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1170342"></a><img width="110" height="47" src="images/chap9-11.gif" /></p>
<p>
<a id="pgfId-1091620"></a>The time-integral of <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> from <span class="webflare-courier-new" style="white-space:pre"><em>t</em></span><subscript>
0
 to <span class="webflare-courier-new" style="white-space:pre"><em>t</em></span> with initial condition <span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span>. In DC or IC analysis, and when <span class="webflare-courier-new" style="white-space:pre"><em>assert</em></span> is nonzero, returns <span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span>. <span class="webflare-courier-new" style="white-space:pre"><em>t</em></span><sub>0</sub> is the time when <span class="webflare-courier-new" style="white-space:pre"><em>assert</em></span> last became 0.</subscript></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1032532"></a>The initial condition forces the DC solution to the system. You must specify the initial condition, <span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span>, unless you are using the <code>idt</code> operator in a system with feedback that forces <span class="webflare-courier-new" style="white-space:pre"><em>input</em></span> to zero. If you use a model in a feedback configuration, you can leave out the initial condition without any unexpected behavior during simulation. For example, an operational amplifier alone needs an initial condition, but the same amplifier with the right external feedback circuitry does not need that forced DC solution.<a id="marker-1032533"></a></p>
<p>
<a id="pgfId-1032534"></a>The following statement illustrates using <code>idt</code> with a specified initial condition.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032535"></a>V(out) &lt;+ sin(2*`M_PI*(fc*$abstime + idt(gain*V(in),0))) ;</pre>
<h3>
<a id="pgfId-1032539"></a><a id="36508"></a>Cir<a id="marker-1032537"></a><a id="marker-1134492"></a>cular Integr<a id="marker-1032538"></a><a id="marker-1134496"></a>ator Operator</h3>

<p>
<a id="pgfId-1032540"></a>Use the circular integrator operator to convert an expression argument into its indefinitely integrated form.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032541"></a><strong>idtmod(</strong><code><em>expr</em></code> [ <strong>, </strong><code><em>ic</em></code> [ <strong>, </strong><code><em>modulus</em></code> [<strong>, </strong><code><em>offset</em></code> [<strong>,</strong> <code><em>abstol</em></code> | <code><em>nature</em></code> ] ] ] ] <strong>)</strong></pre>

<p>
<a id="pgfId-1032542"></a><span class="webflare-courier-new" style="white-space:pre"><em>expr</em></span> is the dynamic integrand or expression to be integrated.</p>
<p>
<a id="pgfId-1032543"></a><span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span> is a dynamic initial condition. By default, the value of <span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span> is zero.</p>
<p>
<a id="pgfId-1032544"></a><span class="webflare-courier-new" style="white-space:pre"><em>modulus</em></span> is a dynamic value at which the output of <code>idtmod</code> is reset. <span class="webflare-courier-new" style="white-space:pre"><em>modulus</em></span> must be a positive value equation. If you do not specify <span class="webflare-courier-new" style="white-space:pre"><em>modulus</em></span>, <code>idtmod</code> behaves like the <code>idt</code> operator and performs no limiting on the output of the integrator.</p>
<p>
<a id="pgfId-1032545"></a><span class="webflare-courier-new" style="white-space:pre"><em>offset</em></span> is a dynamic value added to the integration. The default is zero.</p>
<p>
<a id="pgfId-1032546"></a>The <span class="webflare-courier-new" style="white-space:pre"><em>modulus</em></span> and <span class="webflare-courier-new" style="white-space:pre"><em>offset</em></span> parameters define the bounds of the integral. The output of the <code>idtmod</code> function always remains in the range</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032547"></a><code><em>offset</em></code> &lt; idtmod_output &lt; <code><em>offset</em></code>+<code><em>modulus</em></code></pre>

<p>
<a id="pgfId-1034641"></a><span class="webflare-courier-new" style="white-space:pre"><em>abstol</em></span> is a constant explicit absolute tolerance that applies to the input of the <code>idtmod</code> operator. Set <span class="webflare-courier-new" style="white-space:pre"><em>abstol</em></span> at the largest signal level that you consider negligible.</p>
<p>
<a id="pgfId-1034639"></a><span class="webflare-courier-new" style="white-space:pre"><em>nature</em></span> is a nature from which the absolute tolerance is to be derived.</p>
<p>
<a id="pgfId-1034632"></a>The circular integrator operator is subject to the restrictions listed in <a href="chap9.html#27794">&#8220;Restrictions on Using Analog Operators&#8221;</a>.</p>
<p>
<a id="pgfId-1032552"></a>The value returned by the <code>idtmod</code> operator depends on which parameters you specify.</p>

<p>
<a id="pgfId-1095299"></a></p>
<table class="webflareTable" id="#id1032553">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1032555">
<a id="pgfId-1032555"></a>If you specify</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1032557">
<a id="pgfId-1032557"></a>Then idtmod returns</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032559"></a><span class="webflare-courier-new" style="white-space:pre"><em>expr</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1170357"></a><img width="142" height="50" src="images/chap9-12.gif" /></p>
<p>
<a id="pgfId-1092160"></a>The time-integral of <span class="webflare-courier-new" style="white-space:pre"><em>expr</em></span> from 0 to <span class="webflare-courier-new" style="white-space:pre"><em>t</em></span> with the initial condition being computed in the DC analysis. Returns <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span>.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032566"></a><span class="webflare-courier-new" style="white-space:pre"><em>expr</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1170376"></a><img width="168" height="46" src="images/chap9-13.gif" /></p>
<p>
<a id="pgfId-1092163"></a>The time-integral of <span class="webflare-courier-new" style="white-space:pre"><em>expr</em></span><em> </em>from 0 to <span class="webflare-courier-new" style="white-space:pre"><em>t</em></span> with initial condition <span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span>. In DC or IC analysis, returns <span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span>; otherwise, returns<em> </em><span class="webflare-courier-new" style="white-space:pre"><em>x</em></span><em>.</em></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032573"></a><span class="webflare-courier-new" style="white-space:pre"><em>expr</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>modulus</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1170399"></a><img width="168" height="46" src="images/chap9-14.gif" /></p>
<p>
<a id="pgfId-1092166"></a>where <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> <code>=</code> <span class="webflare-courier-new" style="white-space:pre"><em>n</em></span><code>*</code><span class="webflare-courier-new" style="white-space:pre"><em>modulus</em></span> <code>+</code> <span class="webflare-courier-new" style="white-space:pre"><em>k<br />n</em></span> <code>=</code> ... -3, -2, -1, 0, 1, 2, 3 ...<br />Returns <span class="webflare-courier-new" style="white-space:pre"><em>k</em></span> where 0 <code>&lt;</code> <span class="webflare-courier-new" style="white-space:pre"><em>k</em></span> <code>&lt;</code> <span class="webflare-courier-new" style="white-space:pre"><em>modulus</em></span></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032581"></a><span class="webflare-courier-new" style="white-space:pre"><em>expr</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>modulus</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>offset</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1170417"></a><img width="168" height="46" src="images/chap9-15.gif" /></p>
<p>
<a id="pgfId-1092168"></a>where <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> <code>=</code> <span class="webflare-courier-new" style="white-space:pre"><em>n</em></span><code>*</code><span class="webflare-courier-new" style="white-space:pre"><em>modulus</em></span> <code>+</code> <span class="webflare-courier-new" style="white-space:pre"><em>k<br /></em></span>Returns <span class="webflare-courier-new" style="white-space:pre"><em>k</em></span> where <span class="webflare-courier-new" style="white-space:pre"><em>offset</em></span> <code>&lt;</code> <span class="webflare-courier-new" style="white-space:pre"><em>k</em></span> <code>&lt;</code> <span class="webflare-courier-new" style="white-space:pre"><em>offset</em></span> <code>+</code> <span class="webflare-courier-new" style="white-space:pre"><em>modulus</em></span></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1034648"></a><span class="webflare-courier-new" style="white-space:pre"><em>expr</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>modulus</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>offset, abstol</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1170435"></a><img width="168" height="46" src="images/chap9-16.gif" /></p>
<p>
<a id="pgfId-1092170"></a>where <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> <code>=</code> <span class="webflare-courier-new" style="white-space:pre"><em>n</em></span><code>*</code><span class="webflare-courier-new" style="white-space:pre"><em>modulus</em></span> <code>+</code> <span class="webflare-courier-new" style="white-space:pre"><em>k<br /></em></span>Returns <span class="webflare-courier-new" style="white-space:pre"><em>k</em></span> where <span class="webflare-courier-new" style="white-space:pre"><em>offset</em></span> <code>&lt;</code> <span class="webflare-courier-new" style="white-space:pre"><em>k</em></span> <code>&lt;</code> <span class="webflare-courier-new" style="white-space:pre"><em>offset</em></span> <code>+</code> <span class="webflare-courier-new" style="white-space:pre"><em>modulus</em></span></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1034656"></a><span class="webflare-courier-new" style="white-space:pre"><em>expr</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>modulus</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>offset, nature</em></span></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1170453"></a><img width="168" height="46" src="images/chap9-17.gif" /></p>
<p>
<a id="pgfId-1092172"></a>where <span class="webflare-courier-new" style="white-space:pre"><em>x</em></span> <code>=</code> <span class="webflare-courier-new" style="white-space:pre"><em>n</em></span><code>*</code><span class="webflare-courier-new" style="white-space:pre"><em>modulus</em></span> <code>+</code> <span class="webflare-courier-new" style="white-space:pre"><em>k<br /></em></span>Returns <span class="webflare-courier-new" style="white-space:pre"><em>k</em></span> where <span class="webflare-courier-new" style="white-space:pre"><em>offset</em></span> <code>&lt;</code> <span class="webflare-courier-new" style="white-space:pre"><em>k</em></span> <code>&lt;</code> <span class="webflare-courier-new" style="white-space:pre"><em>offset</em></span> <code>+</code> <span class="webflare-courier-new" style="white-space:pre"><em>modulus</em></span></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1035240"></a>The initial condition forces the DC solution to the system. You must specify the initial condition, <span class="webflare-courier-new" style="white-space:pre"><em>ic</em></span>, unless you are using <code>idtmod</code> in a system with feedback that forces <span class="webflare-courier-new" style="white-space:pre"><em>expr</em></span> to zero. If you use a model in a feedback configuration, you can leave out the initial condition without any unexpected behavior during simulation.</p>

<h4>
<a id="pgfId-1032590"></a>Exam<a id="marker-1032589"></a><a id="marker-1134490"></a>ple</h4>

<p>
<a id="pgfId-1170627"></a>The circular integrator is useful in cases where the integral can get very large, such as in a voltage controlled oscillator (<a href="glossary.html#83156">VCO</a>). For example, you might use the following approach to generate arguments in the range [0,2] for the sinusoid.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032592"></a>phase = idtmod(fc + gain*V(IN), 0, 1, 0); //Phase is in range [0,1].<br />V(OUT) &lt;+ sin(2*PI*phase);</pre>
<h3>
<a id="pgfId-1142677"></a>Derivative Operator</h3>

<p>
<a id="pgfId-1142678"></a>Use the <code>ddx</code> operator to access symbolically-computed partial derivatives of expressions in the analog block. </p>

<pre class="webflare-courier-new">
<a id="pgfId-1142683"></a><strong>ddx</strong> <strong>(</strong><code><em>expr</em></code><strong>,</strong> <code><em>potential_access_id</em></code> <strong>(</strong><code><em>net_or_port_scalar_expr</em></code><strong>))<br />ddx (</strong><code><em>expr</em></code><strong>,</strong> <code><em>flow_access_id</em></code> <strong>(</strong><code><em>branch_id</em></code><strong>))</strong></pre>

<p>
<a id="pgfId-1142684"></a><span class="webflare-courier-new" style="white-space:pre"><em>expr</em></span> is a real or integer value expression. The derivative operator returns the partial derivative of this argument with respect to the unknown indicated by the second argument, with all other unknowns held constant and evaluated at the current operating point. If <span class="webflare-courier-new" style="white-space:pre"><em>expr</em></span> does not depend explicitly on the unknown, the derivative operator returns zero. The <span class="webflare-courier-new" style="white-space:pre"><em>expr</em></span> argument:</p>
<ul><li>
<a id="pgfId-1154970"></a>Cannot be a dynamic expression, such as <code>ddx(ddt(...), ...)</code></li><li>
<a id="pgfId-1154972"></a>Cannot be a nested expression, such as <code>ddx(ddx(...), ...)</code></li><li>
<a id="pgfId-1154973"></a>Cannot include symbolically calculated expressions, such as <code>ddx(transition(...), ...)</code></li><li>
<a id="pgfId-1154974"></a>Cannot include arrays, such as <code>ddx(a[0], ...)</code></li><li>
<a id="pgfId-1154975"></a>Cannot contain unknown variables in the system of equations, such as <code>ddx(V(a), ...)</code></li><li>
<a id="pgfId-1154976"></a>Cannot contain quantities that depend on other quantities, such as: <code>I(a,b)&lt;+g*V(a,b); ddx(I(a,b), V(a))</code></li></ul>





<p>
<a id="pgfId-1142691"></a><span class="webflare-courier-new" style="white-space:pre"><em>potential_access_id</em></span> is the access operator for the potential of a scalar net or port.</p>
<p>
<a id="pgfId-1142692"></a><span class="webflare-courier-new" style="white-space:pre"><em>net_or_port_scalar_expr</em></span> is a scalar net or port.</p>
<p>
<a id="pgfId-1142693"></a><span class="webflare-courier-new" style="white-space:pre"><em>flow_access_id</em></span> is the access operator for the flow through a branch.</p>
<p>
<a id="pgfId-1142694"></a><span class="webflare-courier-new" style="white-space:pre"><em>branch_id</em></span> is the name of a branch.</p>
<p>
<a id="pgfId-1142738"></a>The derivative operator is subject to the restrictions listed in <a href="chap9.html#27794">&#8220;Restrictions on Using Analog Operators&#8221;</a>.</p>

<h4>
<a id="pgfId-1142711"></a>Example</h4>

<p>
<a id="pgfId-1142731"></a>This example implements a voltage-controlled dependent current source. The names of the variables indicate the values of the partial derivatives: <code>+1</code>, <code>-1</code>, or <code>0</code>. These values (scaled by the parameter <code>k</code>) can be used in a Newton-Raphson solution.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1142714"></a>module vccs(pout,nout,pin,nin);
&#160;&#160;&#160;&#160;electrical pout, nout, pin, nin;
&#160;&#160;&#160;&#160;inout pout, nout, pin, nin;
&#160;&#160;&#160;&#160;parameter real k = 1.0;
&#160;&#160;&#160;&#160;real vin, one, minusone, zero;
&#160;&#160;&#160;&#160;analog begin
&#160;&#160;&#160;&#160; vin = V(pin,nin);<br />  one = ddx(vin, V(pin));<br />  minusone = ddx(vin, V(nin));<br />  zero = ddx(vin, V(pout));<br />  I(pout,nout) &lt;+ k * vin;<br /> end<br />endmodule</pre>
<h3>
<a id="pgfId-1032594"></a><a id="marker-1134378"></a><a id="36934"></a>Delay Operator</h3>

<p>
<a id="pgfId-1032598"></a>Use the<a id="marker-1032595"></a> <code>absdelay</code> operator to delay the entire signal of a continuously valued waveform.<a id="marker-1032596"></a><a id="marker-1032597"></a></p>

<pre class="webflare-courier-new">
<a id="pgfId-1032599"></a><strong>absdelay(</strong> <code><em>expr</em></code> <strong>,</strong> <code><em>time_delay</em></code> [ <strong>,</strong> <code><em>max_delay</em></code> ] <strong>)</strong></pre>

<p>
<a id="pgfId-1032600"></a><span class="webflare-courier-new" style="white-space:pre"><em>expr</em></span> is a dynamic expression to be delayed. </p>
<p>
<a id="pgfId-1034663"></a><span class="webflare-courier-new" style="white-space:pre"><em>time_delay</em></span>, a dynamic nonnegative value, is the length of the delay. If you specify <span class="webflare-courier-new" style="white-space:pre"><em>max_delay</em></span>, you can change the value of <span class="webflare-courier-new" style="white-space:pre"><em>time_delay</em></span> during a simulation, as long as the value remains in the range 0 &lt; <span class="webflare-courier-new" style="white-space:pre"><em>time_delay</em></span> &lt; <span class="webflare-courier-new" style="white-space:pre"><em>max_delay</em></span>. Typically <span class="webflare-courier-new" style="white-space:pre"><em>time_delay</em></span> is a constant but can also vary with time (when <span class="webflare-courier-new" style="white-space:pre"><em>max_delay</em></span> is defined).</p>
<p>
<a id="pgfId-1034667"></a><span class="webflare-courier-new" style="white-space:pre"><em>max_delay</em></span> is a constant nonnegative number greater than or equal to <span class="webflare-courier-new" style="white-space:pre"><em>time_delay</em></span>. You cannot change <span class="webflare-courier-new" style="white-space:pre"><em>max_delay</em></span> because the simulator ignores any attempted changes and continues to use the initial value.</p>
<p>
<a id="pgfId-1035634"></a>For example, to delay an input voltage you might code</p>

<pre class="webflare-courier-new">
<a id="pgfId-1035635"></a>V(out) &lt;+ absdelay(V(in), 5u) ;</pre>

<p>
<a id="pgfId-1035632"></a>The <code>absdelay</code> operator is subject to the restrictions listed in <a href="chap9.html#27794">&#8220;Restrictions on Using Analog Operators&#8221;</a>.</p>
<p>
<a id="pgfId-1034762"></a>In DC and operating analyses, the <code>absdelay</code> operator returns the value of <span class="webflare-courier-new" style="white-space:pre"><em>expr</em></span> unchanged. In time-domain analyses, the <code>absdelay</code> operator introduces a transport delay equal to the instantaneous value of <span class="webflare-courier-new" style="white-space:pre"><em>time_delay</em></span> based on the following formula.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1035629"></a>Output(t) = Input(max(t-time_delay, 0))</pre>
<h3>
<a id="pgfId-1032608"></a><a id="20376"></a>Transition Filter</h3>

<p>
<a id="pgfId-1032612"></a>Use the<a id="marker-1032609"></a> <code>transition</code> filter to smooth piecewise constant waveforms, such as digital logic waveforms. The <code>transition</code><a id="marker-1032610"></a><a id="marker-1032611"></a> filter returns a real number that over time describes a piecewise linear waveform. The <code>transition</code> filter also causes the simulator to place time points at both corners of a transition to assure that each transition is adequately resolved.<a id="marker-1032613"></a></p>

<pre class="webflare-courier-new">
<a id="pgfId-1032614"></a><strong>transition(</strong><code><em>input</em></code> [<strong>,</strong> <code><em>delay</em></code> [<strong>,</strong> <code><em>rise_time</em></code> [<strong>,</strong> <code><em>fall_time</em></code> [<strong>,</strong> <code><em>time_tol</em></code> ]]]]<strong>)</strong></pre>

<p>
<a id="pgfId-1089568"></a><span class="webflare-courier-new" style="white-space:pre"><em>input</em></span> is a dynamic input expression that describes a piecewise constant waveform. It must have a real value. In DC analysis, the <code>transition</code> filter simply returns the value of <span class="webflare-courier-new" style="white-space:pre"><em>input</em></span>. Changes in <span class="webflare-courier-new" style="white-space:pre"><em>input</em></span> do not have an effect on the output value until <span class="webflare-courier-new" style="white-space:pre"><em>delay</em></span> seconds have passed. </p>
<p>
<a id="pgfId-1032616"></a><span class="webflare-courier-new" style="white-space:pre"><em>delay</em></span> is a dynamic nonnegative real value that is an initial delay. By default, <span class="webflare-courier-new" style="white-space:pre"><em>delay</em></span> has a value of zero. </p>
<p>
<a id="pgfId-1043582"></a><span class="webflare-courier-new" style="white-space:pre"><em>rise_time</em></span> is a dynamic positive real value specifying the time over which you want positive transitions to occur. If you do not specify <span class="webflare-courier-new" style="white-space:pre"><em>rise_time</em></span> or if you give <span class="webflare-courier-new" style="white-space:pre"><em>rise_time</em></span> a value of 0, <span class="webflare-courier-new" style="white-space:pre"><em>rise_time</em></span> defaults to the value defined by <code>&#8216;default_transition</code>.</p>
<p>
<a id="pgfId-1043584"></a><span class="webflare-courier-new" style="white-space:pre"><em>fall_time</em></span> is a dynamic positive real number specifying the time over which you want negative transitions to occur. By default, <span class="webflare-courier-new" style="white-space:pre"><em>fall_time</em></span> has the same value that <span class="webflare-courier-new" style="white-space:pre"><em>rise_time</em></span> has. If you do not specify <span class="webflare-courier-new" style="white-space:pre"><em>rise_time</em></span> or if you give <span class="webflare-courier-new" style="white-space:pre"><em>rise_time</em></span> a value of 0, <span class="webflare-courier-new" style="white-space:pre"><em>fall_time</em></span> defaults to the value defined by <code>&#8216;default_transition</code>.</p>
<p>
<a id="pgfId-1097095"></a><span class="webflare-courier-new" style="white-space:pre"><em>time_tol</em></span> is a constant expression with a positive value. This option requires the simulator to place time points no more than the value of <span class="webflare-courier-new" style="white-space:pre"><em>time_tol</em></span> away from the two corners of the transition.</p>
<p>
<a id="pgfId-1043585"></a>If<code> &#8216;default_transition</code> is not specified, the default behavior of the <code>transition</code> filter approximates the ideal behavior of a zero-duration transition.</p>
<p>
<a id="pgfId-1032622"></a>The <code>transition</code> filter is subject to the restrictions listed in <a href="chap9.html#27794">&#8220;Restrictions on Using Analog Operators&#8221;</a>.</p>
<p>
<a id="pgfId-1035561"></a>With the <code>transition</code> filter, you can control transitions between discrete signal levels by setting the rise time and fall time of signal transitions. The <code>transition</code> filter stretches instantaneous changes in signals over a finite amount of time, as shown below, and can also delay the transitions.</p>

<p>
<a id="pgfId-1035565"></a></p>
<div class="webflare-div-image">
<img width="421" height="189" src="images/chap9-18.gif" /></div>

<p>
<a id="pgfId-1035562"></a>Use short transitions with caution because they can cause the simulator to slow down to meet accuracy constraints. </p>
<p>
<a id="pgfId-1032682"></a>The next code fragment demonstrates how the <code>transition</code> filter might be used.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032684"></a>// <a id="marker-1032683"></a>comparator model
analog begin
&#160;&#160;&#160;&#160;if ( V(in) &gt; 0 ) begin
&#160;&#160;&#160;&#160;    Vout = 5 ;
&#160;&#160;&#160;&#160;    end 
&#160;&#160;&#160;&#160;else begin
&#160;&#160;&#160;&#160;    Vout = 0 ;
&#160;&#160;&#160;&#160;end
&#160;&#160;&#160;&#160;V(out) &lt;+ transition(Vout) ;<br />end</pre>
<div class="webflare-information-macro webflare-macro-warning">
<a id="pgfId-1032686"></a>
The <code>transition</code><a id="marker-1032685"></a> filter is designed to smooth out piecewise constant waveforms. If you apply the <code>transition</code> filter to smoothly varying waveforms, the simulator might run slowly, and the results will probably be unsatisfactory. For smoothly varying waveforms, consider using the <code>slew</code> filter instead. For information, see <a href="chap9.html#32642">&#8220;Slew Filter&#8221;</a>.</div>

<p>
<a id="pgfId-1032690"></a>If interrupted on a rising transition, the <code>transition</code> filter adjusts the slope so that at the revised end of the transition the value is that of the new destination.</p>
<table class="webflareTable" id="#id1032691">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1035452">
<a id="pgfId-1035452"></a>If the new destination value is <em>below</em> the value at the point of interruption, the <code>transition</code> filter</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1035454">
<a id="pgfId-1035454"></a>If the new destination value is <em>above</em> the value at the point of interruption, the <code>transition</code> filter</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">

<ol><li>
<a id="pgfId-1035456"></a>Uses the value of the original destination as the value of the new origin.</li><li>
<a id="pgfId-1035457"></a>Adjusts the slope of the transition to the rate at which the value would decay from the value of the new origin to the value of the new destination in <code>fall_time</code> seconds.</li><li>
<a id="pgfId-1035458"></a>Causes the value of the filter output to decay at the new slope, from the value at the point of interruption to the value at the new destination.</li></ol>



</td>
<td class="webflareTd" colspan="1" rowspan="1">

<ol><li>
<a id="pgfId-1035460"></a>Retains the original origin.</li><li>
<a id="pgfId-1035461"></a>Adjusts the slope of the transition to the rate at which the value would increase from the value of the origin to the value of the new destination in <code>rise_time</code> seconds.</li><li>
<a id="pgfId-1035462"></a>Causes the value of the filter output to increase at the new slope, from the value at the point of interruption to the value at the new destination.</li></ol>



</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">

<p>
<a id="pgfId-1035464"></a></p>

</td>
<td class="webflareTd" colspan="1" rowspan="1">

<p>
<a id="pgfId-1035466"></a></p>

</td>
</tr>
</tbody></table>
<p>
<a id="pgfId-1032708"></a>In the following example, a rising transition is interrupted when it is about three fourths complete, and the value of the new destination is below the value at the point of interruption. The <code>transition</code> filter computes the slope that would complete a transition from the new origin (not the value at the point of interruption) in the specified <span class="webflare-courier-new" style="white-space:pre"><em>fall_time</em></span>. The <code>transition</code> filter then uses the computed slope to transition from the current value to the new destination. </p>

<p>
<a id="pgfId-1035467"></a></p>
<div class="webflare-div-image">
<img width="454" height="190" src="images/chap9-20.gif" /></div>

<p>
<a id="pgfId-1032754"></a>An interruption in a falling transition causes the transition filter to behave in an equivalent manner. </p>
<p>
<a id="pgfId-1032755"></a>With larger delays, it is possible for a new transition to be specified before a previously specified transition starts. The <code>transition</code> filter handles this by deleting any transitions that would follow a newly scheduled transition. A <code>transition</code> filter can have an arbitrary number of transitions pending. You can use a <code>transition</code> filter in this way to implement the transport delay of discretely valued signals.</p>
<p>
<a id="pgfId-1032756"></a>The following example implements a D-type flip flop. The <code>transition</code> filter smooths the output waveforms.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032757"></a>module d_ff(vin_d, vclk, vout_q, vout_qbar) ;<br />input vclk, vin_d ;<br />output vout_q, vout_qbar ;<br />electrical vout_q, vout_qbar, vclk, vin_d ;<br />parameter real vlogic_high = 5 ;<br />parameter real vlogic_low = 0 ;<br />parameter real vtrans_clk = 2.5 ;<br />parameter real vtrans = 2.5 ;<br />parameter real tdel = 3u from [0:inf) ;<br />parameter real trise = 1u from (0:inf) ;<br />parameter real tfall = 1u from (0:inf) ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051493"></a>integer x ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051495"></a>analog begin
&#160;&#160;&#160;&#160;@ (cross( V(vclk) - vtrans_clk, +1 )) x = (V(vin_d) &gt; vtrans) ;
&#160;&#160;&#160;&#160;V(vout_q) &lt;+ transition( vlogic_high*x + vlogic_low*!x,tdel, trise, tfall );
&#160;&#160;&#160;&#160;V(vout_qbar) &lt;+ transition( vlogic_high*!x + vlogic_low*x, tdel, 
&#160;&#160;&#160;&#160;                                                trise, tfall ) ;
&#160;&#160;&#160;&#160;end</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051497"></a>endmodule</pre>

<p>
<a id="pgfId-1032758"></a>The following example illustrates a use of the <code>transition</code> filter that should be avoided. The expression is dependent on a continuous signal and, as a consequence, the filter runs slowly.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032759"></a>I(p, n) &lt;+ transition(V(p, n)/out1, tdel, trise, tfall);&#160;&#160;   // Do not do this.</pre>

<p>
<a id="pgfId-1032760"></a>However, you can use the following approach to implement the same behavior in a statement that runs much faster.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032761"></a>I(p, n) &lt;+ V(p, n) * transition(1/out1, tdel, trise, tfall); // Do this instead.</pre>
<h3>
<a id="pgfId-1032763"></a><a id="32642"></a>Slew Filter</h3>

<p>
<a id="pgfId-1032767"></a>Use the <code>slew</code><a id="marker-1032764"></a> filter to control the rate of change of a waveform. A typical use for <code>slew</code><a id="marker-1032765"></a><a id="marker-1032766"></a> is generating continuous signals from piecewise continuous signals. For discrete signals, consider using the <code>transition</code> filter instead. See <a href="chap9.html#20376">&#8220;Transition Filter&#8221;</a> for more information.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032771"></a><strong>slew(</strong><code><em>input</em></code> [ <strong>,</strong> <code><em>max_pos_rate</em></code> [ <strong>,</strong> <code><em>max_neg_rate</em></code> ] ] <strong>)</strong></pre>

<p>
<a id="pgfId-1035663"></a><span class="webflare-courier-new" style="white-space:pre"><em>input</em></span> is a dynamic expression with a real value. In DC analysis, the <code>slew</code> filter simply returns the value of <span class="webflare-courier-new" style="white-space:pre"><em>input</em></span>.</p>
<p>
<a id="pgfId-1034751"></a><span class="webflare-courier-new" style="white-space:pre"><em>max_pos_rate</em></span> is a dynamic real number greater than zero, which is the maximum positive slew rate.</p>
<p>
<a id="pgfId-1034752"></a><span class="webflare-courier-new" style="white-space:pre"><em>max_neg_rate</em></span> is a dynamic real number less than zero, which is the maximum negative slew rate.</p>
<p>
<a id="pgfId-1032773"></a>If you specify only one rate, its absolute value is used for both rates. If you give no rates, slew passes the signal through unchanged. If the rate of change of <span class="webflare-courier-new" style="white-space:pre"><em>input</em></span> is less than the specified maximum slew rates, <code>slew</code> returns the value of <span class="webflare-courier-new" style="white-space:pre"><em>input</em></span>.</p>
<p>
<a id="pgfId-1032774"></a>The <code>slew</code> filter is subject to the restrictions listed in <a href="chap9.html#27794">&#8220;Restrictions on Using Analog Operators&#8221;</a>.</p>
<p>
<a id="pgfId-1032778"></a>When applied, <code>slew</code> forces all transitions of <span class="webflare-courier-new" style="white-space:pre"><em>expr</em></span> faster than <span class="webflare-courier-new" style="white-space:pre"><em>max_pos_rate</em></span> to change at the <span class="webflare-courier-new" style="white-space:pre"><em>max_pos_rate</em></span> rate for positive transitions and limits negative transitions to the <span class="webflare-courier-new" style="white-space:pre"><em>max_neg_rate</em></span> rate.</p>

<p>
<a id="pgfId-1035469"></a></p>
<div class="webflare-div-image">
<img width="411" height="106" src="images/chap9-21.gif" /></div>

<p>
<a id="pgfId-1032795"></a>The <code>slew</code> filter is particularly valuable for controlling the rate of change of sinusoidal waveforms. The <code>transition</code><a id="marker-1032796"></a> function distorts such signals, whereas <code>slew</code> preserves the general shape of the waveform. The following 4-bit digital-to-analog converter uses the <code>slew</code><a id="marker-1032797"></a> function to control the rate of change of the analog signal at its output. </p>

<pre class="webflare-courier-new">
<a id="pgfId-1034150"></a>module dac4(d, out) ;<br />input [0:3] d ;<br />inout out ; <br />electrical [0:3] d ;<br />electrical out ; <br />parameter real slewrate = 0.1e6 from (0:inf) ; </pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051499"></a> real Ti ; <br /> real Vref ;<br /> real scale_fact ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051501"></a> analog begin <br />     Ti = 0 ; <br />     Vref = 1.0 ;<br />     scale_fact = 2 ;<br />     generate ii (3,0,-1) begin<br />         Ti = Ti + ((V(d[ii]) &gt; 2.5) ? (1.0/scale_fact) : 0);<br />         scale_fact = scale_fact/2 ;<br />     end<br />     V(out) &lt;+ slew( Ti*Vref, slewrate ) ;<br /> end<br />endmodule</pre>
<h3>
<a id="pgfId-1032800"></a><a id="marker-1134384"></a><a id="12971"></a>Implementing Laplace Transform S-Domain Filters</h3>

<p>
<a id="pgfId-1067085"></a>The Laplace transform filters implement lumped linear continuous-time filters. Each filter accepts an optional absolute tolerance parameter , which this release of Verilog-AMS ignores. The set of array values that are used to define the poles and zeros, or numerator and denominator, of a filter the first time it is used during an analysis are used at all subsequent time points of the analysis. As a result, changing array values during an analysis has no effect on the filter.</p>
<p>
<a id="pgfId-1070603"></a>The Laplace transform filters are subject to the restrictions listed in <a href="chap9.html#27794">&#8220;Restrictions on Using Analog Operators&#8221;</a>. However, while most analog functions can be used, with certain restrictions, in <code>if</code> or <code>case</code> constructs, the Laplace transform filters cannot be used in <code>if</code> or <code>case</code> constructs in any circumstances.</p>

<h4><em>
<a id="pgfId-1067204"></a><a id="marker-1134386"></a>Arguments Represented as Vectors</em></h4>

<p>
<a id="pgfId-1067319"></a>If you use an argument represented as a vector to define a numerator in a Laplace filter, and if one or more of the elements in the vector are 0, the order of the numerator is determined by the <em>position</em> of the rightmost non-zero vector element. For example, in the following module, the order of the numerator, <code>nn</code>, is 1</p>

<pre class="webflare-courier-new">
<a id="pgfId-1067207"></a>module test(pin, nin, pout, nout);<br />electrical pin, nin, pout, nout;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1067208"></a>real nn[0:2];<br />real dd[0:2];</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1067209"></a>analog begin
&#160;&#160;&#160;&#160;@(initial_step) begin
&#160;&#160;&#160;&#160;    nn[0] = 1;// The highest order non-zero coefficient of the numerator.
&#160;&#160;&#160;&#160;    nn[1] = 0;
&#160;&#160;&#160;&#160;    nn[2] = 0;
&#160;&#160;&#160;&#160;    dd[0] = 1;
&#160;&#160;&#160;&#160;    dd[1] = 1;
&#160;&#160;&#160;&#160;    dd[2] = 1;
&#160;&#160;&#160;&#160;end
&#160;&#160;&#160;&#160;V(pout, nout) &lt;+ laplace_nd(V(pin,nin), nn, dd);<br />end<br />endmodule</pre>
<h4><em>
<a id="pgfId-1067184"></a><a id="marker-1134388"></a>Arguments Represented as Arrays</em></h4>

<p>
<a id="pgfId-1067151"></a>If you use an argument represented as an array constant to define a numerator in a Laplace filter, and if one or more of the elements in the array constant are 0, the order of the numerator is determined by the <em>position</em> of the rightmost non-zero array element. For example, if your numerator array constant is {1,0,0}, the order of the numerator is 1. If your array constant is {1,0,1}, the order of the numerator is 3. In the following example, the numerator order is 1 (and the value is 1).</p>

<pre class="webflare-courier-new">
<a id="pgfId-1067196"></a>module test(pin, nin, pout, nout);<br />electrical pin, nin, pout, nout;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1067197"></a>analog begin
&#160;&#160;&#160;&#160;V(pout, nout) &lt;+ laplace_nd(V(pin,nin), {1,0,0}, {1,1,1});<br />end<br />endmodule</pre>

<p>
<a id="pgfId-1166468"></a>Array literals used for the Laplace transforms can also take the form that uses a back tic. For example,</p>

<pre class="webflare-courier-new">
<a id="pgfId-1166469"></a>V(out) &lt;+ laplace_nd(&#8216;{5,6},&#8216;{7.8,9.0});</pre>
<h4>
<a id="pgfId-1032806"></a><a id="marker-1134390"></a>Zero-Pole Laplace Transforms</h4>

<p>
<a id="pgfId-1032809"></a>Use <code>laplace_zp</code><a id="marker-1032807"></a> to implement the zero-pole form of the Laplace transform filter. <a id="marker-1032808"></a></p>

<pre class="webflare-courier-new">
<a id="pgfId-1032810"></a><strong>laplace_zp(</strong><code><em>expr</em></code><strong>,</strong> <strong>,</strong>  [ <strong>,</strong>  ]<strong>)</strong></pre>

<p>
<a id="pgfId-1035253"></a> (zeta) is a fixed-sized vector of M pairs of real numbers. Each pair represents a zero. The first number in the pair is the real part of the zero, and the second is the imaginary part.  (rho) is a fixed-sized vector of N real pairs, one for each pole. Specify the poles in the same manner as the zeros. If you use array literals to define the  and  vectors, the values must be constant or dependent upon parameters only. You cannot use array literal values defined by variables.</p>
<p>
<a id="pgfId-1034769"></a>The transfer function is</p>

<p>
<a id="pgfId-1169650"></a><img width="224" height="171" src="images/chap9-22.gif" /></p>

<p>
<a id="pgfId-1034785"></a>where <img width="21" height="39" src="images/chap9-23.gif" /><span> and </span><img width="21" height="35" src="images/chap9-24.gif" /><span> are the real and imaginary parts of the </span><img width="26" height="27" src="images/chap9-25.gif" /><span> zero, and </span><img width="21" height="39" src="images/chap9-26.gif" /><span> and </span><img width="22" height="35" src="images/chap9-27.gif" /><span> are the real and imaginary parts of the </span><img width="26" height="27" src="images/chap9-28.gif" /><span> pole. </span></p>

<p>
<a id="pgfId-1032835"></a>If a root (a pole or zero) is real, you must specify the imaginary part as 0. If a root is complex, its conjugate must be present. If a root is zero, the term associated with it is implemented as <span class="webflare-courier-new" style="white-space:pre"><em>s</em></span> rather than <img width="66" height="21" src="images/chap9-29.gif" />
, where <em>r</em></p><h4>
<a id="pgfId-1032839"></a><a id="marker-1134392"></a>Zero-Denominator Laplace Transforms</h4>

<p>
<a id="pgfId-1032842"></a>Use <code>laplace_zd</code><a id="marker-1032840"></a> to implement the <a id="marker-1032841"></a>zero-denominator form of the Laplace transform filter. </p>

<pre class="webflare-courier-new">
<a id="pgfId-1032843"></a><strong>laplace_zd(</strong><code><em>expr</em></code><strong>,</strong><italic>
 
<em></em><strong>,</strong><em> </em><span class="webflare-courier-new" style="white-space:pre"><em>d</em></span> [ <strong>,</strong>  ]<strong>)</strong></italic></pre>

<p>
<a id="pgfId-1032844"></a> (zeta) is a fixed-sized vector of M pairs of real numbers. Each pair represents a zero. The first number in the pair is the real part of the zero, and the second is the imaginary part. <span class="webflare-courier-new" style="white-space:pre"><em>d</em></span> is a fixed-sized vector of N real numbers that contains the coefficients of the denominator. If you use array literals to define the  and <span class="webflare-courier-new" style="white-space:pre"><em>d</em></span> vectors, the values must be constant or dependent upon parameters only. You cannot use array literal values defined by variables.</p>
<p>
<a id="pgfId-1032848"></a>The transfer function is</p>

<p>
<a id="pgfId-1170138"></a><img width="230" height="145" src="images/chap9-30.gif" /></p>

<p>
<a id="pgfId-1032861"></a>where <img width="20" height="39" src="images/chap9-31.gif" /><span> and </span><img width="21" height="35" src="images/chap9-32.gif" /><span> are the real and imaginary parts of the </span><img width="26" height="27" src="images/chap9-33.gif" /><span> zero, and </span><img width="20" height="29" src="images/chap9-34.gif" /><span> is the coefficient of the </span><img width="26" height="27" src="images/chap9-35.gif" /><span> power of </span></p>
<span class="webflare-courier-new" style="white-space:pre"><em>s</em></span><span class="webflare-courier-new" style="white-space:pre"><em>s</em></span><span> rather than </span><img width="68" height="21" src="images/chap9-36.gif" /><span>.</span><h4>
<a id="pgfId-1032868"></a><a id="marker-1134394"></a>Numerator-Pole Laplace Transforms</h4>

<p>
<a id="pgfId-1032871"></a>Use <code>laplace_np</code><a id="marker-1032869"></a> to implement the<a id="marker-1032870"></a> numerator-pole form of the Laplace transform filter. </p>

<pre class="webflare-courier-new">
<a id="pgfId-1032872"></a><strong>laplace_np(</strong><code><em>expr</em></code><strong>,</strong> <code><em>n</em></code><strong>,</strong><italic>
 
<em></em> [ <strong>,</strong>  ]<strong>)</strong></italic></pre>

<p>
<a id="pgfId-1032873"></a><span class="webflare-courier-new" style="white-space:pre"><em>n</em></span> is a fixed-sized vector of M real numbers that contains the coefficients of the numerator.  (rho) is a fixed-sized vector of N pairs of real numbers. Each pair represents a pole. The first number in the pair is the real part of the pole, and the second is the imaginary part. If you use array literals to define the <span class="webflare-courier-new" style="white-space:pre"><em>n</em></span> and  vectors, the array values must be constant or dependent upon parameters only. You cannot use array values defined by variables.</p>
<p>
<a id="pgfId-1032877"></a>The transfer function is</p>

<p>
<a id="pgfId-1170156"></a><img width="227" height="141" src="images/chap9-37.gif" /></p>

<p>
<a id="pgfId-1032890"></a>where <img width="20" height="29" src="images/chap9-38.gif" /><span> is the coefficient of the </span><img width="26" height="27" src="images/chap9-39.gif" /><span> power of </span></p>
<span class="webflare-courier-new" style="white-space:pre"><em>s</em></span><img width="21" height="39" src="images/chap9-40.gif" /><span> and </span><img width="22" height="36" src="images/chap9-41.gif" /><span> are the real and imaginary parts of the </span><img width="26" height="27" src="images/chap9-42.gif" /><span> pole. If a pole is real, you must specify the imaginary part as 0. If a pole is complex, its conjugate must be present. If a pole is zero, the term associated with it is implemented as </span><span class="webflare-courier-new" style="white-space:pre"><em>s</em></span><span> rather than </span><img width="69" height="21" src="images/chap9-43.gif" /><span>.</span><h4>
<a id="pgfId-1032897"></a><a id="marker-1134396"></a>Numerator-Denominator Laplace Transforms</h4>

<p>
<a id="pgfId-1032900"></a>Use <code>laplace_nd</code><a id="marker-1032898"></a> to implement the numerator-denominator form of the Laplace transform filter. <a id="marker-1032899"></a></p>

<pre class="webflare-courier-new">
<a id="pgfId-1032901"></a><strong>laplace_nd(</strong><code><em>expr</em></code><strong>,</strong> <code><em>n</em></code><strong>,</strong> <code><em>d</em></code> [ <strong>,</strong>  ]<strong>)</strong></pre>

<p>
<a id="pgfId-1032902"></a><span class="webflare-courier-new" style="white-space:pre"><em>n</em></span> is a fixed-sized vector of M real numbers that contains the coefficients of the numerator, and <span class="webflare-courier-new" style="white-space:pre"><em>d</em></span> is a fixed-sized vector of N real numbers that contains the coefficients of the denominator. If you use array literals to define the <span class="webflare-courier-new" style="white-space:pre"><em>n</em></span> and <span class="webflare-courier-new" style="white-space:pre"><em>d</em></span> vectors, the values must be constant or dependent upon parameters only. You cannot use array values defined by variables.</p>
<p>
<a id="pgfId-1032906"></a>The transfer function is</p>

<p>
<a id="pgfId-1170173"></a><img width="162" height="148" src="images/chap9-44.gif" /></p>

<p>
<a id="pgfId-1032916"></a>where <img width="20" height="29" src="images/chap9-45.gif" /><span> is the coefficient of the </span><img width="26" height="27" src="images/chap9-46.gif" /><span> power of </span></p>
<span class="webflare-courier-new" style="white-space:pre"><em>s</em></span><img width="20" height="29" src="images/chap9-47.gif" /><span> is the coefficient of the </span><img width="26" height="27" src="images/chap9-48.gif" /><span> power of </span><span class="webflare-courier-new" style="white-space:pre"><em>s</em></span><span> in the denominator.</span><h4>
<a id="pgfId-1032920"></a>Examples</h4>

<p>
<a id="pgfId-1032921"></a>The following code fragments illustrate how to use the Laplace transform filters.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032922"></a>V(out) &lt;+ laplace_zp(V(in), {0,0}, {1,2,1,-2});</pre>

<p>
<a id="pgfId-1032926"></a>implements</p>

<p>
<a id="pgfId-1036619"></a><img width="362" height="67" src="images/chap9-49.gif" /></p>

<p>
<a id="pgfId-1032927"></a>The code fragment</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032928"></a>V(out) &lt;+ laplace_nd(V(in), {0,1}, {1,-0.4,0.2});</pre>

<p>
<a id="pgfId-1032929"></a>is equivalent.</p>
<p>
<a id="pgfId-1167186"></a>The following statement contains an empty vector such that the middle argument is null: </p>

<pre class="webflare-courier-new">
<a id="pgfId-1167187"></a>V(out) &lt;+ laplace_zp(V(in), , {-1,0}); </pre>

<p>
<a id="pgfId-1167188"></a>The absence of zeros, indicated by the null argument, means that the transfer function reduces to the following equation: </p>

<p>
<a id="pgfId-1036630"></a><img width="96" height="41" src="images/chap9-50.gif" /></p>

<p>
<a id="pgfId-1032936"></a>The next module illustrates the use of array literals that depend on parameters. In this code, the array literal <code>{dx,6*dx,5*dx}</code> depends on the value of the parameter <code>dx</code>.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032937"></a>module svcvs_zd(pin, nin, pout, nout);<br />electrical pin, nin, pout, nout;<br />parameter real nx = 0.5;<br />parameter integer dx = 1;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051503"></a>analog begin
&#160;&#160;&#160;&#160;V(pout,nout) &lt;+ laplace_zd(V(pin,nin),{0-nx,0},{dx,6*dx,5*dx});<br />end<br />endmodule</pre>

<p>
<a id="pgfId-1032938"></a>The next fragment illustrates an efficient way to initialize array values. Because only the initial set of array values used by a filter has any effect, this example shows how you can use the <code>initial_step</code> event to set values at the beginning of the specified analyses.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032939"></a>real nn[0:1] ;<br />real dd[0:2] ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051505"></a>analog begin
&#160;&#160;&#160;&#160;@(initial_step(&quot;static&quot;)) begin
&#160;&#160;&#160;&#160;    nn[0] = 1 ;            // These assignment
&#160;&#160;&#160;&#160;    nn[1] = 2 ;            // statements run only
&#160;&#160;&#160;&#160;    dd[0] = 1 ;            // at the beginning of
&#160;&#160;&#160;&#160;    dd[1] = 6 ;            // the analyses.
&#160;&#160;&#160;&#160;end
&#160;&#160;&#160;&#160;V(pout, nout) &lt;+ laplace_nd(V(pin,nin), nn, dd) ;<br />end</pre>

<p>
<a id="pgfId-1032940"></a>When you use this technique, be sure to initialize the arrays at the beginning of each analysis that uses the filter.The <code>static</code> analysis is the dc operating point calculation required by most analyses, including <code>tran</code>, <code>ac</code>, and <code>noise</code>. Initializing the array during the <code>static</code> phase ensures that the array is non-zero as these analyses proceed.</p>
<p>
<a id="pgfId-1032941"></a>The next modules illustrate how you can use an array variable to avoid error messages about using array literals with variable dependencies in the Laplace filters. The first version causes an error message.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032942"></a>// This version does not work.<br />&#8216;include &quot;constants.vams&quot;<br />&#8216;include &quot;disciplines.vams&quot;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051507"></a>module laplace(out, in);<br />inout in, out;<br />electrical in, out;<br />real dummy;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051509"></a> analog begin<br />     dummy = -0.5;<br />     V(out) &lt;+  laplace_zd(V(in), [dummy,0], [1,6,5]);   //Illegal!<br /> end<br />endmodule</pre>

<p>
<a id="pgfId-1032943"></a>The next version works as expected.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032944"></a>// This version works correctly.<br />&#8216;include &quot;constants.vams&quot;<br />&#8216;include &quot;disciplines.vams&quot;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051511"></a>module laplace(out, in);<br />inout in, out;<br />electrical in, out;<br />real dummy;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051513"></a>real nn[0:1];</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051515"></a>analog begin
&#160;&#160;&#160;&#160;dummy = -0.5;
&#160;&#160;&#160;&#160;@(initial_step) begin     // Defines the array variable.
&#160;&#160;&#160;&#160;    nn[0] = dummy;
&#160;&#160;&#160;&#160;    nn[1] = 0;
&#160;&#160;&#160;&#160;end</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051517"></a> V(out) &lt;+  laplace_zd(V(in), nn, [1,6,5]);<br />end<br />endmodule</pre>
<h3>
<a id="pgfId-1032946"></a><a id="marker-1134400"></a><a id="16172"></a>Implementing Z-Transform Filters</h3>

<p>
<a id="pgfId-1032948"></a>The <a id="marker-1032947"></a>Z-transform filters implement linear discrete-time filters. Each filter requires you to specify a parameter <span class="webflare-courier-new" style="white-space:pre"><em>T</em></span>, the sampling period of the filter. A filter with unity transfer function acts like a simple sample-and-hold that samples every <span class="webflare-courier-new" style="white-space:pre"><em>T</em></span> seconds. </p>
<p>
<a id="pgfId-1032949"></a>All Z-transform filters share three common arguments, <span class="webflare-courier-new" style="white-space:pre"><em>T</em></span><italic>
, 
<italic>
, 
and <em>t</em>0<italic>
. 
The <span class="webflare-courier-new" style="white-space:pre"><em>T</em></span> argument specifies the period of the filter and must be positive.  specifies the transition time and must be nonnegative. If you specify a nonzero transition time, the simulator controls the time step to accurately resolve both the leading and trailing corner of the transition. If you do not specify a transition time,  defaults to one unit of time as defined by the<code> &#8216;default_transition</code> compiler directive. If you specify a transition time of 0, the output is abruptly discontinuous. Avoid assigning a Z-filter with 0 transition time directly to a branch because doing so greatly slows the simulation. Finally, <em>t</em>0 specifies the time of the first sample/transition and is also optional. If not given, the first transition occurs at <em>t</em>=0.</italic></italic></italic></p>
<p>
<a id="pgfId-1032950"></a>The values of <span class="webflare-courier-new" style="white-space:pre"><em>T</em></span> and <em>t</em>0 at the first time point in the analysis are stored, and those stored values are used at all subsequent time points. The array values used to define a filter are used at all subsequent time points, so changing array values during an analysis has no effect on the filter.</p>
<p>
<a id="pgfId-1032951"></a>The Z-transform filters are subject to the restrictions listed in <a href="chap9.html#27794">&#8220;Restrictions on Using Analog Operators&#8221;</a>.</p>

<h4>
<a id="pgfId-1091625"></a><a id="marker-1134402"></a>Zero-Pole Z-Transforms</h4>

<p>
<a id="pgfId-1032959"></a>Use <code>zi_zp</code><a id="marker-1032957"></a> to implement the zero-pole form of the Z-transform filter. <a id="marker-1032958"></a></p>

<pre class="webflare-courier-new">
<a id="pgfId-1032960"></a><strong>zi_zp(</strong>expr<strong>,</strong><italic>
 
<em></em><strong>,</strong><em> </em><italic>

<strong>,</strong><italic>
 
<span class="webflare-courier-new" style="white-space:pre"><em>T </em></span>[<em> </em><strong>,</strong><em>  </em>[<em> </em><strong>,</strong><em> </em><italic>
t
<em>0</em>] ]<strong>)</strong></italic></italic></italic></italic></pre>

<p>
<a id="pgfId-1032961"></a> (zeta) is a fixed or parameter-sized vector of M pairs of real numbers. Each pair represents a zero. The first number in the pair is the real part of the zero, and the second is the imaginary part.  (rho) is a fixed or parameter-sized vector of N real pairs, one for each pole. The poles are given in the same manner as the zeros. If you use array literals to define the  and  vectors, the values must be constant or dependent upon parameters only. You cannot use array values defined by variables.</p>
<p>
<a id="pgfId-1032965"></a>The transfer function is</p>

<p>
<a id="pgfId-1170193"></a><img width="252" height="155" src="images/chap9-51.gif" /></p>

<p>
<a id="pgfId-1032981"></a>where <img width="21" height="39" src="images/chap9-52.gif" /><span> and </span><img width="21" height="35" src="images/chap9-53.gif" /><span> are the real and imaginary parts of the </span><img width="26" height="27" src="images/chap9-54.gif" /><span> zero, and </span><img width="21" height="39" src="images/chap9-55.gif" /><span> and </span><img width="22" height="35" src="images/chap9-56.gif" /><span> are the real and imaginary parts of the </span><img width="26" height="27" src="images/chap9-57.gif" /><span> pole. If a root (a pole or zero) is real, you must specify the imaginary part as 0. If a root is complex, its conjugate must also be present. If a root is the origin, the term associated with it is implemented as </span></p>
<em>z </em><img width="99" height="34" src="images/chap9-58.gif" /><span>, where </span><em>r</em><span> is the root. If a list of poles or zeros is empty, unity is used for the corresponding denominator or numerator.</span><h4>
<a id="pgfId-1032988"></a><a id="marker-1134404"></a>Zero-Denominator Z-Transforms</h4>

<p>
<a id="pgfId-1032991"></a>Use <code>zi_zd</code><a id="marker-1032989"></a> to implement the <a id="marker-1032990"></a>zero-denominator form of the Z-transform filter. </p>

<pre class="webflare-courier-new">
<a id="pgfId-1032992"></a><strong>zi_zd(</strong><code><em>expr</em></code><strong>,</strong><italic>
 
<em></em><strong>,</strong><span class="webflare-courier-new" style="white-space:pre"><em> d</em></span><strong>,</strong><em> </em><italic>
T 
[<italic>
 
<strong>,</strong><italic>
  
[<italic>
 
<strong>,</strong> <em>t</em>0] ]<strong>)</strong></italic></italic></italic></italic></italic></pre>

<p>
<a id="pgfId-1032993"></a> (zeta) is a fixed or parameter-sized vector of M pairs of real numbers. Each pair represents a zero. The first number in the pair is the real part of the zero, and the second is the imaginary part. <span class="webflare-courier-new" style="white-space:pre"><em>d</em></span> is a fixed or parameter-sized vector of N real numbers that contains the coefficients of the denominator. If you use array literals to define the  and <span class="webflare-courier-new" style="white-space:pre"><em>d</em></span> vectors, the values must be constant or dependent upon parameters only. You cannot use array values defined by variables.</p>
<p>
<a id="pgfId-1032997"></a>The transfer function is</p>

<p>
<a id="pgfId-1170210"></a><img width="259" height="146" src="images/chap9-59.gif" /></p>

<p>
<a id="pgfId-1033010"></a>where <img width="20" height="39" src="images/chap9-60.gif" /><span> and </span><img width="21" height="35" src="images/chap9-61.gif" /><span> are the real and imaginary parts of the </span><img width="26" height="27" src="images/chap9-62.gif" /><span> zero, and </span><img width="20" height="29" src="images/chap9-63.gif" /><span> is the coefficient of the </span><img width="26" height="27" src="images/chap9-64.gif" /><span> power of z in the denominator. If a zero is real, you must specify the imaginary part as 0. If a zero is complex, its conjugate must also be present. If a zero is the origin, the term associated with it is implemented as </span></p>
<em>z </em><img width="100" height="34" src="images/chap9-65.gif" /><span>. </span><h4>
<a id="pgfId-1033017"></a><a id="marker-1134406"></a>Numerator-Pole Z-Transforms</h4>

<p>
<a id="pgfId-1033020"></a>Use <code>zi_np</code><a id="marker-1033018"></a> to implement the <a id="marker-1033019"></a>numerator-pole form of the Z-transform filter. </p>

<pre class="webflare-courier-new">
<a id="pgfId-1033021"></a><strong>zi_np(</strong><code><em>expr</em></code><strong>,</strong> <code><em>n</em></code><strong>,</strong><italic>
 
<em></em><strong>,</strong><em> </em><span class="webflare-courier-new" style="white-space:pre"><em>T</em></span><italic>
 
[<italic>
 
<strong>,</strong><italic>
  
[<italic>
 
<strong>,</strong><italic>
 
<em>t</em><italic>
0
] ]<strong>)</strong></italic></italic></italic></italic></italic></italic></italic></pre>

<p>
<a id="pgfId-1033022"></a><span class="webflare-courier-new" style="white-space:pre"><em>n</em></span> is a fixed or parameter-sized vector of M real numbers that contains the coefficients of the numerator.  (rho) is a fixed or parameter-sized vector of N pairs of real numbers. Each pair represents a pole. The first number in the pair is the real part of the pole, and the second is the imaginary part. If you use array literals to define the <span class="webflare-courier-new" style="white-space:pre"><em>n</em></span> and  vectors, the values must be constant or dependent upon parameters only. You cannot use array values defined by variables.</p>
<p>
<a id="pgfId-1033026"></a>The transfer function is</p>

<p>
<a id="pgfId-1170468"></a><img width="282" height="152" src="images/chap9-66.gif" /></p>

<p>
<a id="pgfId-1033039"></a>where <img width="20" height="29" src="images/chap9-67.gif" /><span> is the coefficient of the </span><img width="26" height="27" src="images/chap9-68.gif" /><span> power of z in the numerator, and </span><img width="21" height="39" src="images/chap9-69.gif" /><span> and </span><img width="22" height="35" src="images/chap9-70.gif" /><span> are the real and imaginary parts of the </span><img width="26" height="27" src="images/chap9-71.gif" /><span> pole. If a pole is real, the imaginary part must be specified as 0. If a pole is complex, its conjugate must also be present. If a pole is the origin, the term associated with it is implemented as </span></p>
<em>z </em><img width="78" height="47" src="images/chap9-72.gif" /><span>.</span><h4>
<a id="pgfId-1033046"></a><a id="marker-1134408"></a>Numerator-Denominator Z-Transforms</h4>

<p>
<a id="pgfId-1033049"></a>Use <code>zi_nd</code><a id="marker-1033047"></a> to implement the <a id="marker-1033048"></a>numerator-denominator form of the Z-transform filter. </p>

<pre class="webflare-courier-new">
<a id="pgfId-1033050"></a><strong>zi_nd(</strong><code><em>expr</em></code><strong>,</strong> <code><em>n</em></code><strong>,</strong> <code><em>d</em></code><strong>,</strong> <code><em>T</em></code><em> </em>[<em> </em><strong>,</strong><em>  </em>[<em> </em><strong>,</strong><em> </em><italic>
t
<em>0</em>]<em> </em>]<strong>)</strong></italic></pre>

<p>
<a id="pgfId-1033051"></a><span class="webflare-courier-new" style="white-space:pre"><em>n</em></span> is a fixed or parameter-sized vector of M real numbers that contains the coefficients of the numerator, and <span class="webflare-courier-new" style="white-space:pre"><em>d</em></span> is a fixed or parameter-sized vector of N real numbers that contains the coefficients of the denominator. If you use array literals to define the <span class="webflare-courier-new" style="white-space:pre"><em>n</em></span> and <span class="webflare-courier-new" style="white-space:pre"><em>d</em></span> vectors, the values must be constant or dependent upon parameters only. You cannot use array values defined by variables.</p>
<p>
<a id="pgfId-1036838"></a>The transfer function is</p>

<p>
<a id="pgfId-1170490"></a><img width="167" height="139" src="images/chap9-73.gif" /></p>

<p>
<a id="pgfId-1036852"></a>where <img width="20" height="29" src="images/chap9-74.gif" /><span> is the coefficient of the </span><img width="26" height="27" src="images/chap9-75.gif" /><span> power of </span></p>
<span class="webflare-courier-new" style="white-space:pre"><em>z</em></span><img width="20" height="29" src="images/chap9-76.gif" /><span> is the coefficient of the </span><img width="26" height="27" src="images/chap9-77.gif" /><span> power of s in the denominator.</span><h4>
<a id="pgfId-1033069"></a>Examples</h4>

<p>
<a id="pgfId-1155094"></a>The following example illustrates an <a id="marker-1155092"></a>ideal<a id="marker-1155093"></a> sampled data integrator with the transfer function </p>

<p>
<a id="pgfId-1155098"></a><img width="113" height="62" src="images/chap9-78.gif" /></p>

<p>
<a id="pgfId-1155099"></a>This transfer function can be implemented as</p>

<pre class="webflare-courier-new">
<a id="pgfId-1155100"></a>module ideal_int (in, out) ;<br />electrical in, out ;<br />parameter real T = 0.1m ;<br />parameter real tt = 0.02n ;<br />parameter real td = 0.04m ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1155101"></a>analog begin
&#160;&#160;&#160;&#160;// The filter is defined with constant array literals.
&#160;&#160;&#160;&#160;V(out) &lt;+ zi_nd(V(in), {1}, {1,-1}, T, tt, td) ;<br />end<br />endmodule</pre>

<p>
<a id="pgfId-1033078"></a>The next example illustrates additional ways to use parameters and arrays to define filters.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1033079"></a>module zi (in, out);<br />electrical in, out;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051521"></a>parameter real T = 0.1;<br />parameter real tt = 0.02m;<br />parameter real td = 0.04m;<br />parameter real n0 = 1;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051523"></a>parameter integer start_num = 0;<br />parameter integer num_d = 2;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051525"></a>real nn[0:0];                            // Fixed-sized array<br />real dd[start_num:start_num+num_d-1];    // Parameter-sized array<br />real d;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051527"></a>analog begin</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051529"></a> // The arrays are initialized at the beginning of the listed analyses.</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051531"></a> @(initial_step(&quot;ac&quot;,&quot;dc&quot;,&quot;tran&quot;)) begin<br />     d = 1*n0;<br />     nn[start_num] = n0;<br />     dd[start_num] = d; dd[1] = -d;<br /> end</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051533"></a> V(out) &lt;+ zi_nd( V(in), nn, dd, T, tt, td);<br />end<br />endmodule</pre>
<h2>
<a id="pgfId-1033081"></a><a id="marker-1134412"></a><a id="37809"></a>Displaying Results</h2>

<p>
<a id="pgfId-1033083"></a>Verilog-AMS provides these tasks for <a id="marker-1033082"></a>displaying information: <code>$strobe</code>, <code>$display</code>, <code>$monitor</code>, <code>$write</code>, and <code>$debug</code>.</p>

<h3>
<a id="pgfId-1033085"></a><a id="marker-1134414"></a><a id="29634"></a>$strobe</h3>

<p>
<a id="pgfId-1033088"></a>Use the <a id="marker-1033086"></a><a id="marker-1033087"></a><code>$strobe</code> task to display information on the screen. <code>$strobe</code> and <code>$display</code> use the same arguments and are completely interchangeable. <code>$strobe</code> is supported in both analog and digital contexts.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1033089"></a>strobe_task ::=
&#160;&#160;&#160;&#160;    <strong>$strobe </strong>[ <strong>(</strong> { list_of_arguments } <strong>)</strong> ]</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051535"></a>list_of_arguments ::=
&#160;&#160;&#160;&#160;    <code><em>argument<br /></em></code> |&#160;&#160; list_of_arguments <strong>,</strong> <code><em>argument</em></code></pre>

<p>
<a id="pgfId-1033090"></a>The <code>$strobe</code> task prints a new-line character after the final argument. A <code>$strobe</code> task without any arguments prints only a new-line character.</p>
<p>
<a id="pgfId-1033091"></a>Each <span class="webflare-courier-new" style="white-space:pre"><em>argument</em></span> is a quoted string or an expression that returns a value.</p>
<p>
<a id="pgfId-1033092"></a>Each quoted string is a set of ordinary characters, special characters, or conversion specifications, all enclosed in one set of quotation marks. Each conversion specification in the string must have a corresponding argument following the string. You must ensure that the type of each argument is appropriate for the corresponding conversion specification.</p>
<p>
<a id="pgfId-1033093"></a>You can specify an argument without a corresponding conversion specification. If you do, an integer argument is displayed using the <code>%d</code> format, and a real argument is displayed using the <code>%g</code> format.</p>

<h4>
<a id="pgfId-1033095"></a><a id="marker-1134416"></a><a id="marker-1033094"></a>Special Characters</h4>

<p>
<a id="pgfId-1033096"></a>Use the following sequences to include the specified characters and information in a quoted string.</p>

<p>
<a id="pgfId-1091629"></a></p>
<table class="webflareTable" id="#id1033097">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1033099">
<a id="pgfId-1033099"></a>Use this sequence</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1033101">
<a id="pgfId-1033101"></a>To include</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033103"></a><code>\n</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033106"></a>The <a id="marker-1033105"></a>new-line character</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033109"></a><code>\t</code><a id="marker-1033108"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033112"></a>The <a id="marker-1033111"></a>tab character</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033114"></a><code>\\</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033117"></a>The <a id="marker-1033116"></a>backslash character, \</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033119"></a><code>\&quot;</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033122"></a>The <a id="marker-1033121"></a>quotation mark character, &quot;</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1123981"></a><code>\ddd</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1123983"></a>A character specified by 1 to 3 octal digits</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033124"></a><code>%%</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033127"></a>The <a id="marker-1033126"></a>percent character, %</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033129"></a><code>%m</code> or <code>%M</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033132"></a>The <a id="marker-1033131"></a>hierarchical name of the current module, function, or named block</p>
</td>
</tr>
</tbody></table>
<h4>
<a id="pgfId-1033133"></a><a id="marker-1134418"></a>Conversion Specifications</h4>

<p>
<a id="pgfId-1033135"></a><a id="marker-1033134"></a>Conversion specifications have the form</p>

<pre class="webflare-courier-new">
<a id="pgfId-1033136"></a><strong>%</strong> [ <code><em>flag</em></code> ] [ <code><em>field_width</em></code> ] [ <strong>.</strong> <code><em>precision</em></code> ] <code><em>format_character</em></code></pre>

<p>
<a id="pgfId-1033137"></a>where <span class="webflare-courier-new" style="white-space:pre"><em>flag</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>field_width</em></span>, and <span class="webflare-courier-new" style="white-space:pre"><em>precision</em></span> can be used only with a real argument. </p>
<p>
<a id="pgfId-1033158"></a><span class="webflare-courier-new" style="white-space:pre"><em>flag</em></span> is one of the three choices shown in the table:</p>

<p>
<a id="pgfId-1091630"></a></p>
<table class="webflareTable" id="#id1033138">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1033140">
<a id="pgfId-1033140"></a>flag</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1033142">
<a id="pgfId-1033142"></a>Meaning</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033144"></a><code>-</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033147"></a>Left<a id="marker-1033146"></a> justify the output</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033149"></a><code>+</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033152"></a>Always <a id="marker-1033151"></a>print a sign</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033154"></a>Blank space, or any character other than a sign</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033157"></a>Print a <a id="marker-1033156"></a>space</p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1033159"></a><span class="webflare-courier-new" style="white-space:pre"><em>field_width</em></span> is an integer specifying the minimum width for the field.</p>
<p>
<a id="pgfId-1033160"></a><span class="webflare-courier-new" style="white-space:pre"><em>precision</em></span> is an integer specifying the number of digits to the right of the decimal point.</p>
<p>
<a id="pgfId-1033242"></a><span class="webflare-courier-new" style="white-space:pre"><em>format_character</em></span> is one of the following characters.</p>

<p>
<a id="pgfId-1091631"></a></p>
<table class="webflareTable" id="#id1033161">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1033163">
<a id="pgfId-1033163"></a>format_
character</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1033165">
<a id="pgfId-1033165"></a>Type of Argument</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1033167">
<a id="pgfId-1033167"></a>Output</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1033169">
<a id="pgfId-1033169"></a>Example Output</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1123969"></a><code>b</code> or <code>B</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1123971"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1123973"></a>Binary format</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1125302"></a>00000000000000000000000000111000</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033172"></a><code>c</code><a id="marker-1033171"></a> or <code>C</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033174"></a>Integer</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033176"></a>ASCII character format</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033178"></a></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033181"></a><code>d</code> or <code>D</code><a id="marker-1033180"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033183"></a>Integer</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033185"></a>Decimal format</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033187"></a>191, 48, -567</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033190"></a><code>e</code> or <code>E</code><a id="marker-1033189"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033192"></a>Real</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033194"></a>Real, exponential format</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033196"></a>-1.0, 4e8, <br />34.349e-12</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033199"></a><code>f</code><a id="marker-1033198"></a> or <code>F</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033201"></a>Real</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033203"></a>Real, fixed-point format</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033205"></a>191.04, -4.789</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033208"></a><code>g</code> or <code>G</code><a id="marker-1033207"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033210"></a>Real</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033212"></a>Real, exponential, or decimal format, whichever format results in the shortest printed output</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033214"></a>9.6001, 7.34E-8, <br />-23.1E6</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033217"></a><code>h</code> or <code>H</code><a id="marker-1033216"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033219"></a>Integer</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033221"></a>Hexadecimal format</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033223"></a>3e, 262, a38, fff, 3E, A38</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033226"></a><code>o</code> or <code>O</code><a id="marker-1033225"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033228"></a>Integer</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033230"></a>Octal format</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033232"></a>127, 777</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1125281"></a><code>r</code> or <code>R</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1125283"></a>Real</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1125285"></a>Engineering notation format</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1125287"></a>123,457M, 12.345K</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033235"></a><code>s</code> or <code>S</code><a id="marker-1033234"></a></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033237"></a>String constant</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033239"></a>String format</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033241"></a></p>
</td>
</tr>
</tbody></table>
<h4>
<a id="pgfId-1033245"></a><a id="marker-1134420"></a>Examples of $strobe Formatting</h4>

<p>
<a id="pgfId-1033248"></a>Assume<a id="marker-1033246"></a><a id="marker-1033247"></a> that module <code>format_module</code> is instantiated in a netlist file with the instantiation</p>

<pre class="webflare-courier-new">
<a id="pgfId-1033249"></a>formatTest format_module</pre>

<p>
<a id="pgfId-1033250"></a>The module is defined as</p>

<pre class="webflare-courier-new">
<a id="pgfId-1033251"></a>module format_module ; 
integer ival ;
real rval ;
analog begin 
&#160;&#160;&#160;&#160;ival = 98 ;
&#160;&#160;&#160;&#160;rval = 123.456789 ;
&#160;&#160;&#160;&#160;$strobe(&quot;Format c gives %c&quot; , ival) ;
&#160;&#160;&#160;&#160;$strobe(&quot;Format C gives %C&quot; , ival) ;
&#160;&#160;&#160;&#160;$strobe(&quot;Format d gives %d&quot; , ival) ;
&#160;&#160;&#160;&#160;$strobe(&quot;Format D gives %D&quot; , ival) ;
&#160;&#160;&#160;&#160;$strobe(&quot;Format e (real) gives %e&quot; , rval) ;
&#160;&#160;&#160;&#160;$strobe(&quot;Format E (real) gives %E&quot; , rval) ;
&#160;&#160;&#160;&#160;$strobe(&quot;Format f (real) gives %f&quot; , rval) ;
&#160;&#160;&#160;&#160;$strobe(&quot;Format F (real) gives %F&quot; , rval) ;
&#160;&#160;&#160;&#160;$strobe(&quot;Format g (real)gives %g&quot; , rval) ;
&#160;&#160;&#160;&#160;$strobe(&quot;Format G (real)gives %G&quot; , rval) ;
&#160;&#160;&#160;&#160;$strobe(&quot;Format h gives %h&quot; , ival) ;
&#160;&#160;&#160;&#160;$strobe(&quot;Format H gives %H&quot; , ival) ;
&#160;&#160;&#160;&#160;$strobe(&quot;Format m gives %m&quot;) ;
&#160;&#160;&#160;&#160;$strobe(&quot;Format M gives %M&quot;) ;
&#160;&#160;&#160;&#160;$strobe(&quot;Format o gives %o&quot; , ival) ;
&#160;&#160;&#160;&#160;$strobe(&quot;Format O gives %O&quot; , ival) ;
&#160;&#160;&#160;&#160;$strobe(&quot;Format s gives %s&quot; , &quot;s string&quot;) ;
&#160;&#160;&#160;&#160;$strobe(&quot;Format S gives %S&quot; , &quot;S string&quot;) ;
&#160;&#160;&#160;&#160;$strobe(&quot;newline,\ntab,\tback-slash, \\&quot;) ; 
&#160;&#160;&#160;&#160;$strobe(&quot;doublequote,\&quot;&quot;) ;<br />end</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051537"></a>endmodule</pre>

<p>
<a id="pgfId-1033252"></a>When you run <code>format_module</code>, it displays</p>

<pre class="webflare-courier-new">
<a id="pgfId-1033253"></a>Format c gives b<br />Format C gives b<br />Format d gives 98<br />Format D gives 98<br />Format e gives 1.234568e+02<br />Format E gives 1.234568e+02<br />Format f gives 123.456789<br />Format F gives 123.456789<br />Format g gives 123.457<br />Format G gives 123.457<br />Format h gives 62<br />Format H gives 62<br />Format m gives formatTest<br />Format M gives formatTest<br />Format o gives 142<br />Format O gives 142<br />Format s gives s string<br />Format S gives S string<br />newline,<br />tab,    back-slash, \<br />doublequote,&quot;</pre>
<h3>
<a id="pgfId-1033254"></a><a id="marker-1134422"></a>$display</h3>

<p>
<a id="pgfId-1033257"></a>Use the <a id="marker-1033255"></a><a id="marker-1033256"></a><code>$display</code> task to display information on the screen. <code>$display</code> is supported in both analog and digital contexts.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1033258"></a>display_task ::=
&#160;&#160;&#160;&#160;    <strong>$display </strong>[ <strong>(</strong> { list_of_arguments } <strong>)</strong> ]</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051539"></a>list_of_arguments ::=
&#160;&#160;&#160;&#160;    <code><em>argument<br /></em></code> |&#160;&#160; list_of_arguments <strong>,</strong> <code><em>argument</em></code></pre>

<p>
<a id="pgfId-1033259"></a><code>$display</code> and <code>$strobe</code> use the same arguments and are completely interchangeable. For guidance, see <a href="chap9.html#29634">&#8220;$strobe&#8221;</a>.</p>

<h3>
<a id="pgfId-1043443"></a><a id="marker-1134424"></a>$write</h3>

<p>
<a id="pgfId-1043446"></a>Use the <a id="marker-1043444"></a><a id="marker-1043445"></a><code>$write</code> task to display information on the screen. This task is identical to the <code>$strobe</code> task, except that <code>$strobe</code> automatically adds a newline character to the end of its output, whereas <code>$write</code> does not. <code>$write</code> is supported in both analog and digital contexts.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1043447"></a>write_task ::=
&#160;&#160;&#160;&#160;    <strong>$write </strong>[ <strong>(</strong> { list_of_arguments } <strong>)</strong> ]</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051541"></a>list_of_arguments ::=
&#160;&#160;&#160;&#160;    <code><em>argument<br /></em></code> |&#160;&#160; list_of_arguments <strong>,</strong> <code><em>argument</em></code></pre>

<p>
<a id="pgfId-1046356"></a>The arguments you can use in <code>list_of_arguments</code> are the same as those used for <code>$strobe</code>. For guidance, see <a href="chap9.html#29634">&#8220;$strobe&#8221;</a>.</p>

<h3>
<a id="pgfId-1141322"></a><a id="marker-1141321"></a><a id="79040"></a>$debug</h3>

<p>
<a id="pgfId-1141325"></a>Use the <a id="marker-1141323"></a><a id="marker-1141324"></a><code>$debug</code> task to display information on the screen while the analog solver is running. This task displays the values of the arguments for each iteration of the solver.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1141326"></a>debug_task ::=
&#160;&#160;&#160;&#160;    <strong>$debug </strong>[ <strong>(</strong> { list_of_arguments } <strong>)</strong> ]</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1141327"></a>list_of_arguments ::=
&#160;&#160;&#160;&#160;    <code><em>argument<br /></em></code> |&#160;&#160; list_of_arguments <strong>,</strong> <code><em>argument</em></code></pre>

<p>
<a id="pgfId-1141328"></a>The arguments you can use in <code>list_of_arguments</code> are the same as those used for <code>$strobe</code>. For guidance, see <a href="chap9.html#29634">&#8220;$strobe&#8221;</a>.</p>

<h3>
<a id="pgfId-1167037"></a><a id="marker-1134426"></a>$monitor<a id="53057"></a></h3>

<p>
<a id="pgfId-1167040"></a>Use the <code>$monitor</code><a id="marker-1167038"></a><a id="marker-1167039"></a> task to display information on the screen. This task is identical to the <code>$strobe</code> task, except that <code>$monitor</code> outputs only when an argument changes value.<code>$monitor</code> is supported in only digital contexts.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1167041"></a>$monitor_task ::=
&#160;&#160;&#160;&#160;    <strong>$monitor </strong>[ <strong>(</strong> { list_of_arguments } <strong>)</strong> ]</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1167042"></a>list_of_arguments ::=
&#160;&#160;&#160;&#160;    <code><em>argument<br /></em></code> |&#160;&#160; list_of_arguments <strong>,</strong> <code><em>argument</em></code></pre>

<p>
<a id="pgfId-1167043"></a>The arguments you can use in <code>list_of_</code>arguments are the same as those used for <code>$strobe</code>. For guidance, see <a href="chap9.html#29634">&#8220;$strobe&#8221;</a>.</p>

<h2>
<a id="pgfId-1033264"></a><a id="26375"></a>Specifying Power Consumption</h2>

<p>
<a id="pgfId-1033267"></a>Use the <a id="marker-1033265"></a><a id="marker-1033266"></a><code>$pwr</code> system task to specify the power consumption of a module. The <code>$pwr</code> task is supported in only analog contexts.</p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1043392"></a>The <code>$pwr</code> task is a nonstandard Cadence-specific language extension.</div>

<pre class="webflare-courier-new">
<a id="pgfId-1033268"></a>pwr_task ::=
&#160;&#160;&#160;&#160;    <strong>$pwr(</strong> <code><em>expression</em></code> <strong>)</strong></pre>

<p>
<a id="pgfId-1033269"></a><span class="webflare-courier-new" style="white-space:pre"><em>expression</em></span> is an expression that specifies the power contribution. If you specify more than one <code>$pwr</code> task in a behavioral description, the result of the <code>$pwr</code> task is the sum of the individual contributions. </p>
<p>
<a id="pgfId-1033270"></a>To ensure a useful result, your module must contain an assignment inside the behavior specification. Your module must also compute the value of <code>$pwr</code> tasks at every iteration. If these conditions are not met, the result of the <code>$pwr</code> task is zero.</p>
<p>
<a id="pgfId-1043402"></a>The <code>$pwr</code> task does not return a value and cannot be used inside other expressions. Instead, access the result by using the <code>options</code> and <code>save</code> statements in the analog simulation control file. For example, using the following statement in the analog simulation control file saves all the individual power contributions and the sum of the contributions in the module named <span class="webflare-courier-new" style="white-space:pre"><em>name</em></span>:</p>

<pre class="webflare-courier-new">
<a id="pgfId-1033272"></a><code><em>name</em></code> options pwr=all</pre>

<p>
<a id="pgfId-1033273"></a>For <code>save</code>, use a statement like the following:</p>

<pre class="webflare-courier-new">
<a id="pgfId-1033274"></a>save <code><em>name</em></code>:pwr</pre>

<p>
<a id="pgfId-1033275"></a>In each format, <span class="webflare-courier-new" style="white-space:pre"><em>name</em></span> is the name of a module. </p>
<p>
<a id="pgfId-1168018"></a>For more information about the <code>options</code> statement, see Chapter 7 of the <em>Spectre Circuit Simulator User Guide</em>. For more about the <code>save</code> statement, see Chapter 8 of the <em>Spectre Circuit Simulator User Guide.</em></p>
<p>
<a id="pgfId-1033281"></a>Example</p>

<pre class="webflare-courier-new">
<a id="pgfId-1033282"></a>// Resistor with power contribution<br />&#8216;include &quot;disciplines.vams&quot;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051545"></a>module Res(pos, neg);
inout pos, neg;
electrical pos, neg;
parameter real r=5;
&#160;&#160;&#160;&#160;analog begin
&#160;&#160;&#160;&#160;    V(pos,neg) &lt;+ r * I(pos,neg);
&#160;&#160;&#160;&#160;    $pwr(V(pos,neg)*I(pos,neg));
&#160;&#160;&#160;&#160;end<br />endmodule</pre>
<h2>
<a id="pgfId-1033284"></a><a id="marker-1134428"></a><a id="37176"></a>Working with Files</h2>

<p>
<a id="pgfId-1033285"></a>Verilog-AMS provides several functions for working with files. <code>$fopen</code> prepares a file for writing. <code>$fstrobe</code> and <code>$fdisplay</code> write to a file. <code>$fclose</code> closes an open file.</p>

<h3>
<a id="pgfId-1033286"></a><a id="marker-1134430"></a>Opening a File</h3>

<p>
<a id="pgfId-1033291"></a>Use the <code>$fopen</code><a id="marker-1033287"></a><a id="marker-1033288"></a> function to open a specified file.<a id="marker-1033289"></a><a id="marker-1033290"></a></p>

<pre class="webflare-courier-new">
<a id="pgfId-1092197"></a>fopen_function ::=
&#160;&#160;&#160;&#160;    <code><em>multi_channel_descriptor</em></code> <strong>=</strong> <strong>$fopen</strong> <strong>(</strong> <strong>&quot;</strong><code><em>file_name</em></code><strong>&quot;</strong> [ <strong>&quot;</strong><code><em>io_mode</em></code><strong>&quot;</strong>] <strong>)</strong> <strong>;</strong> |&#160;&#160; <code><em>fd</em></code> = <strong>$fopen</strong> <strong>(</strong> <strong>&quot;</strong><code><em>file_name</em></code><strong>&quot;,</strong> type <strong>)</strong> <strong>;</strong></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1167092"></a>type ::=
&#160;&#160;&#160;&#160;    <strong>&quot;r&quot;<br /></strong> |&#160;&#160; <strong>&quot;w&quot;<br /></strong> |&#160;&#160; <strong>&quot;a&quot;</strong></pre>

<p>
<a id="pgfId-1092199"></a><span class="webflare-courier-new" style="white-space:pre"><em>multi_channel_descriptor</em></span><a id="marker-1092198"></a> is a 32-bit unsigned integer that is uniquely associated with <span class="webflare-courier-new" style="white-space:pre"><em>file_name</em></span>. The <code>$fopen</code> function returns a <span class="webflare-courier-new" style="white-space:pre"><em>multi_channel_descriptor</em></span> value of zero if the file cannot be opened.</p>
<p>
<a id="pgfId-1033295"></a>Think of <span class="webflare-courier-new" style="white-space:pre"><em>multi_channel_descriptor</em></span> as a set of 32 flags, where each flag represents a single output channel. The least significant bit always refers to the standard output. The first time it is called, <code>$fopen</code> opens channel 1 and returns a descriptor value of 2 (binary 10). The second time it is called, <code>$fopen</code> opens channel 2 and returns a descriptor value of 4 (binary 100). Subsequent calls cause <code>$fopen</code> to open channels 3, 4, 5, and so on, and to return values of 8, 16, 32, and so on, up to a maximum of 32 open channels.</p>
<p>
<a id="pgfId-1120191"></a><span class="webflare-courier-new" style="white-space:pre"><em>io_mode</em></span> is one of three possible values: <code>w</code>, <code>a</code>, or <code>r</code>. The <code>w</code> or write mode deletes the contents of any existing files before writing to them. The <code>a</code> or append mode appends the next output to the existing contents of the specified file. In both cases, if the specified file does not exist, <code>$fopen</code> creates that file. The <code>r</code> mode opens a file for reading. An error is reported if the file does not exist.</p>
<p>
<a id="pgfId-1033296"></a>The <code>$fopen</code> function reuses channels associated with any files that are closed.</p>
<p>
<a id="pgfId-1092220"></a><span class="webflare-courier-new" style="white-space:pre"><em>file_name</em></span> is a string that can include the special commands described in <a href="chap9.html#11703">&#8220;Special $fopen Formatting Commands&#8221;</a>. If <span class="webflare-courier-new" style="white-space:pre"><em>file_name</em></span> contains a path indicating that the file is to be opened in a different directory, the directory must already exist when the <code>$fopen</code> function runs. <span class="webflare-courier-new" style="white-space:pre"><em>file_name</em></span> (together with the surrounding quotation marks) can also be replaced by a string parameter.</p>
<p>
<a id="pgfId-1167097"></a><code>type</code> (allowed in <code>initial</code> or <code>always</code> blocks, but not in <code>analog</code> blocks) is a character string or a reg that indicates how the file is to be opened. The value <code>&quot;r&quot;</code> opens the file for reading, <code>&quot;w&quot;</code> truncates the file to zero length or creates the file for writing, <code>&quot;a&quot;</code> opens the file for appending, or creates the file for writing. </p>
<p>
<a id="pgfId-1033297"></a>For example, to open a file named <code>myfile</code>, you can use the code</p>

<pre class="webflare-courier-new">
<a id="pgfId-1033298"></a>integer myChanDesc ;<br />myChanDesc = $fopen ( &quot;myfile&quot; ) ;</pre>
<h4>
<a id="pgfId-1056871"></a><a id="marker-1134432"></a><a id="11703"></a>Special $fopen Formatting Commands</h4>

<p>
<a id="pgfId-1056873"></a>The following special output formatting commands are available for use with the <code>$fopen</code> function.</p>

<p>
<a id="pgfId-1091632"></a></p>
<table class="webflareTable" id="#id1056874">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1056876">
<a id="pgfId-1056876"></a>Command</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1056878">
<a id="pgfId-1056878"></a>Output</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1056880">
<a id="pgfId-1056880"></a>Example</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056882"></a><code>%C</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056884"></a>Design filename</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056886"></a><code>input.scs</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056888"></a><code>%D</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056890"></a>Date (yy-mm-dd)</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056892"></a><code>94-02-28</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056894"></a><code>%H</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056896"></a>Host name</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056898"></a><code>hal</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056900"></a><code>%S</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056902"></a>Simulator type</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056904"></a><code>spectre</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056906"></a><code>%P</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056908"></a>Unix process ID #</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056910"></a><code>3641</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056912"></a><code>%T</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056914"></a>Time (24hh:mm:ss)</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056916"></a><code>15:19:25</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056918"></a><code>%I</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056920"></a>Instance name</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056922"></a><code>opamp3</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056924"></a><code>%A</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056926"></a>Analysis name</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056928"></a><code>dc0p</code>, <code>timeDomain</code>, <code>acSup</code></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1055739"></a>The special output formatting commands can be followed by one or more modifiers, which extract information from UNIX filenames. (To avoid opening a file that is already open, the <code>%C</code> command must be followed by a modifier.) The modifiers are:</p>

<p>
<a id="pgfId-1091633"></a></p>
<table class="webflareTable" id="#id1055835">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1055935">
<a id="pgfId-1055935"></a>Modifier</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1055937">
<a id="pgfId-1055937"></a>Extracted information</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1055939"></a><code>:r</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1055941"></a>Root (base name) of the path for the file</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1055943"></a><code>:e</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1055945"></a>Extension of the path for the file</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1055947"></a><code>:h</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1055949"></a>Head of the path for any portion of the file before the last /</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1055951"></a><code>:t</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1055953"></a>Tail of the path for any portion of the file after the last /</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1055955"></a><code>::</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1055957"></a>The (:) character itself</p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1055962"></a>Any other character after a colon (<code>:</code>) signals the end of modifications. That character is copied with the previous colon.</p>
<p>
<a id="pgfId-1055963"></a>The modifiers are typically used with the <code>%C</code> command although they can be used with any of the commands. However, when the output of a formatting command does not contain a <code>/</code> and &#8220;<em>.</em>&#8221;, the modifiers <code>:t</code> and <code>:r</code> return the whole name and the <code>:e</code> and <code>:h</code> modifiers return &#8220;.&#8221;. As a result, be aware that using modifiers with formatting commands other than <code>%C</code> might not produce the results you expect. For example, using the command</p>

<pre class="webflare-courier-new">
<a id="pgfId-1056965"></a>$fopen(&quot;%I:h.freq_dat&quot;) ;</pre>

<p>
<a id="pgfId-1056967"></a>opens a file named <code>..freq_dat</code>.</p>
<p>
<a id="pgfId-1055971"></a>You can use a concatenated sequence of modifiers. For example, if your design file name is <code>res.ckt</code>, and you use the statement</p>

<pre class="webflare-courier-new">
<a id="pgfId-1055977"></a>$fopen(&quot;%C:r.freq_dat&quot;) ;</pre>

<p>
<a id="pgfId-1055987"></a>then </p>
<ul><li>
<a id="pgfId-1055992"></a><code>%C</code> is the design filename (<code>res.ckt</code>)</li><li>
<a id="pgfId-1055995"></a><code>:r</code> is the root of the design filename (<code>res</code>)</li><li>
<a id="pgfId-1055998"></a><code>.freq_dat</code> is the new filename extension</li></ul>


<p>
<a id="pgfId-1055752"></a>As a result, the name of the opened file is <code>res.freq_dat</code>.</p>
<p>
<a id="pgfId-1055753"></a>The following table shows the various filenames generated from a design filename (<code>%C</code>) of </p>

<pre class="webflare-courier-new">
<a id="pgfId-1056046"></a>/users/maxwell/circuits/opamp.ckt </pre>

<p>
<a id="pgfId-1056096"></a>by using different formatting commands and modifiers.</p>

<p>
<a id="pgfId-1173925"></a></p>
<table class="webflareTable" id="#id1056047">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1056049">
<a id="pgfId-1056049"></a>Command and Modifiers</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1056051">
<a id="pgfId-1056051"></a>Resulting Opened File</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056854"></a><code>$fopen(&quot;%C&quot;);</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056055"></a>None, because the design file cannot be overwritten.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056057"></a><code>$fopen(&quot;%C:r&quot;);</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056059"></a><code>/users/maxwell/circuits/opamp</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056061"></a><code>$fopen(&quot;%C:e&quot;);</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056063"></a><code>ckt</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056065"></a><code>$fopen(&quot;%C:h&quot;);</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056067"></a><code>/users/maxwell/circuits</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056069"></a><code>$fopen(&quot;%C:t&quot;);</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056071"></a><code>opamp.ckt</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056073"></a><code>$fopen(&quot;%C::&quot;);</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056075"></a><code>/users/maxwell/circuits/opamp.ckt:</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056077"></a><code>$fopen(&quot;%C:h:h&quot;);</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056079"></a><code>/users/maxwell</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056081"></a><code>$fopen(&quot;%C:t:r&quot;);</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056083"></a><code>opamp</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056085"></a><code>$fopen(&quot;%C:r:t&quot;);</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056087"></a><code>opamp</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056089"></a><code>$fopen(&quot;/tmp/%C:t:r.raw&quot;);</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056091"></a><code>/tmp/opamp.raw</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056093"></a><code>$fopen(&quot;%C:e%C:r:t&quot;);</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056095"></a><code>ckt.opamp</code></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056859"></a><code>$fopen(&quot;%C:r.%I.dat&quot; );</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1056841"></a><code>/users/maxwell/circuits/<br />     opamp.opamp3.dat</code></p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1091634"></a>When <code>$fopen</code> is used on a compressed file, the file is copied to the <code>/tmp</code> directory and uncompressed there.</p>

<h3>
<a id="pgfId-1120106"></a><a id="marker-1134434"></a>Reading from a File</h3>

<p>
<a id="pgfId-1120116"></a>Use the <code>$fscanf</code> and <code>$fgets</code> functions to read information from a file.</p>

<h4>
<a id="pgfId-1172845"></a>$fscanf</h4>

<p>
<a id="pgfId-1172848"></a>Use the <a id="marker-1172846"></a><a id="marker-1172847"></a><code>$fscanf</code> function to read information from a file.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1120117"></a>fscanf_function ::=
&#160;&#160;&#160;&#160;    <strong>$fscanf</strong> <strong>(</strong><code><em>multi_channel_descriptor</em></code> <strong>, &quot;</strong><code><em>format</em></code><strong>&quot; </strong>{<strong> , </strong><code><em>storage_arg</em></code> }<strong> )</strong></pre>

<p>
<a id="pgfId-1120119"></a>The <span class="webflare-courier-new" style="white-space:pre"><em>multi_channel_descriptor</em></span> that you specify must have a value that is associated with one or more currently open files. The format describes the matching operation done between the <code>$fscanf</code> storage arguments and the input from the data file. The <code>$fscanf</code> function sequentially attempts to match each formatting command in this string to the input coming from the file. After the formatting command is matched to the characters from the input stream, the next formatting command is applied to the next input coming from the file. If a formatting command is not a skipping command, the data read from the file to match a formatting command is stored in the formatting command&#8217;s corresponding <span class="webflare-courier-new" style="white-space:pre"><em>storage_arg</em></span>. The first <span class="webflare-courier-new" style="white-space:pre"><em>storage_arg</em></span> corresponds to the first nonskipping formatting command; the second <span class="webflare-courier-new" style="white-space:pre"><em>storage_arg</em></span> corresponds to the second nonskipping formatting command. This matching process is repeated between all formatting commands and input data. The formatting commands that you can use are the same as those used for <code>$strobe</code>. See <a href="chap9.html#29634">&#8220;$strobe&#8221;</a> for guidance.</p>
<p>
<a id="pgfId-1120177"></a>For example, the following statement reads data from the file designated by <code>fptr1</code> and places the information in variables called <code>db1</code> and <code>int</code>.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1120161"></a>$fscanf(fptr1, &quot;Double = %e and Integer = %d&quot;, dbl, int);</pre>
<h4>
<a id="pgfId-1172874"></a>$fge<a id="fgets"></a>ts</h4>

<p>
<a id="pgfId-1172876"></a>Use the <code>$fgets</code><a id="marker-1172875"></a> function to read the characters from a file, until a newline character or End of File (EOF) condition is encountered, and store the information in a string variable. </p>

<pre class="webflare-courier-new">
<a id="pgfId-1172877"></a>fgets_function ::=
&#160;&#160;&#160;&#160;    <strong>$fgets</strong> <strong>( &quot;</strong><code><em>str</em></code><strong>&quot; </strong>{<strong> , </strong>[<strong> </strong><code><em>multi_channel_descriptor </em></code>] }<strong> )</strong></pre>

<p>
<a id="pgfId-1172878"></a>The <span class="webflare-courier-new" style="white-space:pre"><em>multi_channel_descriptor</em></span> that you specify must have a value that is associated with the currently open file. If an error occurs while reading the file, the function returns zero, otherwise, it returns the number of characters it reads from the file.</p>

<h3>
<a id="pgfId-1033299"></a><a id="marker-1134436"></a>Writing to a File</h3>

<p>
<a id="pgfId-1033302"></a>Verilog-AMS provides three input/output functions for <a id="marker-1033300"></a>writing to a <a id="marker-1033301"></a>file: <code>$fstrobe,</code> <code>$fdisplay</code>, <code>$fwrite</code>, <code>$fmonitor</code>, <code>$fdebug</code>. The <code>$fstrobe</code> and <code>$fdisplay</code> functions use the same arguments and are completely interchangeable. The <code>$fwrite</code> function is similar but does not insert automatic carriage returns in the output.</p>

<h4>
<a id="pgfId-1033303"></a><a id="marker-1134438"></a>$fstrobe</h4>

<p>
<a id="pgfId-1050804"></a>Use the <a id="marker-1050802"></a><a id="marker-1050803"></a><code>$fstrobe</code> function to write information to a file.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1050805"></a>fstrobe_function ::=
&#160;&#160;&#160;&#160;    <strong>$fstrobe</strong> <strong>(</strong><code><em>multi_channel_descriptor</em></code> {<strong>,</strong>list_of_arguments }<strong>)</strong></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1050806"></a>list_of_arguments ::=
&#160;&#160;&#160;&#160;    <code><em>argument<br /></em></code> |&#160;&#160; list_of_arguments <strong>,</strong> <code><em>argument</em></code></pre>

<p>
<a id="pgfId-1033309"></a>The <span class="webflare-courier-new" style="white-space:pre"><em>multi_channel_descriptor</em></span> that you specify must have a value that is associated with one or more currently open files. The arguments that you can use in <code>list_of_</code>arguments are the same as those used for <code>$strobe</code>. See <a href="chap9.html#29634">&#8220;$strobe&#8221;</a> for guidance.</p>
<p>
<a id="pgfId-1033313"></a>For example, the following code fragment illustrates how you might write simultaneously to two open files. </p>

<pre class="webflare-courier-new">
<a id="pgfId-1033314"></a>integer mcd1 ;
integer mcd2 ;
integer mcd ;
@(initial_step) begin
&#160;&#160;&#160;&#160;mcd1 = $fopen(&quot;file1.dat&quot;) ;
&#160;&#160;&#160;&#160;mcd2 = $fopen(&quot;file2.dat&quot;) ;<br />end<br />.<br />.<br />.<br />mcd = mcd1 | mcd2 ; // Bitwise OR combines two channels<br />$fstrobe(mcd, &quot;This is written to both files&quot;) ;</pre>
<h4>
<a id="pgfId-1033315"></a><a id="marker-1134440"></a>$fdisplay</h4>

<p>
<a id="pgfId-1033318"></a>Use the <code>$fdisplay</code><a id="marker-1033316"></a><a id="marker-1033317"></a> function to write information to a file.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1033319"></a>fdisplay_function ::=
&#160;&#160;&#160;&#160;    <strong>$fdisplay</strong> <strong>(</strong><code><em>multi_channel_descriptor</em></code> {<strong>,</strong>list_of_arguments }<strong>)</strong></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051547"></a>list_of_arguments ::=
&#160;&#160;&#160;&#160;    <code><em>argument<br /></em></code> |&#160;&#160; list_of_arguments <strong>,</strong> <code><em>argument</em></code></pre>

<p>
<a id="pgfId-1033320"></a>The <span class="webflare-courier-new" style="white-space:pre"><em>multi_channel_descriptor</em></span> that you specify must have a value that is associated with a currently open file. The arguments that you can use in <code>list_of_</code>arguments are the same as those used for <code>$strobe</code>. See <a href="chap9.html#29634">&#8220;$strobe&#8221;</a> for guidance.</p>

<h4>
<a id="pgfId-1043472"></a><a id="marker-1134442"></a>$fwrite</h4>

<p>
<a id="pgfId-1043475"></a>Use the <code>$fwrite</code><a id="marker-1043473"></a><a id="marker-1043474"></a> function to write information to a file.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1043476"></a>fwrite_function ::=
&#160;&#160;&#160;&#160;    <strong>$fwrite</strong> <strong>(</strong><code><em>multi_channel_descriptor</em></code> {<strong>,</strong>list_of_arguments }<strong>)</strong></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051549"></a>list_of_arguments ::=
&#160;&#160;&#160;&#160;    <code><em>argument<br /></em></code> |&#160;&#160; list_of_arguments <strong>,</strong> <code><em>argument</em></code></pre>

<p>
<a id="pgfId-1043477"></a>The <span class="webflare-courier-new" style="white-space:pre"><em>multi_channel_descriptor</em></span> that you specify must have a value that is associated with a currently open file. The arguments that you can use in <code>list_of_</code>arguments are the same as those used for <code>$strobe</code>. See <a href="chap9.html#29634">&#8220;$strobe&#8221;</a> for guidance.</p>
<p>
<a id="pgfId-1046552"></a>The <code>$fwrite</code> function does not insert automatic carriage returns in the output.</p>

<h4>
<a id="pgfId-1172654"></a>$fmon<a id="fmonitor"></a>itor</h4>

<p>
<a id="pgfId-1172659"></a>The <code>$fmonitor</code><a id="marker-1172655"></a> function is similar to <a href="chap9.html#53057">$monitor</a>. However, it prints the values of variables or expressions that are specified as an argument to the task to a specified file.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1172660"></a>fmonitor_function ::=
&#160;&#160;&#160;&#160;    <strong>$fmonitor</strong> <strong>( </strong><code><em>multi_channel_descriptor</em></code> {<strong>,</strong>list_of_arguments }<strong>)</strong></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172661"></a>list_of_arguments ::=
&#160;&#160;&#160;&#160;    <code><em>argument<br /></em></code> |&#160;&#160; list_of_arguments <strong>,</strong> <code><em>argument</em></code></pre>

<p>
<a id="pgfId-1172662"></a>The <span class="webflare-courier-new" style="white-space:pre"><em>multi_channel_descriptor</em></span> that you specify must have a value that is associated with a currently open file.</p>

<h4>
<a id="pgfId-1172664"></a>$fdeb<a id="fdebug"></a>ug</h4>

<p>
<a id="pgfId-1172669"></a>The <code>$fdebug</code><a id="marker-1172665"></a> function is similar to <a href="chap9.html#79040">$debug</a>. However, it prints the information to a file.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1172670"></a>fdebug_function ::=
&#160;&#160;&#160;&#160;    <strong>$fdebug</strong> <strong>( </strong><code><em>multi_channel_descriptor</em></code> {<strong>,</strong>list_of_arguments }<strong>)</strong></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172671"></a>list_of_arguments ::=
&#160;&#160;&#160;&#160;    <code><em>argument<br /></em></code> |&#160;&#160; list_of_arguments <strong>,</strong> <code><em>argument</em></code></pre>

<p>
<a id="pgfId-1172672"></a>The <span class="webflare-courier-new" style="white-space:pre"><em>multi_channel_descriptor</em></span> that you specify must have a value that is associated with the currently open file.</p>

<h4>
<a id="pgfId-1172721"></a>$ferr<a id="ferror"></a>or</h4>

<p>
<a id="pgfId-1172722"></a>ferror_function ::=
&#160;&#160;&#160;&#160;    <strong>$ferror</strong> <strong>(</strong><span class="webflare-courier-new" style="white-space:pre"><em>multi_channel_descriptor</em></span> <strong>,</strong>argument <strong>)</strong></p>
<p>
<a id="pgfId-1172724"></a>Use the <code>$ferror</code><a id="marker-1172723"></a> function to write the error information generated by the current input/output function to a string variable.</p>
<p>
<a id="pgfId-1172725"></a>The function also returns an integral value of the error code. If no error is generated by the input/output function, the <code>$ferror</code> function returns zero and the string variable does not contain anything.</p>

<h3>
<a id="pgfId-1172746"></a>Finding the File Position</h3>
<h4>
<a id="pgfId-1172748"></a>$ft<a id="ftell"></a>ell</h4>

<p>
<a id="pgfId-1172750"></a>Use the <code>$ftell</code><a id="marker-1172749"></a> function to return the offset value from the beginning of a file.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1172751"></a>ftell_function ::= 
&#160;&#160;&#160;&#160;    <strong>$ftell</strong> <strong>(</strong> <code><em>multi_channel_descriptor</em></code> <strong>)</strong> <strong>;</strong></pre>

<p>
<a id="pgfId-1172752"></a>The offset value can be used by the <code>$fseek</code> function to reposition the file.</p>
<p>
<a id="pgfId-1172753"></a>The <span class="webflare-courier-new" style="white-space:pre"><em>multi_channel_descriptor</em></span> that you specify must have a value that is associated with the currently opened file.</p>

<h4>
<a id="pgfId-1172755"></a>$fse<a id="fseek"></a>ek</h4>

<p>
<a id="pgfId-1172757"></a>Use the <code>$fseek</code><a id="marker-1172756"></a> function to set the position of the next input or output operation on a file.</p>
<p>
<a id="pgfId-1172758"></a>fseek_function ::= 
&#160;&#160;&#160;&#160;    <strong>$fseek</strong> <strong>(</strong> <span class="webflare-courier-new" style="white-space:pre"><em>multi_channel_descriptor</em></span><strong>,</strong><span class="webflare-courier-new" style="white-space:pre"><em> offset_value</em></span><strong>,</strong><span class="webflare-courier-new" style="white-space:pre"><em> opearation_value</em></span><strong>)</strong> <strong>;</strong></p>
<p>
<a id="pgfId-1172759"></a>The new postion depends on the value specified for <code>operation_value</code> and can be any of the following:</p>
<p>
<a id="pgfId-1172760"></a>0 &#8211; sets the position equal to <code>offset_value</code></p>
<p>
<a id="pgfId-1172761"></a>1 &#8211; sets the position to the current location after adding <code>offset_value</code></p>
<p>
<a id="pgfId-1172762"></a>2 &#8211; sets the position to End of File (EOF) after adding <code>offset_value</code></p>
<p>
<a id="pgfId-1172763"></a>The <code>$fseek</code> function can be used to position the file pointer to any position in the file, however, when data is written to the file, the file pointer is ignored and the output is written at the end of the file and the file pointer is automatically positioned at the end of the output.</p>
<p>
<a id="pgfId-1172764"></a>If an error occurs while repositioning the file, the function returns -1, otherwise, it returns 0.</p>

<h4>
<a id="pgfId-1172786"></a>$rew<a id="rewind"></a>ind</h4>

<p>
<a id="pgfId-1172788"></a>Use the <code>$rewind</code><a id="marker-1172787"></a> function to set the position of the next input or output operation on a file.</p>
<p>
<a id="pgfId-1172789"></a>rewind_function ::= 
&#160;&#160;&#160;&#160;    <strong>$rewind</strong> <strong>(</strong> <span class="webflare-courier-new" style="white-space:pre"><em>multi_channel_descriptor</em></span><strong>)</strong> <strong>;</strong></p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1172790"></a><code>$rewind</code> is equivalent to <code>$fseek (</code>multi_channel_descriptor, 0, 0)</div>

<h3>
<a id="pgfId-1033324"></a>Closing a File</h3>

<p>
<a id="pgfId-1033329"></a>Use the <a id="marker-1033325"></a><a id="marker-1033326"></a><code>$fclose</code> function to close a specified file.<a id="marker-1033327"></a><a id="marker-1033328"></a></p>

<pre class="webflare-courier-new">
<a id="pgfId-1033330"></a>file_close_function ::= 
&#160;&#160;&#160;&#160;    <strong>$fclose</strong> <strong>(</strong> <code><em>multi_channel_descriptor</em></code> <strong>)</strong> <strong>;</strong></pre>

<p>
<a id="pgfId-1033331"></a>The <span class="webflare-courier-new" style="white-space:pre"><em>multi_channel_descriptor</em></span> that you specify must have a value that is associated with the currently open file that you want to close.</p>

<h2>
<a id="pgfId-1033334"></a><a id="marker-1134446"></a><a id="14667"></a>Simulator Con<a id="simulator_control_functions"></a>trol Functions</h2>

<p>
<a id="pgfId-1172910"></a>Verilog-AMS provides the following simulator control functions:</p>
<ul><li>
<a id="pgfId-1172914"></a><a href="chap9.html#13859">$finish</a></li><li>
<a id="pgfId-1172918"></a><a href="chap9.html#80695">$stop</a></li><li>
<a id="pgfId-1172922"></a><a href="chap9.html#85591">$fatal</a></li><li>
<a id="pgfId-1172926"></a><a href="chap9.html#59848">$error</a></li><li>
<a id="pgfId-1172930"></a><a href="chap9.html#97456">$warning</a></li><li>
<a id="pgfId-1172934"></a><a href="chap9.html#38906">$info</a></li></ul>





<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1172935"></a>For simulation tools, the <code>$fatal</code>, <code>$error</code>, <code>$warning</code>, and <code>$info</code> functions also report the simulation run time at which the function is called. You can also use these functions to include additional information using the same format as the <code>$display</code> function.</div>

<h3>
<a id="pgfId-1172937"></a><a id="13859"></a>$finish</h3>

<p>
<a id="pgfId-1172938"></a>If the <code>$finish</code> function is called during an accepted iteration, the simulator exits after the current solution is complete and returns the control to the operating system. <code>$finish</code> called during a rejected iteration has no effect.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1172939"></a>finish_function ::=
&#160;&#160;&#160;&#160;    <strong>$finish</strong> [<strong>(</strong> msg_level <strong>)</strong>] <strong>;</strong></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172940"></a>msg_level ::=
&#160;&#160;&#160;&#160;    <strong>0</strong> | <strong>1</strong> | <strong>2</strong></pre>

<p>
<a id="pgfId-1172941"></a>The <code>msg_level</code> value determines which diagnostic messages print before control returns to the operating system. The default <code>msg_level</code> value is 1.</p>

<p>
<a id="pgfId-1172959"></a></p>
<table class="webflareTable" id="#id1172942">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1172944">
<a id="pgfId-1172944"></a>msg_level</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1172946">
<a id="pgfId-1172946"></a>Messages printed</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1172948"></a><code>0</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1172950"></a>None</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1172952"></a><code>1</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1172954"></a>Simulation time and location</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1172956"></a><code>2</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1172958"></a>Simulation time, location, and statistics about the memory and CPU time used in the simulation</p>
</td>
</tr>
</tbody></table>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1172960"></a>In this release, the <code>$finish</code> function always behaves as though the <code>msg_level</code> value is <code>0</code>, regardless of the value you actually use.</div>
<p>
<a id="pgfId-1172961"></a>If the <code>$finish</code> function is called from an <code>analog</code> <code>initial</code> block, the simulator does not perform any simulation and exits with a message. In addition, when a simulation exits due to <code>$finish</code>, all appropriate <code>final_step</code> blocks are triggered.</p>
<p>
<a id="pgfId-1172962"></a>For example, to make the simulator exit, you might code</p>

<pre class="webflare-courier-new">
<a id="pgfId-1172963"></a>$finish ;</pre>
<h3>
<a id="pgfId-1172964"></a>$finish_current_analysis</h3>

<p>
<a id="pgfId-1172965"></a>Use the <code>$finish_current_analysis</code> function to stop the current transient analysis without exiting the simulator. The <code>$finish_current_analysis</code> enables you to stop the ongoing transient analysis and continue to run the remaining analysis. The syntax of <code>$finish_current_analysis</code> is the following:</p>

<pre class="webflare-courier-new">
<a id="pgfId-1172966"></a>finish_function ::=</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172967"></a>$finish_current_analysis [( msg_level )] ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172968"></a>msg_level ::=
&#160;&#160;&#160;&#160;    <strong>0</strong> | <strong>1</strong> | <strong>2</strong></pre>

<p>
<a id="pgfId-1172969"></a>where <code>msg_level</code> value works exactly the same way as it does in the <code>$finish</code> function.</p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1172970"></a>The <code>$finish_current_analysis</code> can be used to stop only the transient analysis and not any other analysis type.</div>

<h3>
<a id="pgfId-1172972"></a><a id="80695"></a>$stop</h3>

<p>
<a id="pgfId-1172973"></a>The <code>$stop</code> function is treated the same as the <code>$finish</code> function.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1172974"></a>stop_function ::=
&#160;&#160;&#160;&#160;    <strong>$stop</strong> [<strong>(</strong> msg_level <strong>)</strong>] <strong>;</strong></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1172975"></a>msg_level ::=
&#160;&#160;&#160;&#160;    <strong>0</strong> | <strong>1</strong> | <strong>2</strong></pre>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1172976"></a>In this release, the <code>$stop</code> function always behaves as though the <code>msg_level</code> value is 0, regardless of the value you actually use. In addition, the <code>$stop</code> function cannot be used within an analog initial block.</div>

<h3>
<a id="pgfId-1172979"></a><a id="85591"></a>$fa<a id="fatal"></a>tal</h3>

<p>
<a id="pgfId-1172980"></a>Use the <code>$fatal</code> function to generate a runtime fatal error message and make the simulator exit with an error code. The first argument to the <code>$fatal</code> function is the same as the <code>$finish</code> function and identifies which diagnostic message should the simulator print before exiting.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1172981"></a>fatal_function ::=
&#160;&#160;&#160;&#160;    <strong>$fatal</strong> [ ( msg_level [ , message_argument { , message_argument } ] ) ] <strong>;</strong></pre>

<p>
<a id="pgfId-1172982"></a>msg_level ::=
&#160;&#160;&#160;&#160;    <strong>0</strong> | <strong>1</strong> | <strong>2</strong></p>

<p>
<a id="pgfId-1173000"></a></p>
<table class="webflareTable" id="#id1172983">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1172985">
<a id="pgfId-1172985"></a>msg_level</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1172987">
<a id="pgfId-1172987"></a>Messages printed</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1172989"></a><code>0</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1172991"></a>None</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1172993"></a><code>1</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1172995"></a>Simulation time and location</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1172997"></a><code>2</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1172999"></a>Simulation time, location, and statistics about the memory and CPU time used in the simulation</p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1173001"></a>If you call the <code>$fatal</code> function from an <code>analog</code> <code>initial</code> block, the initialization is aborted after the message is generated and the simulation exits.</p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1173002"></a>Currently, the <code>$fatal</code> function, like the <code>$finish</code> function, behaves as though <code>msg_level</code> is <code>0</code> regardless of the value that you specify for <code>msg_level</code>.</div>

<h3>
<a id="pgfId-1173005"></a><a id="59848"></a>$er<a id="error"></a>ror</h3>

<p>
<a id="pgfId-1173006"></a>Use the <code>$error</code> function to generate a runtime error message.</p>

<a id="pgfId-1173007"></a><pre class="webflare-courier-new webflare-syx-syntax">
error_function ::=
     <strong>$error</strong> [ ( [ message_argument { , message_argument } ] ) ] <strong>;</strong></pre>

<p>
<a id="pgfId-1173008"></a>If you call the <code>$error</code> function from an <code>analog</code> <code>initial</code> block, the initialization continues after the message is generated.</p>

<h3>
<a id="pgfId-1173011"></a><a id="97456"></a>$war<a id="warning"></a>ning</h3>

<p>
<a id="pgfId-1173012"></a>Use the <code>$warning</code> function to generate a runtime warning message, which can be suppressed by the simulator.</p>

<a id="pgfId-1173013"></a><pre class="webflare-courier-new webflare-syx-syntax">
warning_function ::=
     <strong>$warning</strong> [ ( [ message_argument { , message_argument } ] ) ] <strong>;</strong></pre>

<p>
<a id="pgfId-1173014"></a>If you call the <code>$warning</code> function from an <code>analog</code> <code>initial</code> block, the initialization and simulation is not affected.</p>

<h3>
<a id="pgfId-1173017"></a><a id="38906"></a>$in<a id="info"></a>fo</h3>

<p>
<a id="pgfId-1173018"></a>Use the <code>$info</code> function to generate an informational message that does not include any severity.</p>

<a id="pgfId-1173019"></a><pre class="webflare-courier-new webflare-syx-syntax">
info_function ::=
     <strong>$info</strong> [ ( [ message_argument { , message_argument } ] ) ] <strong>;</strong></pre>

<p>
<a id="pgfId-1173020"></a>If you call the <code>$info</code> function from an <code>analog</code> <code>initial</code> block, the initialization and simulation is not affected.</p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1173021"></a>The <code>$fatal</code>, <code>$error</code>, <code>$warning</code>, and <code>$info</code> functions also report the simulation run time at which the severity system task is called. In addition, you can use these functions to include additional information using the same format as the <code>$display</code> function.</div>
<p>
<a id="pgfId-1173022"></a>Non-fatal system severity functions (<code>$error</code>, <code>$warning</code>, and <code>$info</code>) called during a rejected iteration do not have any effect. <code>$fatal</code> ends the simulation without checking whether the iteration should be rejected.</p>

<h2>
<a id="pgfId-1043500"></a><a id="marker-1134448"></a>Entering Interactive Tcl Mode</h2>

<p>
<a id="pgfId-1043508"></a>Use the <code>$stop</code> function to make the simulator enter interactive mode and display a Tcl prompt.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1043512"></a>stop_function ::=
&#160;&#160;&#160;&#160;    <strong>$stop</strong> [<strong>(</strong> msg_level <strong>)</strong>] <strong>;</strong></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051553"></a>msg_level ::=
&#160;&#160;&#160;&#160;    <strong>0</strong> | <strong>1</strong> | <strong>2</strong></pre>

<p>
<a id="pgfId-1043513"></a>The <code>msg_level</code> value determines which diagnostic messages print before the simulator starts the interactive mode. The default <code>msg_level</code> value is 1.</p>

<p>
<a id="pgfId-1091636"></a></p>
<table class="webflareTable" id="#id1043514">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1043516">
<a id="pgfId-1043516"></a>msg_level</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1043518">
<a id="pgfId-1043518"></a>Messages printed</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1043520"></a><code>0</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1043522"></a>None</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1043524"></a><code>1</code></p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1043526"></a>Simulation time and location</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1043528"></a>2</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1043530"></a>Simulation time, location, and statistics about the memory and CPU time used in the simulation</p>
</td>
</tr>
</tbody></table>

<p>
<a id="pgfId-1043532"></a>For example, to make the simulator go interactive, you might code</p>

<pre class="webflare-courier-new">
<a id="pgfId-1043533"></a>$stop ;</pre>
<h2>
<a id="pgfId-1033381"></a><a id="marker-1134450"></a><a id="41808"></a>User-Defined Functions</h2>

<p>
<a id="pgfId-1033384"></a>Verilog-AMS supports<a id="marker-1033382"></a><a id="marker-1033383"></a> user-defined functions. By defining and using your own functions, you can simplify your code and enhance readability and reuse. Each function can be a digital function (as defined in<em> IEEE 1364-1995 Verilog HDL</em>) or an analog function.</p>

<h3>
<a id="pgfId-1033386"></a><a id="marker-1134452"></a><a id="30341"></a>Declaring an Analog User-Defined Function</h3>

<p>
<a id="pgfId-1033388"></a>To <a id="marker-1033387"></a>define an analog function, use this syntax:</p>

<pre class="webflare-courier-new">
<a id="pgfId-1034808"></a>analog_function_declaration ::=
&#160;&#160;&#160;&#160;    <strong>analog function</strong> [ type ] <code><em>function_identifier</em></code> <strong>;
&#160;&#160;&#160;&#160;    </strong>function_item_declaration {function_item_declaration}
&#160;&#160;&#160;&#160;    <code><em>statement
&#160;&#160;&#160;&#160;    </em></code><strong>endfunction</strong></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051555"></a>type ::=
&#160;&#160;&#160;&#160;    <strong>integer<br /></strong> |&#160;&#160; <strong>real</strong></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051557"></a>function_item_declaration ::=
&#160;&#160;&#160;&#160;    input_declaration
&#160;&#160;&#160;&#160;|&#160;&#160; block_item_declaration</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051559"></a>block_item_declaration ::=
&#160;&#160;&#160;&#160;    integer_declaration
&#160;&#160;&#160;&#160;|&#160;&#160; real_declaration</pre>

<p>
<a id="pgfId-1034812"></a><code>type</code> is the type of the value returned by the function. The default value is <code>real</code>.</p>
<p>
<a id="pgfId-1033392"></a><span class="webflare-courier-new" style="white-space:pre"><em>statement</em></span> cannot include analog operators and cannot define module behavior. Specifically, <span class="webflare-courier-new" style="white-space:pre"><em>statement</em></span><a id="marker-1033391"></a> cannot include</p>
<ul><li>
<a id="pgfId-1033394"></a><code>ddt</code> operator</li><li>
<a id="pgfId-1033395"></a><code>idt</code> operator</li><li>
<a id="pgfId-1033396"></a><code>idtmod</code> operator</li><li>
<a id="pgfId-1033397"></a>Access functions</li><li>
<a id="pgfId-1034815"></a>Contribution statements</li><li>
<a id="pgfId-1034816"></a>Event control statements</li><li>
<a id="pgfId-1033398"></a>Simulator library functions, except that you can include the functions in the next list</li></ul>






<p>
<a id="pgfId-1033399"></a><span class="webflare-courier-new" style="white-space:pre"><em>statement</em></span> can include references to</p>
<ul><li>
<a id="pgfId-1033400"></a><code>$vt</code></li><li>
<a id="pgfId-1033401"></a><code>$vt(</code><span class="webflare-courier-new" style="white-space:pre"><em>temp</em></span><code>)</code></li><li>
<a id="pgfId-1033402"></a><code>$temperature</code></li><li>
<a id="pgfId-1033403"></a><code>$realtime</code></li><li>
<a id="pgfId-1045565"></a><code>$abstime</code></li><li>
<a id="pgfId-1033404"></a><code>analysis</code></li><li>
<a id="pgfId-1033405"></a><code>$strobe</code></li><li>
<a id="pgfId-1033406"></a><code>$display</code></li><li>
<a id="pgfId-1043577"></a><code>$write</code></li><li>
<a id="pgfId-1033407"></a><code>$fopen</code></li><li>
<a id="pgfId-1033408"></a><code>$fstrobe</code></li><li>
<a id="pgfId-1033409"></a><code>$fdisplay</code></li><li>
<a id="pgfId-1043576"></a><code>$fwrite</code></li><li>
<a id="pgfId-1033410"></a><code>$fclose</code></li><li>
<a id="pgfId-1033411"></a>All mathematical functions</li></ul>














<p>
<a id="pgfId-1033412"></a>You can declare local variables to be used in the function.</p>
<p>
<a id="pgfId-1033414"></a>Each function you define must have at least one declared input. Each function must also assign a value to the implicitly defined internal variable with the same name as the function.</p>
<p>
<a id="pgfId-1033415"></a>For example,</p>

<pre class="webflare-courier-new">
<a id="pgfId-1033416"></a>analog function real chopper ;
&#160;&#160;&#160;&#160;input sw, in ; // The function has two declared inputs.
&#160;&#160;&#160;&#160;real sw, in ;
//The next line assigns a value to the implicit variable, chopper.
&#160;&#160;&#160;&#160;chopper = ((sw &gt; 0) ? in : -in) ;<br />endfunction</pre>

<p>
<a id="pgfId-1033417"></a>The <code>chopper</code> function takes two variables, <code>sw</code> and <code>in</code>, and returns a real result. You can use the function in any subsequent function definition or in the module definition. </p>

<h3>
<a id="pgfId-1033421"></a><a id="36620"></a>Calling a User-Defined Analog Function</h3>

<p>
<a id="pgfId-1033424"></a>To <a id="marker-1033422"></a>call<a id="marker-1033423"></a> a user-defined analog function, use the following syntax.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1033425"></a>analog_function_call ::=
&#160;&#160;&#160;&#160;    <code><em>function_identifier</em></code> <strong>(</strong> <code><em>expression</em></code> { <strong>,</strong> <code><em>expression</em></code> } <strong>)</strong></pre>

<p>
<a id="pgfId-1033426"></a><span class="webflare-courier-new" style="white-space:pre"><em>function_identifier</em></span> must be the name of a defined function. Each <span class="webflare-courier-new" style="white-space:pre"><em>expression</em></span> is evaluated by the simulator before the function runs. However, do not rely on having expressions evaluated in a certain order because the simulator is allowed to evaluate them in any order.</p>
<p>
<a id="pgfId-1034817"></a>An analog function must not call itself, either directly or indirectly, because recursive functions are illegal. Analog function calls are allowed only inside of analog blocks.</p>
<p>
<a id="pgfId-1033427"></a>The module <code>phase_detector</code> illustrates how the <code>chopper</code> function can be called.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1033428"></a>module phase_detector(lo, rf, if0) ;<br />inout lo, rf, if0 ;<br />electrical lo, rf, if0 ;<br />parameter real gain = 1 ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051561"></a> function real chopper;<br />     input sw, in;<br />     real sw, in;<br />     chopper = ((sw &gt; 0) ? in : -in);<br /> endfunction</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1051563"></a>analog
&#160;&#160;&#160;&#160;V(if0) &lt;+ gain * chopper(V(lo),V(rf));  //Call from within the analog block.<br />endmodule</pre>
<br /><a href="#pagetop">Return to top</a><br /></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="chap8.html" id="prev" title="Analog">Analog </a></em></b><b><em><a href="chap10.html" id="nex" title="Instantiating Modules and Primitives">Instantiating Modules and Prim ...</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2019, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
</body></html>