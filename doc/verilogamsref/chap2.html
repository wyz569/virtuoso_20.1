
<html><head><title>Creating Modules</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="jommy" />
<meta name="CreateDate" content="2019-09-18" />
<meta name="CreateTime" content="1568827696" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes the analog and mixed-signal aspects of the Cadence Verilog-AMS language. With Verilog-AMS, you can create and use modules that describe the high-level behavior and structure of analog, digital, and mixed-signal components and systems." />
<meta name="DocTitle" content="Cadence Verilog-AMS Language Reference" />
<meta name="DocType" content="User Guide" />
<meta name="FileTitle" content="Creating Modules" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-3.1" />
<meta name="Keyword" content="verilogamsref" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2019-09-18" />
<meta name="ModifiedTime" content="1568827696" />
<meta name="NextFile" content="chap3.html" />
<meta name="Group" content="Analog Mixed-Signal Simulation" />
<meta name="Platform" content="Functional Verification" />
<meta name="PrevFile" content="chap1.html" />
<meta name="Product" content="Xcelium" />
<meta name="ProductFamily" content="Xcelium" />
<meta name="ProductVersion" content="19.09" />
<meta name="RightsManagement" content="Copyright 2012-2019 Cadence Design Systems Inc." />
<meta name="Title" content="Cadence Verilog-AMS Language Reference -- Creating Modules" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="product_feature" content="" />
<meta name="product_subfeature" content="" />
<meta name="Version" content="19.09" />
<meta name="SpaceKey" content="verilogamsref1909" />
<meta name="webflare-version" content="1.4" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" /></head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="verilogamsrefTOC.html">Contents</a></li><li><a class="prev" href="chap1.html" title="Modeling Concepts">Modeling Concepts</a></li><li style="float: right;"><a class="viewPrint" href="verilogamsref.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="chap3.html" title="Lexical Conventions">Lexical Conventions</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Cadence Verilog-AMS Language Reference<br />Product Version 19.09, September 2019</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;">

<h1>2
<a id="pgfId-1031800"></a><a id="37633"></a></h1>
<h1>
<a id="pgfId-1031802"></a><hr />
<a id="16009"></a>Creating Modules<a id="marker-1086326"></a><hr />
</h1>

<p>
<a id="pgfId-1086370"></a>A module definition appears between the keywords <code>module</code><a id="marker-1086459"></a> and <code>endmodule</code><a id="marker-1086460"></a> or <code>macromodule</code> and <code>endmodule</code>. The following definition for a digital to analog converter illustrates the <a id="marker-1086369"></a>form of a module definition. </p>

<p>
<a id="pgfId-1086394"></a></p>
<div class="webflare-div-image">
<img width="668" height="258" src="images/chap2-2.gif" /></div>

<p>
<a id="pgfId-1031803"></a>See the following topics for information about creating and using modules in Cadence<sup>&#174;</sup> Verilog<sup>&#174;</sup>-AMS: </p>
<ul><li>
<a id="pgfId-1031806"></a><a href="chap2.html#10303">Declaring Modules</a></li><li>
<a id="pgfId-1031810"></a><a href="chap2.html#21604">Declaring the Module Interface</a></li><li>
<a id="pgfId-1031814"></a><a href="chap2.html#64557">Specifying Supply Sensitivity Attributes</a></li><li>
<a id="pgfId-1087975"></a><a href="chap2.html#31616">Defining Module Analog Behavior</a></li><li>
<a id="pgfId-1086315"></a><a href="chap2.html#15924">Using Internal Nodes in Modules</a></li><li>
<a id="pgfId-1086317"></a><a href="chap10.html#20654">Chapter 10, &#8220;Instantiating Modules and Primitives&#8221;</a> <br />
<a id="pgfId-1086341"></a>This chapter contains detailed discussions about declaring and connecting ports and about instantiating modules. </li></ul>







<h2>
<a id="pgfId-1031863"></a><a id="10303"></a>Declaring Modules<a id="marker-1086273"></a></h2>

<p>
<a id="pgfId-1031865"></a>To declare a module, use this syntax.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1031866"></a>module_declaration ::= <br /><strong><em>&#160;&#160;&#160;&#160;    </em></strong>module_keyword <code><em>module_identifier</em></code> [ <strong>(</strong> list_of_ports <strong>)</strong> ] <strong>;</strong>  
&#160;&#160;&#160;&#160;    [ module_items ]
&#160;&#160;&#160;&#160;    <strong>endmodule</strong><a id="marker-1031867"></a> 
</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1033290"></a>module_keyword ::=
&#160;&#160;&#160;&#160;    <strong>module<br /></strong> |&#160;&#160; <strong>macromodule</strong></pre>
<pre class="webflare-courier-new">
<a id="pgfId-1033962"></a>module_items ::=
&#160;&#160;&#160;&#160;    { module_item }
&#160;&#160;&#160;&#160;|   analog_block

module_item ::= 
&#160;&#160;&#160;&#160;    module_item_declaration
&#160;&#160;&#160;&#160;|   parameter_override
&#160;&#160;&#160;&#160;|   module_instantiation
&#160;&#160;&#160;&#160;|   digital_continuous_assignment
&#160;&#160;&#160;&#160;|   digital_gate_instantiation
&#160;&#160;&#160;&#160;|   digital_udp_instantiation
&#160;&#160;&#160;&#160;|   digital_specify_block
&#160;&#160;&#160;&#160;|   digital_initial_construct
&#160;&#160;&#160;&#160;|&#160;&#160; digital_always_construct</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1086040"></a>module_item_declaration ::=
&#160;&#160;&#160;&#160;    parameter_declaration
&#160;&#160;&#160;&#160;|   aliasparam_declaration
&#160;&#160;&#160;&#160;|   input_declaration
&#160;&#160;&#160;&#160;|   output_declaration
&#160;&#160;&#160;&#160;|   inout_declaration
&#160;&#160;&#160;&#160;|   ground_declaration
&#160;&#160;&#160;&#160;|   integer_declaration
&#160;&#160;&#160;&#160;|   net_discipline_declaration
&#160;&#160;&#160;&#160;|   real_declaration
&#160;&#160;&#160;&#160;|   genvar_declaration
&#160;&#160;&#160;&#160;|   branch_declaration
&#160;&#160;&#160;&#160;|   analog_function_declaration
&#160;&#160;&#160;&#160;|   digital_function_declaration
&#160;&#160;&#160;&#160;|   digital_net_declaration
&#160;&#160;&#160;&#160;|   digital_reg_declaration
&#160;&#160;&#160;&#160;|   digital_time_declaration
&#160;&#160;&#160;&#160;|   digital_realtime_declaration
&#160;&#160;&#160;&#160;|   digital_event_declaration
&#160;&#160;&#160;&#160;|&#160;&#160; digital_task_declaration</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1038827"></a>parameter_override ::=
&#160;&#160;&#160;&#160;    <strong>defparam</strong> list_of_param_assignments <strong>;</strong></pre>
<p>
<a id="pgfId-1086251"></a></p>
<table class="webflareTable" id="#id1086235">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1086237"></a><span class="webflare-courier-new" style="white-space:pre"><em>module_identifier</em></span> </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1086239"></a>The name of the module being declared.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1086241"></a><code>list_of_ports</code> </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1086243"></a>An ordered list of the module&#8217;s ports. For details, see <a href="chap2.html#12546">&#8220;Ports&#8221;</a>.</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1086245"></a><code>module_items</code> </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1086247"></a>Declarations and definitions. </p>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1086262"></a>Note that you can have no more than one analog block in each module.</div>

</td>
</tr>
</tbody></table>
<p>
<a id="pgfId-1058055"></a></p>
<table class="webflareTable" id="#id1031876">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1031878">
<a id="pgfId-1031878"></a>For information about </span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id1031880">
<a id="pgfId-1031880"></a>Read </span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1031882"></a>Analog blocks</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1031886"></a><a href="chap2.html#31616">&#8220;Defining Module Analog Behavior&#8221;</a></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1031889"></a>Parameter overrides</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1031893"></a><a href="chap10.html#40611">&#8220;Overriding Parameter Values in Instances&#8221;</a></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1031903"></a>Module instantiation</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1031907"></a><a href="chap10.html#26570">&#8220;Instantiating Verilog-AMS Modules&#8221;</a></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033000"></a>Digital continuous assignments</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033002"></a>&#8220;Continuous Assignments&#8221; in the <em>Verilog-XL Reference</em></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032996"></a>Digital gate instantiations</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033984"></a>&#8220;Gate and Switch Declaration Syntax&#8221; in the <em>Verilog-XL Reference</em></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032992"></a>Digital udp instantiations</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032994"></a>&#8220;UDP Instances&#8221; in the <em>Verilog-XL Reference</em></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032988"></a>Digital specify blocks</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032990"></a>&#8220;Understanding Specify Blocks&#8221; in the <em>Verilog-XL Reference</em></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032984"></a>Digital initial constructs</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032986"></a>&#8220;initial Statement&#8221; in the <em>Verilog-XL Reference</em></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032980"></a>Digital always constructs</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032982"></a>&#8220;always Statement&#8221; in the <em>Verilog-XL Reference</em></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032966"></a>Parameter declarations</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032971"></a><a href="chap4.html#39933">&#8220;Parameters&#8221;</a></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1031910"></a>Input, output, and inout declarations</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1031914"></a><a href="chap2.html#12831">&#8220;Port Direction&#8221;</a></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1034394"></a>Ground declarations</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1034396"></a><a href="chap4.html#42243">&#8220;Ground Nodes&#8221;</a></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1031917"></a>Integer declarations</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1031922"></a><a href="chap4.html#28457">&#8220;Integer Numbers&#8221;</a></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032973"></a>Net discipline declarations</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1032978"></a><a href="chap4.html#33223">&#8220;Net Disciplines&#8221;</a></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1031924"></a>Real declarations</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1031929"></a><a href="chap4.html#15828">&#8220;Real Numbers&#8221;</a></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1083366"></a>Genvar declarations</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1083368"></a><a href="chap4.html#43033">&#8220;Genvars&#8221;</a></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033051"></a>Branch declarations</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033053"></a><a href="chap4.html#28929">&#8220;Named Branches&#8221;</a></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1034400"></a>Analog function declarations</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1034402"></a><a href="chap9.html#41808">&#8220;User-Defined Functions&#8221;</a></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033047"></a>Digital function declarations</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033049"></a>&#8220;Functions and Function Calling&#8221; in the <em>Verilog-XL Reference</em></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033043"></a>Digital net declarations</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033045"></a>&#8220;Net and Register Declaration Syntax&#8221; in the <em>Verilog-XL Reference</em></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033039"></a>Digital reg declarations</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033993"></a>&#8220;Net and Register Declaration Syntax&#8221; in the <em>Verilog-XL Reference</em></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033035"></a>Digital time declarations</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033037"></a>&#8220;Integers and Times&#8221; in the <em>Verilog-XL Reference</em></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033031"></a>Digital realtime declarations</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033033"></a>&#8220;Real Numbers&#8221; in the <em>Verilog-XL Reference</em> </p>

<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1086210"></a>The simulator evaluates realtime and real declarations identically.</div>

</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033027"></a>Digital event declarations</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033029"></a>&#8220;Event Control&#8221; in the <em>Verilog-XL Reference</em></p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033023"></a>Digital task declarations</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1033025"></a>&#8220;Tasks and Task Enabling&#8221; in the <em>Verilog-XL Reference</em></p>
</td>
</tr>
</tbody></table>
<h2>
<a id="pgfId-1031939"></a><a id="marker-1074027"></a><a id="marker-1031937"></a><a id="21604"></a>Declaring the Module Interface</h2>

<p>
<a id="pgfId-1031940"></a>Use the module interface declarations to define </p>
<ul><li>
<a id="pgfId-1031941"></a>Name of the module </li><li>
<a id="pgfId-1031942"></a>Ports of the module </li><li>
<a id="pgfId-1031943"></a>Parameters of the module </li></ul>


<p>
<a id="pgfId-1031946"></a>For <a id="marker-1031944"></a>example, the module <a id="marker-1031945"></a>interface declaration</p>

<pre class="webflare-courier-new">
<a id="pgfId-1031947"></a>module res(p, n) ;<br />inout p, n ;<br />electrical p, n ;<br />parameter real r = 0 ;</pre>

<p>
<a id="pgfId-1031948"></a>declares a module named <code>res</code>, ports named <code>p</code> and <code>n</code>, and a parameter named <code>r</code>. </p>

<h3>
<a id="pgfId-1031949"></a>Module <a id="modulename"></a>Name<a id="marker-1086510"></a></h3>

<p>
<a id="pgfId-1031950"></a>To define the name for a module, put an identifier after the keyword <code>module</code> or <code>macromodule</code>. Ensure that the new module name is unique among other module, schematic, subcircuit, and model names, and any built-in Spectre<sup>&#174;</sup> circuit simulator primitives. If your module has any ports, list them in parentheses following the identifier.</p>

<h3>
<a id="pgfId-1031952"></a><a id="12546"></a>Po<a id="moduleports"></a>rts<a id="marker-1086497"></a></h3>

<p>
<a id="pgfId-1031954"></a>To declare the ports used in a module, use port declarations. To specify the type and direction of a port, use the related declarations described in this section.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1031955"></a>list_of_ports ::= 
&#160;&#160;&#160;&#160;     port {<strong> ,</strong> port } 

port ::= 
&#160;&#160;&#160;&#160;     port_expression
&#160;&#160;&#160;&#160;|&#160;&#160;  <strong>.</strong>port identifier<strong>(</strong> [port_expression ]<strong>)<br /></strong>port_expression ::=
&#160;&#160;&#160;&#160;     port_identifier
&#160;&#160;&#160;&#160;|    port_identifier [ constant_expression ] 
&#160;&#160;&#160;&#160;|    port_identifier [ constant_range ] 

constant_range ::=
&#160;&#160;&#160;&#160;msb_constant_expression <strong>:</strong> lsb_constant_expression</pre>

<p>
<a id="pgfId-1034462"></a>For example, these code fragments illustrate possible port declarations.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1031957"></a>module exam1 ;&#160;&#160;             // Defines no ports</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1031958"></a>module exam2 (p, n) ;&#160;&#160;      // Defines 2 simple ports</pre>

<p>
<a id="pgfId-1072883"></a>Normally, you cannot use <code>Q</code> as the name of a port. However, if you need to use <code>Q</code> as a port name, you can use the special text macro identifier, <code>VAMS_ELEC_DIS_ONLY</code>, as follows.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1072889"></a>`define VAMS_ELEC_DIS_ONLY<br />`include &quot;disciplines.vams&quot;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1072895"></a>(module 1, which uses a port called Q)<br />(module 2, which use a port called Q)<br />...</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1072896"></a>`include &quot;disciplines.vams&quot;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1072897"></a>(module 3, which uses an access function called Q)<br />(module 4, which uses an access function called Q)<br />...</pre>

<p>
<a id="pgfId-1072937"></a>This macro undefines the sections in the <code>disciplines.vams</code> file that use <code>Q</code>, making it available for you to use as a port name. Consequently, when you need to use Q as an access function again, you need to include the <code>disciplines.vams</code> file again.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1086051"></a><a id="marker-1074033"></a>module exam5 (.b(p), .d(n))  // Defines the ports b and d, which are<br />                             // connected to the signals p and n,<br />                             // respectively</pre>
<h4>
<a id="pgfId-1034515"></a>Port Type</h4>

<p>
<a id="pgfId-1031964"></a>To declare the type of a <a id="marker-1031962"></a>port, use a net discipline declaration in the body of the module. If you do not declare the type of a <a id="marker-1031965"></a>port, you can use the port only in a <a id="marker-1031966"></a>structural description. In other words, you can pass the port to module instances, but you cannot access the port in a behavioral description. Net discipline declarations are described in <a href="chap4.html#33223">&#8220;Net Disciplines&#8221;</a>.</p>
<p>
<a id="pgfId-1034862"></a>Ports declared as vectors must use identical ranges for the port type and port direction declarations.</p>

<h4>
<a id="pgfId-1031971"></a><a id="12831"></a>Port Direction<a id="marker-1086490"></a></h4>

<p>
<a id="pgfId-1031974"></a>You must declare the port direction for every port in the list of ports section of the module declaration. To declare the <a id="marker-1031972"></a>direction<a id="marker-1031973"></a> of a port, use one of the following three syntaxes.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1031975"></a>input_declaration ::=
&#160;&#160;&#160;&#160;     <strong>input</strong> [ range ] list_of_port_identifiers <strong>;<br /></strong>output_declaration ::=
&#160;&#160;&#160;&#160;     <strong>output</strong> [ range ] list_of_port_identifiers <strong>;<br /></strong>inout_declaration ::=
&#160;&#160;&#160;&#160;     <strong>inout</strong> [ range ] list_of_port_identifiers <strong>;<br /></strong>range ::=
&#160;&#160;&#160;&#160;     <strong>[</strong> <code><em>constant_expression</em></code> <strong>:</strong> <code><em>constant_expression</em></code> <strong>]</strong></pre>

<ul><li>
<a id="pgfId-1031977"></a><code>input</code>: Declares that the signals on the port cannot be set, although they can be used in expressions.</li><li>
<a id="pgfId-1090351"></a><code>output</code>: Declares that the signals on the port can be set, but they cannot be used in expressions.</li><li>
<a id="pgfId-1090358"></a><code>inout</code>: Declares that the port is bidirectional. The signals on the port can be both set and used in expressions. <code>inout</code><a id="marker-1031981"></a><a id="marker-1031982"></a> is the default port direction.</li></ul>


<p>
<a id="pgfId-1031984"></a>Ports declared as vectors must use identical ranges for the port type and port direction declarations.</p>
<p>
<a id="pgfId-1034865"></a>In this release of Verilog-AMS, </p>
<ul><li>
<a id="pgfId-1031985"></a>The compiler does not enforce correct application of <code>input</code>, <code>output</code>, and <code>inout</code>.</li><li>
<a id="pgfId-1031986"></a>You cannot use parameters to define <span class="webflare-courier-new" style="white-space:pre"><em>constant_expression</em></span>.</li></ul>


<h4>
<a id="pgfId-1035215"></a>Port Declaration Example<a id="marker-1086483"></a></h4>

<p>
<a id="pgfId-1086056"></a>Module <code>daconv</code>, described below, has nine ports. The <code>compSig</code> port is declared with a port direction of <code>output</code>, so that its value can be set. The other ports are declared with a port direction of <code>input</code>, so that their values can be read. The <code>compSig</code> port is declared as an analog port of the <code>electrical</code> discipline.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1086057"></a>module daconv(b0, b1, b2, b3, b4, b5, b6, b7, compSig); // Declares nine ports
input b0, b1, b2, b3, b4, b5, b6, b7;        // Declares ports as input
output compSig;                              // Declares port as output

logic b0, b1, b2, b3, b4, b5, b6, b7;        // Declares type of digital ports
electrical compSig;                          // Declares type of analog port

parameter real refVolt = 12.0;

analog 
&#160;&#160;&#160;&#160;begin

&#160;&#160;&#160;&#160;    V(compSig) &lt;+  (refVolt/256) *(b0 + 2*(b1 + 2*(b2 + 2*(b3 +2*(b4 +2*
&#160;&#160;&#160;&#160;        (b5 +2*(b6 +2*b7)))))));

&#160;&#160;&#160;&#160;end<br />endmodule</pre>
<h3>
<a id="pgfId-1031990"></a>Para<a id="moduleparameters"></a>meters<a id="marker-1086478"></a></h3>

<p>
<a id="pgfId-1031992"></a>With parameter (and dynamicparam) declarations, you specify <a id="marker-1031991"></a>parameters that can be changed when a module is used as an instance in a design. Using parameters lets you customize each instance. </p>
<p>
<a id="pgfId-1031993"></a>For each parameter, you must specify a default value. You can also specify an optional type and an optional valid range. The following example illustrates how to declare parameters and variables in a module.</p>

<p>
<a id="pgfId-1034079"></a></p>
<div class="webflare-div-image">
<img width="637" height="315" src="images/chap2-3.gif" /></div>

<p>
<a id="pgfId-1032020"></a>Module <code>sdiode</code> has a parameter, <code>area</code>, that defaults to 1. If <code>area</code> is not specified for an instance, it receives a value of 1. Similarly, the other parameters, <code>is</code>, <code>n</code>, <code>cjo</code>, <code>m</code>, <code>phi</code>, and <code>tt</code>, have specified default values too.</p>
<p>
<a id="pgfId-1070244"></a>Module <code>sdiode</code> also defines three local variables: <code>vd</code>, <code>id</code>, and <code>qd</code>. </p>
<p>
<a id="pgfId-1070248"></a>For more information about parameter declarations, see <a href="chap4.html#39933">&#8220;Parameters&#8221;</a>.</p>

<h2>
<a id="pgfId-1070254"></a><a id="64557"></a>Specifying Supply <a id="supplySensitivity"></a>Sensitivity <a id="groundSensitivity"></a>Attributes<a id="marker-1086749"></a></h2>

<p>
<a id="pgfId-1086708"></a>Add the <code>groundSensitivity</code> and <code>supplySensitivity</code> attributes to a port or pin definition in a mattributesodule to make a connect module sensitive to supplies in the module to which it connects. </p>

<pre class="webflare-courier-new">
<a id="pgfId-1086738"></a>sensitivity_attribute ::= 
    &#160;&#160;&#160;&#160;<strong>(*</strong> [ <strong>integer groundSensitivity = &quot;</strong><code><em>gSig_sensitive_to</em></code><strong>&quot; ;</strong> ] <br /><strong>&#160;&#160;</strong>     [ <strong>integer supplySensitivity = &quot;</strong><code><em>sSig_sensitive_to</em></code><strong>&quot; ;</strong> ] <strong>*)</strong></pre>

<p>
<a id="pgfId-1086739"></a><span class="webflare-courier-new" style="white-space:pre"><em>gSig_sensitive_to</em></span>, <span class="webflare-courier-new" style="white-space:pre"><em>sSig_sensitive_to <br /></em></span>Names of signals, typically global signals, to which you want a connect module to be sensitive. </p>

<p>
<a id="pgfId-1086785"></a>When you specify a <code>supplySensitivity</code> or a <code>groundSensitivity</code> attribute on a signal in a connect module, the declared signal (in the connect module) takes on the value of the <code>supplySensitivity</code> or <code>groundSensitivity</code> signal you specify. </p>
<p>
<a id="pgfId-1086786"></a>When you specify a <code>supplySensitivity</code> or the <code>groundSensitivity</code> attribute (or both) on a signal in an ordinary module, the value of the <code>supplySensitivity</code> or <code>groundSensitivity</code> signal overrides the value of the signal of the same name in the connect module to which the ordinary module connects. </p>

<p>
<a id="pgfId-1086814"></a>For example, you might use the <code>groundSensitivity</code> attribute in a connect module (such as <code>l_to_e</code>, below) as follows: </p>

<pre class="webflare-courier-new">
<a id="pgfId-1086815"></a>connectmodule l_to_e(dval, aval);<br />    ...<br />    electrical (* integer groundSensitivity = &quot;global_pwr.pow1&quot; ; *) gnd ;<br />    ...<br />endmodule</pre>

<p>
<a id="pgfId-1086816"></a>The default value of <code>gnd</code> in this connect module is the value of signal <code>global_pwr.pow1</code>. If module <code>l_to_e</code> connects to digital port <code>d</code> in ordinary module <code>sample</code> (below), the value of <code>global_pwr.pow5</code>, which appears in the <code>groundSensitivity</code> attribute for <code>d</code>, overrides the default value of <code>gnd</code> in the connect module. </p>

<pre class="webflare-courier-new">
<a id="pgfId-1086985"></a>module sample(d);<br />    output (* integer groundSensitivity = &quot;global_pwr.pow5&quot; ; *) d ;<br />    ...<br />endmodule</pre>

<p>
<a id="pgfId-1086983"></a>If port <code>d</code> does not have a <code>groundSensitivity</code> attribute, the value of <code>gnd</code> in the connect module retains its default value of <code>global_pwr.pow1</code>: </p>

<pre class="webflare-courier-new">
<a id="pgfId-1086905"></a>module sample(d);<br />    output d ;<br />    ...<br />endmodule</pre>

<p>
<a id="pgfId-1087021"></a>Making a connect module sensitive to supplies in the connected digital port is more likely to produce the behavior you expect because: </p>
<ul><li>
<a id="pgfId-1086552"></a>When a connect module converts analog signals to digital values, the decision to output a one or a zero depends on the relationship between the analog signal and a threshold value. The software determines the threshold value based on the supply values in the component that includes the connected digital port. </li><li>
<a id="pgfId-1086553"></a>When a connect module converts digital values to analog signals, the connect module needs to determine what voltage to produce for each digital input value. Again, that voltage depends on the supplies in the component that includes the connected digital port. </li></ul>

<p>
<a id="pgfId-1086566"></a>The following basic principles apply to using these sensitivity attributes: </p>
<ul><li>
<a id="pgfId-1086568"></a>The software inserts connect modules between a digital port and an analog net. When you use the <code>groundSensitivity</code> and <code>supplySensitivity</code> attributes, you make the connect module sensitive to the signals on the digital port, regardless of the port direction. </li><li>
<a id="pgfId-1086569"></a>There are two steps involved in establishing ground or supply sensitivity: Specifying the necessary attributes in the connect module and adding the corresponding attributes to the connected digital port definition in the ordinary module. <br /><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1087098"></a>If the connected digital port is part of a schematic, you define the attributes on the connected pin on the schematic. </div></li><li>
<a id="pgfId-1086571"></a>You must use detailed discipline resolution or the sensitivity attributes have no effect. </li></ul>



<p>
<a id="pgfId-1087513"></a>See the following topics for more information: </p>
<ul><li>
<a id="pgfId-1087517"></a><a href="chap2.html#26313">Using the Sensitivity Attributes in a Chain of Buffers</a> </li><li>
<a id="pgfId-1087525"></a><a href="chap2.html#37506">Using Sensitivity Attributes with Inherited Connections</a></li></ul>


<h3>
<a id="pgfId-1086573"></a><a id="26313"></a>Using the Sensitivity Attributes in a Chain of <a id="supplySensitivityExample"></a>Buffers</h3>

<p>
<a id="pgfId-1086574"></a>Consider a design containing three buffers, such as the following, where buffers <code>ba1</code> and <code>ba3 </code>are analog blocks with analog input and output pins, and buffer <code>bd2</code> is a digital block with logic input and output pins: </p>

<p>
<a id="pgfId-1087158"></a></p>
<div class="webflare-div-image">
<img width="668" height="113" src="images/chap2-4.gif" /></div>

<p>
<a id="pgfId-1086602"></a>During elaboration, the software inserts connect modules across net <code>n1</code> and the digital input port of buffer <code>bd2</code>, and across the digital output port of buffer <code>bd2</code> and net <code>n2</code>. </p>
<p>
<a id="pgfId-1086603"></a>If you know this design has an operating voltage of 5.0 Volts, you might write an analog-to-digital connect module with hard-coded thresholds, such as the following: </p>

<pre class="webflare-courier-new">
<a id="pgfId-1086604"></a>&#8216;include &quot;disciplines.vams&quot;<br />connectmodule elect2logic(aVal, dVal);<br />    output dVal;<br />    input aVal;<br />    logic dVal;<br />    electrical aVal;<br />    reg temp;<br />    always begin              // Digital, do this always <br />    if(V(aVal) &gt;  3.0)<br />        #1 temp = 1;          // Delay 1 time unit, drive output 1<br />    else if (V(aVal) &lt; 2.0)<br />        #1 temp = 0;          // or drive output 0, depending on aVal <br />    else<br />        #1 temp = 1&#8217;bx;<br />    end<br />    assign dVal = temp;        // Bind register to digital output <br />endmodule</pre>

<p>
<a id="pgfId-1086609"></a>However, if the design can operate at 3.0 or 5.0 Volts depending on the supplies, you might use the <code>supplySensitivity</code> and <code>groundSensitivity</code> attributes to write a connect module that is sensitive to the supplies, such as the following: </p>

<pre class="webflare-courier-new">
<a id="pgfId-1087841"></a><a id="supplySensitiveConnectModule"></a>// Supply-sensitive connect module <br />&#8216;include &quot;disciplines.vams&quot;<br />connectmodule elect2logic(aVal, dVal);<br />    output dVal;<br />    input aVal;<br />    logic dVal;<br />    electrical aVal;<br />    electrical (* integer supplySensitivity = &quot;cds_globals.\\vdd! &quot; ; *) \vdd! ;<br />    electrical (* integer groundSensitivity = &quot;cds_globals.\\vss! &quot; ; *) \vss! ;<br />    reg temp;<br />    always begin                   // Do this always <br />    if(V(aVal) &gt;  ((V(\vdd! ) - V(\vss! ))/2 + 0.5 ))<br />        #1 temp = 1;               // Delay 1 time unit, drive output 1 <br />    else if (V(aVal) &lt; ((V(\vdd! ) - V(\vss! ))/2 -0.5))<br />        #1 temp = 0;               // or drive output 0, depending on aVal <br />    else<br />        #1 temp = 1&#8217;bx;<br />    end<br />    assign dVal = temp;             // Bind register to digital output <br />endmodule</pre>

<p>
<a id="pgfId-1087842"></a>The threshold values are functions of the supply and ground values. </p>
<p>
<a id="pgfId-1087843"></a>To specify the digital ports to which the connect module is sensitive, add <code>groundSensitivity</code> and <code>supplySensitivity</code> attributes to the connected digital port. In our example, the software inserts a connect module both at the input and at the output port of buffer <code>bd2</code>, so in the supply-sensitive module definition, you would add both sensitivity attributes to both ports of the buffer, like this: </p>

<pre class="webflare-courier-new">
<a id="pgfId-1086618"></a>module <a id="bux2_5V"></a>bux2_5V (Z,A);<br />input<br />    (* integer supplySensitivity=&quot;\\vdd! &quot;;<br />       integer groundSensitivity=&quot;\\vss! &quot;; *)<br />A ;<br />output<br />    (* integer supplySensitivity=&quot;\\vdd! &quot;;<br />       integer groundSensitivity=&quot;\\vss! &quot;; *)<br />Z;<br />wire \vss! ;<br />wire \vdd! ;<br />analog begin<br />    V(\vss! ) &lt;+ 0.0 ;<br />    V(\vdd! ) &lt;+ 5.0 ;<br />end<br />buf #1 (Z,A);<br />specify<br />    specparam<br />    t_A_Z_rise = 0.1,<br />    t_A_Z_fall = 0.1;<br />    // Delays<br />    (A +=&gt; Z) = (t_A_Z_rise,t_A_Z_fall);<br />endspecify<br />endmodule</pre>
<h3>
<a id="pgfId-1086628"></a><a id="37506"></a>Using Sensitivity Attributes with Inherited <a id="supplySensitivityInhConn"></a>Connections<a id="marker-1087713"></a></h3>

<p>
<a id="pgfId-1087557"></a>An inherited connection is a net expression associated with either a signal or a terminal. You use inherited connections to override specific global names in your design. For more information, see &#8220;Inherited Connections&#8221; in the <em>Virtuoso Schematic Editor L User Guide</em>. </p>
<p>
<a id="pgfId-1087576"></a>You can use inherited connections to set the values of signals on ports and use the supply sensitivity attributes to make a connect module sensitive to those values. By doing so, you can switch between different power supplies (that you set by inherited connections) and have connect modules that behave differently depending on the value of the supplies. </p>
<p>
<a id="pgfId-1087693"></a>For example, here is a buffer module with both supply sensitivity attributes on both the input and the output ports (<code>A</code> and <code>Z</code>). The signal name for each of the sensitivity attributes is an inherited connection (<code>\\vdd!</code> for <code>supplySensitivity</code> and <code>\\vss!</code> for <code>groundSensitivity</code>). The <code>inh_conn_prop_name</code> and <code>inh_conn_def_value</code> attributes on wires <code>\vss!</code> and <code>\vdd!</code> set the value of the inherited connections: </p>

<pre class="webflare-courier-new">
<a id="pgfId-1087655"></a>module bux2 (Z,A);<br />input<br />    (* integer supplySensitivity=&quot;\\vdd! &quot;;<br />       integer groundSensitivity=&quot;\\vss! &quot;; *)<br />A ;<br />output<br />    (* integer supplySensitivity=&quot;\\vdd! &quot;;<br />       integer groundSensitivity=&quot;\\vss! &quot;; *)<br />Z;<br />wire<br />    (* inh_conn_prop_name=&quot;lSup&quot;, // if set, specifies value for \vss! <br />        inh_conn_def_value=&quot;cds_globals.\\vss! &quot; *)<br />\vss! ; // \vss! has default value cds_globals.\\vss!<br />wire<br />    (* inh_conn_prop_name=&quot;hSup&quot;, // if set, specifies value for \vdd! <br />       inh_conn_def_value=&quot;cds_globals.\\vdd! &quot; *)<br />\vdd! ; // \vdd! has default value cds_globals.\\vdd!<br />buf #1 (Z,A);<br />&#8216;ifdef functional<br />&#8216;else<br />specify<br />    specparam<br />    t_A_Z_rise = 0.1,<br />    t_A_Z_fall = 0.1;<br />    // Delays<br />    (A +=&gt; Z) = (t_A_Z_rise,t_A_Z_fall);<br />endspecify<br />&#8216;endif<br />endmodule</pre>

<p>
<a id="pgfId-1087653"></a>You can compare this buffer module with <code>module bux2_5V</code> in the previous section, where the <code>\vss!</code> and <code>\vdd!</code> net values do not depend on inherited connections: </p>

<pre class="webflare-courier-new">
<a id="pgfId-1087878"></a>wire \vss! ;<br />wire \vdd! ;</pre>

<p>
<a id="pgfId-1087846"></a>The supply-sensitive connect module is the same as the one that appears in the previous section. </p>

<h2>
<a id="pgfId-1086302"></a><a id="marker-1074041"></a><a id="marker-1070252"></a><a id="31616"></a>Defining Module Analog Behavior</h2>

<p>
<a id="pgfId-1034119"></a>To define the analog (continuous time) behavioral characteristics of a module, you create an analog block. The simulator evaluates all the analog blocks in the various modules of a design as though the blocks are executing concurrently.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1087060"></a>analog_block ::= 
&#160;&#160;&#160;&#160;    <strong>analog</strong> analog_statement<br />
analog_statement ::= 
&#160;&#160;  analog_seq_block <br />   |analog_branch_contribution <br />   |analog_indirect_branch_assignment <br />   |analog_procedural_assignment <br />   |analog_conditional_statement <br />   |analog_for_statement <br />   |analog_case_statement <br />   |analog_event_controlled_statement <br />   |system_task_enable <br />   |statement <br />
statement ::= 
&#160;&#160;  seq_block <br />   |procedural_assignment <br />   |conditional_statement <br />   |loop_statement <br />   |case_statement</pre>

<p>
<a id="pgfId-1034443"></a><code>analog_statement</code> can appear only within the analog block.</p>
<p>
<a id="pgfId-1086086"></a><code>statement</code> can appear anywhere within the module, including within the analog block.</p>
<p>
<a id="pgfId-1034153"></a>See <a href="chap5.html#10229">&#8220;Sequential Block Statement&#8221;</a> for more information about <code>analog_seq_block</code> and <code>seq_block</code>. </p>
<p>
<a id="pgfId-1035272"></a>In the analog block, you can code <a id="marker-1035271"></a>contribution statements that define relationships among analog signals in the module. For example, consider the following contribution statements:</p>

<pre class="webflare-courier-new">
<a id="pgfId-1035273"></a>V(n1, n2) &lt;+ expression;<br />I(n1, n2) &lt;+ expression;</pre>

<p>
<a id="pgfId-1032038"></a>where <code>V(n1,n2)</code> and <code>I(n1,n2)</code> represent potential and flow sources, respectively. You can define <code>expression</code> to be any combination of linear, nonlinear, algebraic, or differential expressions involving module signals, constants, and parameters.</p>
<p>
<a id="pgfId-1032040"></a>The modules you write can contain at most a single <a id="marker-1032039"></a>analog block. When you use an <a id="marker-1032041"></a><a id="marker-1032042"></a>analog block, you must place it after the interface declarations and local declarations.</p>
<p>
<a id="pgfId-1086096"></a>Because the description in the analog block is a continuous-time behavioral description, you must not use blocking event control statements, such as blocking delays, events, or waits, within the block.</p>
<p>
<a id="pgfId-1086120"></a><a id="marker-1074043"></a>The following module includes an analog block and initial and always blocks. These blocks work together within a single module to define an analog to digital converter.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1086121"></a>module adc;<br />electrical vin;<br />parameter real a_amp = 5;        // This parameter is used by analog.<br />parameter real d_volt_range = 5; // This parameter is used by digital.<br />real a_freq, a_phase;<br />real d_half_range;<br />real d_vin;<br />real a_vin<br />real d_vin_save;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1086122"></a>reg [7:0] b;<br />
integer ii;
integer d_fd;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1086123"></a>initial begin<br />        b = 0;<br />        d_half_range = d_volt_range / 2;<br />        d_fd = $fopen(&quot;ms6.dat&quot;);<br />        $fstrobe(d_fd,&quot;time\tb\td_vin\ta_vin\n&quot;);<br />        d_vin = 0;<br />end</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1086124"></a>always begin<br />        #1;<br />        d_vin =  V(vin);          // Probes the voltage.<br />        d_vin_save = d_vin;<br />
&#160;&#160;      for (ii=0; ii &lt; 8; ii = ii + 1) begin // Converts the voltage into<br />                                              // an 8-bit register.<br />                if (d_vin &gt; d_half_range) begin<br />                        b[ii] = 1;<br />                d_vin = d_vin -  d_half_range;<br />                end else b[ii] = 0;<br />                d_vin = d_vin * 2;<br />        end<br />        // Writes the digital output to a file.<br />        $fstrobe(d_fd,&quot;%g\t%b\t%g\t%g&quot;,$abstime, b, d_vin_save, a_vin);<br />end</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1086125"></a>analog begin<br />      @(initial_step) begin<br />                a_freq = 10K;<br />      end<br />
&#160;&#160;    // input<br />      a_phase = 2*&#8216;M_PI*a_freq*$abstime;<br />      a_vin = a_amp*sin(a_phase);<br />      V(vin) &lt;+ a_amp*sin(a_phase);     // Creates a sinusoidal voltage source.<br />end<br />
endmodule</pre>
<h3>
<a id="pgfId-1032064"></a><a id="35582"></a>Defining Analog Behavior with Control Flow</h3>

<p>
<a id="pgfId-1032065"></a>You can also incorporate conditional control flow into a module. With <a id="marker-1032066"></a>control flow, you can define the behavior of a module in regions.</p>
<p>
<a id="pgfId-1033180"></a>The following module, for example, describes a <a id="marker-1033179"></a>voltage deadband amplifier <code>vdba</code>. If the input voltage is greater than <code>vin_high</code> or less than <code>vin_low</code>, the amplifier is active. When the amplifier is active, the output is <code>gain</code> times the differential voltage between the input voltage and the edge of the deadband. When the input is in the deadband between <code>vin_low</code> and <code>vin_high</code>, the amplifier is quiescent and the output voltage is zero.</p>

<p>
<a id="pgfId-1034080"></a></p>
<div class="webflare-div-image">
<img width="490" height="227" src="images/chap2-5.gif" /></div>
<pre class="webflare-courier-new">
<a id="pgfId-1033210"></a><a id="marker-1033208"></a><a id="marker-1033209"></a>module vdba(in, out);<br />input in ;<br />output out ;<br />electrical in, out ;<br />parameter real vin_low = -2.0 ;<br />parameter real vin_high = 2.0 ;<br />parameter real gain = 1 from (0:inf) ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1032099"></a> analog begin<br />      if (V(in) &gt;= vin_high) begin<br />           V(out) &lt;+ gain*(V(in) - vin_high) ;<br />      end else if (V(in) &lt;= vin_low) begin<br />           V(out) &lt;+ gain*(V(in) - vin_low) ;<br />      end else begin<br />           V(out) &lt;+ 0 ;<br />      end<br /> end</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1032100"></a>endmodule</pre>

<p>
<a id="pgfId-1032101"></a>The following graph shows the response of the <code>vdba</code> module to a sinusoidal source.</p>

<p>
<a id="pgfId-1034081"></a></p>
<div class="webflare-div-image">
<img width="505" height="268" src="images/chap2-6.gif" /></div>
<h3>
<a id="pgfId-1032380"></a><a id="marker-1074045"></a><a id="30954"></a>Using Integration and Differentiation with Analog Signals</h3>

<p>
<a id="pgfId-1032381"></a>The relationships that you define among analog signals can include time domain differentiation and integration. Verilog-AMS provides a time derivative function, <code>ddt</code>, and two time integral functions, <code>idt</code> and <code>idtmod</code>, that you can use to define such relationships. For example, you might write a behavioral description for an inductor as follows.<a id="marker-1032382"></a></p>

<pre class="webflare-courier-new">
<a id="pgfId-1032385"></a>m<a id="marker-1032383"></a><a id="marker-1032384"></a>odule induc(p, n);<br />inout p, n;<br />electrical p, n;<br />parameter real L = 0;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1032386"></a> analog<br /> &#160;&#160;   V(p, n) &lt;+ ddt(L * I(p, n)) ;</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1032387"></a>endmodule</pre>

<p>
<a id="pgfId-1032388"></a>In module <code>induc</code>, the voltage across the external ports of the component is defined as equal to the time derivative of <code>L</code> times the current flowing between the ports.</p>
<p>
<a id="pgfId-1032390"></a>To define a higher order derivative, you must use an <a id="marker-1032389"></a>internal node or signal. For example, module <code>diff_2</code> defines internal node <code>diff</code>, and sets <code>V(diff)</code> equal to the derivative of <code>V(in)</code>. Then the module sets <code>V(out)</code> equal to the derivative of <code>V(diff)</code>, in effect taking the second order derivative of <code>V(in)</code>. </p>

<pre class="webflare-courier-new">
<a id="pgfId-1032391"></a>module diff_2(in, out) ;<br />input in ;<br />output out ;<br />electrical in, out ;<br />electrical diff ;&#160;&#160;  // Defines an internal node.</pre>
<pre class="webflare-courier-new">
<a id="pgfId-1032392"></a> analog begin<br /> &#160;&#160;   V(diff) &lt;+ <a id="marker-1032393"></a>ddt(V(in)) ;
&#160;&#160;&#160;&#160;     V(out) &lt;+ ddt(V(diff)) ;
&#160;&#160;&#160;&#160;end<br />
endmodule</pre>

<p>
<a id="pgfId-1032396"></a>For time domain integration, use the <code>idt</code><a id="marker-1032395"></a> or <code>idtmod</code> functions, as illustrated in module <code>integrator</code>.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032397"></a>module integrator(in, out) ;
input in ;
output out ;
electrical in, out ;

&#160;&#160;&#160;&#160;analog begin
&#160;&#160;&#160;&#160;     V(out) &lt;+ idt(V(in), 0) ;
&#160;&#160;&#160;&#160;end<br />
endmodule</pre>

<p>
<a id="pgfId-1032400"></a>Module <code>integrator</code> sets the output voltage to the integral of the input voltage. The second term in the <code>idt</code> function is the initial condition. </p>

<p>
<a id="pgfId-1087905"></a></p>
<table class="webflareTable" id="#id1087909">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<p>
<a id="pgfId-1087938"></a>For more information on&#8230;</p>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<p>
<a id="pgfId-1087940"></a>see&#8230;</p>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1087911"></a><code>ddt</code> </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1087913"></a><a href="chap9.html#18023">&#8220;Time Derivative Operator&#8221;</a> </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1087915"></a><code>idtmod</code> </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1087917"></a><a href="chap9.html#36508">&#8220;Circular Integrator Operator&#8221;</a> </p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1087919"></a><code>idt</code> </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a id="pgfId-1087921"></a><a href="chap9.html#31165">&#8220;Time Integral Operator&#8221;</a> </p>
</td>
</tr>
</tbody></table>
<h2>
<a id="pgfId-1032413"></a><a id="marker-1074047"></a><a id="marker-1032410"></a><a id="15924"></a>Using Internal Nodes in <a id="marker-1032412"></a>Modules</h2>

<p>
<a id="pgfId-1032414"></a>Using Verilog-AMS, you can implement complex designs in a variety of different ways. For example, you can define behavior in modules at the leaf level and use the top-level module to define the structure of the system. You can also define structure within modules by defining internal nodes. With<a id="marker-1032415"></a> internal nodes, you can directly define behavior in the module, or you can introduce internal nodes as a means of solving higher order differential equations that define the network. </p>

<h3>
<a id="pgfId-1032416"></a><a id="marker-1074049"></a>Using Internal Nodes in Behavioral Definitions</h3>

<p>
<a id="pgfId-1032451"></a>Consider the following <a id="marker-1032417"></a>RLC circuit.</p>

<p>
<a id="pgfId-1034082"></a></p>
<div class="webflare-div-image">
<img width="670" height="158" src="images/chap2-7.gif" /></div>

<p>
<a id="pgfId-1032452"></a>Module <code>rlc_behav</code> uses an internal node <code>n1</code> and the ports <code>in</code>, <code>ref</code>, and <code>out</code>, to define directly the behavioral characteristics of the RLC circuit. Notice how <code>n1</code><a id="marker-1032453"></a> does not appear in the list of ports for the module.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032959"></a><a id="marker-1032957"></a><a id="marker-1032958"></a>module rlc_behav(in, out, ref) ;
inout in, out, ref ;
electrical in, out, ref ;
parameter real R=1, L=1, C=1 ;

&#160;&#160;&#160;&#160;electrical n1 ;

&#160;&#160;&#160;&#160;analog begin
&#160;&#160;&#160;&#160;     V(in, n1) &lt;+ R*I(in, n1) ;
&#160;&#160;&#160;&#160;     V(n1, out) &lt;+ L*ddt(I(n1, out)) ;
&#160;&#160;&#160;&#160;     I(out, ref) &lt;+ C*ddt(V(out, ref)) ;
&#160;&#160;&#160;&#160;end<br />
endmodule</pre>
<h3>
<a id="pgfId-1032459"></a><a id="marker-1074051"></a>Using <a id="marker-1032457"></a>Internal Nodes in H<a id="marker-1032458"></a>igher Order Systems </h3>

<p>
<a id="pgfId-1043275"></a>You can also represent the RLC circuit by its governing differential equations. The transfer function is given by</p>

<p>
<a id="pgfId-1089216"></a><img width="241" height="57" src="images/chap2-8.gif" /></p>

<p>
<a id="pgfId-1089475"></a>In the time domain, this becomes</p>

<p>
<a id="pgfId-1089487"></a><img width="308" height="42" src="images/chap2-9.gif" /></p>

<p>
<a id="pgfId-1089173"></a>If you set</p>

<p>
<a id="pgfId-1032473"></a><img width="101" height="32" src="images/chap2-10.gif" /></p>

<p>
<a id="pgfId-1089245"></a>you can write</p>

<p>
<a id="pgfId-1089515"></a><img width="293" height="40" src="images/chap2-11.gif" /></p>

<p>
<a id="pgfId-1032479"></a>Module <code>rlc_high_order</code> implements these descriptions.</p>

<pre class="webflare-courier-new">
<a id="pgfId-1032482"></a>m<a id="marker-1032480"></a>odule <a id="marker-1032481"></a>rlc_high_order(in, out, ref) ;
inout in, out, ref ;
electrical in, out, ref ;
parameter real R=1, L=1, C=1 ;

&#160;&#160;&#160;&#160;electrical n1 ;

&#160;&#160;&#160;&#160;analog begin
&#160;&#160;&#160;&#160;     V(n1, ref) &lt;+ ddt(V(out, ref)) ;
&#160;&#160;&#160;&#160;     V(out, ref) &lt;+ V(in) - (R*C*V(n1) - L*ddt(V(n1))*C ;
&#160;&#160;&#160;&#160;end<br />
endmodule</pre>

<p>
<a id="pgfId-1036632"></a></p>

<br /><a href="#pagetop">Return to top</a><br /></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="chap1.html" id="prev" title="Modeling Concepts">Modeling Concepts</a></em></b><b><em><a href="chap3.html" id="nex" title="Lexical Conventions">Lexical Conventions</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2019, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
</body></html>