
<html><head><title>Comparator Macromodel</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="TopicTags" content="TRUE" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="rgirdhar" />
<meta name="CreateDate" content="2020-08-14" />
<meta name="CreateTime" content="1597435096" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="The Cadence Functional Block Library Reference Manual is a library within the Cadence analog design enviroment and is used by analog designers as a high-level design tool." />
<meta name="DocTitle" content="Virtuoso Functional Block Library Reference" />
<meta name="DocType" content="Reference" />
<meta name="FileTitle" content="Comparator Macromodel" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-3.2.1" />
<meta name="Keyword" content="fblocklibref" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2020-08-14" />
<meta name="ModifiedTime" content="1597435096" />
<meta name="NextFile" content="appB.html" />
<meta name="Group" content="" />
<meta name="Platform" content="Custom IC Design" />
<meta name="PrevFile" content="chap3.html" />
<meta name="c_product" content="Virtuoso Analog Design Environment" />
<meta name="Product" content="Virtuoso Analog Design Environment" />
<meta name="ProductFamily" content="Virtuoso Analog Design Environment" />
<meta name="ProductVersion" content="ICADVM20.1" />
<meta name="RightsManagement" content="Copyright 2012-2020 Cadence Design Systems Inc." />
<meta name="Title" content="Virtuoso Functional Block Library Reference -- Comparator Macromodel" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="prod_feature" content="" />
<meta name="prod_subfeature" content="" />
<meta name="new_topic" content="No" />
<meta name="spotlight_topic" content="0" />
<meta name="Version" content="ICADVM20.1" />
<meta name="SpaceKey" content="fblocklibrefICADVM201" />
<meta name="webflare-version" content="2.0" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" /></head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="fblocklibrefTOC.html">Contents</a></li><li><a class="prev" href="chap3.html" title="Functional Block Library Examples">Functional Block Library Examp ...</a></li><li style="float: right;"><a class="viewPrint" href="fblocklibref.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="appB.html" title="OpAmp Macromodel">OpAmp Macromodel</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Virtuoso Functional Block Library Reference<br />Product Version ICADVM20.1, October 2020</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;"><a name="#firstpage"></a>

<h1>A
<a name="pgfId-919892"></a></h1>
<h1>
<a name="pgfId-919894"></a><hr />
<a name="33295"></a>Comparator Macromodel<hr />
</h1>

<p>
<a name="pgfId-919915"></a>The <a name="marker-919914"></a>comparator macromodel is a parameterized macromodel in the analog circuit design environment. This macromodel uses a simplified equivalent circuit to emulate the DC, AC, and transient nature of a real comparator&#8217;s electrical performance. </p>
<p>
<a name="pgfId-919916"></a>A macromodel is advantageous because it reduces computation time and space, but it still retains accuracy. The comparator model shown in this appendix is a modified model of the Harris level_0 comparator macromodel, which has a simple RC circuit with the clamping stage. This macromodel represents both the IC comparator&#8217;s performance and an ideal comparator as accurately as possible. </p>
<div class="webflare-information-macro webflare-macro-note">
<a name="pgfId-921658"></a>The use of the comparator macromodel does not create the same device as that denoted earlier in <a href="chap2.html#13955">Chapter 2, &#8220;Functional Block Library Components.&#8221;</a> For details about the comparator component, refer to <a href="chap2.html#11152">&#8220;Comparator&#8221;</a>.</div>
<p>
<a name="pgfId-919921"></a>The comparator macromodel simulates the following effects:</p>
<ul><li>
<a name="pgfId-919922"></a>Input bias current </li><li>
<a name="pgfId-919923"></a>Input offset current</li><li>
<a name="pgfId-919924"></a>Input offset voltage</li><li>
<a name="pgfId-919925"></a>Input resistance</li><li>
<a name="pgfId-919926"></a>Input capacitance</li><li>
<a name="pgfId-919927"></a>Open loop gain</li><li>
<a name="pgfId-919928"></a>Small-signal delay time</li><li>
<a name="pgfId-919929"></a>Small-signal rising and falling time</li><li>
<a name="pgfId-919930"></a>Overdrive voltage for small-signal transient response test</li><li>
<a name="pgfId-919931"></a>Output voltage swing</li><li>
<a name="pgfId-919932"></a>Output resistance</li></ul>











  <!--  [TOPIC_START_OPEN]type=cmdref

[TOPIC_START_ATTR]text=Circuit Diagram

[TOPIC_START_ATTR]description=

[TOPIC_START_ATTR]keyword=

[TOPIC_START_CLOSE] -->




<h3>
<a name="pgfId-919933"></a>Circuit Diagram</h3>

<p>
<a name="pgfId-919934"></a>The following figure is a schematic of the comparator macromodel circuit.</p>

<p>
<a name="pgfId-921649"></a></p>
<div class="webflare-div-image">
<img width="668" height="266" src="images/appA-2.gif" /></div>
<!-- [TOPIC_END] -->
  <!--  [TOPIC_START_OPEN]type=cmdref

[TOPIC_START_ATTR]text=Functional Description

[TOPIC_START_ATTR]description=

[TOPIC_START_ATTR]keyword=

[TOPIC_START_CLOSE] -->




<h3>
<a name="pgfId-921650"></a>Functional Description </h3>

<p>
<a name="pgfId-921651"></a>There are three stages in the comparator macromodel:</p>
<ul><li>
<a name="pgfId-919947"></a>Input stage</li><li>
<a name="pgfId-919948"></a>Gain and delay stage</li><li>
<a name="pgfId-919949"></a>Output stage</li></ul>



<h4>
<a name="pgfId-919951"></a>Input Stage</h4>

<p>
<a name="pgfId-919952"></a>The input stage is built with four components:</p>
<ul><li>
<a name="pgfId-919953"></a><em>Rin</em> =  input resistance</li><li>
<a name="pgfId-919954"></a><em>Cin</em> =  input capacitance</li><li>
<a name="pgfId-919955"></a><em>Ibp</em> =  bias current </li><li>
<a name="pgfId-919956"></a><em>Ibn</em> =  bias current</li></ul>



<p>
<a name="pgfId-919957"></a>The input stage of the comparator macromodel uses a rough linear approximation. The four components model the input current versus voltage variation around the active region. However, the input stage does not model the saturation and cutoff effects of the input currents and terminal resistances.</p>

<h4>
<a name="pgfId-919958"></a>Gain and Delay Stage</h4>

<p>
<a name="pgfId-919959"></a>The gain and delay stage is constructed with a voltage-controlled current source and a single RC time constant circuit.</p>
<p>
<a name="pgfId-919960"></a>G<sub>1</sub>, C<sub>1</sub>, R<sub>x</sub>, and R<sub>d</sub> create a single pole roll-off amplifier circuit. R<sub>x</sub>, R<sub>d</sub>, and G<sub>1</sub> model small signal gain. </p>
<p>
<a name="pgfId-919961"></a>The clamping voltages of the two diodes D<sub>h</sub> and D<sub>l</sub> are set to the value of the positive and negative output voltage swing. These diodes are built to be referenced directly to ground. If the negative output voltage swing V<sub>OL </sub>is defined as zero like the default value, an independent voltage source of value V<sub>OH</sub>/2 is inserted between the diodes and ground. This allows the output voltages to have symmetric limiting characteristics. </p>

<h4>
<a name="pgfId-919962"></a>Output Stage</h4>

<p>
<a name="pgfId-919963"></a>G<sub>2</sub> and R<sub>o</sub> build the output stage, which forms a gain of one buffer. G<sub>2</sub> is put there to isolate the gain stage and the outside load to reduce the unwanted influence of the load to the modeling of delay time.</p>

<!-- [TOPIC_END] -->
  <!--  [TOPIC_START_OPEN]type=cmdref

[TOPIC_START_ATTR]text=Macromodel Netlist

[TOPIC_START_ATTR]description=

[TOPIC_START_ATTR]keyword=

[TOPIC_START_CLOSE] -->




<h3>
<a name="pgfId-919964"></a>Macromodel Netlist</h3>

<p>
<a name="pgfId-919965"></a>The following shows a netlist of the comparator macromodel.</p>

<pre class="webflare-courier-new codeContent">
<a name="pgfId-921398"></a># comparator 0.s<br />#<br /># Description:  Small signal model of input stage, no<br />#               Io limits or power supply effects, simple<br />#               resistive input stage, small large signal<br />#               delay, constant Rout and no current limit<br />#<br /># Format:<br />#<br /># USE  comparator name ibias vos ios rin cin voh vol vis trs tds gol ro<br />#     &amp;1 &amp;2 &amp;3 &amp;4 &amp;5 &amp;6 &amp;7 &amp;8 &amp;9 &amp;10 &amp;11 &amp;12 &amp;13 <br />#<br /># Default values of the parameters:<br />#<br /># &amp;1   model name                                 name = &amp;1<br /># &amp;2   Input bias current                         ibias = 200n<br /># &amp;3   Input offset voltage                       vos = 0<br /># &amp;4   Input offset current                       ios = 10n<br /># &amp;5   Input resistance                           rin = 1meg<br /># &amp;6   Input capacitance                          cin = 1p<br /># &amp;7   Positive output voltage swing              voh = 5<br /># &amp;8   Negative output voltage swing              vol = 0<br /># &amp;9   Overdrive voltage for delay time test      vis = 2m<br /># &amp;10  Small signal rising and falling time test  trs = 20n<br /># &amp;11  Small signal delay time                    tds = 50n<br /># &amp;12  Open loop game                             gol = 100k<br /># &amp;13  Output resistance                          ro = 200<br />#<br />.subckt &amp;1 10 20 30<br />#<br /># Input stage<br />#<br />RIN   10  20   (&amp;5)<br />CIN   10  20   (&amp;6)<br />IBP   10  0    (&amp;2) +(&amp;4)/2<br />IBN   20  0    (&amp;2) -(&amp;4)/2<br />#<br /># Gain Stage<br />#<br />G1  0   2   poly    1  10  20 =-(&amp;3)*(&amp;12)  1E5=(&amp;12)/1E5<br />C1  2   0   ((&amp;11-&amp;10/2)/log(2))/(1E5/&amp;<br />             (&amp;12*(&amp;9)*(&amp;10)/(&amp;7-(&amp;8))/((&amp;11-&amp;10/2)/log(2))-1))<br />RX  2   3   1E5/(&amp;12*(&amp;9)*&amp;10/(&amp;7-(&amp;8))/((&amp;11-&amp;10/2)/log(2))-1)<br />#<br />If &amp;7*(&amp;8)&lt;&gt;0 then <br />  RD   3 0   1E5<br />  DH   3 0   DH<br />  DL   0 3   DL<br /> .MODEL DH D  IS = 0.3*(&amp;12)/1E33  N = &amp;7/VT/LOG(1E28) <br /> .MODEL DL D  IS = 0.3*(&amp;12)/1E33  N = -(&amp;8)/VT/LOG(1E28)<br />else<br />  RD   3 8    1E5<br />  DH   3 8    DM<br />  DL   8 3    DM<br />  VM   8 0    (&amp;7+(&amp;8))/2<br /> .MODEL DM D  IS=0.3*(&amp;12)/1E33  N=(&amp;7+&amp;(&amp;8))/2/VT/LOG(1E28) <br />endif<br />#<br />#   Output Stage<br />#<br />RO  0 30   (&amp;13)<br />G2  0 30   poly 1 3 0  0 =1/(&amp;13+0.1)<br />.ends &amp;1</pre>
<!-- [TOPIC_END] -->
  <!--  [TOPIC_START_OPEN]type=cmdref

[TOPIC_START_ATTR]text=Using the Comparator Macromodel

[TOPIC_START_ATTR]description=

[TOPIC_START_ATTR]keyword=

[TOPIC_START_CLOSE] -->




<h2>
<a name="pgfId-919967"></a>Using the Comparator Macromodel</h2>

<p>
<a name="pgfId-919968"></a>You can use the comparator macromodel by</p>
<ul><li>
<a name="pgfId-919969"></a>Defining the common specification sheet values, available in most semiconductor product catalogs</li><li>
<a name="pgfId-919970"></a>Placing the comparator macromodel symbol in your schematic</li><li>
<a name="pgfId-919971"></a>Defining the CDF parameter values and by using default values for parameters that you do not set</li></ul>



<!-- [TOPIC_END] -->
  <!--  [TOPIC_START_OPEN]type=cmdref

[TOPIC_START_ATTR]text=Entering the Macromodel into Your Design

[TOPIC_START_ATTR]description=

[TOPIC_START_ATTR]keyword=

[TOPIC_START_CLOSE] -->




<h3>
<a name="pgfId-919972"></a>Entering the Macromodel into Your Design</h3>

<p>
<a name="pgfId-919973"></a>The following is a comparator macromodel symbol:</p>

<p>
<a name="pgfId-921104"></a></p>
<div class="webflare-div-image">
<img width="668" height="121" src="images/appA-3.gif" /></div>

<p>
<a name="pgfId-919984"></a>For proper operation of the macromodel, you need to connect the following three I/O pins.</p>
<table class="webflareTable" id="#id923665">
<tbody><tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-923667"></a>IN</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-923669"></a>Positive input terminal</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-923671"></a>INN</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-923673"></a>Negative input terminal</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-923675"></a>OUT</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-923677"></a>Output terminal</p>
</td>
</tr>
</tbody></table>

<!-- [TOPIC_END] -->
  <!--  [TOPIC_START_OPEN]type=cmdref

[TOPIC_START_ATTR]text=Setting Macromodel Parameters

[TOPIC_START_ATTR]description=

[TOPIC_START_ATTR]keyword=

[TOPIC_START_CLOSE] -->




<h3>
<a name="pgfId-919986"></a>Setting Macromodel Parameters</h3>

<p>
<a name="pgfId-919987"></a>There are 12 parameters you can use to describe the behavior of the comparator macromodel.</p>

<p>
<a name="pgfId-921455"></a> </p>
<table class="webflareTable" id="#id919988">
<tbody><tr>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id919990">
<a name="pgfId-919990"></a>Property</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id919992">
<a name="pgfId-919992"></a>Typical Value</span>
</th>
<th class="webflareTh" colspan="1" rowspan="1">
<span class="tbl-head" id="#id919994">
<a name="pgfId-919994"></a>Description</span>
</th>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-919996"></a>ibias</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-919998"></a>200 n </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920000"></a>Input bias current</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920002"></a>vos</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920004"></a>0</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920006"></a>Input offset voltage</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920008"></a>ios</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920010"></a>10 n</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920012"></a>Input offset current</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920014"></a>rin</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920016"></a>1 meg</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920018"></a>Input resistance</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920020"></a>cin </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920022"></a>1 p</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920024"></a>Input capacitance</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920026"></a>voh</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920028"></a>5</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920030"></a>Positive output voltage swing</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920032"></a>vol</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920034"></a>0 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920036"></a>Negative output voltage swing</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920038"></a>vis</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920040"></a>2 m</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920042"></a>Overdrive voltage for small-signal transient response test</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920044"></a>trs</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920046"></a>20 n</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920048"></a>Small-signal rising and falling time</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920050"></a>tds</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920052"></a>50 n</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920054"></a> Small-signal delay time</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920056"></a>gol</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920058"></a>100 k</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920060"></a> Open loop gain</p>
</td>
</tr>
<tr>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920062"></a>ro</p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920064"></a>200 </p>
</td>
<td class="webflareTd" colspan="1" rowspan="1">
<p>
<a name="pgfId-920066"></a> Output resistance</p>
</td>
</tr>
</tbody></table>

<p>
<a name="pgfId-920067"></a>The cell CDF description defines these parameters. You can make these properties arbitrary functions of temperature (<code>TEMPDC</code>), random number generators, or other user-defined variables. For example, you can specify the offset voltage &#8220;vos&#8221; linear function for temperature by entering its value in the CDF description as follows:</p>

<pre class="webflare-courier-new codeContent">
<a name="pgfId-922159"></a>3m + 0.01m * (TEMPDC - 25)</pre>
<!-- [TOPIC_END] -->
  <!--  [TOPIC_START_OPEN]type=cmdref

[TOPIC_START_ATTR]text=Accuracy and Limitations

[TOPIC_START_ATTR]description=

[TOPIC_START_ATTR]keyword=

[TOPIC_START_CLOSE] -->




<h2>
<a name="pgfId-920069"></a>Accuracy and Limitations</h2>

<p>
<a name="pgfId-920070"></a>Electrical effects are modeled accurately by this macromodel. However, such a simple circuit might not work as a comprehensive model. The comparator macromodel</p>
<ul><li>
<a name="pgfId-920071"></a>Cannot model specifications that are not defined as macromodel parameters</li><li>
<a name="pgfId-920072"></a>Cannot model high frequency response <br />
<a name="pgfId-921667"></a>The behavior of the comparator at a frequency higher than 1/(4 × t ds) is not expected to match the circuit measurements. The capacitor of the single time constant circuit is not fully charged. The delay time might not be realistic.</li><li>
<a name="pgfId-920073"></a>Cannot vary delay time according to the input overdrive voltage</li><li>
<a name="pgfId-920074"></a>Cannot model hysteresis effects</li></ul>





<!-- [TOPIC_END] -->
  <!--  [TOPIC_START_OPEN]type=cmdref

[TOPIC_START_ATTR]text=Example

[TOPIC_START_ATTR]description=

[TOPIC_START_ATTR]keyword=

[TOPIC_START_CLOSE] -->




<h2>
<a name="pgfId-920076"></a>Example</h2>

<p>
<a name="pgfId-920077"></a>Below is a schematic of a Schmitt Trigger that uses the <a name="marker-920078"></a>comparator macromodel.</p>

<p>
<a name="pgfId-921110"></a></p>
<div class="webflare-div-image">
<img width="663" height="428" src="images/appA-4.gif" /></div>
<!-- [TOPIC_END] -->

<p>
<a name="pgfId-922263"></a></p>

<br /><a href="#pagetop">Return to top</a><br /></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="chap3.html" id="prev" title="Functional Block Library Examples">Functional Block Library Examp ...</a></em></b><b><em><a href="appB.html" id="nex" title="OpAmp Macromodel">OpAmp Macromodel</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2020, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
</body></html>