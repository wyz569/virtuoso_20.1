
<html><head><title>Placing and Routing the Design</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="Approver" content="Technical Publications" />
<meta name="Author" content="spriya" />
<meta name="CreateDate" content="2020-09-16" />
<meta name="CreateTime" content="1600316867" />
<meta name="DataType" content="Manuals" />
<meta name="Description" content="Describes the features and functionality of the Virtuoso Custom Placer in the ICADV 12.2 release." />
<meta name="DocTitle" content="Virtuoso Automated Device Placement and Routing Flow Guide" />
<meta name="DocType" content="User Guide" />
<meta name="FileTitle" content="Placing and Routing the Design" />
<meta name="FileType" content="Chapter" />
<meta name="FMWikiRelease" content="FM-Wiki-3.2.1" />
<meta name="Keyword" content="autodevicelayoutflow" />
<meta name="Language" content="English" />
<meta name="ModifiedDate" content="2020-09-16" />
<meta name="ModifiedTime" content="1600316867" />
<meta name="NextFile" content="AutoDeviceArray.html" />
<meta name="Group" content="" />
<meta name="Platform" content="Custom IC Design" />
<meta name="PrevFile" content="Place.html" />
<meta name="c_product" content="Virtuoso Layout Suite" />
<meta name="Product" content="Virtuoso Layout Suite" />
<meta name="ProductFamily" content="Virtuoso Layout Suite" />
<meta name="ProductVersion" content="ICADVM20.1" />
<meta name="RightsManagement" content="Copyright 2012-2020 Cadence Design Systems Inc." />
<meta name="Title" content="Virtuoso Automated Device Placement and Routing Flow Guide -- Placing and Routing the Design" />
<meta name="Keywords" content="" />
<meta name="topic_type" content="" />
<meta name="reference_type" content="" />
<meta name="prod_feature" content="" />
<meta name="prod_subfeature" content="" />
<meta name="new_topic" content="No" />
<meta name="spotlight_topic" content="0" />
<meta name="Version" content="ICADVM20.1" />
<meta name="SpaceKey" content="autodevicelayoutflowICADVM201" />
<meta name="webflare-version" content="2.0" />
<link rel="stylesheet" href="styles/webflare.css" type="text/css" /></head><body style="background-color: #FFFFFF;"><a name="pagetop"></a>
<!-- Begin Buttons -->
<header><div class="docHeadr">Product Documentation<img src="icons/Cadence-Logo.jpg" /></div><nav class="blueHead"><ul><li><a class="content" href="autodevicelayoutflowTOC.html">Contents</a></li><li><a class="prev" href="Place.html" title="Initializing and Planning the Layout">Initializing and Planning the  ...</a></li><li style="float: right;"><a class="viewPrint" href="autodevicelayoutflow.pdf">View/Print PDF</a></li><li style="float: right;margin-right: 25px;"><a class="nextd" href="AutoDeviceArray.html" title="Generating Modgens Automatically">Generating Modgens Automatical ...</a></li></ul></nav></header>
<!-- End Buttons -->
<h5><center>Virtuoso Automated Device Placement and Routing Flow Guide<br />Product Version ICADVM20.1, October 2020</center></h5><div id="main-content" style="min-height: 50vh; margin-left: 5%; margin-right: 2%;"><a name="#firstpage"></a>

<h1>3
<a id="pgfId-1065082"></a></h1>
<h1>
<a id="pgfId-1065083"></a><hr />
Placing and Routing the Design<hr />
</h1>

<p>
<a id="pgfId-1065596"></a>This chapter covers the following topics:</p>
<ul><li>
<a id="pgfId-1069252"></a><a href="Routing.html#29368">Placing Devices</a></li><li>
<a id="pgfId-1072279"></a><a href="Routing.html#91645">Adding Base Layer Fill</a></li><li>
<a id="pgfId-1069274"></a><a href="Routing.html#66517">Routing the Design</a></li></ul>



<h2>
<a id="pgfId-1071979"></a><a id="29368"></a><a id="98610"></a>Placing De<a id="place"></a>vices</h2>

<p>
<a id="pgfId-1071980"></a>After initializing the layout and generating the required constraints and tracks, the next task is to place the devices and pins within the PR boundary. The Virtuoso automated device placement and routing flow supports two placement models: </p>
<ul><li>
<a id="pgfId-1071984"></a><a href="Routing.html#83170">Automatic Placement</a>: Placement is performed by running the Virtuoso device-level automatic placer.</li><li>
<a id="pgfId-1071988"></a><a href="Routing.html#84968">Interactive Placement</a>: Devices are placed semi-automatically. Depending on the placement needs and the complexity of the design, you can first run the Virtuoso device-level automatic placer, and then use the interactive placement options to refine the placement. </li></ul>


<h3>
<a id="pgfId-1071990"></a><a id="83170"></a>Automatic Placement</h3>

<p>
<a id="pgfId-1071991"></a>The Virtuoso device-level placer analyzes the constraints from various sources, such as Modgens, Constraint Manager, figGroups, and circuit finder, and runs the global placer to achieve the required placement results without any design rule violations. </p>
<p>
<a id="pgfId-1071992"></a>To run the Virtuoso device-level automatic placer:</p>
<ol><li>
<a id="pgfId-1071993"></a>Click <em>Place Devices</em> on the <em>Flow</em> tab of the Auto Device P&amp;R assistant to open the <em>Placer</em> tab.<br />
<a id="pgfId-1072000"></a><div class="webflare-div-image">
<img width="668" height="538" src="images/Routing-2.gif" /></div></li><li>
<a id="pgfId-1072001"></a>Select one of the following placement objectives:<br />
<a id="pgfId-1072002"></a><em>- Area Only: </em>Place devices to optimize compactness.<br />
<a id="pgfId-1072003"></a><em>- Wire Length Only:</em> Minimizes the wire length for better routability.<br />
<a id="pgfId-1072004"></a><em>- Area and Wire Length:</em> Achieve a balance between compact placement and reduced wire length.</li><li>
<a id="pgfId-1072005"></a>Select one of the following options to specify the placement region:<br />
<a id="pgfId-1072006"></a><em>- Aspect Ratio</em>: Generates a placement boundary as per the specified dimensions. The default value is 1.00, which specifies a square boundary. An aspect ratio of .50 specifies a boundary twice as high as it is wide. A value of 2.00 specifies a boundary twice as wide as it is high. Multiple placement results can be obtained for different aspect ratios. Examples:<br /><ffi2-fig-frame-in-2 id="#id1072473">
<a id="pgfId-1072473"></a></ffi2-fig-frame-in-2><div class="webflare-div-image">
<img src="images/AspectRatioExamples.gif" /></div>
<a id="pgfId-1072011"></a><em>- PR Boundary</em>: Fits all the objects inside the existing PR boundary. The placer does not adjust the boundary.<br /><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1078562"></a>In the <em>Aspect Ratio</em> mode, you can set <a href="Envars.html#26452">autoPlaceAdjustBoundary</a> to <code>t</code> to let the placer adjust the PR boundary to enclose all the components in the design. You can also set <a href="Envars.html#47974">autoPlaceAdjustRowRegion</a> to <code>t</code> to let the placer adjust the row regions during placement. </div><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1077788"></a>To enable the placer to follow the aspect ratio specified in the initialization step, set <em>PR Boundary</em> as the placement region. Otherwise, the placer follows the aspect ratio specified in the placement options.</div><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1078175"></a>To lock the aspect ratio of all Modgens while running the placer, set <a href="Envars.html#31125">autoPlaceLockFGAR</a> to <code>t</code>. The aspect ratio-related settings defined in the Auto Device Array form are ignored. When set to <code>nil</code> (default), the aspect ratio settings in the Auto Device Array form are honored while running the placer.</div></li><li>
<a id="pgfId-1072012"></a>Click <em>Run Auto Place</em> to run the placer. <br />
<a id="pgfId-1076007"></a>Click <em>Run ECO Place</em> to run the placer to incrementally place the non-optimally placed devices, such as the unplaced, overlapping, non-grid compliant, and non-row compliant devices. These devices are placed based on their connectivity with the placed components, while honoring all constraints and grids. The incremental placer runs without changing the aspect ratio of the figGroups and Modgens. The incremental place run results depend on the starting layout.<br />
<a id="pgfId-1076251"></a>When you run the placer, a progress bar that indicates the placement status is displayed at the bottom-right corner of the design canvas. The run placer button changes to the stop placer button, which lets you stop the placer and revert the design placement to its initial state.<br />
<a id="pgfId-1076679"></a><div class="webflare-div-image">
<img width="668" height="373" src="images/Routing-4.gif" /></div></li></ol>





























<p>
<a id="pgfId-1072013"></a>The following image depicts the automatic row-based, constraint-compliant placement of devices and groups achieved after running the Virtuoso device-level automatic placer.</p>

<p>
<a id="pgfId-1072025"></a></p>
<div class="webflare-div-image">
<img width="668" height="381" src="images/Routing-5.gif" /></div>
<h3>
<a id="pgfId-1072027"></a><a id="84968"></a>Interactive Placement</h3>

<p>
<a id="pgfId-1072028"></a>To run the device-level interactive placer:</p>
<ol><li>
<a id="pgfId-1072029"></a>Select <em>Context Menu</em> to display a shortcut menu that lets you perform context-sensitive operations on devices and device groups directly in the layout canvas. For more information, see <a href="Routing.html#44640">Interactive Placement Using the Context Menu</a>.</li><li>
<a id="pgfId-1072033"></a>Select <em>Row Snapping</em> to display row snapping-related details in the Information pane during interactive placement of devices.</li><li>
<a id="pgfId-1072034"></a>Select <em>WSP Snapping</em> to display SP and WSP snapping-related details in the Information pane during interactive placement of devices.<br />
<a id="pgfId-1072038"></a><div class="webflare-div-image">
<img width="668" height="225" src="images/Routing-6.gif" /></div></li></ol>





<h4>
<a id="pgfId-1072040"></a><a id="44640"></a>Interactive Placement Using the Context Menu</h4>

<p>
<a id="pgfId-1072041"></a>Select <em>Context Menu</em> in the <em>Interactive Placer</em> section to display a shortcut menu when you select devices and device groups in the layout canvas.</p>
<p>
<a id="pgfId-1072042"></a>The following images show the context-sensitive menus for devices and device groups.</p>

<p>
<a id="pgfId-1072052"></a></p>
<div class="webflare-div-image">
<img width="668" height="577" src="images/Routing-7.gif" /></div>

<p>
<a id="pgfId-1072053"></a>The context menu lists the following interactive placement options:</p>
<ul><li>
<a id="pgfId-1072054"></a>Group and Ungroup Devices: Lets you group and ungroup the selected devices. The relative positions of the grouped devices are always maintained. Grouped devices can be in the same or different rows. Devices in a group are abutted horizontally. <br />
<a id="pgfId-1072055"></a>The following image shows the vertical grouping of devices across two different rows.<br />
<a id="pgfId-1072060"></a><div class="webflare-div-image">
<img width="668" height="204" src="images/Routing-8.gif" /></div>
<a id="pgfId-1072061"></a>In the following image, a device is moved to a new location. The other devices in the group are also moved to new locations to maintain the relative positions of the grouped devices.<br />
<a id="pgfId-1076862"></a><div class="webflare-div-image">
<img src="images/GroupMove.gif" /></div>
<a id="pgfId-1072065"></a>You can merge two or more device groups by selecting the groups and then selecting <em>Group</em> from the context menu.</li><li>
<a id="pgfId-1072066"></a>Taller: Stacks the selected devices vertically. This option is applicable only for grouped devices.<br />
<a id="pgfId-1072067"></a>The following example shows the effect of choosing the <em>Taller</em> setting for a horizontal group of devices.<br />
<a id="pgfId-1072076"></a><div class="webflare-div-image">
<img width="668" height="233" src="images/Routing-10.gif" /></div>
<a id="pgfId-1072077"></a>When you move a stacked device, the associated grouped devices are also moved to new locations so that their relative positions are maintained.</li><li>
<a id="pgfId-1072078"></a>Wider: Arranges the selected devices horizontally. This option is applicable only for grouped devices. Therefore, when you move a grouped device, the relative positions of the other devices in the group are also updated.</li><li>
<a id="pgfId-1072079"></a>Spread Any: Moves existing devices in any direction to avoid overlaps. This option is applicable when you move a device to a position where there is another (overlapping) device. The device that you moved is placed at the new location, while the existing device is moved to avoid overlaps. An arrow indicating the direction of movement is displayed.<br />
<a id="pgfId-1072088"></a><div class="webflare-div-image">
<img width="668" height="303" src="images/Routing-11.gif" /></div></li><li>
<a id="pgfId-1072089"></a>Spread X: Moves existing devices in the X-direction to avoid overlaps. This option is applicable when you move a device to a position where there is another (overlapping) device. The device that you moved is placed at the new location, while the existing device is moved to avoid overlaps. <br />
<a id="pgfId-1072102"></a><div class="webflare-div-image">
<img width="668" height="404" src="images/Routing-12.gif" /></div>
<a id="pgfId-1072103"></a>An info balloon that summarizes the following information is displayed:<br />
<a id="pgfId-1072104"></a>- Total wire length<br />
<a id="pgfId-1072105"></a>- Change in wire length<br />
<a id="pgfId-1072106"></a>- Row to which the device has snapped<br />
<a id="pgfId-1072107"></a>- Snap pattern to which the device has snapped</li><li>
<a id="pgfId-1077152"></a><strong>Edit Group:</strong> Displays the Auto Device Array form. Use the options in the form to create and edit Modgens. For more information about the form, see <a href="AutoDeviceArray.html#49602">Generating Modgens Automatically</a>.</li><li>
<a id="pgfId-1077109"></a><strong>Insert Row Above:</strong> Inserts a blank row above the selection.</li><li>
<a id="pgfId-1077128"></a><strong>Insert Row Below:</strong> Inserts a blank row below the selection.</li></ul>





































<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1074063"></a>An extended outline around grouped devices indicates that the number of open connections have exceeded the given certain threshold, which have resulted in unverified connectivity areas. These open connections are visible in the Annotation Browser. To address this issue, either re-extract the design or extract the unverified area in the Annotation Browser.</div>

<h2>
<a id="pgfId-1072112"></a><a id="91645"></a>Adding Base Layer Fill</h2>

<p>
<a id="pgfId-1072113"></a>After device placement, there might be some gaps in the layout design. The unfilled area might also result from the <em>Utilization</em> setting on the <em>Initialize</em> tab. Running a DRC check on the design at this point could report several spacing violations. To avoid these violations, you must generate base layer fill in the unfilled area, between devices. Base layer fill, which includes device, poly, and cut poly fill, are critical for density (manufacturing and matching) reasons at advanced nodes. The automated device placement and routing flow provides a unified interface for adding all types of base layer fill. To generate device fill:</p>
<ol><li>
<a id="pgfId-1072117"></a>Click <em>Add Base Layer Fill</em> in the Auto Device P&amp;R assistant to open the <em>Fill</em> tab.<br />
<a id="pgfId-1073136"></a><div class="webflare-div-image">
<img width="668" height="539" src="images/Routing-13.gif" /></div></li><li>
<a id="pgfId-1072126"></a>Ensure that <em>Enable Dummy Fill</em> is selected to add dummy fill. </li><li>
<a id="pgfId-1072127"></a>Specify the required options in the <em>Dummy Fill</em> section. <ol><li>
<a id="pgfId-1072146"></a>Select one of the following options to specify the instance to be considered as the master for creating dummy fill.</li><li>
<a id="pgfId-1072147"></a>Select <em>Neighbor</em> to create dummies that match the neighboring active devices. This option is selected by default.</li><li>
<a id="pgfId-1072148"></a>Specify the <em>Library</em>, <em>Cell</em>, and <em>View</em> of the master cellview when <em>Neighbor</em> is not selected.</li><li>
<a id="pgfId-1072149"></a>Specify the <em>Net Name</em> to which the dummy fill must be connected. </li><li>
<a id="pgfId-1072150"></a>Select <em>Match Neighbor</em> to match the connectivity of the dummy devices to the bulk net of the neighbor. The bulk net of the neighbor is assigned to the gate, source, and drain terminals of the dummy devices, unless the source and drain terminals overlap (abut) the active device terminals on a different net. <em>Match Neighbor</em> is selected by default. When unchecked and <em>Net Name</em> is blank, the dummy device terminals are not assigned any net unless they overlap (abut) an active device terminal to inherit its net.</li><li>
<a id="pgfId-1072151"></a>Select the required option from the <em>Create Fill As</em> section:</li><li>
<a id="pgfId-1073966"></a><em>Multiple Instance</em> mode inserts multiple dummy fill as per the setting of the <a href="Envars.html#54632">dummyFillNeighborMultipleMode</a> environment variable. When set to <code>singleFinger</code>, single-fingered multiple dummy instances are created. When set to <code>exactCopy</code>, dummies are created as exact copies of their neighboring instances.</li><li>
<a id="pgfId-1074803"></a><em>Single Instance</em> mode inserts each dummy fill as a single instance with multiple fingers to fill the gaps and empty rows. </li><li>
<a id="pgfId-1072152"></a>Select <em>Enable Hierarchical Fill</em> to look through the hierarchy to identify gaps that need to be filled.</li></ol></li><li>
<a id="pgfId-1072131"></a>Ensure that <em>Enable Poly Fill</em> is selected to insert poly fill.</li><li>
<a id="pgfId-1072155"></a>Specify the required options in the <em>Poly Fill</em> section. Poly fill extend the gate poly and add cut poly rails as per the DRC rules. <br /><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1073911"></a>As part of poly fill, the tool supports poly extensions, cut poly rails, and local interconnect layers, along with rails on the associated cut layer.</div><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1074994"></a>Poly fill does not fill diffusion areas and areas with placement blockages.</div><div class="webflare-information-macro webflare-macro-information">
<a id="pgfId-1078829"></a>
It is recommended that you do not place the same type of devices with different bulk nets in the same row. If present, extra space is left while inserting dummy fill to avoid shorts.</div><br />
<a id="pgfId-1073902"></a>To insert poly fill and cut poly:<ol><li>
<a id="pgfId-1072156"></a>Select the <em>Poly Layer</em> to derive cut-poly rails. The default value is the first layer-purpose pair that has its layer function set to <code>Poly</code>. </li><li>
<a id="pgfId-1072157"></a>Specify the maximum <em>Poly Fill Width</em> by which the fill can be extended. The default value is set to the minimum width value for the cut layer as defined in the technology file.</li><li>
<a id="pgfId-1072158"></a>Specify the <em>Cut-Poly Layer Width</em>. The default value is <code>0.0u</code>.</li></ol></li><li>
<a id="pgfId-1072136"></a>Specify the area to be filled using one of the following options:<ul><li>
<a id="pgfId-1072137"></a>CellView (default): Inserts device fill in all row regions in the current cellview.</li><li>
<a id="pgfId-1072138"></a>Row Region: Inserts device fill only in the row region you select from the drop-down list. </li><li>
<a id="pgfId-1072139"></a>Custom Area: Inserts device fill in the custom area drawn. You can either use <em>Area to Fill</em> to specify the area coordinates or click <em>Draw</em> to draw the required area in the canvas.<br /><div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1078067"></a>Device fill is not inserted in areas outside row regions.</div></li></ul></li><li>
<a id="pgfId-1072140"></a>Click <em>Insert Fill</em> to generate the required dummy and poly fill as per your specifications.</li></ol>








































<p>
<a id="pgfId-1072159"></a>The following image depicts a placed design for which automatic DRC-compliant base layer fill (Dummy and Poly) have been added. </p>
<ul><li>
<a id="pgfId-1072160"></a>The dummy fill cells match the neighboring active devices. </li><li>
<a id="pgfId-1072161"></a>The poly fill cells extend the gate poly and add cut poly as per the DRC.<br />
<a id="pgfId-1074455"></a><div class="webflare-div-image">
<img src="images/Fill_Result.gif" /></div></li></ul>





<p>
<a id="pgfId-1072165"></a>Select instances in the schematic to view the dummy fill around these devices. You can also see the gate poly of the devices being extended by the poly fill and the cut poly rails between rows of devices.</p>
<div class="webflare-information-macro webflare-macro-note">
<a id="pgfId-1074476"></a>You can select a local interconnect layer for diffusion from the <em>Fill Layer</em> drop-down list in the <em>Poly Fill</em> section to add fill for these layers. The associated cut layer is picked automatically. You can choose to fill the entire cellview or only the selected areas. </div>

<h4><em>
<a id="pgfId-1078878"></a>Why are poly fill not generated?</em></h4>

<p>
<a id="pgfId-1078879"></a>Poly fill might not be generated due to various design scenarios and constraints. To generate poly fill correctly, check the following settings:</p>
<ul><li>
<a id="pgfId-1078880"></a>Ensure that there are no diffusion areas. Poly fill do not fill the diffusion areas. </li><li>
<a id="pgfId-1078910"></a>Check for any spacing rules between diffusion areas and poly shapes. Ensure that these rules are adhered to.</li><li>
<a id="pgfId-1078881"></a>Ensure that the selected area is inside the cellview boundary.</li><li>
<a id="pgfId-1078882"></a>Ensure that the poly shapes are aligned properly along the poly grid. If not aligned, a warning message is displayed and poly fill are not inserted.</li><li>
<a id="pgfId-1078874"></a>Check whether the <code>allowedLengthRanges</code> rule is set for the specified fill layer in the technology file. If set, ensure that the spacing left for the poly fill in the selected area is sufficient to accommodate the poly fill.</li></ul>





<h4>
<a id="pgfId-1074514"></a>Deleting Fill</h4>

<p>
<a id="pgfId-1074570"></a>To delete device fill:</p>

<ol><li>
<a id="pgfId-1074610"></a>Select the required options in the <em>Dummy Fill</em> and <em>Poly Fill</em> areas to indicate the device fill to be deleted.</li><li>
<a id="pgfId-1072141"></a>Click <em>Delete Fill</em>.</li></ol>

<xx-commentlist>



<h2>
<a id="pgfId-1069279"></a><a id="66517"></a>Routing th<a id="routing"></a>e Design</h2>

<p>
<a id="pgfId-1070628"></a>The final step in the automated device placement and routing flow is device routing. You can use the Tree Router, which is the automatic device-level router to route your design.</p>
<p>
<a id="pgfId-1070886"></a>To route a design, click <em>Route Devices </em>in the Auto Device P&amp;R assistant to open the <em>Router </em>tab.</p>

<p>
<a id="pgfId-1071106"></a>Click <em>Enable Tree Router in Wire Assistant</em> to open the Wire Assistant. </p>

<p>
<a id="pgfId-1071215"></a></p>
<div class="webflare-div-image">
<img src="images/Router.gif" /></div>

<p>
<a id="pgfId-1071182"></a>The Auto Device Routing preset is selected by default. In this mode, the Tree router is used for routing. The Tree router automatically identifies and routes mesh, ring (tap cell rings), and tree structures in the design.</p>
<p>
<a id="pgfId-1071820"></a>The following image shows an automatically placed and routed design that is WSP-based, DRC-correct, and constraint-compliant.</p>

<p>
<a id="pgfId-1071877"></a></p>
<div class="webflare-div-image">
<img src="images/RoutedDesign.gif" /></div>

<p>
<a id="pgfId-1071714"></a>For more information about running the tree router, see <h-hot><a actuate="user" class="URL" href="../autouser/treeRouting.html#firstpage" show="replace" xml:link="simple">Using the Tree Route Flow (ICADVM 18.1 Only)</a></h-hot> in Virtuoso Space-based Router User Guide.</p>
<p>
<a id="pgfId-1071817"></a></p>

<br /><a href="#pagetop">Return to top</a><br /></xx-commentlist></div>
<!-- Begin Buttons --><!-- End Buttons -->
<footer><nav class="navigation"><b><em><a href="Place.html" id="prev" title="Initializing and Planning the Layout">Initializing and Planning the  ...</a></em></b><b><em><a href="AutoDeviceArray.html" id="nex" title="Generating Modgens Automatically">Generating Modgens Automatical ...</a></em></b></nav><div>
            For further assistance, contact <a href="https://support.cadence.com">Cadence Online Support</a>. Copyright &#169; 2020, <a href="https://www.cadence.com">Cadence Design Systems, Inc.</a> All rights reserved. 
          </div></footer>
</body></html>